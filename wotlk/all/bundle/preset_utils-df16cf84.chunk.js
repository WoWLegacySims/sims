var e=Object.defineProperty,t=(t,i,a)=>(((t,i,a)=>{i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a})(t,"symbol"!=typeof i?i+"":i,a),a);import{T as i,P as a,M as s}from"./index-6d46f689.chunk.js";import{P as o,T as l,a as n,b as r,C as d,p as c,c as m,e as h,r as p,I as u,s as g,g as f,f as w,i as I,A as x,D as y,d as b,H as v,h as S,M as E,j as P,k,l as C,m as _,n as N,R as T,o as R,q as L,t as G,W as A,u as D,v as U,w as O,x as M,y as W,z as V,B as F,E as z,F as j,G as H,J as B,K as q,L as $,N as K,O as Y,Q as J,U as Z,V as Q,X,Y as ee,Z as te,_ as ie,$ as ae,a0 as se,a1 as oe,a2 as le,S as ne,a3 as re,a4 as de,a5 as ce,a6 as me,a7 as he,a8 as pe,a9 as ue,aa as ge,ab as fe,ac as we,ad as Ie,ae as xe,af as ye,ag as be,ah as ve,ai as Se,aj as Ee,ak as Pe,al as ke,am as Ce,an as _e,ao as Ne,ap as Te,aq as Re,ar as Le,as as Ge,at as Ae,au as De,av as Ue,aw as Oe,ax as Me,ay as We,az as Ve,aA as Fe,aB as ze,aC as je,aD as He,aE as Be,aF as qe,aG as $e,aH as Ke,aI as Ye,aJ as Je,aK as Ze,aL as Qe,aM as Xe,aN as et,aO as tt,aP as it,aQ as at,aR as st,aS as ot,aT as lt,aU as nt,aV as rt,aW as dt,aX as ct,aY as mt,aZ as ht,a_ as pt,a$ as ut,b0 as gt,b1 as ft,b2 as wt,b3 as It,b4 as xt,b5 as yt,b6 as bt,b7 as vt,b8 as St,b9 as Et,ba as Pt,bb as kt,bc as Ct,bd as _t,be as Nt,bf as Tt,bg as Rt,bh as Lt,bi as Gt,bj as At,bk as Dt,bl as Ut,bm as Ot,bn as Mt,bo as Wt,bp as Vt,bq as Ft,br as zt,bs as jt,bt as Ht,bu as Bt,bv as qt,bw as $t,bx as Kt,by as Yt,bz as Jt,bA as Zt,bB as Qt,bC as Xt,bD as ei,bE as ti,bF as ii,bG as ai,bH as si,bI as oi,bJ as li,bK as ni,bL as ri,bM as di,bN as ci,bO as mi,bP as hi,bQ as pi,bR as ui,bS as gi,bT as fi,bU as wi,bV as Ii,bW as xi,bX as yi,bY as bi,bZ as vi,b_ as Si,b$ as Ei,c0 as Pi,c1 as ki,c2 as Ci,c3 as _i,c4 as Ni,c5 as Ti,c6 as Ri,c7 as Li,c8 as Gi,c9 as Ai,ca as Di,cb as Ui,cc as Oi,cd as Mi,ce as Wi,cf as Vi,cg as Fi,ch as zi,ci as ji,cj as Hi,ck as Bi,cl as qi,cm as $i,cn as Ki,co as Yi,cp as Ji,cq as Zi,cr as Qi,cs as Xi,ct as ea,cu as ta,cv as ia,cw as aa,cx as sa,cy as oa,cz as la,cA as na,cB as ra,cC as da,cD as ca,cE as ma,cF as ha,cG as pa,cH as ua,cI as ga,cJ as fa,cK as wa,cL as Ia,cM as xa,cN as ya,cO as ba,cP as va,cQ as Sa,cR as Ea,cS as Pa,cT as ka,cU as Ca,cV as _a,cW as Na,cX as Ta,cY as Ra,cZ as La,c_ as Ga,c$ as Aa,d0 as Da,d1 as Ua,d2 as Oa,d3 as Ma,d4 as Wa,d5 as Va,d6 as Fa,d7 as za,d8 as ja,d9 as Ha,da as Ba,db as qa,dc as $a,dd as Ka,de as Ya,df as Ja,dg as Za,dh as Qa,di as Xa,dj as es,dk as ts,dl as is,dm as as,dn as ss,dp as os,dq as ls,dr as ns,ds as rs,dt as ds,du as cs,dv as ms,dw as hs,dx as ps,dy as us,dz as gs,dA as fs,dB as ws,dC as Is,dD as xs,dE as ys,dF as bs,dG as vs,dH as Ss,dI as Es,dJ as Ps,dK as ks,dL as Cs,dM as _s,dN as Ns,dO as Ts,dP as Rs,dQ as Ls,dR as Gs,dS as As,dT as Ds,dU as Us,dV as Os,dW as Ms,dX as Ws,dY as Vs,dZ as Fs,d_ as zs,d$ as js}from"./detailed_results-cef766fa.chunk.js";const Hs={en:"English",cn:"简体中文",de:"Deutsch",es:"Español",fr:"Français",it:"Italiano",ko:"한국어",pt:"Português Brasileiro",ru:"Русский"};let Bs="";const qs={1:.096154,2:.096154,3:.096154,4:.096154,5:.096154,6:.096154,7:.096154,8:.096154,9:.096154,10:.096154,11:.144231,12:.192308,13:.240385,14:.288462,15:.336538,16:.384615,17:.432692,18:.480769,19:.528846,20:.576923,21:.625,22:.673077,23:.721154,24:.769231,25:.817308,26:.865385,27:.913462,28:.961538,29:1.009615,30:1.057692,31:1.105769,32:1.153846,33:1.201923,34:1.25,35:1.298077,36:1.346154,37:1.394231,38:1.442308,39:1.490385,40:1.538462,41:1.586538,42:1.634615,43:1.682692,44:1.730769,45:1.778846,46:1.826923,47:1.875,48:1.923077,49:1.971154,50:2.019231,51:2.067308,52:2.115385,53:2.163461,54:2.211539,55:2.259615,56:2.307692,57:2.355769,58:2.403846,59:2.451923,60:2.5,61:2.594937,62:2.697368,63:2.808219,64:2.928571,65:3.059702,66:3.203125,67:3.360656,68:3.534483,69:3.727273,70:3.942308,71:4.241735,72:4.563906,73:4.910545,74:5.283514,75:5.684809,76:6.116584,77:6.581153,78:7.081008,79:7.618829,80:8.197496,81:8.820117,82:9.490026,83:10.210818};function $s(e){return qs[e]}const Ks={1:.384615,2:.384615,3:.384615,4:.384615,5:.384615,6:.384615,7:.384615,8:.384615,9:.384615,10:.384615,11:.576923,12:.769231,13:.961538,14:1.153846,15:1.346154,16:1.538462,17:1.730769,18:1.923077,19:2.115385,20:2.307692,21:2.5,22:2.692308,23:2.884615,24:3.076923,25:3.269231,26:3.461538,27:3.653846,28:3.846154,29:4.038462,30:4.230769,31:4.423077,32:4.615385,33:4.807693,34:5,35:5.192308,36:5.384615,37:5.576923,38:5.769231,39:5.961538,40:6.153846,41:6.346154,42:6.538462,43:6.730769,44:6.923077,45:7.115385,46:7.307693,47:7.5,48:7.692307,49:7.884615,50:8.076923,51:8.269231,52:8.461538,53:8.653846,54:8.846154,55:9.038462,56:9.230769,57:9.423077,58:9.615385,59:9.807693,60:10,61:10.379747,62:10.789474,63:11.232877,64:11.714287,65:12.238807,66:12.8125,67:13.442624,68:14.137931,69:14.909091,70:15.769233,71:16.966942,72:18.255625,73:19.642183,74:21.134054,75:22.739237,76:24.466339,77:26.324617,78:28.324036,79:30.475315,80:32.789989,81:35.280472,82:37.960106,83:40.843273};function Ys(e){return Ks[e]}const Js={1:.538462,2:.538462,3:.538462,4:.538462,5:.538462,6:.538462,7:.538462,8:.538462,9:.538462,10:.538462,11:.807692,12:1.076923,13:1.346154,14:1.615385,15:1.884615,16:2.153846,17:2.423077,18:2.692308,19:2.961538,20:3.230769,21:3.5,22:3.769231,23:4.038462,24:4.307692,25:4.576923,26:4.846154,27:5.115385,28:5.384615,29:5.653846,30:5.923077,31:6.192307,32:6.461538,33:6.730769,34:7,35:7.269231,36:7.538462,37:7.807693,38:8.076923,39:8.346154,40:8.615384,41:8.884615,42:9.153846,43:9.423077,44:9.692307,45:9.961538,46:10.23077,47:10.5,48:10.769232,49:11.038462,50:11.307693,51:11.576923,52:11.846155,53:12.115385,54:12.384617,55:12.653847,56:12.923079,57:13.192308,58:13.461539,59:13.73077,60:14,61:14.531647,62:15.105265,63:15.726029,64:16.4,65:17.134329,66:17.9375,67:18.819674,68:19.793104,69:20.872728,70:22.076923,71:23.753721,72:25.557875,73:27.499056,74:29.587677,75:31.834934,76:34.252872,77:36.854465,78:39.653648,79:42.66544,80:45.905987,81:49.392658,82:53.14415,83:57.180576};function Zs(e){return Js[e]}const Qs={1:.384615,2:.384615,3:.384615,4:.384615,5:.384615,6:.384615,7:.384615,8:.384615,9:.384615,10:.384615,11:.576923,12:.769231,13:.961538,14:1.153846,15:1.346154,16:1.538462,17:1.730769,18:1.923077,19:2.115385,20:2.307692,21:2.5,22:2.692308,23:2.884615,24:3.076923,25:3.269231,26:3.461538,27:3.653846,28:3.846154,29:4.038462,30:4.230769,31:4.423077,32:4.615385,33:4.807693,34:5,35:5.192308,36:5.384615,37:5.576923,38:5.769231,39:5.961538,40:6.153846,41:6.346154,42:6.538462,43:6.730769,44:6.923077,45:7.115385,46:7.307693,47:7.5,48:7.692307,49:7.884615,50:8.076923,51:8.269231,52:8.461538,53:8.653846,54:8.846154,55:9.038462,56:9.230769,57:9.423077,58:9.615385,59:9.807693,60:10,61:10.379747,62:10.789474,63:11.232877,64:11.714287,65:12.238807,66:12.8125,67:13.442624,68:14.137931,69:14.909091,70:15.769233,71:16.966942,72:18.255625,73:19.642183,74:21.134054,75:22.739237,76:24.466339,77:26.324617,78:28.324036,79:30.475315,80:32.789989,81:35.280472,82:37.960106,83:40.843273};function Xs(e){return Qs[e]}const eo={1:.307692,2:.307692,3:.307692,4:.307692,5:.307692,6:.307692,7:.307692,8:.307692,9:.307692,10:.307692,11:.461538,12:.615385,13:.769231,14:.923077,15:1.076923,16:1.230769,17:1.384615,18:1.538462,19:1.692308,20:1.846154,21:2,22:2.153846,23:2.307692,24:2.461539,25:2.615385,26:2.769231,27:2.923077,28:3.076923,29:3.230769,30:3.384615,31:3.538462,32:3.692308,33:3.846154,34:4,35:4.153846,36:4.307692,37:4.461538,38:4.615385,39:4.769231,40:4.923077,41:5.076923,42:5.230769,43:5.384615,44:5.538462,45:5.692307,46:5.846154,47:6,48:6.153846,49:6.307693,50:6.461538,51:6.615385,52:6.769231,53:6.923077,54:7.076923,55:7.230769,56:7.384615,57:7.538462,58:7.692307,59:7.846154,60:8,61:8.303798,62:8.631579,63:8.986301,64:9.371428,65:9.791045,66:10.25,67:10.754099,68:11.310346,69:11.927274,70:12.615385,71:13.573555,72:14.6045,73:15.713748,74:16.907244,75:18.191391,76:19.573071,77:21.059694,78:22.659227,79:24.380253,80:26.231993,81:28.224375,82:30.368088,83:32.674614};function to(e){return eo[e]}const io={1:.75,2:.75,3:.75,4:.75,5:.75,6:.75,7:.75,8:.75,9:.75,10:.75,11:.75,12:.75,13:.75,14:.75,15:.75,16:.75,17:.75,18:.75,19:.75,20:.75,21:.75,22:.75,23:.75,24:.75,25:.75,26:.75,27:.75,28:.75,29:.75,30:.75,31:.75,32:.75,33:.75,34:.75,35:.778846,36:.807692,37:.836538,38:.865385,39:.894231,40:.923077,41:.951923,42:.980769,43:1.009615,44:1.038462,45:1.067308,46:1.096154,47:1.125,48:1.153846,49:1.182692,50:1.211538,51:1.240385,52:1.269231,53:1.298077,54:1.326923,55:1.355769,56:1.384615,57:1.413461,58:1.442308,59:1.471154,60:1.5,61:1.556962,62:1.618421,63:1.684931,64:1.757143,65:1.835821,66:1.921875,67:2.016393,68:2.12069,69:2.236364,70:2.365385,71:2.545041,72:2.738343,73:2.946327,74:3.170108,75:3.410886,76:3.66995,77:3.948692,78:4.248605,79:4.571297,80:4.918498,81:5.29207,82:5.694016,83:6.12649};function ao(e){return io[e]}const so={1:2.5,2:2.5,3:2.5,4:2.5,5:2.5,6:2.5,7:2.5,8:2.5,9:2.5,10:2.5,11:2.5,12:2.5,13:2.5,14:2.5,15:2.5,16:2.5,17:2.5,18:2.5,19:2.5,20:2.5,21:2.5,22:2.5,23:2.5,24:2.5,25:2.5,26:2.5,27:2.5,28:2.5,29:2.5,30:2.5,31:2.5,32:2.5,33:2.5,34:2.5,35:2.596154,36:2.692308,37:2.788461,38:2.884615,39:2.980769,40:3.076923,41:3.173077,42:3.269231,43:3.365385,44:3.461538,45:3.557692,46:3.653846,47:3.75,48:3.846154,49:3.942308,50:4.038462,51:4.134615,52:4.230769,53:4.326923,54:4.423077,55:4.519231,56:4.615385,57:4.711538,58:4.807693,59:4.903846,60:5,61:5.189874,62:5.394737,63:5.616438,64:5.857142,65:6.119403,66:6.406251,67:6.721312,68:7.068965,69:7.454545,70:7.884615,71:8.483471,72:9.127811,73:9.821091,74:10.567027,75:11.369618,76:12.23317,77:13.162309,78:14.162018,79:15.237658,80:16.394995,81:17.640236,82:18.980053,83:20.421637};const oo={1:14.375,2:14.375,3:14.375,4:14.375,5:14.375,6:14.375,7:14.375,8:14.375,9:14.375,10:14.375,11:14.375,12:14.375,13:14.375,14:14.375,15:14.375,16:14.375,17:14.375,18:14.375,19:14.375,20:14.375,21:14.375,22:14.375,23:14.375,24:14.375,25:14.375,26:14.375,27:14.375,28:14.375,29:14.375,30:14.375,31:14.375,32:14.375,33:14.375,34:14.375,35:14.927885,36:15.48077,37:16.033655,38:16.586538,39:17.139423,40:17.692308,41:18.245193,42:18.798079,43:19.350962,44:19.903847,45:20.456732,46:21.009617,47:21.5625,48:22.115387,49:22.668272,50:23.221157,51:23.77404,52:24.326925,53:24.879808,54:25.432693,55:25.985579,56:26.538464,57:27.091347,58:27.644234,59:28.197117,60:28.750002,61:29.841774,62:31.019739,63:32.294521,64:33.678574,65:35.186569,66:36.835941,67:38.647545,68:40.646553,69:42.86364,70:45.336544,71:48.779964,72:52.484921,73:56.471275,74:60.76041,75:65.375305,76:70.340721,77:75.683273,78:81.431602,79:87.616531,80:94.271225,81:101.43134,82:109.13531,83:117.4244};const lo={1:.16416545454545453,2:.16416545454545453,3:.16416545454545453,4:.16416545454545453,5:.16416545454545453,6:.16416545454545453,7:.16416545454545453,8:.16416545454545453,9:.16416545454545453,10:.16416545454545453,11:.2462472727272727,12:.32833,13:.41041272727272726,14:.4924954545454545,15:.5745781818181818,16:.65666,17:.7387427272727273,18:.8208254545454545,19:.9029081818181818,20:.984990909090909,21:1.0670736363636362,22:1.1491554545454543,23:1.2312381818181817,24:1.313320909090909,25:1.3954036363636364,26:1.4774854545454545,27:1.5595681818181817,28:1.641650909090909,29:1.7237336363636362,30:1.8058163636363636,31:1.8878990909090907,32:1.9699809090909088,33:2.0520636363636364,34:2.134146363636363,35:2.2162290909090907,36:2.298311818181818,37:2.380393636363636,38:2.4624763636363634,39:2.5445590909090905,40:2.626641818181818,41:2.708724545454545,42:2.7908063636363636,43:2.8728890909090907,44:2.954971818181818,45:3.037054545454545,46:3.1191372727272726,47:3.2012199999999997,48:3.283301818181818,49:3.3653845454545452,50:3.4474672727272724,51:3.52955,52:3.611631818181818,53:3.6937145454545455,54:3.775797272727272,55:3.85788,56:3.939962727272727,57:4.022044545454545,58:4.104127272727273,59:4.18621,60:4.268292727272726,61:4.4303799999999995,62:4.6052636363636354,63:4.794520909090909,64:5,65:5.223879999999999,66:5.46875,67:5.737704545454545,68:6.034482727272727,69:6.363636363636363,70:6.7307690909090905,71:7.241988181818181,72:7.792034545454544,73:8.383858181818182,74:9.020632727272726,75:9.705772727272725,76:10.44295,77:11.236117272727272,78:12.089528181818181,79:13.007757272727272,80:13.995727272727272,81:15.05873727272727,82:16.202484545454542,83:17.433102727272725};const no=5;class ro{constructor(e,i){t(this,"sim"),t(this,"raid"),t(this,"buffs",o.create()),t(this,"compChangeEmitter",new l),t(this,"buffsChangeEmitter",new l),t(this,"changeEmitter"),t(this,"players"),t(this,"playerChangeListener"),this.sim=i,this.raid=e,this.players=[...Array(5).keys()].map((e=>null)),this.playerChangeListener=e=>this.changeEmitter.emit(e),this.changeEmitter=l.onAny([this.compChangeEmitter,this.buffsChangeEmitter],"PartyChange")}size(){return this.players.filter((e=>null!=e)).length}isEmpty(){return 0==this.size()}clear(e){this.setBuffs(e,o.create());for(let t=0;t<5;t++)this.setPlayer(e,t,null)}getIndex(){return this.raid.getParties().indexOf(this)}getPlayers(){return this.players.slice()}getPlayer(e){return this.players[e]}setPlayer(e,t,i){if(t<0||t>=5)throw new Error("Invalid player index: "+t);i!=this.players[t]&&l.freezeAllAndDo((()=>{const a=this.players[t];if(null!=a&&(a.changeEmitter.off(this.playerChangeListener),a.setParty(null)),null!=i){const a=i.getParty();a&&a.setPlayer(e,i.getPartyIndex(),null),this.players[t]=i,i.changeEmitter.on(this.playerChangeListener),i.setParty(this)}else this.players[t]=null;this.compChangeEmitter.emit(e)}))}getBuffs(){return o.clone(this.buffs)}setBuffs(e,t){o.equals(this.buffs,t)||(this.buffs=o.clone(t),this.buffsChangeEmitter.emit(e))}toProto(e,t){return n.create({players:this.players.map((i=>null==i?r.create():i.toProto(e,t))),buffs:this.buffs})}fromProto(e,t){l.freezeAllAndDo((()=>{this.setBuffs(e,t.buffs||o.create());for(let i=0;i<5;i++){if(!t.players[i]||t.players[i].class==d.ClassUnknown){this.setPlayer(e,i,null);continue}const a=t.players[i],s=c(a),o=this.players[i];if(o&&s==o.spec)o.fromProto(e,a);else{const t=new Bo(s,this.sim);t.fromProto(e,a),this.setPlayer(e,i,t)}}}))}}class co extends m{constructor(e,a){const s=p();super(e,"copy-button",h("button",{className:`btn ${a.extraCssClasses?.join(" ")??""}`,ref:s},h("i",{className:"fas fa-copy me-1"}),a.text??"Copy to Clipboard")),t(this,"config"),this.config=a;const o=s.value;let l=!1;o.addEventListener("click",(e=>{if(l)return;const t=this.config.getContent();if(null==navigator.clipboard)alert(t);else{l=!0,navigator.clipboard.writeText(t);const e=o.innerHTML;o.innerHTML='<i class="fas fa-check me-1"></i>Copied',setTimeout((()=>{o.innerHTML=e,l=!1}),1500)}})),a.tooltip&&i.getOrCreateInstance(o,{title:a.tooltip})}}class mo extends u{constructor(e,i,a){super(e,"talents-picker-root",i,{...a,inline:!0}),t(this,"config"),t(this,"numRows"),t(this,"numCols"),t(this,"pointsPerRow"),t(this,"maxPoints"),t(this,"trees"),this.config=a,this.pointsPerRow=a.pointsPerRow,this.numRows=Math.max(...a.trees.map((e=>e.talents.map((e=>e.location.rowIdx)).flat())).flat())+1,this.numCols=Math.max(...a.trees.map((e=>e.talents.map((e=>e.location.colIdx)).flat())).flat())+1,this.maxPoints=a.maxPoints;const s=p(),o=()=>this.maxPoints-i.getTalentTreePoints().reduce(((e,t)=>e+t),0),n=()=>{const e=o();return h("span",{className:"talent-tree-points",ref:s},e)};l.onAny([i.talentsChangeEmitter,i.levelChangeEmitter]).on((()=>{this.maxPoints=i.getMaxTalentPoints(),s.value.replaceWith(n())}));const r=p();this.rootElem.appendChild(h("div",{id:"talents-carousel",className:"carousel slide"},h("div",{className:"talents-picker-header"},h("div",null,h("label",null,"Points Remaining:"),n()),h("div",{className:"talents-picker-actions",ref:r})),h("div",{className:"carousel-inner"}),h("div",{id:"talents-carousel",className:"carousel slide"},h("div",{className:"carousel-inner"}),h("button",{className:"carousel-control-prev",type:"button"},h("span",{className:"carousel-control-prev-icon",attributes:{"aria-hidden":!0}}),h("span",{className:"visually-hidden"},"Previous")),h("button",{className:"carousel-control-next",type:"button"},h("span",{className:"carousel-control-next-icon",attributes:{"aria-hidden":!0}}),h("span",{className:"visually-hidden"},"Next"))))),new co(r.value,{extraCssClasses:["btn-sm","btn-outline-primary","copy-talents"],getContent:()=>i.getTalentsString(),text:"Copy",tooltip:"Copy talent string"});const d=this.rootElem.querySelector(".carousel-inner"),c=this.rootElem.querySelector(".carousel-control-prev"),m=this.rootElem.querySelector(".carousel-control-next");this.trees=a.trees.map(((e,t)=>{const i=document.createElement("div");return d.appendChild(i),i.classList.add("carousel-item"),1===t&&i.classList.add("active"),"Ferocity"===e.name&&(t+=3),"Tenacity"===e.name&&(t+=4),"Cunning"===e.name&&(t+=5),new ho(i,e,this,a.klass,t)})),this.trees.forEach((e=>e.talents.forEach((e=>e.setPoints(0,!1)))));let u=0;c.addEventListener("click",(()=>{u>=1||(u+=1,d.style.transform=`translateX(${33.3*u}%)`,d.children[Math.abs(u-2)%3].classList.remove("active"),d.children[Math.abs(u-1)%3].classList.add("active"))})),m.addEventListener("click",(()=>{u<=-1||(u-=1,d.style.transform=`translateX(${33.3*u}%)`,d.children[Math.abs(u)%3].classList.remove("active"),d.children[Math.abs(u)+1].classList.add("active"))})),this.init()}getInputElem(){return this.rootElem}getInputValue(){return this.trees.map((e=>e.getTalentsString())).join("-").replace(/-+$/g,"")}setInputValue(e){const t=e.split("-");this.trees.forEach(((e,i)=>e.setTalentsString(t[i]||""))),this.updateTrees()}updateTrees(){this.isFull()?this.rootElem.classList.add("talents-full"):this.rootElem.classList.remove("talents-full"),this.trees.forEach((e=>e.update()))}get numPoints(){return g(this.trees.map((e=>e.numPoints)))}isFull(){return this.numPoints>=this.maxPoints}setMaxPoints(e){e!=this.maxPoints&&(this.maxPoints=e,this.updateTrees())}isHunterPet(){return["Cunning","Ferocity","Tenacity"].includes(this.config.trees[0].name)}}class ho extends m{constructor(e,a,s,o,n){super(e,"talent-tree-picker-root"),t(this,"config"),t(this,"title"),t(this,"pointsElem"),t(this,"talents"),t(this,"picker"),t(this,"numPoints"),this.config=a,this.numPoints=0,this.picker=s,this.rootElem.appendChild(h(w,null,h("div",{className:"talent-tree-header"},h("img",{src:f(o,n),className:"talent-tree-icon"}),h("span",{className:"talent-tree-title"}),h("span",{className:"talent-tree-points"}),h("button",{className:"talent-tree-reset btn btn-link link-danger"},h("i",{className:"fa fa-times"}))),h("div",{className:"talent-tree-background"}),h("div",{className:"talent-tree-main"}))),this.title=this.rootElem.getElementsByClassName("talent-tree-title")[0],this.pointsElem=this.rootElem.querySelector(".talent-tree-points");this.rootElem.querySelector(".talent-tree-background").style.backgroundImage=`url('${a.backgroundUrl}')`;const r=this.rootElem.querySelector(".talent-tree-main");r.style.gridTemplateRows=`repeat(${this.picker.numRows}, 1fr)`,r.style.gridTemplateColumns=`repeat(${this.picker.numCols}, 1fr)`;const d="3.5rem";r.style.height=`calc(${d} * ${this.picker.numRows})`,r.style.maxWidth=`calc(${d} * ${this.picker.numCols})`,this.rootElem.style.maxWidth=`calc(${d} * ${this.picker.numCols+2})`,this.talents=a.talents.map((e=>new uo(r,e,this))),this.talents.forEach((e=>{e.config.prereqLocation&&this.getTalent(e.config.prereqLocation).config.childLocations.push(e.config.location)}));const c=(e,t)=>{e.initChildReqs(),e.zIndex=t;for(const i of e.config.childLocations){const a=this.getTalent(i);a.parentReq=e.getChildReqArrow(i),c(a,t-2)}};for(const t of this.talents)0!=t.config.childLocations.length&&void 0===t.config.prereqLocation&&c(t,20);const m=this.rootElem.querySelector(".talent-tree-reset");new i(m,{title:"Reset talent points"}),m.addEventListener("click",(e=>{this.talents.forEach((e=>e.setPoints(0,!1))),this.picker.inputChanged(l.nextEventID())}))}update(){this.title.innerHTML=this.config.name,this.pointsElem.textContent=`${this.numPoints} / ${this.getMaxSpendablePoints()}`,this.talents.forEach((e=>e.update()))}getTalent(e){const t=this.talents.find((t=>t.getRow()==e.rowIdx&&t.getCol()==e.colIdx));if(!t)throw new Error("No talent found with location: "+e);return t}getTalentsString(){return this.talents.map((e=>String(e.getPoints()))).join("").replace(/0+$/g,"")}setTalentsString(e){this.talents.forEach(((t,i)=>t.setPoints(Number(e.charAt(i)),!1)))}getMaxSpendablePoints(){return this.picker.isHunterPet()?this.picker.modObject.getMaxPetTalentPoints():Math.max(0,this.picker.modObject.getMaxTalentPoints())}}class po extends m{constructor(e,i,a){super(e,"talent-picker-req-arrow",document.createElement("div")),t(this,"dir"),t(this,"zIdx"),t(this,"parentLoc"),t(this,"childLoc"),this.zIdx=0,this.parentLoc=i,this.childLoc=a,this.rootElem.style.gridRow=String(i.rowIdx+1),this.rootElem.style.gridColumn=String(i.colIdx+1);let s=Math.max(i.rowIdx,a.rowIdx)+1,o=Math.max(i.colIdx,a.colIdx)+1;i.rowIdx==a.rowIdx?(this.dir=i.colIdx<a.colIdx?"right":"left",this.rootElem.dataset.reqArrowColSize=String(Math.abs(i.colIdx-a.colIdx)),o="left"==this.dir?o+1:o-1):i.colIdx==a.colIdx?(this.dir="down",this.rootElem.dataset.reqArrowRowSize=String(Math.abs(i.rowIdx-a.rowIdx)),s+=1):(this.dir=i.colIdx<a.colIdx?"rightdown":"leftdown",this.rootElem.dataset.reqArrowColSize=String(Math.abs(i.colIdx-a.colIdx)),this.rootElem.dataset.reqArrowRowSize=String(Math.abs(i.rowIdx-a.rowIdx)),s+=1,o="rightdown"==this.dir?o+1:o-1,this.rootElem.appendChild(h("div",null))),this.rootElem.style.gridRowEnd=String(s),this.rootElem.style.gridColumnEnd=String(o),this.rootElem.classList.add(`talent-picker-req-arrow-${this.dir}`)}get zIndex(){return this.zIdx}set zIndex(e){this.zIdx=e,this.rootElem.style.zIndex=String(e)}setReqFufilled(e){e?this.rootElem.dataset.reqActive="true":delete this.rootElem.dataset.reqActive}}class uo extends m{constructor(e,i,a){super(e,"talent-picker-root",document.createElement("a")),t(this,"config"),t(this,"tree"),t(this,"pointsDisplay"),t(this,"longTouchTimer"),t(this,"childReqs"),t(this,"zIdx"),t(this,"parentReq"),this.config=i,this.tree=a,this.childReqs=[],this.parentReq=null,this.zIdx=0,this.rootElem.style.gridRow=String(this.config.location.rowIdx+1),this.rootElem.style.gridColumn=String(this.config.location.colIdx+1),this.rootElem.dataset.maxPoints=String(this.config.maxPoints),this.rootElem.dataset.whtticon="false",this.pointsDisplay=document.createElement("span"),this.pointsDisplay.classList.add("talent-picker-points"),this.rootElem.appendChild(this.pointsDisplay),this.rootElem.addEventListener("click",(e=>{e.preventDefault()})),this.rootElem.addEventListener("contextmenu",(e=>{e.preventDefault()})),this.rootElem.addEventListener("touchmove",(e=>{null!=this.longTouchTimer&&(clearTimeout(this.longTouchTimer),this.longTouchTimer=void 0)})),this.rootElem.addEventListener("touchstart",(e=>{e.preventDefault(),this.longTouchTimer=window.setTimeout((()=>{this.setPoints(0,!0),this.tree.picker.inputChanged(l.nextEventID()),this.longTouchTimer=void 0}),750)})),this.rootElem.addEventListener("touchend",(e=>{if(e.preventDefault(),null==this.longTouchTimer)return;clearTimeout(this.longTouchTimer),this.longTouchTimer=void 0;let t=this.getPoints()+1;this.config.maxPoints<t&&(t=0),this.setPoints(t,!0),this.tree.picker.inputChanged(l.nextEventID())})),this.rootElem.addEventListener("mousedown",(e=>{I(e)?this.setPoints(this.getPoints()-1,!0):this.setPoints(this.getPoints()+1,!0),this.tree.picker.inputChanged(l.nextEventID())}))}initChildReqs(){if(0!=this.config.childLocations.length)for(const e of this.config.childLocations)this.childReqs.push(new po(this.rootElem.parentElement,this.config.location,e))}getChildReqArrow(e){for(const t of this.childReqs)if(t.childLoc===e)return t;throw Error("missing child prereq?")}get zIndex(){return this.zIdx}set zIndex(e){this.zIdx=e,this.rootElem.style.zIndex=String(this.zIdx);for(const t of this.childReqs)t.zIndex=this.zIdx-1}getRow(){return this.config.location.rowIdx}getCol(){return this.config.location.colIdx}getPoints(){const e=Number(this.rootElem.dataset.points);return isNaN(e)?0:e}isFull(){return this.getPoints()>=this.config.maxPoints}canSetPoints(e){const t=this.getPoints();if(e>t){const i=e-t;if(this.tree.picker.numPoints+i>this.tree.picker.maxPoints)return!1;if(this.tree.numPoints<this.getRow()*this.tree.picker.pointsPerRow)return!1;if(this.config.prereqLocation&&!this.tree.getTalent(this.config.prereqLocation).isFull())return!1}else{const i=t-e,a=[...Array(this.tree.picker.numRows).keys()].map((e=>this.tree.talents.filter((t=>t.getRow()==e)))).map((e=>g(e.map((e=>e.getPoints())))));a[this.getRow()]-=i;const s=a.map(((e,t)=>g(a.slice(0,t+1))));if(!this.tree.talents.every((e=>0==e.getPoints()||0==e.getRow()||s[e.getRow()-1]>=e.getRow()*this.tree.picker.pointsPerRow)))return!1;for(const e of this.config.childLocations)if(this.tree.getTalent(e).getPoints()>0)return!1}return!0}setPoints(e,t){const i=this.getPoints();if(e=Math.max(0,e),e=Math.min(this.config.maxPoints,e),t&&!this.canSetPoints(e))return;this.tree.numPoints+=e-i,this.rootElem.dataset.points=String(e),this.pointsDisplay.textContent=e+"/"+this.config.maxPoints,this.isFull()?this.rootElem.classList.add("talent-full"):this.rootElem.classList.remove("talent-full");const a=this.getSpellIdForPoints(e);x.fromSpellId(a).fill().then((e=>{e.setWowheadHref(this.rootElem),this.rootElem.style.backgroundImage=`url('${e.iconUrl}')`}))}getSpellIdForPoints(e){const t=Math.max(0,e-1);if(this.config.spellIds[t])return this.config.spellIds[t];throw new Error(`No rank ${e} for talent ${String(this.config.fieldName)}`)}update(){const e=this.canSetPoints(this.getPoints()+1);e?this.rootElem.classList.add("talent-picker-can-add"):this.rootElem.classList.remove("talent-picker-can-add"),this.parentReq&&this.parentReq.setReqFufilled(e||this.isFull())}}function go(e){return e.forEach((e=>{e.talents.forEach(((t,i)=>{if(t.childLocations=[],0!=i){const a=e.talents[i-1];if(t.location.rowIdx<a.location.rowIdx||t.location.rowIdx==a.location.rowIdx&&t.location.colIdx<=a.location.colIdx)throw new Error(`Out-of-order talent: ${String(t.fieldName)}`)}if(t.spellIds.length<t.maxPoints){let e=t.spellIds[t.spellIds.length-1];for(let i=t.spellIds.length;i<t.maxPoints;i++)e++,t.spellIds.push(e)}}))})),e}const fo=go([{name:"Balance",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/283.jpg",talents:[{fieldName:"starlightWrath",location:{rowIdx:0,colIdx:1},spellIds:[16814,16815,16816,16817,16818],maxPoints:5},{fieldName:"genesis",location:{rowIdx:0,colIdx:2},spellIds:[57810,57811,57812,57813,57814],maxPoints:5},{fieldName:"moonglow",location:{rowIdx:1,colIdx:0},spellIds:[16845,16846,16847],maxPoints:3},{fieldName:"naturesMajesty",location:{rowIdx:1,colIdx:1},spellIds:[35363,35364],maxPoints:2},{fieldName:"improvedMoonfire",location:{rowIdx:1,colIdx:3},spellIds:[16821,16822],maxPoints:2},{fieldName:"brambles",location:{rowIdx:2,colIdx:0},spellIds:[16836,16839,16840],maxPoints:3},{fieldName:"naturesGrace",location:{rowIdx:2,colIdx:1},spellIds:[16880,61345,61346],maxPoints:3,prereqLocation:{rowIdx:1,colIdx:1}},{fieldName:"naturesSplendor",location:{rowIdx:2,colIdx:2},spellIds:[57865],maxPoints:1,prereqLocation:{rowIdx:1,colIdx:1}},{fieldName:"naturesReach",location:{rowIdx:2,colIdx:3},spellIds:[16819,16820],maxPoints:2},{fieldName:"vengeance",location:{rowIdx:3,colIdx:1},spellIds:[16909,16910,16911,16912,16913],maxPoints:5},{fieldName:"celestialFocus",location:{rowIdx:3,colIdx:2},spellIds:[16850,16923,16924],maxPoints:3},{fieldName:"lunarGuidance",location:{rowIdx:4,colIdx:0},spellIds:[33589,33590,33591],maxPoints:3},{fieldName:"insectSwarm",location:{rowIdx:4,colIdx:1},spellIds:[5570],maxPoints:1},{fieldName:"improvedInsectSwarm",location:{rowIdx:4,colIdx:2},spellIds:[57849,57850,57851],maxPoints:3,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"dreamstate",location:{rowIdx:5,colIdx:0},spellIds:[33597,33599,33956],maxPoints:3},{fieldName:"moonfury",location:{rowIdx:5,colIdx:1},spellIds:[16896,16897,16899],maxPoints:3},{fieldName:"balanceOfPower",location:{rowIdx:5,colIdx:2},spellIds:[33592,33596],maxPoints:2},{fieldName:"moonkinForm",location:{rowIdx:6,colIdx:1},spellIds:[24858],maxPoints:1},{fieldName:"improvedMoonkinForm",location:{rowIdx:6,colIdx:2},spellIds:[48384,48395,48396],maxPoints:3,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"improvedFaerieFire",location:{rowIdx:6,colIdx:3},spellIds:[33600,33601,33602],maxPoints:3},{fieldName:"owlkinFrenzy",location:{rowIdx:7,colIdx:0},spellIds:[48389,48392,48393],maxPoints:3,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"wrathOfCenarius",location:{rowIdx:7,colIdx:2},spellIds:[33603,33604,33605,33606,33607],maxPoints:5},{fieldName:"eclipse",location:{rowIdx:8,colIdx:0},spellIds:[48516,48521,48525],maxPoints:3},{fieldName:"typhoon",location:{rowIdx:8,colIdx:1},spellIds:[50516],maxPoints:1,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"forceOfNature",location:{rowIdx:8,colIdx:2},spellIds:[33831],maxPoints:1},{fieldName:"galeWinds",location:{rowIdx:8,colIdx:3},spellIds:[48488,48514],maxPoints:2},{fieldName:"earthAndMoon",location:{rowIdx:9,colIdx:1},spellIds:[48506,48510,48511],maxPoints:3},{fieldName:"starfall",location:{rowIdx:10,colIdx:1},spellIds:[48505],maxPoints:1}]},{name:"Feral Combat",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/281.jpg",talents:[{fieldName:"ferocity",location:{rowIdx:0,colIdx:1},spellIds:[16934,16935,16936,16937,16938],maxPoints:5},{fieldName:"feralAggression",location:{rowIdx:0,colIdx:2},spellIds:[16858,16859,16860,16861,16862],maxPoints:5},{fieldName:"feralInstinct",location:{rowIdx:1,colIdx:0},spellIds:[16947,16948,16949],maxPoints:3},{fieldName:"savageFury",location:{rowIdx:1,colIdx:1},spellIds:[16998,16999],maxPoints:2},{fieldName:"thickHide",location:{rowIdx:1,colIdx:2},spellIds:[16929,16930,16931],maxPoints:3},{fieldName:"feralSwiftness",location:{rowIdx:2,colIdx:0},spellIds:[17002,24866],maxPoints:2},{fieldName:"survivalInstincts",location:{rowIdx:2,colIdx:1},spellIds:[61336],maxPoints:1},{fieldName:"sharpenedClaws",location:{rowIdx:2,colIdx:2},spellIds:[16942,16943,16944],maxPoints:3},{fieldName:"shreddingAttacks",location:{rowIdx:3,colIdx:0},spellIds:[16966,16968],maxPoints:2},{fieldName:"predatoryStrikes",location:{rowIdx:3,colIdx:1},spellIds:[16972,16974,16975],maxPoints:3},{fieldName:"primalFury",location:{rowIdx:3,colIdx:2},spellIds:[37116,37117],maxPoints:2,prereqLocation:{rowIdx:2,colIdx:2}},{fieldName:"primalPrecision",location:{rowIdx:3,colIdx:3},spellIds:[48409,48410],maxPoints:2,prereqLocation:{rowIdx:2,colIdx:2}},{fieldName:"brutalImpact",location:{rowIdx:4,colIdx:0},spellIds:[16940,16941],maxPoints:2},{fieldName:"feralCharge",location:{rowIdx:4,colIdx:2},spellIds:[49377],maxPoints:1},{fieldName:"nurturingInstinct",location:{rowIdx:4,colIdx:3},spellIds:[33872,33873],maxPoints:2},{fieldName:"naturalReaction",location:{rowIdx:5,colIdx:0},spellIds:[57878,57880,57881],maxPoints:3},{fieldName:"heartOfTheWild",location:{rowIdx:5,colIdx:1},spellIds:[17003,17004,17005,17006,24894],maxPoints:5,prereqLocation:{rowIdx:3,colIdx:1}},{fieldName:"survivalOfTheFittest",location:{rowIdx:5,colIdx:2},spellIds:[33853,33855,33856],maxPoints:3},{fieldName:"leaderOfThePack",location:{rowIdx:6,colIdx:1},spellIds:[17007],maxPoints:1},{fieldName:"improvedLeaderOfThePack",location:{rowIdx:6,colIdx:2},spellIds:[34297,34300],maxPoints:2,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"primalTenacity",location:{rowIdx:6,colIdx:3},spellIds:[33851,33852,33957],maxPoints:3},{fieldName:"protectorOfThePack",location:{rowIdx:7,colIdx:0},spellIds:[57873,57876,57877],maxPoints:3,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"predatoryInstincts",location:{rowIdx:7,colIdx:2},spellIds:[33859,33866,33867],maxPoints:3},{fieldName:"infectedWounds",location:{rowIdx:7,colIdx:3},spellIds:[48483,48484,48485],maxPoints:3},{fieldName:"kingOfTheJungle",location:{rowIdx:8,colIdx:0},spellIds:[48492,48494,48495],maxPoints:3},{fieldName:"mangle",location:{rowIdx:8,colIdx:1},spellIds:[33917],maxPoints:1,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"improvedMangle",location:{rowIdx:8,colIdx:2},spellIds:[48532,48489,48491],maxPoints:3,prereqLocation:{rowIdx:8,colIdx:1}},{fieldName:"rendAndTear",location:{rowIdx:9,colIdx:1},spellIds:[48432,48433,48434,51268,51269],maxPoints:5},{fieldName:"primalGore",location:{rowIdx:9,colIdx:2},spellIds:[63503],maxPoints:1,prereqLocation:{rowIdx:9,colIdx:1}},{fieldName:"berserk",location:{rowIdx:10,colIdx:1},spellIds:[50334],maxPoints:1}]},{name:"Restoration",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/282.jpg",talents:[{fieldName:"improvedMarkOfTheWild",location:{rowIdx:0,colIdx:0},spellIds:[17050,17051],maxPoints:2},{fieldName:"naturesFocus",location:{rowIdx:0,colIdx:1},spellIds:[17063,17065,17066],maxPoints:3},{fieldName:"furor",location:{rowIdx:0,colIdx:2},spellIds:[17056,17058,17059,17060,17061],maxPoints:5},{fieldName:"naturalist",location:{rowIdx:1,colIdx:0},spellIds:[17069,17070,17071,17072,17073],maxPoints:5},{fieldName:"subtlety",location:{rowIdx:1,colIdx:1},spellIds:[17118,17119,17120],maxPoints:3},{fieldName:"naturalShapeshifter",location:{rowIdx:1,colIdx:2},spellIds:[16833,16834,16835],maxPoints:3},{fieldName:"intensity",location:{rowIdx:2,colIdx:0},spellIds:[17106,17107,17108],maxPoints:3},{fieldName:"omenOfClarity",location:{rowIdx:2,colIdx:1},spellIds:[16864],maxPoints:1},{fieldName:"masterShapeshifter",location:{rowIdx:2,colIdx:2},spellIds:[48411,48412],maxPoints:2,prereqLocation:{rowIdx:1,colIdx:2}},{fieldName:"tranquilSpirit",location:{rowIdx:3,colIdx:1},spellIds:[24968,24969,24970,24971,24972],maxPoints:5},{fieldName:"improvedRejuvenation",location:{rowIdx:3,colIdx:2},spellIds:[17111,17112,17113],maxPoints:3},{fieldName:"naturesSwiftness",location:{rowIdx:4,colIdx:0},spellIds:[17116],maxPoints:1,prereqLocation:{rowIdx:2,colIdx:0}},{fieldName:"giftOfNature",location:{rowIdx:4,colIdx:1},spellIds:[17104,24943,24944,24945,24946],maxPoints:5},{fieldName:"improvedTranquility",location:{rowIdx:4,colIdx:3},spellIds:[17123,17124],maxPoints:2},{fieldName:"empoweredTouch",location:{rowIdx:5,colIdx:0},spellIds:[33879,33880],maxPoints:2},{fieldName:"naturesBounty",location:{rowIdx:5,colIdx:2},spellIds:[17074,17075,17076,17077,17078],maxPoints:5,prereqLocation:{rowIdx:3,colIdx:2}},{fieldName:"livingSpirit",location:{rowIdx:6,colIdx:0},spellIds:[34151,34152,34153],maxPoints:3},{fieldName:"swiftmend",location:{rowIdx:6,colIdx:1},spellIds:[18562],maxPoints:1,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"naturalPerfection",location:{rowIdx:6,colIdx:2},spellIds:[33881,33882,33883],maxPoints:3},{fieldName:"empoweredRejuvenation",location:{rowIdx:7,colIdx:1},spellIds:[33886,33887,33888,33889,33890],maxPoints:5},{fieldName:"livingSeed",location:{rowIdx:7,colIdx:2},spellIds:[48496,48499,48500],maxPoints:3},{fieldName:"revitalize",location:{rowIdx:8,colIdx:0},spellIds:[48539,48544,48545],maxPoints:3},{fieldName:"treeOfLife",location:{rowIdx:8,colIdx:1},spellIds:[65139],maxPoints:1,prereqLocation:{rowIdx:7,colIdx:1}},{fieldName:"improvedTreeOfLife",location:{rowIdx:8,colIdx:2},spellIds:[48535,48536,48537],maxPoints:3,prereqLocation:{rowIdx:8,colIdx:1}},{fieldName:"improvedBarkskin",location:{rowIdx:9,colIdx:0},spellIds:[63410,63411],maxPoints:2},{fieldName:"giftOfTheEarthmother",location:{rowIdx:9,colIdx:2},spellIds:[51179,51180,51181,51182,51183],maxPoints:5},{fieldName:"wildGrowth",location:{rowIdx:10,colIdx:1},spellIds:[48438],maxPoints:1,prereqLocation:{rowIdx:8,colIdx:1}}]}]),wo={majorGlyphs:{[y.GlyphOfBarkskin]:{name:"Glyph of Barkskin",description:"Reduces the chance you'll be critically hit by 25% while Barkskin is active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_stoneclawtotem.jpg"},[y.GlyphOfBerserk]:{name:"Glyph of Berserk",description:"Increases the duration of Berserk by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_berserk.jpg"},[y.GlyphOfClaw]:{name:"Glyph of Claw",description:"Reduces the energy cost of your Claw ability by 5.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_rake.jpg"},[y.GlyphOfEntanglingRoots]:{name:"Glyph of Entangling Roots",description:"Increases the damage your Entangling Roots victims can take before the Entangling Roots automatically breaks by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_stranglevines.jpg"},[y.GlyphOfFocus]:{name:"Glyph of Focus",description:"Increases the damage done by Starfall by 10%, but decreases its radius by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_starfall.jpg"},[y.GlyphOfFrenziedRegeneration]:{name:"Glyph of Frenzied Regeneration",description:"While Frenzied Regeneration is active, healing effects on you are 20% more powerful.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_bullrush.jpg"},[y.GlyphOfGrowling]:{name:"Glyph of Growling",description:"Increases the chance for your Growl ability to work successfully by 8%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_physical_taunt.jpg"},[y.GlyphOfHealingTouch]:{name:"Glyph of Healing Touch",description:"Decreases the cast time of Healing Touch by 1.5 sec, the mana cost by 25%, and the amount healed by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_healingtouch.jpg"},[y.GlyphOfHurricane]:{name:"Glyph of Hurricane",description:"Your Hurricane ability now also slows the movement speed of its victims by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_cyclone.jpg"},[y.GlyphOfInnervate]:{name:"Glyph of Innervate",description:'Innervate now grants the caster 45% of <dfn title="her">his</dfn> base mana pool over 10 sec in addition to the normal effects of Innervate.',iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_lightning.jpg"},[y.GlyphOfInsectSwarm]:{name:"Glyph of Insect Swarm",description:"Increases the damage of your Insect Swarm ability by 30%, but it no longer affects your victim's chance to hit.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_insectswarm.jpg"},[y.GlyphOfLifebloom]:{name:"Glyph of Lifebloom",description:"Increases the duration of Lifebloom by 1 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_herb_felblossom.jpg"},[y.GlyphOfMangle]:{name:"Glyph of Mangle",description:"Increases the damage done by Mangle by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_mangle2.jpg"},[y.GlyphOfMaul]:{name:"Glyph of Maul",description:"Your Maul ability now hits 1 additional target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_maul.jpg"},[y.GlyphOfMonsoon]:{name:"Glyph of Monsoon",description:"Reduces the cooldown of your Typhoon spell by 3 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_typhoon.jpg"},[y.GlyphOfMoonfire]:{name:"Glyph of Moonfire",description:"Increases the periodic damage of your Moonfire ability by 75%, but initial damage is decreased by 90%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_starfall.jpg"},[y.GlyphOfNourish]:{name:"Glyph of Nourish",description:"Your Nourish heals an additional 6% for each of your heal over time effects present on the target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_nourish.jpg"},[y.GlyphOfRake]:{name:"Glyph of Rake",description:"Your Rake ability prevents targets from fleeing.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_disembowel.jpg"},[y.GlyphOfRapidRejuvenation]:{name:"Glyph of Rapid Rejuvenation",description:"Your haste now reduces the time between the periodic healing ticks of your Rejuvenation spell.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_rejuvenation.jpg"},[y.GlyphOfRebirth]:{name:"Glyph of Rebirth",description:"Players resurrected by Rebirth are returned to life with 100% health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_reincarnation.jpg"},[y.GlyphOfRegrowth]:{name:"Glyph of Regrowth",description:"Increases the healing of your Regrowth spell by 20% if your Regrowth effect is still active on the target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_resistnature.jpg"},[y.GlyphOfRejuvenation]:{name:"Glyph of Rejuvenation",description:"While your Rejuvenation targets are below 50% health, you will heal them for an additional 50% health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_rejuvenation.jpg"},[y.GlyphOfRip]:{name:"Glyph of Rip",description:"Increases the duration of your Rip ability by 4 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_ghoulfrenzy.jpg"},[y.GlyphOfSavageRoar]:{name:"Glyph of Savage Roar",description:"Your Savage Roar ability grants an additional 3% bonus damage done.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_skinteeth.jpg"},[y.GlyphOfShred]:{name:"Glyph of Shred",description:"Each time you Shred, the duration of your Rip on the target is extended 2 sec, up to a maximum of 6 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_vampiricaura.jpg"},[y.GlyphOfStarfall]:{name:"Glyph of Starfall",description:"Reduces the cooldown of Starfall by 30 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_starfall.jpg"},[y.GlyphOfStarfire]:{name:"Glyph of Starfire",description:"Your Starfire ability increases the duration of your Moonfire effect on the target by 3 sec, up to a maximum of 9 additional seconds.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_starfire.jpg"},[y.GlyphOfSurvivalInstincts]:{name:"Glyph of Survival Instincts",description:"Your Survival Instincts ability grants an additional 15% of your maximum health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_tigersroar.jpg"},[y.GlyphOfSwiftmend]:{name:"Glyph of Swiftmend",description:"Your Swiftmend ability no longer consumes a Rejuvenation or Regrowth effect from the target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_relics_idolofrejuvenation.jpg"},[y.GlyphOfWildGrowth]:{name:"Glyph of Wild Growth",description:"Wild Growth can affect 1 additional target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_flourish.jpg"},[y.GlyphOfWrath]:{name:"Glyph of Wrath",description:"Reduces the pushback suffered from damaging attacks while casting your Wrath spell by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_abolishmagic.jpg"}},minorGlyphs:{[b.GlyphOfAquaticForm]:{name:"Glyph of Aquatic Form",description:"Increases your swim speed by 50% while in Aquatic Form.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_aquaticform.jpg"},[b.GlyphOfChallengingRoar]:{name:"Glyph of Challenging Roar",description:"Reduces the cooldown of your Challenging Roar ability by 30 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_challangingroar.jpg"},[b.GlyphOfDash]:{name:"Glyph of Dash",description:"Reduces the cooldown of your Dash ability by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_dash.jpg"},[b.GlyphOfTheWild]:{name:"Glyph of the Wild",description:"Mana cost of your Mark of the Wild and Gift of the Wild spells reduced by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_regeneration.jpg"},[b.GlyphOfThorns]:{name:"Glyph of Thorns",description:"Increases the duration of your Thorns ability by 50 min when cast on yourself.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_thorns.jpg"},[b.GlyphOfTyphoon]:{name:"Glyph of Typhoon",description:"Reduces the cost of your Typhoon spell by 8% and increases its radius by 10 yards, but it no longer knocks enemies back.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_typhoon.jpg"},[b.GlyphOfUnburdenedRebirth]:{name:"Glyph of Unburdened Rebirth",description:"Your Rebirth spell no longer requires a reagent.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_reincarnation.jpg"}}},Io=go([{name:"Beast Mastery",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/361.jpg",talents:[{fieldName:"improvedAspectOfTheHawk",location:{rowIdx:0,colIdx:1},spellIds:[19552,19553,19554,19555,19556],maxPoints:5},{fieldName:"enduranceTraining",location:{rowIdx:0,colIdx:2},spellIds:[19583,19584,19585,19586,19587],maxPoints:5},{fieldName:"focusedFire",location:{rowIdx:1,colIdx:0},spellIds:[35029,35030],maxPoints:2},{fieldName:"improvedAspectOfTheMonkey",location:{rowIdx:1,colIdx:1},spellIds:[19549,19550,19551],maxPoints:3},{fieldName:"thickHide",location:{rowIdx:1,colIdx:2},spellIds:[19609,19610,19612],maxPoints:3},{fieldName:"improvedRevivePet",location:{rowIdx:1,colIdx:3},spellIds:[24443,19575],maxPoints:2},{fieldName:"pathfinding",location:{rowIdx:2,colIdx:0},spellIds:[19559,19560],maxPoints:2},{fieldName:"aspectMastery",location:{rowIdx:2,colIdx:1},spellIds:[53265],maxPoints:1},{fieldName:"unleashedFury",location:{rowIdx:2,colIdx:2},spellIds:[19616,19617,19618,19619,19620],maxPoints:5},{fieldName:"improvedMendPet",location:{rowIdx:3,colIdx:1},spellIds:[19572,19573],maxPoints:2},{fieldName:"ferocity",location:{rowIdx:3,colIdx:2},spellIds:[19598,19599,19600,19601,19602],maxPoints:5},{fieldName:"spiritBond",location:{rowIdx:4,colIdx:0},spellIds:[19578,20895],maxPoints:2},{fieldName:"intimidation",location:{rowIdx:4,colIdx:1},spellIds:[19577],maxPoints:1},{fieldName:"bestialDiscipline",location:{rowIdx:4,colIdx:3},spellIds:[19590,19592],maxPoints:2},{fieldName:"animalHandler",location:{rowIdx:5,colIdx:0},spellIds:[34453,34454],maxPoints:2},{fieldName:"frenzy",location:{rowIdx:5,colIdx:2},spellIds:[19621,19622,19623,19624,19625],maxPoints:5,prereqLocation:{rowIdx:3,colIdx:2}},{fieldName:"ferociousInspiration",location:{rowIdx:6,colIdx:0},spellIds:[34455,34459,34460],maxPoints:3},{fieldName:"bestialWrath",location:{rowIdx:6,colIdx:1},spellIds:[19574],maxPoints:1,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"catlikeReflexes",location:{rowIdx:6,colIdx:2},spellIds:[34462,34464,34465],maxPoints:3},{fieldName:"invigoration",location:{rowIdx:7,colIdx:0},spellIds:[53252,53253],maxPoints:2,prereqLocation:{rowIdx:6,colIdx:0}},{fieldName:"serpentsSwiftness",location:{rowIdx:7,colIdx:2},spellIds:[34466,34467,34468,34469,34470],maxPoints:5},{fieldName:"longevity",location:{rowIdx:8,colIdx:0},spellIds:[53262,53263,53264],maxPoints:3},{fieldName:"theBeastWithin",location:{rowIdx:8,colIdx:1},spellIds:[34692],maxPoints:1,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"cobraStrikes",location:{rowIdx:8,colIdx:2},spellIds:[53256,53259,53260],maxPoints:3,prereqLocation:{rowIdx:7,colIdx:2}},{fieldName:"kindredSpirits",location:{rowIdx:9,colIdx:1},spellIds:[56314,56315,56316,56317,56318],maxPoints:5},{fieldName:"beastMastery",location:{rowIdx:10,colIdx:1},spellIds:[53270],maxPoints:1}]},{name:"Marksmanship",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/363.jpg",talents:[{fieldName:"improvedConcussiveShot",location:{rowIdx:0,colIdx:0},spellIds:[19407,19412],maxPoints:2},{fieldName:"focusedAim",location:{rowIdx:0,colIdx:1},spellIds:[53620,53621,53622],maxPoints:3},{fieldName:"lethalShots",location:{rowIdx:0,colIdx:2},spellIds:[19426,19427,19429,19430,19431],maxPoints:5},{fieldName:"carefulAim",location:{rowIdx:1,colIdx:0},spellIds:[34482,34483,34484],maxPoints:3},{fieldName:"improvedHuntersMark",location:{rowIdx:1,colIdx:1},spellIds:[19421,19422,19423],maxPoints:3},{fieldName:"mortalShots",location:{rowIdx:1,colIdx:2},spellIds:[19485,19487,19488,19489,19490],maxPoints:5},{fieldName:"goForTheThroat",location:{rowIdx:2,colIdx:0},spellIds:[34950,34954],maxPoints:2},{fieldName:"improvedArcaneShot",location:{rowIdx:2,colIdx:1},spellIds:[19454,19455,19456],maxPoints:3},{fieldName:"aimedShot",location:{rowIdx:2,colIdx:2},spellIds:[19434],maxPoints:1,prereqLocation:{rowIdx:1,colIdx:2}},{fieldName:"rapidKilling",location:{rowIdx:2,colIdx:3},spellIds:[34948,34949],maxPoints:2},{fieldName:"improvedStings",location:{rowIdx:3,colIdx:1},spellIds:[19464,19465,19466],maxPoints:3},{fieldName:"efficiency",location:{rowIdx:3,colIdx:2},spellIds:[19416,19417,19418,19419,19420],maxPoints:5},{fieldName:"concussiveBarrage",location:{rowIdx:4,colIdx:0},spellIds:[35100,35102],maxPoints:2},{fieldName:"readiness",location:{rowIdx:4,colIdx:1},spellIds:[23989],maxPoints:1},{fieldName:"barrage",location:{rowIdx:4,colIdx:2},spellIds:[19461,19462,24691],maxPoints:3},{fieldName:"combatExperience",location:{rowIdx:5,colIdx:0},spellIds:[34475,34476],maxPoints:2},{fieldName:"rangedWeaponSpecialization",location:{rowIdx:5,colIdx:3},spellIds:[19507,19508,19509],maxPoints:3},{fieldName:"piercingShots",location:{rowIdx:6,colIdx:0},spellIds:[53234,53237,53238],maxPoints:3},{fieldName:"trueshotAura",location:{rowIdx:6,colIdx:1},spellIds:[19506],maxPoints:1,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"improvedBarrage",location:{rowIdx:6,colIdx:2},spellIds:[35104,35110,35111],maxPoints:3,prereqLocation:{rowIdx:4,colIdx:2}},{fieldName:"masterMarksman",location:{rowIdx:7,colIdx:1},spellIds:[34485,34486,34487,34488,34489],maxPoints:5},{fieldName:"rapidRecuperation",location:{rowIdx:7,colIdx:2},spellIds:[53228,53232],maxPoints:2},{fieldName:"wildQuiver",location:{rowIdx:8,colIdx:0},spellIds:[53215,53216,53217],maxPoints:3},{fieldName:"silencingShot",location:{rowIdx:8,colIdx:1},spellIds:[34490],maxPoints:1,prereqLocation:{rowIdx:7,colIdx:1}},{fieldName:"improvedSteadyShot",location:{rowIdx:8,colIdx:2},spellIds:[53221,53222,53224],maxPoints:3},{fieldName:"markedForDeath",location:{rowIdx:9,colIdx:1},spellIds:[53241,53243,53244,53245,53246],maxPoints:5},{fieldName:"chimeraShot",location:{rowIdx:10,colIdx:1},spellIds:[53209],maxPoints:1}]},{name:"Survival",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/362.jpg",talents:[{fieldName:"improvedTracking",location:{rowIdx:0,colIdx:0},spellIds:[52783,52785,52786,52787,52788],maxPoints:5},{fieldName:"hawkEye",location:{rowIdx:0,colIdx:1},spellIds:[19498,19499,19500],maxPoints:3},{fieldName:"savageStrikes",location:{rowIdx:0,colIdx:2},spellIds:[19159,19160],maxPoints:2},{fieldName:"surefooted",location:{rowIdx:1,colIdx:0},spellIds:[19290,19294,24283],maxPoints:3},{fieldName:"entrapment",location:{rowIdx:1,colIdx:1},spellIds:[19184,19387,19388],maxPoints:3},{fieldName:"trapMastery",location:{rowIdx:1,colIdx:2},spellIds:[19376,63457,63458],maxPoints:3},{fieldName:"survivalInstincts",location:{rowIdx:1,colIdx:3},spellIds:[34494,34496],maxPoints:2},{fieldName:"survivalist",location:{rowIdx:2,colIdx:0},spellIds:[19255,19256,19257,19258,19259],maxPoints:5},{fieldName:"scatterShot",location:{rowIdx:2,colIdx:1},spellIds:[19503],maxPoints:1},{fieldName:"deflection",location:{rowIdx:2,colIdx:2},spellIds:[19295,19297,19298],maxPoints:3},{fieldName:"survivalTactics",location:{rowIdx:2,colIdx:3},spellIds:[19286,19287],maxPoints:2},{fieldName:"tNT",location:{rowIdx:3,colIdx:1},spellIds:[56333,56336,56337],maxPoints:3},{fieldName:"lockAndLoad",location:{rowIdx:3,colIdx:3},spellIds:[56342,56343,56344],maxPoints:3},{fieldName:"hunterVsWild",location:{rowIdx:4,colIdx:0},spellIds:[56339,56340,56341],maxPoints:3,prereqLocation:{rowIdx:2,colIdx:0}},{fieldName:"killerInstinct",location:{rowIdx:4,colIdx:1},spellIds:[19370,19371,19373],maxPoints:3},{fieldName:"counterattack",location:{rowIdx:4,colIdx:2},spellIds:[19306],maxPoints:1,prereqLocation:{rowIdx:2,colIdx:2}},{fieldName:"lightningReflexes",location:{rowIdx:5,colIdx:0},spellIds:[19168,19180,19181,24296,24297],maxPoints:5},{fieldName:"resourcefulness",location:{rowIdx:5,colIdx:2},spellIds:[34491,34492,34493],maxPoints:3},{fieldName:"exposeWeakness",location:{rowIdx:6,colIdx:0},spellIds:[34500,34502,34503],maxPoints:3,prereqLocation:{rowIdx:5,colIdx:0}},{fieldName:"wyvernSting",location:{rowIdx:6,colIdx:1},spellIds:[19386],maxPoints:1,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"thrillOfTheHunt",location:{rowIdx:6,colIdx:2},spellIds:[34497,34498,34499],maxPoints:3},{fieldName:"masterTactician",location:{rowIdx:7,colIdx:0},spellIds:[34506,34507,34508,34838,34839],maxPoints:5},{fieldName:"noxiousStings",location:{rowIdx:7,colIdx:1},spellIds:[53295,53296,53297],maxPoints:3,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"pointOfNoEscape",location:{rowIdx:8,colIdx:0},spellIds:[53298,53299],maxPoints:2},{fieldName:"blackArrow",location:{rowIdx:8,colIdx:1},spellIds:[3674],maxPoints:1},{fieldName:"sniperTraining",location:{rowIdx:8,colIdx:3},spellIds:[53302,53303,53304],maxPoints:3},{fieldName:"huntingParty",location:{rowIdx:9,colIdx:2},spellIds:[53290,53291,53292],maxPoints:3,prereqLocation:{rowIdx:6,colIdx:2}},{fieldName:"explosiveShot",location:{rowIdx:10,colIdx:1},spellIds:[53301],maxPoints:1,prereqLocation:{rowIdx:8,colIdx:1}}]}]),xo={majorGlyphs:{[v.GlyphOfAimedShot]:{name:"Glyph of Aimed Shot",description:"Reduces the cooldown of your Aimed Shot ability by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_spear_07.jpg"},[v.GlyphOfArcaneShot]:{name:"Glyph of Arcane Shot",description:"Your Arcane Shot refunds 20% of its mana cost if the target has one of your Stings active on it.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_impalingbolt.jpg"},[v.GlyphOfAspectOfTheViper]:{name:"Glyph of Aspect of the Viper",description:"Increases the amount of mana gained from attacks while Aspect of the Viper is active by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_aspectoftheviper.jpg"},[v.GlyphOfBestialWrath]:{name:"Glyph of Bestial Wrath",description:"Decreases the cooldown of Bestial Wrath by 20 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_ferociousbite.jpg"},[v.GlyphOfChimeraShot]:{name:"Glyph of Chimera Shot",description:"Reduces the cooldown of Chimera Shot by 1 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_chimerashot2.jpg"},[v.GlyphOfDeterrence]:{name:"Glyph of Deterrence",description:"Decreases the cooldown of Deterrence by 10 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_whirlwind.jpg"},[v.GlyphOfDisengage]:{name:"Glyph of Disengage",description:"Decreases the cooldown of Disengage by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_feint.jpg"},[v.GlyphOfExplosiveShot]:{name:"Glyph of Explosive Shot",description:"Increases the critical strike chance of Explosive Shot by 4%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_explosiveshot.jpg"},[v.GlyphOfExplosiveTrap]:{name:"Glyph of Explosive Trap",description:"The periodic damage from your Explosive Trap can now be critical strikes.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_selfdestruct.jpg"},[v.GlyphOfFreezingTrap]:{name:"Glyph of Freezing Trap",description:"When your Freezing Trap breaks, the victim's movement speed is reduced by 30% for 4 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_chainsofice.jpg"},[v.GlyphOfFrostTrap]:{name:"Glyph of Frost Trap",description:"Increases the radius of the effect from your Frost Trap by 2 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_freezingbreath.jpg"},[v.GlyphOfHuntersMark]:{name:"Glyph of Hunter's Mark",description:"Increases the attack power bonus of your Hunter's Mark by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_snipershot.jpg"},[v.GlyphOfImmolationTrap]:{name:"Glyph of Immolation Trap",description:"Decreases the duration of the effect from your Immolation Trap by 6 sec., but damage while active is increased by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_flameshock.jpg"},[v.GlyphOfKillShot]:{name:"Glyph of Kill Shot",description:"Reduces the cooldown of Kill Shot by 6 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_assassinate2.jpg"},[v.GlyphOfMending]:{name:"Glyph of Mending",description:"Increases the healing done by your Mend Pet ability by 40%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_mendpet.jpg"},[v.GlyphOfMultiShot]:{name:"Glyph of Multi-Shot",description:"Decreases the cooldown of Multi-Shot by 1 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_upgrademoonglaive.jpg"},[v.GlyphOfRapidFire]:{name:"Glyph of Rapid Fire",description:"Increases the haste from Rapid Fire by an additional 8%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_runningshot.jpg"},[v.GlyphOfRaptorStrike]:{name:"Glyph of Raptor Strike",description:"Reduces damage taken by 20% for 3 sec after using Raptor Strike.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_meleedamage.jpg"},[v.GlyphOfScatterShot]:{name:"Glyph of Scatter Shot",description:"Increases the range of Scatter Shot by 3 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_golemstormbolt.jpg"},[v.GlyphOfSerpentSting]:{name:"Glyph of Serpent Sting",description:"Increases the duration of your Serpent Sting by 6 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_quickshot.jpg"},[v.GlyphOfSnakeTrap]:{name:"Glyph of Snake Trap",description:"Snakes from your Snake Trap take 90% reduced damage from area of effect spells.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_snaketrap.jpg"},[v.GlyphOfSteadyShot]:{name:"Glyph of Steady Shot",description:"Increases the damage dealt by Steady Shot by 10% when your target is afflicted with Serpent Sting.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_steadyshot.jpg"},[v.GlyphOfTheBeast]:{name:"Glyph of the Beast",description:"Increases the attack power bonus of Aspect of the Beast for you and your pet by an additional 2%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mount_pinktiger.jpg"},[v.GlyphOfTheHawk]:{name:"Glyph of the Hawk",description:"Increases the haste bonus of the Improved Aspect of the Hawk effect by an additional 6%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_ravenform.jpg"},[v.GlyphOfTrueshotAura]:{name:"Glyph of Trueshot Aura",description:"While your Trueshot Aura is active, you have 10% increased critical strike chance on your Aimed Shot.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_trueshot.jpg"},[v.GlyphOfVolley]:{name:"Glyph of Volley",description:"Decreases the mana cost of Volley by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_marksmanship.jpg"},[v.GlyphOfWyvernSting]:{name:"Glyph of Wyvern Sting",description:"Decreases the cooldown of your Wyvern Sting by 6 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_spear_02.jpg"}},minorGlyphs:{[S.GlyphOfFeignDeath]:{name:"Glyph of Feign Death",description:"Reduces the cooldown of your Feign Death spell by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_feigndeath.jpg"},[S.GlyphOfMendPet]:{name:"Glyph of Mend Pet",description:"Your Mend Pet spell increases your pet's happiness slightly.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_mendpet.jpg"},[S.GlyphOfPossessedStrength]:{name:"Glyph of Possessed Strength",description:"Increases the damage your pet inflicts while using Eyes of the Beast by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_eyeoftheowl.jpg"},[S.GlyphOfRevivePet]:{name:"Glyph of Revive Pet",description:"Reduces the pushback suffered from damaging attacks while casting Revive Pet by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_beastsoothe.jpg"},[S.GlyphOfScareBeast]:{name:"Glyph of Scare Beast",description:"Reduces the pushback suffered from damaging attacks while casting Scare Beast by 75%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_cower.jpg"},[S.GlyphOfThePack]:{name:"Glyph of the Pack",description:"Increases the range of your Aspect of the Pack ability by 15 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mount_jungletiger.jpg"}}},yo=go([{name:"Arcane",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/81.jpg",talents:[{fieldName:"arcaneSubtlety",location:{rowIdx:0,colIdx:0},spellIds:[11210,12592],maxPoints:2},{fieldName:"arcaneFocus",location:{rowIdx:0,colIdx:1},spellIds:[11222,12839,12840],maxPoints:3},{fieldName:"arcaneStability",location:{rowIdx:0,colIdx:2},spellIds:[11237,12463,12464,16769,16770],maxPoints:5},{fieldName:"arcaneFortitude",location:{rowIdx:1,colIdx:0},spellIds:[28574,54658,54659],maxPoints:3},{fieldName:"magicAbsorption",location:{rowIdx:1,colIdx:1},spellIds:[29441,29444],maxPoints:2},{fieldName:"arcaneConcentration",location:{rowIdx:1,colIdx:2},spellIds:[11213,12574,12575,12576,12577],maxPoints:5},{fieldName:"magicAttunement",location:{rowIdx:2,colIdx:0},spellIds:[11247,12606],maxPoints:2},{fieldName:"spellImpact",location:{rowIdx:2,colIdx:1},spellIds:[11242,12467,12469],maxPoints:3},{fieldName:"studentOfTheMind",location:{rowIdx:2,colIdx:2},spellIds:[44397,44398,44399],maxPoints:3},{fieldName:"focusMagic",location:{rowIdx:2,colIdx:3},spellIds:[54646],maxPoints:1},{fieldName:"arcaneShielding",location:{rowIdx:3,colIdx:0},spellIds:[11252,12605],maxPoints:2},{fieldName:"improvedCounterspell",location:{rowIdx:3,colIdx:1},spellIds:[11255,12598],maxPoints:2},{fieldName:"arcaneMeditation",location:{rowIdx:3,colIdx:2},spellIds:[18462,18463,18464],maxPoints:3},{fieldName:"tormentTheWeak",location:{rowIdx:3,colIdx:3},spellIds:[29447,55339,55340],maxPoints:3},{fieldName:"improvedBlink",location:{rowIdx:4,colIdx:0},spellIds:[31569,31570],maxPoints:2},{fieldName:"presenceOfMind",location:{rowIdx:4,colIdx:1},spellIds:[12043],maxPoints:1},{fieldName:"arcaneMind",location:{rowIdx:4,colIdx:3},spellIds:[11232,12500,12501,12502,12503],maxPoints:5},{fieldName:"prismaticCloak",location:{rowIdx:5,colIdx:0},spellIds:[31574,31575,54354],maxPoints:3},{fieldName:"arcaneInstability",location:{rowIdx:5,colIdx:1},spellIds:[15058,15059,15060],maxPoints:3,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"arcanePotency",location:{rowIdx:5,colIdx:2},spellIds:[31571,31572],maxPoints:2,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"arcaneEmpowerment",location:{rowIdx:6,colIdx:0},spellIds:[31579,31582,31583],maxPoints:3},{fieldName:"arcanePower",location:{rowIdx:6,colIdx:1},spellIds:[12042],maxPoints:1,prereqLocation:{rowIdx:5,colIdx:1}},{fieldName:"incantersAbsorption",location:{rowIdx:6,colIdx:2},spellIds:[44394,44395,44396],maxPoints:3},{fieldName:"arcaneFlows",location:{rowIdx:7,colIdx:1},spellIds:[44378,44379],maxPoints:2,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"mindMastery",location:{rowIdx:7,colIdx:2},spellIds:[31584,31585,31586,31587,31588],maxPoints:5},{fieldName:"slow",location:{rowIdx:8,colIdx:1},spellIds:[31589],maxPoints:1},{fieldName:"missileBarrage",location:{rowIdx:8,colIdx:2},spellIds:[44404,54486,54488,54489,54490],maxPoints:5},{fieldName:"netherwindPresence",location:{rowIdx:9,colIdx:1},spellIds:[44400,44402,44403],maxPoints:3},{fieldName:"spellPower",location:{rowIdx:9,colIdx:2},spellIds:[35578,35581],maxPoints:2},{fieldName:"arcaneBarrage",location:{rowIdx:10,colIdx:1},spellIds:[44425],maxPoints:1}]},{name:"Fire",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/41.jpg",talents:[{fieldName:"improvedFireBlast",location:{rowIdx:0,colIdx:0},spellIds:[11078,11080],maxPoints:2},{fieldName:"incineration",location:{rowIdx:0,colIdx:1},spellIds:[18459,18460,54734],maxPoints:3},{fieldName:"improvedFireball",location:{rowIdx:0,colIdx:2},spellIds:[11069,12338,12339,12340,12341],maxPoints:5},{fieldName:"ignite",location:{rowIdx:1,colIdx:0},spellIds:[11119,11120,12846,12847,12848],maxPoints:5},{fieldName:"burningDetermination",location:{rowIdx:1,colIdx:1},spellIds:[54747,54749],maxPoints:2},{fieldName:"worldInFlames",location:{rowIdx:1,colIdx:2},spellIds:[11108,12349,12350],maxPoints:3},{fieldName:"flameThrowing",location:{rowIdx:2,colIdx:0},spellIds:[11100,12353],maxPoints:2},{fieldName:"impact",location:{rowIdx:2,colIdx:1},spellIds:[11103,12357,12358],maxPoints:3},{fieldName:"pyroblast",location:{rowIdx:2,colIdx:2},spellIds:[11366],maxPoints:1},{fieldName:"burningSoul",location:{rowIdx:2,colIdx:3},spellIds:[11083,12351],maxPoints:2},{fieldName:"improvedScorch",location:{rowIdx:3,colIdx:0},spellIds:[11095,12872,12873],maxPoints:3},{fieldName:"moltenShields",location:{rowIdx:3,colIdx:1},spellIds:[11094,13043],maxPoints:2},{fieldName:"masterOfElements",location:{rowIdx:3,colIdx:3},spellIds:[29074,29075,29076],maxPoints:3},{fieldName:"playingWithFire",location:{rowIdx:4,colIdx:0},spellIds:[31638,31639,31640],maxPoints:3},{fieldName:"criticalMass",location:{rowIdx:4,colIdx:1},spellIds:[11115,11367,11368],maxPoints:3},{fieldName:"blastWave",location:{rowIdx:4,colIdx:2},spellIds:[11113],maxPoints:1,prereqLocation:{rowIdx:2,colIdx:2}},{fieldName:"blazingSpeed",location:{rowIdx:5,colIdx:0},spellIds:[31641,31642],maxPoints:2},{fieldName:"firePower",location:{rowIdx:5,colIdx:2},spellIds:[11124,12378,12398,12399,12400],maxPoints:5},{fieldName:"pyromaniac",location:{rowIdx:6,colIdx:0},spellIds:[34293,34295,34296],maxPoints:3},{fieldName:"combustion",location:{rowIdx:6,colIdx:1},spellIds:[11129],maxPoints:1,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"moltenFury",location:{rowIdx:6,colIdx:2},spellIds:[31679,31680],maxPoints:2},{fieldName:"fieryPayback",location:{rowIdx:7,colIdx:0},spellIds:[64353,64357],maxPoints:2},{fieldName:"empoweredFire",location:{rowIdx:7,colIdx:2},spellIds:[31656,31657,31658],maxPoints:3},{fieldName:"firestarter",location:{rowIdx:8,colIdx:0},spellIds:[44442,44443],maxPoints:2,prereqLocation:{rowIdx:8,colIdx:1}},{fieldName:"dragonsBreath",location:{rowIdx:8,colIdx:1},spellIds:[31661],maxPoints:1,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"hotStreak",location:{rowIdx:8,colIdx:2},spellIds:[44445,44446,44448],maxPoints:3},{fieldName:"burnout",location:{rowIdx:9,colIdx:1},spellIds:[44449,44469,44470,44471,44472],maxPoints:5},{fieldName:"livingBomb",location:{rowIdx:10,colIdx:1},spellIds:[44457],maxPoints:1}]},{name:"Frost",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/61.jpg",talents:[{fieldName:"frostbite",location:{rowIdx:0,colIdx:0},spellIds:[11071,12496,12497],maxPoints:3},{fieldName:"improvedFrostbolt",location:{rowIdx:0,colIdx:1},spellIds:[11070,12473,16763,16765,16766],maxPoints:5},{fieldName:"iceFloes",location:{rowIdx:0,colIdx:2},spellIds:[31670,31672,55094],maxPoints:3},{fieldName:"iceShards",location:{rowIdx:1,colIdx:0},spellIds:[11207,12672,15047],maxPoints:3},{fieldName:"frostWarding",location:{rowIdx:1,colIdx:1},spellIds:[11189,28332],maxPoints:2},{fieldName:"precision",location:{rowIdx:1,colIdx:2},spellIds:[29438,29439,29440],maxPoints:3},{fieldName:"permafrost",location:{rowIdx:1,colIdx:3},spellIds:[11175,12569,12571],maxPoints:3},{fieldName:"piercingIce",location:{rowIdx:2,colIdx:0},spellIds:[11151,12952,12953],maxPoints:3},{fieldName:"icyVeins",location:{rowIdx:2,colIdx:1},spellIds:[12472],maxPoints:1},{fieldName:"improvedBlizzard",location:{rowIdx:2,colIdx:2},spellIds:[11185,12487,12488],maxPoints:3},{fieldName:"arcticReach",location:{rowIdx:3,colIdx:0},spellIds:[16757,16758],maxPoints:2},{fieldName:"frostChanneling",location:{rowIdx:3,colIdx:1},spellIds:[11160,12518,12519],maxPoints:3},{fieldName:"shatter",location:{rowIdx:3,colIdx:2},spellIds:[11170,12982,12983],maxPoints:3},{fieldName:"coldSnap",location:{rowIdx:4,colIdx:1},spellIds:[11958],maxPoints:1},{fieldName:"improvedConeOfCold",location:{rowIdx:4,colIdx:2},spellIds:[11190,12489,12490],maxPoints:3},{fieldName:"frozenCore",location:{rowIdx:4,colIdx:3},spellIds:[31667,31668,31669],maxPoints:3},{fieldName:"coldAsIce",location:{rowIdx:5,colIdx:0},spellIds:[55091,55092],maxPoints:2,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"wintersChill",location:{rowIdx:5,colIdx:2},spellIds:[11180,28592,28593],maxPoints:3},{fieldName:"shatteredBarrier",location:{rowIdx:6,colIdx:0},spellIds:[44745,54787],maxPoints:2,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"iceBarrier",location:{rowIdx:6,colIdx:1},spellIds:[11426],maxPoints:1,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"arcticWinds",location:{rowIdx:6,colIdx:2},spellIds:[31674,31675,31676,31677,31678],maxPoints:5},{fieldName:"empoweredFrostbolt",location:{rowIdx:7,colIdx:1},spellIds:[31682,31683],maxPoints:2},{fieldName:"fingersOfFrost",location:{rowIdx:7,colIdx:2},spellIds:[44543,44545],maxPoints:2},{fieldName:"brainFreeze",location:{rowIdx:8,colIdx:0},spellIds:[44546,44548,44549],maxPoints:3},{fieldName:"summonWaterElemental",location:{rowIdx:8,colIdx:1},spellIds:[31687],maxPoints:1},{fieldName:"enduringWinter",location:{rowIdx:8,colIdx:2},spellIds:[44557,44560,44561],maxPoints:3,prereqLocation:{rowIdx:8,colIdx:1}},{fieldName:"chilledToTheBone",location:{rowIdx:9,colIdx:1},spellIds:[44566,44567,44568,44570,44571],maxPoints:5},{fieldName:"deepFreeze",location:{rowIdx:10,colIdx:1},spellIds:[44572],maxPoints:1}]}]),bo={majorGlyphs:{[E.GlyphOfArcaneBarrage]:{name:"Glyph of Arcane Barrage",description:"Reduces the mana cost of Arcane Barrage by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mage_arcanebarrage.jpg"},[E.GlyphOfArcaneBlast]:{name:"Glyph of Arcane Blast",description:"Increases the damage from your Arcane Blast buff by 3%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_blast.jpg"},[E.GlyphOfArcaneExplosion]:{name:"Glyph of Arcane Explosion",description:"Reduces mana cost of Arcane Explosion by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_wispsplode.jpg"},[E.GlyphOfArcaneMissiles]:{name:"Glyph of Arcane Missiles",description:"Increases the critical strike damage bonus of Arcane Missiles by 25%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_starfall.jpg"},[E.GlyphOfArcanePower]:{name:"Glyph of Arcane Power",description:"Increases the duration of Arcane Power by 3 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_lightning.jpg"},[E.GlyphOfBlink]:{name:"Glyph of Blink",description:"Increases the distance you travel with the Blink spell by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_blink.jpg"},[E.GlyphOfDeepFreeze]:{name:"Glyph of Deep Freeze",description:"Increases the range of Deep Freeze by 10 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mage_deepfreeze.jpg"},[E.GlyphOfEternalWater]:{name:"Glyph of Eternal Water",description:"Your Summon Water Elemental now lasts indefinitely, but your Water Elemental can no longer cast Freeze.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_summonwaterelemental_2.jpg"},[E.GlyphOfEvocation]:{name:"Glyph of Evocation",description:"Your Evocation ability also causes you to regain 60% of your health over its duration.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_purge.jpg"},[E.GlyphOfFireBlast]:{name:"Glyph of Fire Blast",description:"Increases the critical strike chance of Fire Blast by 50% when the target is stunned or incapacitated.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_fireball.jpg"},[E.GlyphOfFireball]:{name:"Glyph of Fireball",description:"Reduces the casting time of your Fireball spell by 0.15 sec, but removes the damage over time effect.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_flamebolt.jpg"},[E.GlyphOfFrostNova]:{name:"Glyph of Frost Nova",description:"Your Frost Nova targets can take an additional 20% damage before the Frost Nova effect automatically breaks.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frostnova.jpg"},[E.GlyphOfFrostbolt]:{name:"Glyph of Frostbolt",description:"Increases the damage dealt by Frostbolt by 5%, but removes the slowing effect.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frostbolt02.jpg"},[E.GlyphOfFrostfire]:{name:"Glyph of Frostfire",description:"Increases the initial damage dealt by Frostfire Bolt by 2% and its critical strike chance by 2%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mage_frostfirebolt.jpg"},[E.GlyphOfIceArmor]:{name:"Glyph of Ice Armor",description:"Your Ice Armor and Frost Armor spells grant an additional 50% armor and resistance.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frostarmor02.jpg"},[E.GlyphOfIceBarrier]:{name:"Glyph of Ice Barrier",description:"Increases the amount of damage absorbed by your Ice Barrier by 30%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_ice_lament.jpg"},[E.GlyphOfIceBlock]:{name:"Glyph of Ice Block",description:"Your Frost Nova cooldown is now reset every time you use Ice Block.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frost.jpg"},[E.GlyphOfIceLance]:{name:"Glyph of Ice Lance",description:"Your Ice Lance now causes 4 times damage against frozen targets higher level than you instead of triple damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frostblast.jpg"},[E.GlyphOfIcyVeins]:{name:"Glyph of Icy Veins",description:"Your Icy Veins ability also removes all movement slowing and cast time slowing effects.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_coldhearted.jpg"},[E.GlyphOfInvisibility]:{name:"Glyph of Invisibility",description:"Increases the duration of the Invisibility effect by 10 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mage_invisibility.jpg"},[E.GlyphOfLivingBomb]:{name:"Glyph of Living Bomb",description:"The periodic damage from your Living Bomb can now be critical strikes.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mage_livingbomb.jpg"},[E.GlyphOfMageArmor]:{name:"Glyph of Mage Armor",description:"Your Mage Armor spell grants an additional 20% mana regeneration while casting.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_magearmor.jpg"},[E.GlyphOfManaGem]:{name:"Glyph of Mana Gem",description:"Increases the mana received from using a mana gem by 40%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_gem_stone_01.jpg"},[E.GlyphOfMirrorImage]:{name:"Glyph of Mirror Image",description:"Your Mirror Image spell now creates a 4th copy.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_magic_lesserinvisibilty.jpg"},[E.GlyphOfMoltenArmor]:{name:"Glyph of Molten Armor",description:"Your Molten Armor grants an additional 20% of your spirit as critical strike rating.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mage_moltenarmor.jpg"},[E.GlyphOfPolymorph]:{name:"Glyph of Polymorph",description:"Your Polymorph spell also removes all damage over time effects from the target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_polymorph.jpg"},[E.GlyphOfRemoveCurse]:{name:"Glyph of Remove Curse",description:"Your Remove Curse spell also makes the target immune to all curses for 4 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_removecurse.jpg"},[E.GlyphOfScorch]:{name:"Glyph of Scorch",description:"Increases the damage of your Scorch spell by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_soulburn.jpg"},[E.GlyphOfWaterElemental]:{name:"Glyph of Water Elemental",description:"Reduces the cooldown of your Summon Water Elemental spell by 30 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_summonwaterelemental_2.jpg"}},minorGlyphs:{[P.GlyphOfArcaneIntellect]:{name:"Glyph of Arcane Intellect",description:"Reduces the mana cost of your Arcane Intellect and Arcane Brilliance spells by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_magicalsentry.jpg"},[P.GlyphOfBlastWave]:{name:"Glyph of Blast Wave",description:"The mana cost of your Blast Wave spell is reduced by 15%, but it no longer knocks enemies back.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_excorcism_02.jpg"},[P.GlyphOfFireWard]:{name:"Glyph of Fire Ward",description:"You have an additional 5% chance to reflect Fire spells while your Fire Ward is active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_firearmor.jpg"},[P.GlyphOfFrostArmor]:{name:"Glyph of Frost Armor",description:"Increases the duration of your Frost Armor and Ice Armor spells by 30 min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frostarmor02.jpg"},[P.GlyphOfFrostWard]:{name:"Glyph of Frost Ward",description:"You have an additional 5% chance to reflect Frost spells while your Frost Ward is active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frostward.jpg"},[P.GlyphOfSlowFall]:{name:"Glyph of Slow Fall",description:"Your Slow Fall spell no longer requires a reagent.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_magic_featherfall.jpg"},[P.GlyphOfThePenguin]:{name:"Glyph of the Penguin",description:"Your Polymorph: Sheep spell polymorphs the target into a penguin instead.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_penguinpet.jpg"}}},vo=go([{name:"Holy",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/classic/382.jpg",talents:[{fieldName:"spiritualFocus",location:{rowIdx:0,colIdx:1},spellIds:[20205],maxPoints:5},{fieldName:"sealsOfThePure",location:{rowIdx:0,colIdx:2},spellIds:[20224,20225,20330],maxPoints:5},{fieldName:"healingLight",location:{rowIdx:1,colIdx:0},spellIds:[20237],maxPoints:3},{fieldName:"divineIntellect",location:{rowIdx:1,colIdx:1},spellIds:[20257],maxPoints:5},{fieldName:"unyieldingFaith",location:{rowIdx:1,colIdx:2},spellIds:[9453,25836],maxPoints:2},{fieldName:"auraMastery",location:{rowIdx:2,colIdx:0},spellIds:[31821],maxPoints:1},{fieldName:"illumination",location:{rowIdx:2,colIdx:1},spellIds:[20210,20212],maxPoints:5},{fieldName:"improvedLayOnHands",location:{rowIdx:2,colIdx:2},spellIds:[20234],maxPoints:2},{fieldName:"improvedConcentrationAura",location:{rowIdx:3,colIdx:0},spellIds:[20254],maxPoints:3},{fieldName:"improvedBlessingOfWisdom",location:{rowIdx:3,colIdx:2},spellIds:[20244],maxPoints:2},{fieldName:"blessedHands",location:{rowIdx:3,colIdx:3},spellIds:[53660],maxPoints:2},{fieldName:"pureOfHeart",location:{rowIdx:4,colIdx:0},spellIds:[31822],maxPoints:2},{fieldName:"divineFavor",location:{rowIdx:4,colIdx:1},prereqLocation:{rowIdx:2,colIdx:1},spellIds:[20216],maxPoints:1},{fieldName:"sanctifiedLight",location:{rowIdx:4,colIdx:2},spellIds:[20359],maxPoints:3},{fieldName:"purifyingPower",location:{rowIdx:5,colIdx:0},spellIds:[31825],maxPoints:2},{fieldName:"holyPower",location:{rowIdx:5,colIdx:2},spellIds:[5923,5924,5925,5926,25829],maxPoints:5},{fieldName:"lightsGrace",location:{rowIdx:6,colIdx:0},spellIds:[31833,31835],maxPoints:3},{fieldName:"holyShock",location:{rowIdx:6,colIdx:1},prereqLocation:{rowIdx:4,colIdx:1},spellIds:[20473],maxPoints:1},{fieldName:"blessedLife",location:{rowIdx:6,colIdx:2},spellIds:[31828],maxPoints:3},{fieldName:"sacredCleansing",location:{rowIdx:7,colIdx:0},spellIds:[53551],maxPoints:3},{fieldName:"holyGuidance",location:{rowIdx:7,colIdx:2},spellIds:[31837],maxPoints:5},{fieldName:"divineIllumination",location:{rowIdx:8,colIdx:0},spellIds:[31842],maxPoints:1},{fieldName:"judgementsOfThePure",location:{rowIdx:8,colIdx:2},spellIds:[53671,53673,54151,54154,54155],maxPoints:5},{fieldName:"infusionOfLight",location:{rowIdx:9,colIdx:1},prereqLocation:{rowIdx:6,colIdx:1},spellIds:[53569,53576],maxPoints:2},{fieldName:"enlightenedJudgements",location:{rowIdx:9,colIdx:2},spellIds:[53556],maxPoints:2},{fieldName:"beaconOfLight",location:{rowIdx:10,colIdx:1},spellIds:[53563],maxPoints:1}]},{name:"Protection",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/classic/383.jpg",talents:[{fieldName:"divinity",location:{rowIdx:0,colIdx:1},spellIds:[63646],maxPoints:5},{fieldName:"divineStrength",location:{rowIdx:0,colIdx:2},spellIds:[20262],maxPoints:5},{fieldName:"stoicism",location:{rowIdx:1,colIdx:0},spellIds:[31844,31845,53519],maxPoints:3},{fieldName:"guardiansFavor",location:{rowIdx:1,colIdx:1},spellIds:[20174],maxPoints:2},{fieldName:"anticipation",location:{rowIdx:1,colIdx:2},spellIds:[20096],maxPoints:5},{fieldName:"divineSacrifice",location:{rowIdx:2,colIdx:0},spellIds:[64205],maxPoints:1},{fieldName:"improvedRighteousFury",location:{rowIdx:2,colIdx:1},spellIds:[20468],maxPoints:3},{fieldName:"toughness",location:{rowIdx:2,colIdx:2},spellIds:[20143],maxPoints:5},{fieldName:"divineGuardian",location:{rowIdx:3,colIdx:0},prereqLocation:{rowIdx:2,colIdx:0},spellIds:[53527,53530],maxPoints:2},{fieldName:"improvedHammerOfJustice",location:{rowIdx:3,colIdx:1},spellIds:[20487],maxPoints:2},{fieldName:"improvedDevotionAura",location:{rowIdx:3,colIdx:2},spellIds:[20138],maxPoints:3},{fieldName:"blessingOfSanctuary",location:{rowIdx:4,colIdx:1},spellIds:[20911],maxPoints:1},{fieldName:"reckoning",location:{rowIdx:4,colIdx:2},spellIds:[20177,20179,20181,20180,20182],maxPoints:5},{fieldName:"sacredDuty",location:{rowIdx:5,colIdx:0},spellIds:[31848],maxPoints:2},{fieldName:"oneHandedWeaponSpecialization",location:{rowIdx:5,colIdx:2},spellIds:[20196],maxPoints:3},{fieldName:"spiritualAttunement",location:{rowIdx:6,colIdx:0},spellIds:[31785,33776],maxPoints:2},{fieldName:"holyShield",location:{rowIdx:6,colIdx:1},prereqLocation:{rowIdx:4,colIdx:1},spellIds:[20925],maxPoints:1},{fieldName:"ardentDefender",location:{rowIdx:6,colIdx:2},spellIds:[31850],maxPoints:3},{fieldName:"redoubt",location:{rowIdx:7,colIdx:0},spellIds:[20127,20130,20135],maxPoints:3},{fieldName:"combatExpertise",location:{rowIdx:7,colIdx:2},spellIds:[31858],maxPoints:3},{fieldName:"touchedByTheLight",location:{rowIdx:8,colIdx:0},spellIds:[53590],maxPoints:3},{fieldName:"avengersShield",location:{rowIdx:8,colIdx:1},prereqLocation:{rowIdx:6,colIdx:1},spellIds:[31935],maxPoints:1},{fieldName:"guardedByTheLight",location:{rowIdx:8,colIdx:2},spellIds:[53583,53585],maxPoints:2},{fieldName:"shieldOfTheTemplar",location:{rowIdx:9,colIdx:1},prereqLocation:{rowIdx:8,colIdx:1},spellIds:[53709],maxPoints:3},{fieldName:"judgementsOfTheJust",location:{rowIdx:9,colIdx:2},spellIds:[53695],maxPoints:2},{fieldName:"hammerOfTheRighteous",location:{rowIdx:10,colIdx:1},spellIds:[53595],maxPoints:1}]},{name:"Retribution",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/classic/381.jpg",talents:[{fieldName:"deflection",location:{rowIdx:0,colIdx:1},spellIds:[20060],maxPoints:5},{fieldName:"benediction",location:{rowIdx:0,colIdx:2},spellIds:[20101],maxPoints:5},{fieldName:"improvedJudgements",location:{rowIdx:1,colIdx:0},spellIds:[25956],maxPoints:2},{fieldName:"heartOfTheCrusader",location:{rowIdx:1,colIdx:1},spellIds:[20335],maxPoints:3},{fieldName:"improvedBlessingOfMight",location:{rowIdx:1,colIdx:2},spellIds:[20042,20045],maxPoints:2},{fieldName:"vindication",location:{rowIdx:2,colIdx:0},spellIds:[9452,26016],maxPoints:2},{fieldName:"conviction",location:{rowIdx:2,colIdx:1},spellIds:[20117],maxPoints:5},{fieldName:"sealOfCommand",location:{rowIdx:2,colIdx:2},spellIds:[20375],maxPoints:1},{fieldName:"pursuitOfJustice",location:{rowIdx:2,colIdx:3},spellIds:[26022],maxPoints:2},{fieldName:"eyeForAnEye",location:{rowIdx:3,colIdx:0},spellIds:[9799,25988],maxPoints:2},{fieldName:"sanctityOfBattle",location:{rowIdx:3,colIdx:2},spellIds:[32043,35396,35397],maxPoints:3},{fieldName:"crusade",location:{rowIdx:3,colIdx:3},spellIds:[31866],maxPoints:3},{fieldName:"twoHandedWeaponSpecialization",location:{rowIdx:4,colIdx:0},spellIds:[20111],maxPoints:3},{fieldName:"sanctifiedRetribution",location:{rowIdx:4,colIdx:2},spellIds:[31869],maxPoints:1},{fieldName:"vengeance",location:{rowIdx:5,colIdx:1},prereqLocation:{rowIdx:2,colIdx:1},spellIds:[20049,20056,20057],maxPoints:3},{fieldName:"divinePurpose",location:{rowIdx:5,colIdx:2},spellIds:[31871],maxPoints:2},{fieldName:"theArtOfWar",location:{rowIdx:6,colIdx:0},spellIds:[53486,53488],maxPoints:2},{fieldName:"repentance",location:{rowIdx:6,colIdx:1},spellIds:[20066],maxPoints:1},{fieldName:"judgementsOfTheWise",location:{rowIdx:6,colIdx:2},spellIds:[31876],maxPoints:3},{fieldName:"fanaticism",location:{rowIdx:7,colIdx:1},prereqLocation:{rowIdx:6,colIdx:1},spellIds:[31879],maxPoints:3},{fieldName:"sanctifiedWrath",location:{rowIdx:7,colIdx:2},spellIds:[53375],maxPoints:2},{fieldName:"swiftRetribution",location:{rowIdx:8,colIdx:0},spellIds:[53379,53484,53648],maxPoints:3},{fieldName:"crusaderStrike",location:{rowIdx:8,colIdx:1},spellIds:[35395],maxPoints:1},{fieldName:"sheathOfLight",location:{rowIdx:8,colIdx:2},spellIds:[53501],maxPoints:3},{fieldName:"righteousVengeance",location:{rowIdx:9,colIdx:1},spellIds:[53380],maxPoints:3},{fieldName:"divineStorm",location:{rowIdx:10,colIdx:1},spellIds:[53385],maxPoints:1}]}]),So={majorGlyphs:{[k.GlyphOfAvengerSShield]:{name:"Glyph of Avenger's Shield",description:"Your Avenger's Shield hits 2 fewer targets, but for 100% more damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_avengersshield.jpg"},[k.GlyphOfAvengingWrath]:{name:"Glyph of Avenging Wrath",description:"Reduces the cooldown of your Hammer of Wrath spell by 50% while Avenging Wrath is active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_avenginewrath.jpg"},[k.GlyphOfBeaconOfLight]:{name:"Glyph of Beacon of Light",description:"Increases the duration of Beacon of Light by 30 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_paladin_beaconoflight.jpg"},[k.GlyphOfCleansing]:{name:"Glyph of Cleansing",description:"Reduces the mana cost of your Cleanse and Purify spells by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_purify.jpg"},[k.GlyphOfConsecration]:{name:"Glyph of Consecration",description:"Increases the duration and cooldown of Consecration by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_innerfire.jpg"},[k.GlyphOfCrusaderStrike]:{name:"Glyph of Crusader Strike",description:"Reduces the mana cost of your Crusader Strike ability by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_crusaderstrike.jpg"},[k.GlyphOfDivinePlea]:{name:"Glyph of Divine Plea",description:"While Divine Plea is active, you take 3% reduced damage from all sources.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_aspiration.jpg"},[k.GlyphOfDivineStorm]:{name:"Glyph of Divine Storm",description:"Your Divine Storm now heals for an additional 15% of the damage it causes.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_paladin_divinestorm.jpg"},[k.GlyphOfDivinity]:{name:"Glyph of Divinity",description:"Your Lay on Hands grants twice as much mana as normal and also grants you as much mana as it grants your target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_layonhands.jpg"},[k.GlyphOfExorcism]:{name:"Glyph of Exorcism",description:"Increases damage done by Exorcism by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_excorcism_02.jpg"},[k.GlyphOfFlashOfLight]:{name:"Glyph of Flash of Light",description:"Your Flash of Light has an additional 5% critical strike chance.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_flashheal.jpg"},[k.GlyphOfHammerOfJustice]:{name:"Glyph of Hammer of Justice",description:"Increases your Hammer of Justice range by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_sealofmight.jpg"},[k.GlyphOfHammerOfTheRighteous]:{name:"Glyph of Hammer of the Righteous",description:"Your Hammer of the Righteous hits 1 additional target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_paladin_hammeroftherighteous.jpg"},[k.GlyphOfHammerOfWrath]:{name:"Glyph of Hammer of Wrath",description:"Reduces the mana cost of Hammer of Wrath by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_thunderclap.jpg"},[k.GlyphOfHolyLight]:{name:"Glyph of Holy Light",description:"Your Holy Light grants 10% of its heal amount to up to 5 friendly targets within 8 yards of the initial target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_holybolt.jpg"},[k.GlyphOfHolyShock]:{name:"Glyph of Holy Shock",description:"Reduces the cooldown of Holy Shock by 1 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_searinglight.jpg"},[k.GlyphOfHolyWrath]:{name:"Glyph of Holy Wrath",description:"Reduces the cooldown of your Holy Wrath spell by 15 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_excorcism.jpg"},[k.GlyphOfJudgement]:{name:"Glyph of Judgement",description:"Your Judgements deal 10% more damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_paladin_judgementred.jpg"},[k.GlyphOfRighteousDefense]:{name:"Glyph of Righteous Defense",description:"Increases the chance for your Righteous Defense and Hand of Reckoning abilities to work successfully by 8% on each target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_shoulder_37.jpg"},[k.GlyphOfSalvation]:{name:"Glyph of Salvation",description:"When you cast Hand of Salvation on yourself, it also reduces damage taken by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_sealofsalvation.jpg"},[k.GlyphOfSealOfCommand]:{name:"Glyph of Seal of Command",description:"You gain 8% of your base mana each time you use a Judgement with Seal of Command active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_innerrage.jpg"},[k.GlyphOfSealOfLight]:{name:"Glyph of Seal of Light",description:"While Seal of Light is active, the effect of your healing spells is increased by 5%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_healingaura.jpg"},[k.GlyphOfSealOfRighteousness]:{name:"Glyph of Seal of Righteousness",description:"Increases the damage done by Seal of Righteousness by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_thunderbolt.jpg"},[k.GlyphOfSealOfVengeance]:{name:"Glyph of Seal of Vengeance",description:"Your Seal of Vengeance or Seal of Corruption also grants 10 expertise while active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_sealofvengeance.jpg"},[k.GlyphOfSealOfWisdom]:{name:"Glyph of Seal of Wisdom",description:"While Seal of Wisdom is active, the cost of your healing spells is reduced by 5%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_righteousnessaura.jpg"},[k.GlyphOfShieldOfRighteousness]:{name:"Glyph of Shield of Righteousness",description:"Reduces the mana cost of Shield of Righteousness by 80%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_paladin_shieldofvengeance.jpg"},[k.GlyphOfSpiritualAttunement]:{name:"Glyph of Spiritual Attunement",description:"Increases the amount of mana gained from your Spiritual Attunement spell by an additional 2%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_revivechampion.jpg"},[k.GlyphOfTurnEvil]:{name:"Glyph of Turn Evil",description:"Reduces the casting time of your Turn Evil spell by 100%, but increases the cooldown by 8 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_turnundead.jpg"}},minorGlyphs:{[C.GlyphOfBlessingOfKings]:{name:"Glyph of Blessing of Kings",description:"Reduces the mana cost of your Blessing of Kings and Greater Blessing of Kings spells by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_magic_magearmor.jpg"},[C.GlyphOfBlessingOfMight]:{name:"Glyph of Blessing of Might",description:"Increases the duration of your Blessing of Might spell by 20 min when cast on yourself.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_fistofjustice.jpg"},[C.GlyphOfBlessingOfWisdom]:{name:"Glyph of Blessing of Wisdom",description:"Increases the duration of your Blessing of Wisdom spell by 20 min when cast on yourself.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_sealofwisdom.jpg"},[C.GlyphOfLayOnHands]:{name:"Glyph of Lay on Hands",description:"Reduces the cooldown of your Lay on Hands spell by 5 min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_layonhands.jpg"},[C.GlyphOfSenseUndead]:{name:"Glyph of Sense Undead",description:"Damage against Undead increased by 1% while your Sense Undead ability is active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_senseundead.jpg"},[C.GlyphOfTheWise]:{name:"Glyph of the Wise",description:"Reduces the mana cost of your Seal of Wisdom spell by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_righteousnessaura.jpg"}}},Eo=go([{name:"Discipline",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/201.jpg",talents:[{fieldName:"unbreakableWill",location:{rowIdx:0,colIdx:1},spellIds:[14522,14788,14789,14790,14791],maxPoints:5},{fieldName:"twinDisciplines",location:{rowIdx:0,colIdx:2},spellIds:[47586,47587,47588,52802,52803],maxPoints:5},{fieldName:"silentResolve",location:{rowIdx:1,colIdx:0},spellIds:[14523,14784,14785],maxPoints:3},{fieldName:"improvedInnerFire",location:{rowIdx:1,colIdx:1},spellIds:[14747,14770,14771],maxPoints:3},{fieldName:"improvedPowerWordFortitude",location:{rowIdx:1,colIdx:2},spellIds:[14749,14767],maxPoints:2},{fieldName:"martyrdom",location:{rowIdx:1,colIdx:3},spellIds:[14531,14774],maxPoints:2},{fieldName:"meditation",location:{rowIdx:2,colIdx:0},spellIds:[14521,14776,14777],maxPoints:3},{fieldName:"innerFocus",location:{rowIdx:2,colIdx:1},spellIds:[14751],maxPoints:1},{fieldName:"improvedPowerWordShield",location:{rowIdx:2,colIdx:2},spellIds:[14748,14768,14769],maxPoints:3},{fieldName:"absolution",location:{rowIdx:3,colIdx:0},spellIds:[33167,33171,33172],maxPoints:3},{fieldName:"mentalAgility",location:{rowIdx:3,colIdx:1},spellIds:[14520,14780,14781],maxPoints:3},{fieldName:"improvedManaBurn",location:{rowIdx:3,colIdx:3},spellIds:[14750,14772],maxPoints:2},{fieldName:"reflectiveShield",location:{rowIdx:4,colIdx:0},spellIds:[33201,33202],maxPoints:2},{fieldName:"mentalStrength",location:{rowIdx:4,colIdx:1},spellIds:[18551,18552,18553,18554,18555],maxPoints:5},{fieldName:"soulWarding",location:{rowIdx:4,colIdx:2},spellIds:[63574],maxPoints:1,prereqLocation:{rowIdx:2,colIdx:2}},{fieldName:"focusedPower",location:{rowIdx:5,colIdx:0},spellIds:[33186,33190],maxPoints:2},{fieldName:"enlightenment",location:{rowIdx:5,colIdx:2},spellIds:[34908,34909,34910],maxPoints:3},{fieldName:"focusedWill",location:{rowIdx:6,colIdx:0},spellIds:[45234,45243,45244],maxPoints:3},{fieldName:"powerInfusion",location:{rowIdx:6,colIdx:1},spellIds:[10060],maxPoints:1,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"improvedFlashHeal",location:{rowIdx:6,colIdx:2},spellIds:[63504,63505,63506],maxPoints:3},{fieldName:"renewedHope",location:{rowIdx:7,colIdx:0},spellIds:[57470,57472],maxPoints:2},{fieldName:"rapture",location:{rowIdx:7,colIdx:1},spellIds:[47535,47536,47537],maxPoints:3},{fieldName:"aspiration",location:{rowIdx:7,colIdx:2},spellIds:[47507,47508],maxPoints:2},{fieldName:"divineAegis",location:{rowIdx:8,colIdx:0},spellIds:[47509,47511,47515],maxPoints:3},{fieldName:"painSuppression",location:{rowIdx:8,colIdx:1},spellIds:[33206],maxPoints:1},{fieldName:"grace",location:{rowIdx:8,colIdx:2},spellIds:[47516,47517],maxPoints:2},{fieldName:"borrowedTime",location:{rowIdx:9,colIdx:1},spellIds:[52795,52797,52798,52799,52800],maxPoints:5},{fieldName:"penance",location:{rowIdx:10,colIdx:1},spellIds:[47540],maxPoints:1}]},{name:"Holy",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/202.jpg",talents:[{fieldName:"healingFocus",location:{rowIdx:0,colIdx:0},spellIds:[14913,15012],maxPoints:2},{fieldName:"improvedRenew",location:{rowIdx:0,colIdx:1},spellIds:[14908,15020,17191],maxPoints:3},{fieldName:"holySpecialization",location:{rowIdx:0,colIdx:2},spellIds:[14889,15008,15009,15010,15011],maxPoints:5},{fieldName:"spellWarding",location:{rowIdx:1,colIdx:1},spellIds:[27900,27901,27902,27903,27904],maxPoints:5},{fieldName:"divineFury",location:{rowIdx:1,colIdx:2},spellIds:[18530,18531,18533,18534,18535],maxPoints:5},{fieldName:"desperatePrayer",location:{rowIdx:2,colIdx:0},spellIds:[19236],maxPoints:1},{fieldName:"blessedRecovery",location:{rowIdx:2,colIdx:1},spellIds:[27811,27815,27816],maxPoints:3},{fieldName:"inspiration",location:{rowIdx:2,colIdx:3},spellIds:[14892,15362,15363],maxPoints:3},{fieldName:"holyReach",location:{rowIdx:3,colIdx:0},spellIds:[27789,27790],maxPoints:2},{fieldName:"improvedHealing",location:{rowIdx:3,colIdx:1},spellIds:[14912,15013,15014],maxPoints:3},{fieldName:"searingLight",location:{rowIdx:3,colIdx:2},spellIds:[14909,15017],maxPoints:2,prereqLocation:{rowIdx:1,colIdx:2}},{fieldName:"healingPrayers",location:{rowIdx:4,colIdx:0},spellIds:[14911,15018],maxPoints:2},{fieldName:"spiritOfRedemption",location:{rowIdx:4,colIdx:1},spellIds:[20711],maxPoints:1},{fieldName:"spiritualGuidance",location:{rowIdx:4,colIdx:2},spellIds:[14901,15028,15029,15030,15031],maxPoints:5},{fieldName:"surgeOfLight",location:{rowIdx:5,colIdx:0},spellIds:[33150,33154],maxPoints:2},{fieldName:"spiritualHealing",location:{rowIdx:5,colIdx:2},spellIds:[14898,15349,15354,15355,15356],maxPoints:5},{fieldName:"holyConcentration",location:{rowIdx:6,colIdx:0},spellIds:[34753,34859,34860],maxPoints:3},{fieldName:"lightwell",location:{rowIdx:6,colIdx:1},spellIds:[724],maxPoints:1,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"blessedResilience",location:{rowIdx:6,colIdx:2},spellIds:[33142,33145,33146],maxPoints:3},{fieldName:"bodyAndSoul",location:{rowIdx:7,colIdx:0},spellIds:[64127,64129],maxPoints:2},{fieldName:"empoweredHealing",location:{rowIdx:7,colIdx:1},spellIds:[33158,33159,33160,33161,33162],maxPoints:5},{fieldName:"serendipity",location:{rowIdx:7,colIdx:2},spellIds:[63730,63733,63737],maxPoints:3},{fieldName:"empoweredRenew",location:{rowIdx:8,colIdx:0},spellIds:[63534,63542,63543],maxPoints:3},{fieldName:"circleOfHealing",location:{rowIdx:8,colIdx:1},spellIds:[34861],maxPoints:1},{fieldName:"testOfFaith",location:{rowIdx:8,colIdx:2},spellIds:[47558,47559,47560],maxPoints:3},{fieldName:"divineProvidence",location:{rowIdx:9,colIdx:1},spellIds:[47562,47564,47565,47566,47567],maxPoints:5},{fieldName:"guardianSpirit",location:{rowIdx:10,colIdx:1},spellIds:[47788],maxPoints:1}]},{name:"Shadow",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/203.jpg",talents:[{fieldName:"spiritTap",location:{rowIdx:0,colIdx:0},spellIds:[15270,15335,15336],maxPoints:3},{fieldName:"improvedSpiritTap",location:{rowIdx:0,colIdx:1},spellIds:[15337,15338],maxPoints:2,prereqLocation:{rowIdx:0,colIdx:0}},{fieldName:"darkness",location:{rowIdx:0,colIdx:2},spellIds:[15259,15307,15308,15309,15310],maxPoints:5},{fieldName:"shadowAffinity",location:{rowIdx:1,colIdx:0},spellIds:[15318,15272,15320],maxPoints:3},{fieldName:"improvedShadowWordPain",location:{rowIdx:1,colIdx:1},spellIds:[15275,15317],maxPoints:2},{fieldName:"shadowFocus",location:{rowIdx:1,colIdx:2},spellIds:[15260,15327,15328],maxPoints:3},{fieldName:"improvedPsychicScream",location:{rowIdx:2,colIdx:0},spellIds:[15392,15448],maxPoints:2},{fieldName:"improvedMindBlast",location:{rowIdx:2,colIdx:1},spellIds:[15273,15312,15313,15314,15316],maxPoints:5},{fieldName:"mindFlay",location:{rowIdx:2,colIdx:2},spellIds:[15407],maxPoints:1},{fieldName:"veiledShadows",location:{rowIdx:3,colIdx:1},spellIds:[15274,15311],maxPoints:2},{fieldName:"shadowReach",location:{rowIdx:3,colIdx:2},spellIds:[17322,17323],maxPoints:2},{fieldName:"shadowWeaving",location:{rowIdx:3,colIdx:3},spellIds:[15257,15331,15332],maxPoints:3},{fieldName:"silence",location:{rowIdx:4,colIdx:0},spellIds:[15487],maxPoints:1,prereqLocation:{rowIdx:2,colIdx:0}},{fieldName:"vampiricEmbrace",location:{rowIdx:4,colIdx:1},spellIds:[15286],maxPoints:1},{fieldName:"improvedVampiricEmbrace",location:{rowIdx:4,colIdx:2},spellIds:[27839,27840],maxPoints:2,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"focusedMind",location:{rowIdx:4,colIdx:3},spellIds:[33213,33214,33215],maxPoints:3},{fieldName:"mindMelt",location:{rowIdx:5,colIdx:0},spellIds:[14910,33371],maxPoints:2},{fieldName:"improvedDevouringPlague",location:{rowIdx:5,colIdx:2},spellIds:[63625,63626,63627],maxPoints:3},{fieldName:"shadowform",location:{rowIdx:6,colIdx:1},spellIds:[15473],maxPoints:1,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"shadowPower",location:{rowIdx:6,colIdx:2},spellIds:[33221,33222,33223,33224,33225],maxPoints:5},{fieldName:"improvedShadowform",location:{rowIdx:7,colIdx:0},spellIds:[47569,47570],maxPoints:2,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"misery",location:{rowIdx:7,colIdx:2},spellIds:[33191,33192,33193],maxPoints:3},{fieldName:"psychicHorror",location:{rowIdx:8,colIdx:0},spellIds:[64044],maxPoints:1},{fieldName:"vampiricTouch",location:{rowIdx:8,colIdx:1},spellIds:[34914],maxPoints:1,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"painAndSuffering",location:{rowIdx:8,colIdx:2},spellIds:[47580,47581,47582],maxPoints:3},{fieldName:"twistedFaith",location:{rowIdx:9,colIdx:2},spellIds:[47573,47577,47578,51166,51167],maxPoints:5},{fieldName:"dispersion",location:{rowIdx:10,colIdx:1},spellIds:[47585],maxPoints:1,prereqLocation:{rowIdx:8,colIdx:1}}]}]),Po={majorGlyphs:{[_.GlyphOfCircleOfHealing]:{name:"Glyph of Circle of Healing",description:"Your Circle of Healing spell heals 1 additional target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_circleofrenewal.jpg"},[_.GlyphOfDispelMagic]:{name:"Glyph of Dispel Magic",description:"Your Dispel Magic spell also heals your target for 3% of maximum health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_dispelmagic.jpg"},[_.GlyphOfDispersion]:{name:"Glyph of Dispersion",description:"Reduces the cooldown on Dispersion by 45 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_dispersion.jpg"},[_.GlyphOfFade]:{name:"Glyph of Fade",description:"Reduces the cooldown of your Fade spell by 9 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_magic_lesserinvisibilty.jpg"},[_.GlyphOfFearWard]:{name:"Glyph of Fear Ward",description:"Reduces cooldown and duration of Fear Ward by 60 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_excorcism.jpg"},[_.GlyphOfFlashHeal]:{name:"Glyph of Flash Heal",description:"Reduces the mana cost of your Flash Heal by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_flashheal.jpg"},[_.GlyphOfGuardianSpirit]:{name:"Glyph of Guardian Spirit",description:"If your Guardian Spirit lasts its entire duration without being triggered, the cooldown is reset to 1 min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_guardianspirit.jpg"},[_.GlyphOfHolyNova]:{name:"Glyph of Holy Nova",description:"Increases the damage and healing of your Holy Nova spell by an additional 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_holynova.jpg"},[_.GlyphOfHymnOfHope]:{name:"Glyph of Hymn of Hope",description:"Your Hymn of Hope lasts an additional 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_symbolofhope.jpg"},[_.GlyphOfInnerFire]:{name:"Glyph of Inner Fire",description:"Increases the armor from your Inner Fire spell by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_innerfire.jpg"},[_.GlyphOfLightwell]:{name:"Glyph of Lightwell",description:"Increases the amount healed by your Lightwell by 20%",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_summonlightwell.jpg"},[_.GlyphOfMassDispel]:{name:"Glyph of Mass Dispel",description:"Reduces the mana cost of Mass Dispel by 35%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_massdispel.jpg"},[_.GlyphOfMindControl]:{name:"Glyph of Mind Control",description:"Reduces the chance targets will resist or break your Mind Control spell by an additional 17%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_shadowworddominate.jpg"},[_.GlyphOfMindFlay]:{name:"Glyph of Mind Flay",description:"Increases the damage done by your Mind Flay spell by 10% when your target is afflicted with Shadow Word: Pain.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_siphonmana.jpg"},[_.GlyphOfMindSear]:{name:"Glyph of Mind Sear",description:"Increases the radius of effect on Mind Sear by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_mindshear.jpg"},[_.GlyphOfPainSuppression]:{name:"Glyph of Pain Suppression",description:"Allows Pain Suppression to be cast while stunned.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_painsupression.jpg"},[_.GlyphOfPenance]:{name:"Glyph of Penance",description:"Reduces the cooldown of Penance by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_penance.jpg"},[_.GlyphOfPowerWordShield]:{name:"Glyph of Power Word: Shield",description:"Your Power Word: Shield also heals the target for 20% of the absorption amount.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_powerwordshield.jpg"},[_.GlyphOfPrayerOfHealing]:{name:"Glyph of Prayer of Healing",description:"Your Prayer of Healing spell also heals an additional 20% of its initial heal over 6 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_prayerofhealing02.jpg"},[_.GlyphOfPsychicScream]:{name:"Glyph of Psychic Scream",description:"Increases the duration of your Psychic Scream by 2 sec. and increases its cooldown by 8 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_psychicscream.jpg"},[_.GlyphOfRenew]:{name:"Glyph of Renew",description:"Reduces the duration of your Renew by 3 sec. but increases the amount healed each tick by 25%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_renew.jpg"},[_.GlyphOfScourgeImprisonment]:{name:"Glyph of Scourge Imprisonment",description:"Reduces the cast time of your Shackle Undead by 1.0 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_slow.jpg"},[_.GlyphOfShadow]:{name:"Glyph of Shadow",description:"While in Shadowform, your non-periodic spell critical strikes increase your spell power by 30% of your Spirit for 10 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_mindsooth.jpg"},[_.GlyphOfShadowWordDeath]:{name:"Glyph of Shadow Word: Death",description:"Targets below 35% health take an additional 10% damage from your Shadow Word: Death spell.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_demonicfortitude.jpg"},[_.GlyphOfShadowWordPain]:{name:"Glyph of Shadow Word: Pain",description:"The periodic damage ticks of your Shadow Word: Pain spell restore 1% of your base mana.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_shadowwordpain.jpg"},[_.GlyphOfSmite]:{name:"Glyph of Smite",description:"Your Smite spell inflicts an additional 20% damage against targets afflicted by Holy Fire.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_holysmite.jpg"},[_.GlyphOfSpiritOfRedemption]:{name:"Glyph of Spirit of Redemption",description:"Increases the duration of Spirit of Redemption by 6 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_enchant_essenceeternallarge.jpg"}},minorGlyphs:{[N.GlyphOfFading]:{name:"Glyph of Fading",description:"Reduces the mana cost of your Fade spell by 30%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_magic_lesserinvisibilty.jpg"},[N.GlyphOfFortitude]:{name:"Glyph of Fortitude",description:"Reduces the mana cost of your Power Word: Fortitude and Prayer of Fortitude spells by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_wordfortitude.jpg"},[N.GlyphOfLevitate]:{name:"Glyph of Levitate",description:"Your Levitate spell no longer requires a reagent.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_layonhands.jpg"},[N.GlyphOfShackleUndead]:{name:"Glyph of Shackle Undead",description:"Increases the range of your Shackle Undead spell by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_slow.jpg"},[N.GlyphOfShadowProtection]:{name:"Glyph of Shadow Protection",description:"Increases the duration of your Shadow Protection and Prayer of Shadow Protection spells by 10 min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_antishadow.jpg"},[N.GlyphOfShadowfiend]:{name:"Glyph of Shadowfiend",description:"Receive 5% of your maximum mana if your Shadowfiend dies from damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_shadowfiend.jpg"}}},ko=go([{name:"Assassination",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/182.jpg",talents:[{fieldName:"improvedEviscerate",location:{rowIdx:0,colIdx:0},spellIds:[14162,14163,14164],maxPoints:3},{fieldName:"remorselessAttacks",location:{rowIdx:0,colIdx:1},spellIds:[14144,14148],maxPoints:2},{fieldName:"malice",location:{rowIdx:0,colIdx:2},spellIds:[14138,14139,14140,14141,14142],maxPoints:5},{fieldName:"ruthlessness",location:{rowIdx:1,colIdx:0},spellIds:[14156,14160,14161],maxPoints:3},{fieldName:"bloodSpatter",location:{rowIdx:1,colIdx:1},spellIds:[51632,51633],maxPoints:2},{fieldName:"puncturingWounds",location:{rowIdx:1,colIdx:3},spellIds:[13733,13865],maxPoints:3},{fieldName:"vigor",location:{rowIdx:2,colIdx:0},spellIds:[14983],maxPoints:1},{fieldName:"improvedExposeArmor",location:{rowIdx:2,colIdx:1},spellIds:[14168,14169],maxPoints:2},{fieldName:"lethality",location:{rowIdx:2,colIdx:2},prereqLocation:{rowIdx:0,colIdx:2},spellIds:[14128,14132,14135,14136,14137],maxPoints:5},{fieldName:"vilePoisons",location:{rowIdx:3,colIdx:1},spellIds:[16513,16514,16515],maxPoints:3},{fieldName:"improvedPoisons",location:{rowIdx:3,colIdx:2},spellIds:[14113,14114,14115,14116,14117],maxPoints:5},{fieldName:"fleetFooted",location:{rowIdx:4,colIdx:0},spellIds:[31208,31209],maxPoints:2},{fieldName:"coldBlood",location:{rowIdx:4,colIdx:1},spellIds:[14177],maxPoints:1},{fieldName:"improvedKidneyShot",location:{rowIdx:4,colIdx:2},spellIds:[14174,14175,14176],maxPoints:3},{fieldName:"quickRecovery",location:{rowIdx:4,colIdx:3},spellIds:[31244,31245],maxPoints:2},{fieldName:"sealFate",location:{rowIdx:5,colIdx:1},prereqLocation:{rowIdx:4,colIdx:1},spellIds:[14186,14190,14193,14194,14195],maxPoints:5},{fieldName:"murder",location:{rowIdx:5,colIdx:2},spellIds:[14158,14159],maxPoints:2},{fieldName:"deadlyBrew",location:{rowIdx:6,colIdx:0},spellIds:[51625,51626],maxPoints:2},{fieldName:"overkill",location:{rowIdx:6,colIdx:1},spellIds:[58426],maxPoints:1},{fieldName:"deadenedNerves",location:{rowIdx:6,colIdx:2},spellIds:[31380,31382,31383],maxPoints:3},{fieldName:"focusedAttacks",location:{rowIdx:7,colIdx:0},spellIds:[51634,51635,51636],maxPoints:3},{fieldName:"findWeakness",location:{rowIdx:7,colIdx:2},spellIds:[31234,31235,31236],maxPoints:3},{fieldName:"masterPoisoner",location:{rowIdx:8,colIdx:0},spellIds:[31226,31227,58410],maxPoints:3},{fieldName:"mutilate",location:{rowIdx:8,colIdx:1},prereqLocation:{rowIdx:6,colIdx:1},spellIds:[1329],maxPoints:1},{fieldName:"turnTheTables",location:{rowIdx:8,colIdx:2},spellIds:[51627,51628,51629],maxPoints:3},{fieldName:"cutToTheChase",location:{rowIdx:9,colIdx:1},spellIds:[51664,51665,51667,51668,51669],maxPoints:5},{fieldName:"hungerForBlood",location:{rowIdx:10,colIdx:1},spellIds:[51662],maxPoints:1}]},{name:"Combat",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/181.jpg",talents:[{fieldName:"improvedGouge",location:{rowIdx:0,colIdx:0},spellIds:[13741,13793,13792],maxPoints:3},{fieldName:"improvedSinisterStrike",location:{rowIdx:0,colIdx:1},spellIds:[13732,13863],maxPoints:2},{fieldName:"dualWieldSpecialization",location:{rowIdx:0,colIdx:2},spellIds:[13715,13848,13849,13851,13852],maxPoints:5},{fieldName:"improvedSliceAndDice",location:{rowIdx:1,colIdx:0},spellIds:[14165,14166],maxPoints:2},{fieldName:"deflection",location:{rowIdx:1,colIdx:1},spellIds:[13713,13853,13854],maxPoints:3},{fieldName:"precision",location:{rowIdx:1,colIdx:3},spellIds:[13705,13832,13843,13844,13845],maxPoints:5},{fieldName:"endurance",location:{rowIdx:2,colIdx:0},spellIds:[13742,13872],maxPoints:2},{fieldName:"riposte",location:{rowIdx:2,colIdx:1},prereqLocation:{rowIdx:1,colIdx:1},spellIds:[14251],maxPoints:1},{fieldName:"closeQuartersCombat",location:{rowIdx:2,colIdx:2},prereqLocation:{rowIdx:0,colIdx:2},spellIds:[13706,13804,13805,13806,13807],maxPoints:5},{fieldName:"improvedKick",location:{rowIdx:3,colIdx:0},spellIds:[13754,13867],maxPoints:2},{fieldName:"improvedSprint",location:{rowIdx:3,colIdx:1},spellIds:[13743,13875],maxPoints:2},{fieldName:"lightningReflexes",location:{rowIdx:3,colIdx:2},spellIds:[13712,13788,13789],maxPoints:3},{fieldName:"aggression",location:{rowIdx:3,colIdx:3},spellIds:[18427,18428,18429,61330,61331],maxPoints:5},{fieldName:"maceSpecialization",location:{rowIdx:4,colIdx:0},spellIds:[13709,13800,13801,13802,13803],maxPoints:5},{fieldName:"bladeFlurry",location:{rowIdx:4,colIdx:1},spellIds:[13877],maxPoints:1},{fieldName:"hackAndSlash",location:{rowIdx:4,colIdx:2},spellIds:[13960,13961,13962,13963,13964],maxPoints:5},{fieldName:"weaponExpertise",location:{rowIdx:5,colIdx:1},prereqLocation:{rowIdx:4,colIdx:1},spellIds:[30919,30920],maxPoints:2},{fieldName:"bladeTwisting",location:{rowIdx:5,colIdx:2},spellIds:[31124,31126],maxPoints:2},{fieldName:"vitality",location:{rowIdx:6,colIdx:0},spellIds:[31122,31123,61329],maxPoints:3},{fieldName:"adrenalineRush",location:{rowIdx:6,colIdx:1},spellIds:[13750],maxPoints:1},{fieldName:"nervesOfSteel",location:{rowIdx:6,colIdx:2},spellIds:[31130,31131],maxPoints:2},{fieldName:"throwingSpecialization",location:{rowIdx:7,colIdx:0},spellIds:[5952,51679],maxPoints:2},{fieldName:"combatPotency",location:{rowIdx:7,colIdx:2},spellIds:[35541,35550,35551,35552,35553],maxPoints:5},{fieldName:"unfairAdvantage",location:{rowIdx:8,colIdx:0},spellIds:[51672,51674],maxPoints:2},{fieldName:"surpriseAttacks",location:{rowIdx:8,colIdx:1},prereqLocation:{rowIdx:6,colIdx:1},spellIds:[32601],maxPoints:1},{fieldName:"savageCombat",location:{rowIdx:8,colIdx:2},spellIds:[51682,58413],maxPoints:2},{fieldName:"preyOnTheWeak",location:{rowIdx:9,colIdx:1},spellIds:[51685,51686,51687,51688,51689],maxPoints:5},{fieldName:"killingSpree",location:{rowIdx:10,colIdx:1},spellIds:[51690],maxPoints:1}]},{name:"Subtlety",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/183.jpg",talents:[{fieldName:"relentlessStrikes",location:{rowIdx:0,colIdx:0},spellIds:[14179,58422,58423,58424,58425],maxPoints:5},{fieldName:"masterOfDeception",location:{rowIdx:0,colIdx:1},spellIds:[13958,13970,13971],maxPoints:3},{fieldName:"opportunity",location:{rowIdx:0,colIdx:2},spellIds:[14057,14072],maxPoints:2},{fieldName:"sleightOfHand",location:{rowIdx:1,colIdx:0},spellIds:[30892,30893],maxPoints:2},{fieldName:"dirtyTricks",location:{rowIdx:1,colIdx:1},spellIds:[14076,14094],maxPoints:2},{fieldName:"camouflage",location:{rowIdx:1,colIdx:2},spellIds:[13975,14062,14063],maxPoints:3},{fieldName:"elusiveness",location:{rowIdx:2,colIdx:0},spellIds:[13981,14066],maxPoints:2},{fieldName:"ghostlyStrike",location:{rowIdx:2,colIdx:1},spellIds:[14278],maxPoints:1},{fieldName:"serratedBlades",location:{rowIdx:2,colIdx:2},spellIds:[14171,14172,14173],maxPoints:3},{fieldName:"setup",location:{rowIdx:3,colIdx:0},spellIds:[13983,14070,14071],maxPoints:3},{fieldName:"initiative",location:{rowIdx:3,colIdx:1},spellIds:[13976,13979,13980],maxPoints:3},{fieldName:"improvedAmbush",location:{rowIdx:3,colIdx:2},spellIds:[14079,14080],maxPoints:2},{fieldName:"heightenedSenses",location:{rowIdx:4,colIdx:0},spellIds:[30894,30895],maxPoints:2},{fieldName:"preparation",location:{rowIdx:4,colIdx:1},spellIds:[14185],maxPoints:1},{fieldName:"dirtyDeeds",location:{rowIdx:4,colIdx:2},spellIds:[14082,14083],maxPoints:2},{fieldName:"hemorrhage",location:{rowIdx:4,colIdx:3},prereqLocation:{rowIdx:2,colIdx:2},spellIds:[16511],maxPoints:1},{fieldName:"masterOfSubtlety",location:{rowIdx:5,colIdx:0},spellIds:[31221,31222,31223],maxPoints:3},{fieldName:"deadliness",location:{rowIdx:5,colIdx:2},spellIds:[30902,30903,30904,30905,30906],maxPoints:5},{fieldName:"envelopingShadows",location:{rowIdx:6,colIdx:0},spellIds:[31211,31212,31213],maxPoints:3},{fieldName:"premeditation",location:{rowIdx:6,colIdx:1},prereqLocation:{rowIdx:4,colIdx:1},spellIds:[14183],maxPoints:1},{fieldName:"cheatDeath",location:{rowIdx:6,colIdx:2},spellIds:[31228,31229,31230],maxPoints:3},{fieldName:"sinisterCalling",location:{rowIdx:7,colIdx:1},prereqLocation:{rowIdx:6,colIdx:1},spellIds:[31216,31217,31218,31219,31220],maxPoints:5},{fieldName:"waylay",location:{rowIdx:7,colIdx:2},spellIds:[51692,51696],maxPoints:2},{fieldName:"honorAmongThieves",location:{rowIdx:8,colIdx:0},spellIds:[51698,51700,51701],maxPoints:3},{fieldName:"shadowstep",location:{rowIdx:8,colIdx:1},spellIds:[36554],maxPoints:1},{fieldName:"filthyTricks",location:{rowIdx:8,colIdx:2},spellIds:[58414,58415],maxPoints:2},{fieldName:"slaughterFromTheShadows",location:{rowIdx:9,colIdx:1},spellIds:[51708,51709,51710,51711,51712],maxPoints:5},{fieldName:"shadowDance",location:{rowIdx:10,colIdx:1},spellIds:[51713],maxPoints:1}]}]),Co={majorGlyphs:{[T.GlyphOfAdrenalineRush]:{name:"Glyph of Adrenaline Rush",description:"Increases the duration of Adrenaline Rush by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_shadowworddominate.jpg"},[T.GlyphOfAmbush]:{name:"Glyph of Ambush",description:"Increases the range on Ambush by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_ambush.jpg"},[T.GlyphOfBackstab]:{name:"Glyph of Backstab",description:"Your Backstab increases the duration of your Rupture effect on the target by 2 sec, up to a maximum of 6 additional sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_backstab.jpg"},[T.GlyphOfBladeFlurry]:{name:"Glyph of Blade Flurry",description:"Reduces the energy cost of Blade Flurry by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_punishingblow.jpg"},[T.GlyphOfCloakOfShadows]:{name:"Glyph of Cloak of Shadows",description:"While Cloak of Shadows is active, you take 40% less physical damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_nethercloak.jpg"},[T.GlyphOfCripplingPoison]:{name:"Glyph of Crippling Poison",description:"Increases the chance to inflict your target with Crippling Poison by an additional 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_poisonsting.jpg"},[T.GlyphOfDeadlyThrow]:{name:"Glyph of Deadly Throw",description:"Increases the slowing effect on Deadly Throw by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_throwingknife_06.jpg"},[T.GlyphOfEvasion]:{name:"Glyph of Evasion",description:"Increases the duration of Evasion by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_shadowward.jpg"},[T.GlyphOfEviscerate]:{name:"Glyph of Eviscerate",description:"Increases the critical strike chance of Eviscerate by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_eviscerate.jpg"},[T.GlyphOfExposeArmor]:{name:"Glyph of Expose Armor",description:"Increases the duration of Expose Armor by 12 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_riposte.jpg"},[T.GlyphOfFanOfKnives]:{name:"Glyph of Fan of Knives",description:"Increases the damage done by Fan of Knives by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_fanofknives.jpg"},[T.GlyphOfFeint]:{name:"Glyph of Feint",description:"Reduces the energy cost of Feint by 20.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_feint.jpg"},[T.GlyphOfGarrote]:{name:"Glyph of Garrote",description:"Reduces the duration of your Garrote ability by 3 sec and increases the total damage it deals by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_garrote.jpg"},[T.GlyphOfGhostlyStrike]:{name:"Glyph of Ghostly Strike",description:"Increases the damage dealt by Ghostly Strike by 40% and the duration of its effect by 4 sec, but increases its cooldown by 10 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_curse.jpg"},[T.GlyphOfGouge]:{name:"Glyph of Gouge",description:"Reduces the energy cost of Gouge by 15.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_gouge.jpg"},[T.GlyphOfHemorrhage]:{name:"Glyph of Hemorrhage",description:"Increases the damage bonus against targets afflicted by Hemorrhage by 40%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_lifedrain.jpg"},[T.GlyphOfHungerForBlood]:{name:"Glyph of Hunger For Blood",description:"Increases the bonus damage from Hunger For Blood by 3%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_hungerforblood.jpg"},[T.GlyphOfKillingSpree]:{name:"Glyph of Killing Spree",description:"Reduces the cooldown on Killing Spree by 45 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_murderspree.jpg"},[T.GlyphOfMutilate]:{name:"Glyph of Mutilate",description:"Reduces the cost of Mutilate by 5 energy.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_shadowstrikes.jpg"},[T.GlyphOfPreparation]:{name:"Glyph of Preparation",description:"Your Preparation ability also instantly resets the cooldown of Blade Flurry, Dismantle, and Kick.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_antishadow.jpg"},[T.GlyphOfRupture]:{name:"Glyph of Rupture",description:"Increases the duration of Rupture by 4 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_rupture.jpg"},[T.GlyphOfSap]:{name:"Glyph of Sap",description:"Increases the duration of Sap by 20 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_sap.jpg"},[T.GlyphOfShadowDance]:{name:"Glyph of Shadow Dance",description:"Increases the duration of Shadow Dance by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_shadowdance.jpg"},[T.GlyphOfSinisterStrike]:{name:"Glyph of Sinister Strike",description:"Your Sinister Strike critical strikes have a 50% chance to add an additional combo point.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_ritualofsacrifice.jpg"},[T.GlyphOfSliceAndDice]:{name:"Glyph of Slice and Dice",description:"Increases the duration of Slice and Dice by 3 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_slicedice.jpg"},[T.GlyphOfSprint]:{name:"Glyph of Sprint",description:"Increases the movement speed of your Sprint ability by an additional 30%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_sprint.jpg"},[T.GlyphOfTricksOfTheTrade]:{name:"Glyph of Tricks of the Trade",description:"The bonus damage and threat redirection granted by your Tricks of the Trade ability lasts an additional 4 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_tricksofthetrade.jpg"},[T.GlyphOfVigor]:{name:"Glyph of Vigor",description:"Vigor grants an additional 10 maximum energy.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_earthbindtotem.jpg"}},minorGlyphs:{[R.GlyphOfBlurredSpeed]:{name:"Glyph of Blurred Speed",description:"Enables you to walk on water while your Sprint ability is active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_sprint.jpg"},[R.GlyphOfDistract]:{name:"Glyph of Distract",description:"Increases the range of your Distract ability by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_distract.jpg"},[R.GlyphOfPickLock]:{name:"Glyph of Pick Lock",description:"Reduces the cast time of your Pick Lock ability by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_moonkey.jpg"},[R.GlyphOfPickPocket]:{name:"Glyph of Pick Pocket",description:"Increases the range of your Pick Pocket ability by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_bag_11.jpg"},[R.GlyphOfSafeFall]:{name:"Glyph of Safe Fall",description:"Increases the distance your Safe Fall ability allows you to fall without taking damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_feather_01.jpg"},[R.GlyphOfVanish]:{name:"Glyph of Vanish",description:"Increases your movement speed by 30% while the Vanish effect is active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_vanish.jpg"}}},_o=go([{name:"Elemental",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/classic/261.jpg",talents:[{fieldName:"convection",location:{rowIdx:0,colIdx:1},spellIds:[16039,16109],maxPoints:5},{fieldName:"concussion",location:{rowIdx:0,colIdx:2},spellIds:[16035,16105],maxPoints:5},{fieldName:"callOfFlame",location:{rowIdx:1,colIdx:0},spellIds:[16038,16160,16161],maxPoints:3},{fieldName:"elementalWarding",location:{rowIdx:1,colIdx:1},spellIds:[28996,28997,28998],maxPoints:3},{fieldName:"elementalDevastation",location:{rowIdx:1,colIdx:2},spellIds:[30160,29179,29180],maxPoints:3},{fieldName:"reverberation",location:{rowIdx:2,colIdx:0},spellIds:[16040,16113,16114,16115,16116],maxPoints:5},{fieldName:"elementalFocus",location:{rowIdx:2,colIdx:1},spellIds:[16164],maxPoints:1},{fieldName:"elementalFury",location:{rowIdx:2,colIdx:2},spellIds:[16089,60184,60185,60187,60188],maxPoints:5},{fieldName:"improvedFireNova",location:{rowIdx:3,colIdx:0},spellIds:[16086,16544],maxPoints:2},{fieldName:"eyeOfTheStorm",location:{rowIdx:3,colIdx:3},spellIds:[29062,29064],maxPoints:3},{fieldName:"elementalReach",location:{rowIdx:4,colIdx:0},spellIds:[28999],maxPoints:2},{fieldName:"callOfThunder",location:{rowIdx:4,colIdx:1},prereqLocation:{rowIdx:2,colIdx:1},spellIds:[16041],maxPoints:1},{fieldName:"unrelentingStorm",location:{rowIdx:4,colIdx:3},spellIds:[30664,30665,30666],maxPoints:3},{fieldName:"elementalPrecision",location:{rowIdx:5,colIdx:0},spellIds:[30672,30673,30674],maxPoints:3},{fieldName:"lightningMastery",location:{rowIdx:5,colIdx:2},prereqLocation:{rowIdx:2,colIdx:2},spellIds:[16578],maxPoints:5},{fieldName:"elementalMastery",location:{rowIdx:6,colIdx:1},prereqLocation:{rowIdx:4,colIdx:1},spellIds:[16166],maxPoints:1},{fieldName:"stormEarthAndFire",location:{rowIdx:6,colIdx:2},spellIds:[51483,51485,51486],maxPoints:3},{fieldName:"boomingEchoes",location:{rowIdx:7,colIdx:0},spellIds:[63370,63372],maxPoints:2},{fieldName:"elementalOath",location:{rowIdx:7,colIdx:1},prereqLocation:{rowIdx:6,colIdx:1},spellIds:[51466,51470],maxPoints:2},{fieldName:"lightningOverload",location:{rowIdx:7,colIdx:2},spellIds:[30675,30678,30679],maxPoints:3},{fieldName:"astralShift",location:{rowIdx:8,colIdx:0},spellIds:[51474,51478,51479],maxPoints:3},{fieldName:"totemOfWrath",location:{rowIdx:8,colIdx:1},spellIds:[30706],maxPoints:1},{fieldName:"lavaFlows",location:{rowIdx:8,colIdx:2},spellIds:[51480,51481,51482],maxPoints:3},{fieldName:"shamanism",location:{rowIdx:9,colIdx:1},spellIds:[62097],maxPoints:5},{fieldName:"thunderstorm",location:{rowIdx:10,colIdx:1},spellIds:[51490],maxPoints:1}]},{name:"Enhancement",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/classic/263.jpg",talents:[{fieldName:"enhancingTotems",location:{rowIdx:0,colIdx:0},spellIds:[16259,16295,52456],maxPoints:3},{fieldName:"earthsGrasp",location:{rowIdx:0,colIdx:1},spellIds:[16043,16130],maxPoints:2},{fieldName:"ancestralKnowledge",location:{rowIdx:0,colIdx:2},spellIds:[17485],maxPoints:5},{fieldName:"guardianTotems",location:{rowIdx:1,colIdx:0},spellIds:[16258,16293],maxPoints:2},{fieldName:"thunderingStrikes",location:{rowIdx:1,colIdx:1},spellIds:[16255,16302],maxPoints:5},{fieldName:"improvedGhostWolf",location:{rowIdx:1,colIdx:2},spellIds:[16262,16287],maxPoints:2},{fieldName:"improvedShields",location:{rowIdx:1,colIdx:3},spellIds:[16261,16290,51881],maxPoints:3},{fieldName:"elementalWeapons",location:{rowIdx:2,colIdx:0},spellIds:[16266,29079,29080],maxPoints:3},{fieldName:"shamanisticFocus",location:{rowIdx:2,colIdx:2},spellIds:[43338],maxPoints:1},{fieldName:"anticipation",location:{rowIdx:2,colIdx:3},spellIds:[16254,16271],maxPoints:3},{fieldName:"flurry",location:{rowIdx:3,colIdx:1},prereqLocation:{rowIdx:1,colIdx:1},spellIds:[16256,16281],maxPoints:5},{fieldName:"toughness",location:{rowIdx:3,colIdx:2},spellIds:[16252,16306],maxPoints:5},{fieldName:"improvedWindfuryTotem",location:{rowIdx:4,colIdx:0},spellIds:[29192,29193],maxPoints:2},{fieldName:"spiritWeapons",location:{rowIdx:4,colIdx:1},spellIds:[16268],maxPoints:1},{fieldName:"mentalDexterity",location:{rowIdx:4,colIdx:2},spellIds:[51883],maxPoints:3},{fieldName:"unleashedRage",location:{rowIdx:5,colIdx:0},spellIds:[30802,30808,30809],maxPoints:3},{fieldName:"weaponMastery",location:{rowIdx:5,colIdx:2},spellIds:[29082,29084,29086],maxPoints:3},{fieldName:"frozenPower",location:{rowIdx:5,colIdx:3},spellIds:[63373,63374],maxPoints:2},{fieldName:"dualWieldSpecialization",location:{rowIdx:6,colIdx:0},prereqLocation:{rowIdx:6,colIdx:1},spellIds:[30816,30818],maxPoints:3},{fieldName:"dualWield",location:{rowIdx:6,colIdx:1},prereqLocation:{rowIdx:4,colIdx:1},spellIds:[30798],maxPoints:1},{fieldName:"stormstrike",location:{rowIdx:6,colIdx:2},spellIds:[17364],maxPoints:1},{fieldName:"staticShock",location:{rowIdx:7,colIdx:0},spellIds:[51525],maxPoints:3},{fieldName:"lavaLash",location:{rowIdx:7,colIdx:1},prereqLocation:{rowIdx:6,colIdx:1},spellIds:[60103],maxPoints:1},{fieldName:"improvedStormstrike",location:{rowIdx:7,colIdx:2},prereqLocation:{rowIdx:6,colIdx:2},spellIds:[51521,51522],maxPoints:2},{fieldName:"mentalQuickness",location:{rowIdx:8,colIdx:0},spellIds:[30812],maxPoints:3},{fieldName:"shamanisticRage",location:{rowIdx:8,colIdx:1},spellIds:[30823],maxPoints:1},{fieldName:"earthenPower",location:{rowIdx:8,colIdx:2},spellIds:[51523,51524],maxPoints:2},{fieldName:"maelstromWeapon",location:{rowIdx:9,colIdx:1},spellIds:[51528],maxPoints:5},{fieldName:"feralSpirit",location:{rowIdx:10,colIdx:1},spellIds:[51533],maxPoints:1}]},{name:"Restoration",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/classic/262.jpg",talents:[{fieldName:"improvedHealingWave",location:{rowIdx:0,colIdx:1},spellIds:[16182,16226],maxPoints:5},{fieldName:"totemicFocus",location:{rowIdx:0,colIdx:2},spellIds:[16173,16222],maxPoints:5},{fieldName:"improvedReincarnation",location:{rowIdx:1,colIdx:0},spellIds:[16184,16209],maxPoints:2},{fieldName:"healingGrace",location:{rowIdx:1,colIdx:1},spellIds:[29187,29189,29191],maxPoints:3},{fieldName:"tidalFocus",location:{rowIdx:1,colIdx:2},spellIds:[16179,16214],maxPoints:5},{fieldName:"improvedWaterShield",location:{rowIdx:2,colIdx:0},spellIds:[16180,16196,16198],maxPoints:3},{fieldName:"healingFocus",location:{rowIdx:2,colIdx:1},spellIds:[16181,16230,16232],maxPoints:3},{fieldName:"tidalForce",location:{rowIdx:2,colIdx:2},spellIds:[55198],maxPoints:1},{fieldName:"ancestralUealing",location:{rowIdx:2,colIdx:3},spellIds:[16176,16235],maxPoints:3},{fieldName:"restorativeTotems",location:{rowIdx:3,colIdx:1},spellIds:[16187,16205],maxPoints:3},{fieldName:"tidalMastery",location:{rowIdx:3,colIdx:2},spellIds:[16194,16218],maxPoints:5},{fieldName:"healingWay",location:{rowIdx:4,colIdx:0},spellIds:[29206,29205,29202],maxPoints:3},{fieldName:"naturesSwiftness",location:{rowIdx:4,colIdx:2},spellIds:[16188],maxPoints:1},{fieldName:"focusedMind",location:{rowIdx:4,colIdx:3},spellIds:[30864],maxPoints:3},{fieldName:"purification",location:{rowIdx:5,colIdx:2},spellIds:[16178,16210],maxPoints:5},{fieldName:"naturesGuardian",location:{rowIdx:6,colIdx:0},spellIds:[30881,30883],maxPoints:5},{fieldName:"manaTideTotem",location:{rowIdx:6,colIdx:1},prereqLocation:{rowIdx:3,colIdx:1},spellIds:[16190],maxPoints:1},{fieldName:"cleanseSpirit",location:{rowIdx:6,colIdx:2},prereqLocation:{rowIdx:5,colIdx:2},spellIds:[51886],maxPoints:1},{fieldName:"blessingOfTheEternals",location:{rowIdx:7,colIdx:0},spellIds:[51554,51555],maxPoints:2},{fieldName:"improvedChainHeal",location:{rowIdx:7,colIdx:1},spellIds:[30872],maxPoints:2},{fieldName:"naturesBlessing",location:{rowIdx:7,colIdx:2},spellIds:[30867],maxPoints:3},{fieldName:"ancestralAwakening",location:{rowIdx:8,colIdx:0},spellIds:[51556],maxPoints:3},{fieldName:"earthShield",location:{rowIdx:8,colIdx:1},spellIds:[974],maxPoints:1},{fieldName:"improvedEarthShield",location:{rowIdx:8,colIdx:2},prereqLocation:{rowIdx:8,colIdx:1},spellIds:[51560],maxPoints:2},{fieldName:"tidalWaves",location:{rowIdx:9,colIdx:1},spellIds:[51562],maxPoints:5},{fieldName:"riptide",location:{rowIdx:10,colIdx:1},spellIds:[61295],maxPoints:1}]}]),No={majorGlyphs:{[L.GlyphOfChainHeal]:{name:"Glyph of Chain Heal",description:"Your Chain Heal heals 1 additional target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_healingwavegreater.jpg"},[L.GlyphOfChainLightning]:{name:"Glyph of Chain Lightning",description:"Your Chain Lightning strikes 1 additional target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_chainlightning.jpg"},[L.GlyphOfEarthShield]:{name:"Glyph of Earth Shield",description:"Increases the amount healed by your Earth Shield by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_skinofearth.jpg"},[L.GlyphOfEarthlivingWeapon]:{name:"Glyph of Earthliving Weapon",description:"Increases the chance for your Earthliving weapon to trigger by 5%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_earthlivingweapon.jpg"},[L.GlyphOfElementalMastery]:{name:"Glyph of Elemental Mastery",description:"Reduces the cooldown of your Elemental Mastery ability by 30 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_wispheal.jpg"},[L.GlyphOfFeralSpirit]:{name:"Glyph of Feral Spirit",description:"Your spirit wolves gain an additional 30% of your attack power.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_feralspirit.jpg"},[L.GlyphOfFireElementalTotem]:{name:"Glyph of Fire Elemental Totem",description:"Reduces the cooldown of your Fire Elemental Totem by 5 min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_elemental_totem.jpg"},[L.GlyphOfFireNova]:{name:"Glyph of Fire Nova",description:"Reduces the cooldown of your Fire Nova spell by 3 seconds.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_sealoffire.jpg"},[L.GlyphOfFlameShock]:{name:"Glyph of Flame Shock",description:"Increases the critical strike damage bonus of your Flame Shock damage by 60%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_flameshock.jpg"},[L.GlyphOfFlametongueWeapon]:{name:"Glyph of Flametongue Weapon",description:"Increases your spell critical strike chance by 2% on each of your weapons with Flametongue Weapon active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_flametounge.jpg"},[L.GlyphOfFrostShock]:{name:"Glyph of Frost Shock",description:"Increases the duration of your Frost Shock by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frostshock.jpg"},[L.GlyphOfHealingStreamTotem]:{name:"Glyph of Healing Stream Totem",description:"Your Healing Stream Totem heals for an additional 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_spear_04.jpg"},[L.GlyphOfHealingWave]:{name:"Glyph of Healing Wave",description:"Your Healing Wave also heals you for 20% of the healing effect when you heal someone else.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_magicimmunity.jpg"},[L.GlyphOfHex]:{name:"Glyph of Hex",description:"Increases the damage your Hex target can take before the Hex effect is removed by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_hex.jpg"},[L.GlyphOfLava]:{name:"Glyph of Lava",description:"Your Lava Burst spell gains an additional 10% of your spellpower.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_lavaburst.jpg"},[L.GlyphOfLavaLash]:{name:"Glyph of Lava Lash",description:"Damage on your Lava Lash is increased by an additional 10% if your weapon is enchanted with Flametongue.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_shaman_lavalash.jpg"},[L.GlyphOfLesserHealingWave]:{name:"Glyph of Lesser Healing Wave",description:"Your Lesser Healing Wave heals for 20% more if the target is also affected by Earth Shield.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_healingwavelesser.jpg"},[L.GlyphOfLightningBolt]:{name:"Glyph of Lightning Bolt",description:"Increases the damage dealt by Lightning Bolt by 4%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_lightning.jpg"},[L.GlyphOfLightningShield]:{name:"Glyph of Lightning Shield",description:"Increases the damage from Lightning Shield by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_lightningshield.jpg"},[L.GlyphOfManaTide]:{name:"Glyph of Mana Tide",description:"Your Mana Tide Totem grants an additional 1% of each target's maximum mana each time it pulses.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_healingwavegreater.jpg"},[L.GlyphOfRiptide]:{name:"Glyph of Riptide",description:"Increases the duration of Riptide by 6 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_riptide.jpg"},[L.GlyphOfShocking]:{name:"Glyph of Shocking",description:"Reduces your global cooldown when casting your shock spells by 0.5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_earthshock.jpg"},[L.GlyphOfStoneclawTotem]:{name:"Glyph of Stoneclaw Totem",description:"Your Stoneclaw Totem also places a damage absorb shield on you, equal to 4 times the strength of the shield it places on your totems.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_stoneclawtotem.jpg"},[L.GlyphOfStormstrike]:{name:"Glyph of Stormstrike",description:"Increases the Nature damage bonus from your Stormstrike ability by an additional 8%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_shaman_stormstrike.jpg"},[L.GlyphOfThunder]:{name:"Glyph of Thunder",description:"Reduces the cooldown on Thunderstorm by 10 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_thunderstorm.jpg"},[L.GlyphOfTotemOfWrath]:{name:"Glyph of Totem of Wrath",description:"When you cast Totem of Wrath, you gain 30% of the totem's bonus spell power for 5 min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_totemofwrath.jpg"},[L.GlyphOfWaterMastery]:{name:"Glyph of Water Mastery",description:"Increases the passive mana regeneration of your Water Shield spell by 30%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_shaman_watershield.jpg"},[L.GlyphOfWindfuryWeapon]:{name:"Glyph of Windfury Weapon",description:"Increases the chance per swing for Windfury Weapon to trigger by 2%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_cyclone.jpg"}},minorGlyphs:{[G.GlyphOfAstralRecall]:{name:"Glyph of Astral Recall",description:"Cooldown of your Astral Recall spell reduced by 7.5 min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_astralrecal.jpg"},[G.GlyphOfGhostWolf]:{name:"Glyph of Ghost Wolf",description:"Your Ghost Wolf form regenerates an additional 1% of your maximum health every 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_spiritwolf.jpg"},[G.GlyphOfRenewedLife]:{name:"Glyph of Renewed Life",description:"Your Reincarnation spell no longer requires a reagent.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_reincarnation.jpg"},[G.GlyphOfThunderstorm]:{name:"Glyph of Thunderstorm",description:"Increases the mana you receive from your Thunderstorm spell by 2%, but it no longer knocks enemies back.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_thunderstorm.jpg"},[G.GlyphOfWaterBreathing]:{name:"Glyph of Water Breathing",description:"Your Water Breathing spell no longer requires a reagent.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_demonbreath.jpg"},[G.GlyphOfWaterShield]:{name:"Glyph of Water Shield",description:"Increases the number of charges on your Water Shield spell by 1.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_shaman_watershield.jpg"},[G.GlyphOfWaterWalking]:{name:"Glyph of Water Walking",description:"Your Water Walking spell no longer requires a reagent.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_windwalkon.jpg"}}},To=go([{name:"Affliction",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/302.jpg",talents:[{fieldName:"improvedCurseOfAgony",location:{rowIdx:0,colIdx:0},spellIds:[18827,18829],maxPoints:2},{fieldName:"suppression",location:{rowIdx:0,colIdx:1},spellIds:[18174,18175,18176],maxPoints:3},{fieldName:"improvedCorruption",location:{rowIdx:0,colIdx:2},spellIds:[17810,17811,17812,17813,17814],maxPoints:5},{fieldName:"improvedCurseOfWeakness",location:{rowIdx:1,colIdx:0},spellIds:[18179,18180],maxPoints:2},{fieldName:"improvedDrainSoul",location:{rowIdx:1,colIdx:1},spellIds:[18213,18372],maxPoints:2},{fieldName:"improvedLifeTap",location:{rowIdx:1,colIdx:2},spellIds:[18182,18183],maxPoints:2},{fieldName:"soulSiphon",location:{rowIdx:1,colIdx:3},spellIds:[17804,17805],maxPoints:2},{fieldName:"improvedFear",location:{rowIdx:2,colIdx:0},spellIds:[53754,53759],maxPoints:2},{fieldName:"felConcentration",location:{rowIdx:2,colIdx:1},spellIds:[17783,17784,17785],maxPoints:3},{fieldName:"amplifyCurse",location:{rowIdx:2,colIdx:2},spellIds:[18288],maxPoints:1},{fieldName:"grimReach",location:{rowIdx:3,colIdx:0},spellIds:[18218,18219],maxPoints:2},{fieldName:"nightfall",location:{rowIdx:3,colIdx:1},spellIds:[18094,18095],maxPoints:2},{fieldName:"empoweredCorruption",location:{rowIdx:3,colIdx:3},spellIds:[32381,32382,32383],maxPoints:3},{fieldName:"shadowEmbrace",location:{rowIdx:4,colIdx:0},spellIds:[32385,32387,32392,32393,32394],maxPoints:5},{fieldName:"siphonLife",location:{rowIdx:4,colIdx:1},spellIds:[63108],maxPoints:1},{fieldName:"curseOfExhaustion",location:{rowIdx:4,colIdx:2},spellIds:[18223],maxPoints:1,prereqLocation:{rowIdx:2,colIdx:2}},{fieldName:"improvedFelhunter",location:{rowIdx:5,colIdx:0},spellIds:[54037,54038],maxPoints:2},{fieldName:"shadowMastery",location:{rowIdx:5,colIdx:1},spellIds:[18271,18272,18273,18274,18275],maxPoints:5,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"eradication",location:{rowIdx:6,colIdx:0},spellIds:[47195,47196,47197],maxPoints:3},{fieldName:"contagion",location:{rowIdx:6,colIdx:1},spellIds:[30060,30061,30062,30063,30064],maxPoints:5},{fieldName:"darkPact",location:{rowIdx:6,colIdx:2},spellIds:[18220],maxPoints:1},{fieldName:"improvedHowlOfTerror",location:{rowIdx:7,colIdx:0},spellIds:[30054,30057],maxPoints:2},{fieldName:"malediction",location:{rowIdx:7,colIdx:2},spellIds:[32477,32483,32484],maxPoints:3},{fieldName:"deathsEmbrace",location:{rowIdx:8,colIdx:0},spellIds:[47198,47199,47200],maxPoints:3},{fieldName:"unstableAffliction",location:{rowIdx:8,colIdx:1},spellIds:[30108],maxPoints:1,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"pandemic",location:{rowIdx:8,colIdx:2},spellIds:[58435],maxPoints:1,prereqLocation:{rowIdx:8,colIdx:1}},{fieldName:"everlastingAffliction",location:{rowIdx:9,colIdx:1},spellIds:[47201,47202,47203,47204,47205],maxPoints:5},{fieldName:"haunt",location:{rowIdx:10,colIdx:1},spellIds:[48181],maxPoints:1}]},{name:"Demonology",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/303.jpg",talents:[{fieldName:"improvedHealthstone",location:{rowIdx:0,colIdx:0},spellIds:[18692,18693],maxPoints:2},{fieldName:"improvedImp",location:{rowIdx:0,colIdx:1},spellIds:[18694,18695,18696],maxPoints:3},{fieldName:"demonicEmbrace",location:{rowIdx:0,colIdx:2},spellIds:[18697,18698,18699],maxPoints:3},{fieldName:"felSynergy",location:{rowIdx:0,colIdx:3},spellIds:[47230,47231],maxPoints:2},{fieldName:"improvedHealthFunnel",location:{rowIdx:1,colIdx:0},spellIds:[18703,18704],maxPoints:2},{fieldName:"demonicBrutality",location:{rowIdx:1,colIdx:1},spellIds:[18705,18706,18707],maxPoints:3},{fieldName:"felVitality",location:{rowIdx:1,colIdx:2},spellIds:[18731,18743,18744],maxPoints:3},{fieldName:"improvedSayaad",location:{rowIdx:2,colIdx:0},spellIds:[18754,18755,18756],maxPoints:3},{fieldName:"soulLink",location:{rowIdx:2,colIdx:1},spellIds:[19028],maxPoints:1},{fieldName:"felDomination",location:{rowIdx:2,colIdx:2},spellIds:[18708],maxPoints:1},{fieldName:"demonicAegis",location:{rowIdx:2,colIdx:3},spellIds:[30143,30144,30145],maxPoints:3},{fieldName:"unholyPower",location:{rowIdx:3,colIdx:1},spellIds:[18769,18770,18771,18772,18773],maxPoints:5,prereqLocation:{rowIdx:2,colIdx:1}},{fieldName:"masterSummoner",location:{rowIdx:3,colIdx:2},spellIds:[18709,18710],maxPoints:2,prereqLocation:{rowIdx:2,colIdx:2}},{fieldName:"manaFeed",location:{rowIdx:4,colIdx:0},spellIds:[30326],maxPoints:1,prereqLocation:{rowIdx:3,colIdx:1}},{fieldName:"masterConjuror",location:{rowIdx:4,colIdx:2},spellIds:[18767,18768],maxPoints:2},{fieldName:"masterDemonologist",location:{rowIdx:5,colIdx:1},spellIds:[23785,23822,23823,23824,23825],maxPoints:5,prereqLocation:{rowIdx:3,colIdx:1}},{fieldName:"moltenCore",location:{rowIdx:5,colIdx:2},spellIds:[47245,47246,47247],maxPoints:3},{fieldName:"demonicResilience",location:{rowIdx:6,colIdx:0},spellIds:[30319,30320,30321],maxPoints:3},{fieldName:"demonicEmpowerment",location:{rowIdx:6,colIdx:1},spellIds:[47193],maxPoints:1,prereqLocation:{rowIdx:5,colIdx:1}},{fieldName:"demonicKnowledge",location:{rowIdx:6,colIdx:2},spellIds:[35691,35692,35693],maxPoints:3},{fieldName:"demonicTactics",location:{rowIdx:7,colIdx:1},spellIds:[30242,30245,30246,30247,30248],maxPoints:5},{fieldName:"decimation",location:{rowIdx:7,colIdx:2},spellIds:[63156,63158],maxPoints:2},{fieldName:"improvedDemonicTactics",location:{rowIdx:8,colIdx:0},spellIds:[54347,54348,54349],maxPoints:3,prereqLocation:{rowIdx:7,colIdx:1}},{fieldName:"summonFelguard",location:{rowIdx:8,colIdx:1},spellIds:[30146],maxPoints:1},{fieldName:"nemesis",location:{rowIdx:8,colIdx:2},spellIds:[63117,63121,63123],maxPoints:3},{fieldName:"demonicPact",location:{rowIdx:9,colIdx:1},spellIds:[47236,47237,47238,47239,47240],maxPoints:5},{fieldName:"metamorphosis",location:{rowIdx:10,colIdx:1},spellIds:[59672],maxPoints:1}]},{name:"Destruction",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/301.jpg",talents:[{fieldName:"improvedShadowBolt",location:{rowIdx:0,colIdx:1},spellIds:[17793,17796,17801,17802,17803],maxPoints:5},{fieldName:"bane",location:{rowIdx:0,colIdx:2},spellIds:[17788,17789,17790,17791,17792],maxPoints:5},{fieldName:"aftermath",location:{rowIdx:1,colIdx:0},spellIds:[18119,18120],maxPoints:2},{fieldName:"moltenSkin",location:{rowIdx:1,colIdx:1},spellIds:[63349,63350,63351],maxPoints:3},{fieldName:"cataclysm",location:{rowIdx:1,colIdx:2},spellIds:[17778,17779,17780],maxPoints:3},{fieldName:"demonicPower",location:{rowIdx:2,colIdx:0},spellIds:[18126,18127],maxPoints:2},{fieldName:"shadowburn",location:{rowIdx:2,colIdx:1},spellIds:[17877],maxPoints:1},{fieldName:"ruin",location:{rowIdx:2,colIdx:2},spellIds:[17959,59738,59739,59740,59741],maxPoints:5},{fieldName:"intensity",location:{rowIdx:3,colIdx:0},spellIds:[18135,18136],maxPoints:2},{fieldName:"destructiveReach",location:{rowIdx:3,colIdx:1},spellIds:[17917,17918],maxPoints:2},{fieldName:"improvedSearingPain",location:{rowIdx:3,colIdx:3},spellIds:[17927,17929,17930],maxPoints:3},{fieldName:"backlash",location:{rowIdx:4,colIdx:0},spellIds:[34935,34938,34939],maxPoints:3,prereqLocation:{rowIdx:3,colIdx:0}},{fieldName:"improvedImmolate",location:{rowIdx:4,colIdx:1},spellIds:[17815,17833,17834],maxPoints:3},{fieldName:"devastation",location:{rowIdx:4,colIdx:2},spellIds:[18130],maxPoints:1,prereqLocation:{rowIdx:2,colIdx:2}},{fieldName:"netherProtection",location:{rowIdx:5,colIdx:0},spellIds:[30299,30301,30302],maxPoints:3},{fieldName:"emberstorm",location:{rowIdx:5,colIdx:2},spellIds:[17954,17955,17956,17957,17958],maxPoints:5},{fieldName:"conflagrate",location:{rowIdx:6,colIdx:1},spellIds:[17962],maxPoints:1,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"soulLeech",location:{rowIdx:6,colIdx:2},spellIds:[30293,30295,30296],maxPoints:3},{fieldName:"pyroclasm",location:{rowIdx:6,colIdx:3},spellIds:[18096,18073,63245],maxPoints:3},{fieldName:"shadowAndFlame",location:{rowIdx:7,colIdx:1},spellIds:[30288,30289,30290,30291,30292],maxPoints:5},{fieldName:"improvedSoulLeech",location:{rowIdx:7,colIdx:2},spellIds:[54117,54118],maxPoints:2,prereqLocation:{rowIdx:6,colIdx:2}},{fieldName:"backdraft",location:{rowIdx:8,colIdx:0},spellIds:[47258,47259,47260],maxPoints:3,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"shadowfury",location:{rowIdx:8,colIdx:1},spellIds:[30283],maxPoints:1},{fieldName:"empoweredImp",location:{rowIdx:8,colIdx:2},spellIds:[47220,47221,47223],maxPoints:3},{fieldName:"fireAndBrimstone",location:{rowIdx:9,colIdx:1},spellIds:[47266,47267,47268,47269,47270],maxPoints:5},{fieldName:"chaosBolt",location:{rowIdx:10,colIdx:1},spellIds:[50796],maxPoints:1}]}]),Ro={majorGlyphs:{[A.GlyphOfChaosBolt]:{name:"Glyph of Chaos Bolt",description:"Reduces the cooldown on Chaos Bolt by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warlock_chaosbolt.jpg"},[A.GlyphOfConflagrate]:{name:"Glyph of Conflagrate",description:"Your Conflagrate spell no longer consumes your Immolate or Shadowflame spell from the target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_fireball.jpg"},[A.GlyphOfCorruption]:{name:"Glyph of Corruption",description:"Your Corruption spell has a 4% chance to cause you to enter a Shadow Trance state after damaging the opponent. The Shadow Trance state reduces the casting time of your next Shadow Bolt spell by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_abominationexplosion.jpg"},[A.GlyphOfCurseOfAgony]:{name:"Glyph of Curse of Agony",description:"Increases the duration of your Curse of Agony by 4 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_curseofsargeras.jpg"},[A.GlyphOfDeathCoil]:{name:"Glyph of Death Coil",description:"Increases the duration of your Death Coil by 0.5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_deathcoil.jpg"},[A.GlyphOfDemonicCircle]:{name:"Glyph of Demonic Circle",description:"Reduces the cooldown on Demonic Circle by 4 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_demoniccirclesummon.jpg"},[A.GlyphOfFear]:{name:"Glyph of Fear",description:"Increases the damage your Fear target can take before the Fear effect is removed by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_possession.jpg"},[A.GlyphOfFelguard]:{name:"Glyph of Felguard",description:"Increases the Felguard's total attack power by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_summonfelguard.jpg"},[A.GlyphOfFelhunter]:{name:"Glyph of Felhunter",description:"When your Felhunter uses Devour Magic, you will also be healed for that amount.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_summonfelhunter.jpg"},[A.GlyphOfHaunt]:{name:"Glyph of Haunt",description:"The bonus damage granted by your Haunt spell is increased by an additional 3%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warlock_haunt.jpg"},[A.GlyphOfHealthFunnel]:{name:"Glyph of Health Funnel",description:"Reduces the pushback suffered from damaging attacks while channeling your Health Funnel spell by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_lifedrain.jpg"},[A.GlyphOfHealthstone]:{name:"Glyph of Healthstone",description:"You receive 30% more healing from using a healthstone.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_stone_04.jpg"},[A.GlyphOfHowlOfTerror]:{name:"Glyph of Howl of Terror",description:"Reduces the cooldown on your Howl of Terror spell by 8 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_deathscream.jpg"},[A.GlyphOfImmolate]:{name:"Glyph of Immolate",description:"Increases the periodic damage of your Immolate by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_immolation.jpg"},[A.GlyphOfImp]:{name:"Glyph of Imp",description:"Increases the damage done by your Imp's Firebolt spell by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_summonimp.jpg"},[A.GlyphOfIncinerate]:{name:"Glyph of Incinerate",description:"Increases the damage done by Incinerate by 5%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_burnout.jpg"},[A.GlyphOfLifeTap]:{name:"Glyph of Life Tap",description:"When you use Life Tap or Dark Pact, you gain 20% of your Spirit as spell power for 40 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_burningspirit.jpg"},[A.GlyphOfMetamorphosis]:{name:"Glyph of Metamorphosis",description:"Increases the duration of your Metamorphosis by 6 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_demonform.jpg"},[A.GlyphOfQuickDecay]:{name:"Glyph of Quick Decay",description:"Your haste now reduces the time between periodic damage ticks of your Corruption spell.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_abominationexplosion.jpg"},[A.GlyphOfSearingPain]:{name:"Glyph of Searing Pain",description:"Increases the critical strike bonus of your Searing Pain by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_soulburn.jpg"},[A.GlyphOfShadowBolt]:{name:"Glyph of Shadow Bolt",description:"Reduces the mana cost of your Shadow Bolt by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_shadowbolt.jpg"},[A.GlyphOfShadowburn]:{name:"Glyph of Shadowburn",description:"Increases the critical strike chance of Shadowburn by 20% when the target is below 35% health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_scourgebuild.jpg"},[A.GlyphOfShadowflame]:{name:"Glyph of Shadowflame",description:"Your Shadowflame also applies a 70% movement speed slow on its victims.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warlock_shadowflame.jpg"},[A.GlyphOfSiphonLife]:{name:"Glyph of Siphon Life",description:"Increases the healing you receive from your Siphon Life talent by 25%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_requiem.jpg"},[A.GlyphOfSoulLink]:{name:"Glyph of Soul Link",description:"Increases the percentage of damage shared via your Soul Link by an additional 5%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_gathershadows.jpg"},[A.GlyphOfSoulstone]:{name:"Glyph of Soulstone",description:"Increases the amount of health you gain from resurrecting via a Soulstone by 300%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_soulgem.jpg"},[A.GlyphOfSuccubus]:{name:"Glyph of Succubus",description:"Your Succubus's Seduction ability also removes all damage over time effects from the target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_summonsuccubus.jpg"},[A.GlyphOfUnstableAffliction]:{name:"Glyph of Unstable Affliction",description:"Decreases the casting time of your Unstable Affliction by 0.2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_unstableaffliction_3.jpg"},[A.GlyphOfVoidwalker]:{name:"Glyph of Voidwalker",description:"Increases your Voidwalker's total Stamina by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_summonvoidwalker.jpg"}},minorGlyphs:{[D.GlyphOfCurseOfExhausion]:{name:"Glyph of Curse of Exhausion",description:"Increases the range of your Curse of Exhaustion spell by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_grimward.jpg"},[D.GlyphOfDrainSoul]:{name:"Glyph of Drain Soul",description:"Your Drain Soul ability occasionally creates an additional soul shard.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_haunting.jpg"},[D.GlyphOfSubjugateDemon]:{name:"Glyph of Subjugate Demon",description:"Reduces the cast time of your Subjugate Demon spell by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_enslavedemon.jpg"},[D.GlyphOfKilrogg]:{name:"Glyph of Kilrogg",description:"Increases the movement speed of your Eye of Kilrogg by 50% and allows it to fly in areas where flying mounts are enabled.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_evileye.jpg"},[D.GlyphOfSouls]:{name:"Glyph of Souls",description:"Reduces the mana cost of your Ritual of Souls spell by 70%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_shadesofdarkness.jpg"},[D.GlyphOfUnendingBreath]:{name:"Glyph of Unending Breath",description:"Increases the swim speed of targets affected by your Unending Breath spell by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_demonbreath.jpg"}}},Lo=go([{name:"Arms",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/161.jpg",talents:[{fieldName:"improvedHeroicStrike",location:{rowIdx:0,colIdx:0},spellIds:[12282,12663,12664],maxPoints:3},{fieldName:"deflection",location:{rowIdx:0,colIdx:1},spellIds:[16462,16463,16464,16465,16466],maxPoints:5},{fieldName:"improvedRend",location:{rowIdx:0,colIdx:2},spellIds:[12286,12658],maxPoints:2},{fieldName:"improvedCharge",location:{rowIdx:1,colIdx:0},spellIds:[12285,12697],maxPoints:2},{fieldName:"ironWill",location:{rowIdx:1,colIdx:1},spellIds:[12300,12959,12960],maxPoints:3},{fieldName:"tacticalMastery",location:{rowIdx:1,colIdx:2},spellIds:[12295,12676,12677],maxPoints:3},{fieldName:"improvedOverpower",location:{rowIdx:2,colIdx:0},spellIds:[12290,12963],maxPoints:2},{fieldName:"angerManagement",location:{rowIdx:2,colIdx:1},spellIds:[12296],maxPoints:1},{fieldName:"impale",location:{rowIdx:2,colIdx:2},spellIds:[16493,16494],maxPoints:2},{fieldName:"deepWounds",location:{rowIdx:2,colIdx:3},spellIds:[12834,12849,12867],maxPoints:3,prereqLocation:{rowIdx:2,colIdx:2}},{fieldName:"twoHandedWeaponSpecialization",location:{rowIdx:3,colIdx:1},spellIds:[12163,12711,12712],maxPoints:3},{fieldName:"tasteForBlood",location:{rowIdx:3,colIdx:2},spellIds:[56636,56637,56638],maxPoints:3},{fieldName:"poleaxeSpecialization",location:{rowIdx:4,colIdx:0},spellIds:[12700,12781,12783,12784,12785],maxPoints:5},{fieldName:"sweepingStrikes",location:{rowIdx:4,colIdx:1},spellIds:[12328],maxPoints:1},{fieldName:"maceSpecialization",location:{rowIdx:4,colIdx:2},spellIds:[12284,12701,12702,12703,12704],maxPoints:5},{fieldName:"swordSpecialization",location:{rowIdx:4,colIdx:3},spellIds:[12281,12812,12813,12814,12815],maxPoints:5},{fieldName:"weaponMastery",location:{rowIdx:5,colIdx:0},spellIds:[20504,20505],maxPoints:2},{fieldName:"improvedHamstring",location:{rowIdx:5,colIdx:2},spellIds:[12289,12668,23695],maxPoints:3},{fieldName:"trauma",location:{rowIdx:5,colIdx:3},spellIds:[46854,46855],maxPoints:2},{fieldName:"secondWind",location:{rowIdx:6,colIdx:0},spellIds:[29834,29838],maxPoints:2},{fieldName:"mortalStrike",location:{rowIdx:6,colIdx:1},spellIds:[12294],maxPoints:1,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"strengthOfArms",location:{rowIdx:6,colIdx:2},spellIds:[46865,46866],maxPoints:2},{fieldName:"improvedSlam",location:{rowIdx:6,colIdx:3},spellIds:[12862,12330],maxPoints:2},{fieldName:"juggernaut",location:{rowIdx:7,colIdx:0},spellIds:[64976],maxPoints:1},{fieldName:"improvedMortalStrike",location:{rowIdx:7,colIdx:1},spellIds:[35446,35448,35449],maxPoints:3,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"unrelentingAssault",location:{rowIdx:7,colIdx:2},spellIds:[46859,46860],maxPoints:2},{fieldName:"suddenDeath",location:{rowIdx:8,colIdx:0},spellIds:[29723,29724,29725],maxPoints:3},{fieldName:"endlessRage",location:{rowIdx:8,colIdx:1},spellIds:[29623],maxPoints:1},{fieldName:"bloodFrenzy",location:{rowIdx:8,colIdx:2},spellIds:[29836,29859],maxPoints:2},{fieldName:"wreckingCrew",location:{rowIdx:9,colIdx:1},spellIds:[46867,56611,56612,56613,56614],maxPoints:5},{fieldName:"bladestorm",location:{rowIdx:10,colIdx:1},spellIds:[46924],maxPoints:1}]},{name:"Fury",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/164.jpg",talents:[{fieldName:"armoredToTheTeeth",location:{rowIdx:0,colIdx:0},spellIds:[61216,61221,61222],maxPoints:3},{fieldName:"boomingVoice",location:{rowIdx:0,colIdx:1},spellIds:[12321,12835],maxPoints:2},{fieldName:"cruelty",location:{rowIdx:0,colIdx:2},spellIds:[12320,12852,12853,12855,12856],maxPoints:5},{fieldName:"improvedDemoralizingShout",location:{rowIdx:1,colIdx:1},spellIds:[12324,12876,12877,12878,12879],maxPoints:5},{fieldName:"unbridledWrath",location:{rowIdx:1,colIdx:2},spellIds:[12322,12999,13e3,13001,13002],maxPoints:5},{fieldName:"improvedCleave",location:{rowIdx:2,colIdx:0},spellIds:[12329,12950,20496],maxPoints:3},{fieldName:"piercingHowl",location:{rowIdx:2,colIdx:1},spellIds:[12323],maxPoints:1},{fieldName:"bloodCraze",location:{rowIdx:2,colIdx:2},spellIds:[16487,16489,16492],maxPoints:3},{fieldName:"commandingPresence",location:{rowIdx:2,colIdx:3},spellIds:[12318,12857,12858,12860,12861],maxPoints:5},{fieldName:"dualWieldSpecialization",location:{rowIdx:3,colIdx:0},spellIds:[23584,23585,23586,23587,23588],maxPoints:5},{fieldName:"improvedExecute",location:{rowIdx:3,colIdx:1},spellIds:[20502,20503],maxPoints:2},{fieldName:"enrage",location:{rowIdx:3,colIdx:2},spellIds:[12317,13045,13046,13047,13048],maxPoints:5},{fieldName:"precision",location:{rowIdx:4,colIdx:0},spellIds:[29590,29591,29592],maxPoints:3},{fieldName:"deathWish",location:{rowIdx:4,colIdx:1},spellIds:[12292],maxPoints:1},{fieldName:"improvedIntercept",location:{rowIdx:4,colIdx:2},spellIds:[29888,29889],maxPoints:2},{fieldName:"improvedBerserkerRage",location:{rowIdx:5,colIdx:0},spellIds:[20500,20501],maxPoints:2},{fieldName:"flurry",location:{rowIdx:5,colIdx:2},spellIds:[12319,12971,12972,12973,12974],maxPoints:5},{fieldName:"intensifyRage",location:{rowIdx:6,colIdx:0},spellIds:[46908,46909,56924],maxPoints:3},{fieldName:"bloodthirst",location:{rowIdx:6,colIdx:1},spellIds:[23881],maxPoints:1,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"improvedWhirlwind",location:{rowIdx:6,colIdx:3},spellIds:[29721,29776],maxPoints:2},{fieldName:"furiousAttacks",location:{rowIdx:7,colIdx:0},spellIds:[46910,46911],maxPoints:2},{fieldName:"improvedBerserkerStance",location:{rowIdx:7,colIdx:3},spellIds:[29759,29760,29761,29762,29763],maxPoints:5},{fieldName:"heroicFury",location:{rowIdx:8,colIdx:0},spellIds:[60970],maxPoints:1},{fieldName:"rampage",location:{rowIdx:8,colIdx:1},spellIds:[29801],maxPoints:1,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"bloodsurge",location:{rowIdx:8,colIdx:2},spellIds:[46913,46914,46915],maxPoints:3,prereqLocation:{rowIdx:6,colIdx:1}},{fieldName:"unendingFury",location:{rowIdx:9,colIdx:1},spellIds:[56927,56929,56930,56931,56932],maxPoints:5},{fieldName:"titansGrip",location:{rowIdx:10,colIdx:1},spellIds:[46917],maxPoints:1}]},{name:"Protection",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/163.jpg",talents:[{fieldName:"improvedBloodrage",location:{rowIdx:0,colIdx:0},spellIds:[12301,12818],maxPoints:2},{fieldName:"shieldSpecialization",location:{rowIdx:0,colIdx:1},spellIds:[12298,12724,12725,12726,12727],maxPoints:5},{fieldName:"improvedThunderClap",location:{rowIdx:0,colIdx:2},spellIds:[12287,12665,12666],maxPoints:3},{fieldName:"incite",location:{rowIdx:1,colIdx:1},spellIds:[50685,50686,50687],maxPoints:3},{fieldName:"anticipation",location:{rowIdx:1,colIdx:2},spellIds:[55129,12750,12751,12752,12753],maxPoints:5},{fieldName:"lastStand",location:{rowIdx:2,colIdx:0},spellIds:[12975],maxPoints:1},{fieldName:"improvedRevenge",location:{rowIdx:2,colIdx:1},spellIds:[12797,12799],maxPoints:2},{fieldName:"shieldMastery",location:{rowIdx:2,colIdx:2},spellIds:[29598,29599],maxPoints:2},{fieldName:"toughness",location:{rowIdx:2,colIdx:3},spellIds:[12299,12761,12762,12763,12764],maxPoints:5},{fieldName:"improvedSpellReflection",location:{rowIdx:3,colIdx:0},spellIds:[59088,59089],maxPoints:2},{fieldName:"improvedDisarm",location:{rowIdx:3,colIdx:1},spellIds:[12313,12804],maxPoints:2},{fieldName:"puncture",location:{rowIdx:3,colIdx:2},spellIds:[12308,12810,12811],maxPoints:3},{fieldName:"improvedDisciplines",location:{rowIdx:4,colIdx:0},spellIds:[12312,12803],maxPoints:2},{fieldName:"concussionBlow",location:{rowIdx:4,colIdx:1},spellIds:[12809],maxPoints:1},{fieldName:"gagOrder",location:{rowIdx:4,colIdx:2},spellIds:[12311,12958],maxPoints:2},{fieldName:"oneHandedWeaponSpecialization",location:{rowIdx:5,colIdx:2},spellIds:[16538,16539,16540,16541,16542],maxPoints:5},{fieldName:"improvedDefensiveStance",location:{rowIdx:6,colIdx:0},spellIds:[29593,29594],maxPoints:2},{fieldName:"vigilance",location:{rowIdx:6,colIdx:1},spellIds:[50720],maxPoints:1,prereqLocation:{rowIdx:4,colIdx:1}},{fieldName:"focusedRage",location:{rowIdx:6,colIdx:2},spellIds:[29787,29790,29792],maxPoints:3},{fieldName:"vitality",location:{rowIdx:7,colIdx:1},spellIds:[29140,29143,29144],maxPoints:3},{fieldName:"safeguard",location:{rowIdx:7,colIdx:2},spellIds:[46945,46949],maxPoints:2},{fieldName:"warbringer",location:{rowIdx:8,colIdx:0},spellIds:[57499],maxPoints:1},{fieldName:"devastate",location:{rowIdx:8,colIdx:1},spellIds:[20243],maxPoints:1},{fieldName:"criticalBlock",location:{rowIdx:8,colIdx:2},spellIds:[47294,47295,47296],maxPoints:3},{fieldName:"swordAndBoard",location:{rowIdx:9,colIdx:1},spellIds:[46951,46952,46953],maxPoints:3,prereqLocation:{rowIdx:8,colIdx:1}},{fieldName:"damageShield",location:{rowIdx:9,colIdx:2},spellIds:[58872,58874],maxPoints:2},{fieldName:"shockwave",location:{rowIdx:10,colIdx:1},spellIds:[46968],maxPoints:1}]}]),Go={majorGlyphs:{[U.GlyphOfBarbaricInsults]:{name:"Glyph of Barbaric Insults",description:"Your Mocking Blow ability generates 100% additional threat.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_punishingblow.jpg"},[U.GlyphOfBladestorm]:{name:"Glyph of Bladestorm",description:"Reduces the cooldown on Bladestorm by 15 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_bladestorm.jpg"},[U.GlyphOfBlocking]:{name:"Glyph of Blocking",description:"Increases your block value by 10% for 10 sec after using your Shield Slam ability.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_shield_05.jpg"},[U.GlyphOfBloodthirst]:{name:"Glyph of Bloodthirst",description:"Increases the healing you receive from your Bloodthirst ability by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_bloodlust.jpg"},[U.GlyphOfCleaving]:{name:"Glyph of Cleaving",description:"Increases the number of targets your Cleave hits by 1.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_cleave.jpg"},[U.GlyphOfDevastate]:{name:"Glyph of Devastate",description:"Your Devastate ability now applies two stacks of Sunder Armor.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_sword_11.jpg"},[U.GlyphOfEnragedRegeneration]:{name:"Glyph of Enraged Regeneration",description:"Your Enraged Regeneration ability heals for an additional 10% of your health over its duration.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_focusedrage.jpg"},[U.GlyphOfExecution]:{name:"Glyph of Execution",description:"Your Execute ability deals damage as if you had 10 additional rage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_sword_48.jpg"},[U.GlyphOfHamstring]:{name:"Glyph of Hamstring",description:"Gives your Hamstring ability a 10% chance to immobilize the target for 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_shockwave.jpg"},[U.GlyphOfHeroicStrike]:{name:"Glyph of Heroic Strike",description:"You gain 10 rage when you critically strike with your Heroic Strike ability.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_ambush.jpg"},[U.GlyphOfIntervene]:{name:"Glyph of Intervene",description:"Increases the number attacks you intercept for your Intervene target by 1.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_victoryrush.jpg"},[U.GlyphOfLastStand]:{name:"Glyph of Last Stand",description:"Reduces the cooldown of your Last Stand ability by 1 min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_ashestoashes.jpg"},[U.GlyphOfMortalStrike]:{name:"Glyph of Mortal Strike",description:"Increases the damage of your Mortal Strike ability by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_savageblow.jpg"},[U.GlyphOfOverpower]:{name:"Glyph of Overpower",description:"Adds a 100% chance to enable your Overpower when your attacks are parried.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_meleedamage.jpg"},[U.GlyphOfRapidCharge]:{name:"Glyph of Rapid Charge",description:"Reduces the cooldown of your Charge ability by 7%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_charge.jpg"},[U.GlyphOfRending]:{name:"Glyph of Rending",description:"Increases the duration of your Rend ability by 6 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_gouge.jpg"},[U.GlyphOfResonatingPower]:{name:"Glyph of Resonating Power",description:"Reduces the rage cost of your Thunder Clap ability by 5.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_thunderclap.jpg"},[U.GlyphOfRevenge]:{name:"Glyph of Revenge",description:"After using Revenge, your next Heroic Strike costs no rage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_revenge.jpg"},[U.GlyphOfShieldWall]:{name:"Glyph of Shield Wall",description:"Reduces the cooldown on Shield Wall by 2 min, but Shield Wall now only reduces damage taken by 40%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_shieldwall.jpg"},[U.GlyphOfShockwave]:{name:"Glyph of Shockwave",description:"Reduces the cooldown on Shockwave by 3 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_shockwave.jpg"},[U.GlyphOfSpellReflection]:{name:"Glyph of Spell Reflection",description:"Reduces the cooldown on Spell Reflection by 1 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_shieldreflection.jpg"},[U.GlyphOfSunderArmor]:{name:"Glyph of Sunder Armor",description:"Your Sunder Armor ability affects a second nearby target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_sunder.jpg"},[U.GlyphOfSweepingStrikes]:{name:"Glyph of Sweeping Strikes",description:"Reduces the rage cost of your Sweeping Strikes ability by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_slicedice.jpg"},[U.GlyphOfTaunt]:{name:"Glyph of Taunt",description:"Increases the chance for your Taunt ability to succeed by 8%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_reincarnation.jpg"},[U.GlyphOfVictoryRush]:{name:"Glyph of Victory Rush",description:"Your Victory Rush ability has a 30% increased critical strike chance.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_devastate.jpg"},[U.GlyphOfVigilance]:{name:"Glyph of Vigilance",description:"Your Vigilance ability transfers an additional 5% of your target's threat to you.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_vigilance.jpg"},[U.GlyphOfWhirlwind]:{name:"Glyph of Whirlwind",description:"Reduces the cooldown of your Whirlwind by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_whirlwind.jpg"}},minorGlyphs:{[O.GlyphOfBattle]:{name:"Glyph of Battle",description:"Increases the duration of your Battle Shout ability by 2 min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_battleshout.jpg"},[O.GlyphOfBloodrage]:{name:"Glyph of Bloodrage",description:"Reduces the health cost of your Bloodrage ability by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_racial_bloodrage.jpg"},[O.GlyphOfCharge]:{name:"Glyph of Charge",description:"Increases the range of your Charge ability by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_charge.jpg"},[O.GlyphOfCommand]:{name:"Glyph of Command",description:"Increases the duration of your Commanding Shout ability by 2 min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_rallyingcry.jpg"},[O.GlyphOfEnduringVictory]:{name:"Glyph of Enduring Victory",description:"Increases the window of opportunity in which you can use Victory Rush by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_devastate.jpg"},[O.GlyphOfMockingBlow]:{name:"Glyph of Mocking Blow",description:"Increases the damage of your Mocking Blow ability by 25%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_punishingblow.jpg"},[O.GlyphOfThunderClap]:{name:"Glyph of Thunder Clap",description:"Increases the radius of your Thunder Clap ability by 2 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_thunderclap.jpg"},[O.GlyphOfShatteringThrow]:{name:"Glyph of Shattering Throw",description:"Your Shattering Throw is now instant and can be used in any stance, but it no longer removes invulnerabilities and cannot be used on players or player-controlled targets.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_shatteringthrow.jpg"}}},Ao=go([{name:"Blood",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/398.jpg",talents:[{fieldName:"butchery",location:{rowIdx:0,colIdx:0},spellIds:[48979,49483],maxPoints:2},{fieldName:"subversion",location:{rowIdx:0,colIdx:1},spellIds:[48997,49490,49491],maxPoints:3},{fieldName:"bladeBarrier",location:{rowIdx:0,colIdx:2},spellIds:[49182,49500,49501,55225,55226],maxPoints:5},{fieldName:"bladedArmor",location:{rowIdx:1,colIdx:0},spellIds:[48978,49390,49391,49392,49393],maxPoints:5},{fieldName:"scentOfBlood",location:{rowIdx:1,colIdx:1},spellIds:[49004,49508,49509],maxPoints:3},{fieldName:"twoHandedWeaponSpecialization",location:{rowIdx:1,colIdx:2},spellIds:[55107,55108],maxPoints:2},{fieldName:"runeTap",location:{rowIdx:2,colIdx:0},spellIds:[48982],maxPoints:1},{fieldName:"darkConviction",location:{rowIdx:2,colIdx:1},spellIds:[48987,49477,49478,49479,49480],maxPoints:5},{fieldName:"deathRuneMastery",location:{rowIdx:2,colIdx:2},spellIds:[49467,50033,50034],maxPoints:3},{fieldName:"improvedRuneTap",location:{rowIdx:3,colIdx:0},spellIds:[48985,49488,49489],maxPoints:3,prereqLocation:{rowIdx:2,colIdx:0}},{fieldName:"spellDeflection",location:{rowIdx:3,colIdx:2},spellIds:[49145,49495,49497],maxPoints:3},{fieldName:"vendetta",location:{rowIdx:3,colIdx:3},spellIds:[49015,50154,55136],maxPoints:3},{fieldName:"bloodyStrikes",location:{rowIdx:4,colIdx:0},spellIds:[48977,49394,49395],maxPoints:3},{fieldName:"veteranOfTheThirdWar",location:{rowIdx:4,colIdx:2},spellIds:[49006,49526,50029],maxPoints:3},{fieldName:"markOfBlood",location:{rowIdx:4,colIdx:3},spellIds:[49005],maxPoints:1},{fieldName:"bloodyVengeance",location:{rowIdx:5,colIdx:1},spellIds:[48988,49503,49504],maxPoints:3,prereqLocation:{rowIdx:2,colIdx:1}},{fieldName:"abominationsMight",location:{rowIdx:5,colIdx:2},spellIds:[53137,53138],maxPoints:2},{fieldName:"bloodworms",location:{rowIdx:6,colIdx:0},spellIds:[49027,49542,49543],maxPoints:3},{fieldName:"hysteria",location:{rowIdx:6,colIdx:1},spellIds:[49016],maxPoints:1},{fieldName:"improvedBloodPresence",location:{rowIdx:6,colIdx:2},spellIds:[50365,50371],maxPoints:2},{fieldName:"improvedDeathStrike",location:{rowIdx:7,colIdx:0},spellIds:[62905,62908],maxPoints:2},{fieldName:"suddenDoom",location:{rowIdx:7,colIdx:1},spellIds:[49018,49529,49530],maxPoints:3},{fieldName:"vampiricBlood",location:{rowIdx:7,colIdx:2},spellIds:[55233],maxPoints:1},{fieldName:"willOfTheNecropolis",location:{rowIdx:8,colIdx:0},spellIds:[49189,50149,50150],maxPoints:3},{fieldName:"heartStrike",location:{rowIdx:8,colIdx:1},spellIds:[55050],maxPoints:1},{fieldName:"mightOfMograine",location:{rowIdx:8,colIdx:2},spellIds:[49023,49533,49534],maxPoints:3},{fieldName:"bloodGorged",location:{rowIdx:9,colIdx:1},spellIds:[61154,61155,61156,61157,61158],maxPoints:5},{fieldName:"dancingRuneWeapon",location:{rowIdx:10,colIdx:1},spellIds:[49028],maxPoints:1}]},{name:"Frost",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/399.jpg",talents:[{fieldName:"improvedIcyTouch",location:{rowIdx:0,colIdx:0},spellIds:[49175,50031,51456],maxPoints:3},{fieldName:"runicPowerMastery",location:{rowIdx:0,colIdx:1},spellIds:[49455,50147],maxPoints:2},{fieldName:"toughness",location:{rowIdx:0,colIdx:2},spellIds:[49042,49786,49787,49788,49789],maxPoints:5},{fieldName:"icyReach",location:{rowIdx:1,colIdx:1},spellIds:[55061,55062],maxPoints:2},{fieldName:"blackIce",location:{rowIdx:1,colIdx:2},spellIds:[49140,49661,49662,49663,49664],maxPoints:5},{fieldName:"nervesOfColdSteel",location:{rowIdx:1,colIdx:3},spellIds:[49226,50137,50138],maxPoints:3},{fieldName:"icyTalons",location:{rowIdx:2,colIdx:0},spellIds:[50880,50884,50885,50886,50887],maxPoints:5,prereqLocation:{rowIdx:0,colIdx:0}},{fieldName:"lichborne",location:{rowIdx:2,colIdx:1},spellIds:[49039],maxPoints:1},{fieldName:"annihilation",location:{rowIdx:2,colIdx:2},spellIds:[51468,51472,51473],maxPoints:3},{fieldName:"killingMachine",location:{rowIdx:3,colIdx:1},spellIds:[51123,51127,51128,51129,51130],maxPoints:5},{fieldName:"chillOfTheGrave",location:{rowIdx:3,colIdx:2},spellIds:[49149,50115],maxPoints:2},{fieldName:"endlessWinter",location:{rowIdx:3,colIdx:3},spellIds:[49137,49657],maxPoints:2},{fieldName:"frigidDreadplate",location:{rowIdx:4,colIdx:1},spellIds:[49186,51108,51109],maxPoints:3},{fieldName:"glacierRot",location:{rowIdx:4,colIdx:2},spellIds:[49471,49790,49791],maxPoints:3},{fieldName:"deathchill",location:{rowIdx:4,colIdx:3},spellIds:[49796],maxPoints:1},{fieldName:"improvedIcyTalons",location:{rowIdx:5,colIdx:0},spellIds:[55610],maxPoints:1,prereqLocation:{rowIdx:2,colIdx:0}},{fieldName:"mercilessCombat",location:{rowIdx:5,colIdx:1},spellIds:[49024,49538],maxPoints:2},{fieldName:"rime",location:{rowIdx:5,colIdx:2},spellIds:[49188,56822,59057],maxPoints:3},{fieldName:"chilblains",location:{rowIdx:6,colIdx:0},spellIds:[50040,50041,50043],maxPoints:3},{fieldName:"hungeringCold",location:{rowIdx:6,colIdx:1},spellIds:[49203],maxPoints:1},{fieldName:"improvedFrostPresence",location:{rowIdx:6,colIdx:2},spellIds:[50384,50385],maxPoints:2},{fieldName:"threatOfThassarian",location:{rowIdx:7,colIdx:0},spellIds:[65661,66191,66192],maxPoints:3},{fieldName:"bloodOfTheNorth",location:{rowIdx:7,colIdx:1},spellIds:[54639,54638,54637],maxPoints:3},{fieldName:"unbreakableArmor",location:{rowIdx:7,colIdx:2},spellIds:[51271],maxPoints:1},{fieldName:"acclimation",location:{rowIdx:8,colIdx:0},spellIds:[49200,50151,50152],maxPoints:3},{fieldName:"frostStrike",location:{rowIdx:8,colIdx:1},spellIds:[49143],maxPoints:1},{fieldName:"guileOfGorefiend",location:{rowIdx:8,colIdx:2},spellIds:[50187,50190,50191],maxPoints:3},{fieldName:"tundraStalker",location:{rowIdx:9,colIdx:1},spellIds:[49202,50127,50128,50129,50130],maxPoints:5},{fieldName:"howlingBlast",location:{rowIdx:10,colIdx:1},spellIds:[49184],maxPoints:1}]},{name:"Unholy",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/400.jpg",talents:[{fieldName:"viciousStrikes",location:{rowIdx:0,colIdx:0},spellIds:[51745,51746],maxPoints:2},{fieldName:"virulence",location:{rowIdx:0,colIdx:1},spellIds:[48962,49567,49568],maxPoints:3},{fieldName:"anticipation",location:{rowIdx:0,colIdx:2},spellIds:[55129,55130,55131,55132,55133],maxPoints:5},{fieldName:"epidemic",location:{rowIdx:1,colIdx:0},spellIds:[49036,49562],maxPoints:2},{fieldName:"morbidity",location:{rowIdx:1,colIdx:1},spellIds:[48963,49564,49565],maxPoints:3},{fieldName:"unholyCommand",location:{rowIdx:1,colIdx:2},spellIds:[49588,49589],maxPoints:2},{fieldName:"ravenousDead",location:{rowIdx:1,colIdx:3},spellIds:[48965,49571,49572],maxPoints:3},{fieldName:"outbreak",location:{rowIdx:2,colIdx:0},spellIds:[49013,55236,55237],maxPoints:3},{fieldName:"necrosis",location:{rowIdx:2,colIdx:1},spellIds:[51459,51462,51463,51464,51465],maxPoints:5},{fieldName:"corpseExplosion",location:{rowIdx:2,colIdx:2},spellIds:[49158],maxPoints:1},{fieldName:"onAPaleHorse",location:{rowIdx:3,colIdx:1},spellIds:[49146,51267],maxPoints:2},{fieldName:"bloodCakedBlade",location:{rowIdx:3,colIdx:2},spellIds:[49219,49627,49628],maxPoints:3},{fieldName:"nightOfTheDead",location:{rowIdx:3,colIdx:3},spellIds:[55620,55623],maxPoints:2},{fieldName:"unholyBlight",location:{rowIdx:4,colIdx:0},spellIds:[49194],maxPoints:1},{fieldName:"impurity",location:{rowIdx:4,colIdx:1},spellIds:[49220,49633,49635,49636,49638],maxPoints:5},{fieldName:"dirge",location:{rowIdx:4,colIdx:2},spellIds:[49223,49599],maxPoints:2},{fieldName:"desecration",location:{rowIdx:5,colIdx:0},spellIds:[55666,55667],maxPoints:2},{fieldName:"magicSuppression",location:{rowIdx:5,colIdx:1},spellIds:[49224,49610,49611],maxPoints:3},{fieldName:"reaping",location:{rowIdx:5,colIdx:2},spellIds:[49208,56834,56835],maxPoints:3},{fieldName:"masterOfGhouls",location:{rowIdx:5,colIdx:3},spellIds:[52143],maxPoints:1,prereqLocation:{rowIdx:3,colIdx:3}},{fieldName:"desolation",location:{rowIdx:6,colIdx:0},spellIds:[66799,66814,66815,66816,66817],maxPoints:5},{fieldName:"antiMagicZone",location:{rowIdx:6,colIdx:1},spellIds:[51052],maxPoints:1,prereqLocation:{rowIdx:5,colIdx:1}},{fieldName:"improvedUnholyPresence",location:{rowIdx:6,colIdx:2},spellIds:[50391,50392],maxPoints:2},{fieldName:"ghoulFrenzy",location:{rowIdx:6,colIdx:3},spellIds:[63560],maxPoints:1,prereqLocation:{rowIdx:5,colIdx:3}},{fieldName:"cryptFever",location:{rowIdx:7,colIdx:1},spellIds:[49032,49631,49632],maxPoints:3},{fieldName:"boneShield",location:{rowIdx:7,colIdx:2},spellIds:[49222],maxPoints:1},{fieldName:"wanderingPlague",location:{rowIdx:8,colIdx:0},spellIds:[49217,49654,49655],maxPoints:3},{fieldName:"ebonPlaguebringer",location:{rowIdx:8,colIdx:1},spellIds:[51099,51160,51161],maxPoints:3,prereqLocation:{rowIdx:7,colIdx:1}},{fieldName:"scourgeStrike",location:{rowIdx:8,colIdx:2},spellIds:[55090],maxPoints:1},{fieldName:"rageOfRivendare",location:{rowIdx:9,colIdx:1},spellIds:[50117,50118,50119,50120,50121],maxPoints:5},{fieldName:"summonGargoyle",location:{rowIdx:10,colIdx:1},spellIds:[49206],maxPoints:1}]}]),Do={majorGlyphs:{[M.GlyphOfAntiMagicShell]:{name:"Glyph of Anti-Magic Shell",description:"Increases the duration of your Anti-Magic Shell by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_antimagicshell.jpg"},[M.GlyphOfBloodStrike]:{name:"Glyph of Blood Strike",description:"Your Blood Strike causes an additional 20% damage to snared targets.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_deathstrike.jpg"},[M.GlyphOfBoneShield]:{name:"Glyph of Bone Shield",description:"Adds 1 additional charge to your Bone Shield.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_chest_leather_13.jpg"},[M.GlyphOfChainsOfIce]:{name:"Glyph of Chains of Ice",description:"Your Chains of Ice also causes 144 to 156 Frost damage, increased by your attack power.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_chainsofice.jpg"},[M.GlyphOfDancingRuneWeapon]:{name:"Glyph of Dancing Rune Weapon",description:"Increases the duration of Dancing Rune Weapon by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_sword_07.jpg"},[M.GlyphOfDarkCommand]:{name:"Glyph of Dark Command",description:"Increases the chance for your Dark Command ability to work successfully by 8%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_shamanrage.jpg"},[M.GlyphOfDarkDeath]:{name:"Glyph of Dark Death",description:"Increases the damage or healing done by Death Coil by 15%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_deathcoil.jpg"},[M.GlyphOfDeathAndDecay]:{name:"Glyph of Death and Decay",description:"Damage of your Death and Decay spell increased by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_deathanddecay.jpg"},[M.GlyphOfDeathGrip]:{name:"Glyph of Death Grip",description:"When you deal a killing blow that grants honor or experience, the cooldown of your Death Grip is refreshed.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_strangulate.jpg"},[M.GlyphOfDeathStrike]:{name:"Glyph of Death Strike",description:"Increases your Death Strike's damage by 1% for every 1 runic power you currently have (up to a maximum of 25%). The runic power is not consumed by this effect.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_butcher2.jpg"},[M.GlyphOfDisease]:{name:"Glyph of Disease",description:"Your Pestilence ability now refreshes disease durations and secondary effects of diseases on your primary target back to their maximum duration.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_plaguecloud.jpg"},[M.GlyphOfFrostStrike]:{name:"Glyph of Frost Strike",description:"Reduces the cost of your Frost Strike by 8 Runic Power.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_empowerruneblade2.jpg"},[M.GlyphOfHeartStrike]:{name:"Glyph of Heart Strike",description:"Your Heart Strike also reduces the movement speed of your target by 50% for 10 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_weapon_shortblade_40.jpg"},[M.GlyphOfHowlingBlast]:{name:"Glyph of Howling Blast",description:"Your Howling Blast ability now infects your targets with Frost Fever.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_arcticwinds.jpg"},[M.GlyphOfHungeringCold]:{name:"Glyph of Hungering Cold",description:"Reduces the cost of Hungering Cold by 40 runic power.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_staff_15.jpg"},[M.GlyphOfIceboundFortitude]:{name:"Glyph of Icebound Fortitude",description:"Your Icebound Fortitude now always grants at least 40% damage reduction, regardless of your defense skill.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_iceboundfortitude.jpg"},[M.GlyphOfIcyTouch]:{name:"Glyph of Icy Touch",description:"Your Frost Fever disease deals 20% additional damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_icetouch.jpg"},[M.GlyphOfObliterate]:{name:"Glyph of Obliterate",description:"Increases the damage of your Obliterate ability by 25%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_classicon.jpg"},[M.GlyphOfPlagueStrike]:{name:"Glyph of Plague Strike",description:"Your Plague Strike does 20% additional damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_empowerruneblade.jpg"},[M.GlyphOfRuneStrike]:{name:"Glyph of Rune Strike",description:"Increases the critical strike chance of your Rune Strike by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_darkconviction.jpg"},[M.GlyphOfRuneTap]:{name:"Glyph of Rune Tap",description:"Your Rune Tap now heals you for an additional 1% of your maximum health, and also heals your party for 10% of their maximum health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_runetap.jpg"},[M.GlyphOfScourgeStrike]:{name:"Glyph of Scourge Strike",description:"Your Scourge Strike increases the duration of your diseases on the target by 3 sec, up to a maximum of 9 additional seconds.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_scourgestrike.jpg"},[M.GlyphOfStrangulate]:{name:"Glyph of Strangulate",description:"Reduces the cooldown of your Strangulate by 20 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_soulleech_3.jpg"},[M.GlyphOfTheGhoul]:{name:"Glyph of the Ghoul",description:"Your Ghoul receives an additional 40% of your Strength and 40% of your Stamina.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_animatedead.jpg"},[M.GlyphOfUnbreakableArmor]:{name:"Glyph of Unbreakable Armor",description:"Increases the total armor granted by Unbreakable Armor to 30%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_armor_helm_plate_naxxramas_raidwarrior_c_01.jpg"},[M.GlyphOfUnholyBlight]:{name:"Glyph of Unholy Blight",description:"Increases the damage done by Unholy Blight by 40%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_contagion.jpg"},[M.GlyphOfVampiricBlood]:{name:"Glyph of Vampiric Blood",description:"Increases the duration of your Vampiric Blood by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_lifedrain.jpg"}},minorGlyphs:{[W.GlyphOfBloodTap]:{name:"Glyph of Blood Tap",description:"Your Blood Tap no longer causes damage to you.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_bloodtap.jpg"},[W.GlyphOfCorpseExplosion]:{name:"Glyph of Corpse Explosion",description:"Increases the radius of effect on Corpse Explosion by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_creature_disease_02.jpg"},[W.GlyphOfDeathSEmbrace]:{name:"Glyph of Death's Embrace",description:"Your Death Coil refunds 20 runic power when used to heal.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_deathcoil.jpg"},[W.GlyphOfHornOfWinter]:{name:"Glyph of Horn of Winter",description:"Increases the duration of your Horn of Winter ability by 1 min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_horn_02.jpg"},[W.GlyphOfPestilence]:{name:"Glyph of Pestilence",description:"Increases the radius of your Pestilence effect by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_plaguecloud.jpg"},[W.GlyphOfRaiseDead]:{name:"Glyph of Raise Dead",description:"Your Raise Dead spell no longer requires a reagent.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_animatedead.jpg"}}},Uo={[d.ClassUnknown]:[],[d.ClassDeathknight]:Ao,[d.ClassDruid]:fo,[d.ClassShaman]:_o,[d.ClassHunter]:Io,[d.ClassMage]:yo,[d.ClassRogue]:ko,[d.ClassPaladin]:vo,[d.ClassPriest]:Eo,[d.ClassWarlock]:To,[d.ClassWarrior]:Lo},Oo={[d.ClassUnknown]:{majorGlyphs:[],minorGlyphs:[]},[d.ClassDeathknight]:Do,[d.ClassDruid]:wo,[d.ClassShaman]:No,[d.ClassHunter]:xo,[d.ClassMage]:bo,[d.ClassRogue]:Co,[d.ClassPaladin]:So,[d.ClassPriest]:Po,[d.ClassWarlock]:Ro,[d.ClassWarrior]:Go};function Mo(e,t,i){return t.split("-").forEach(((t,a)=>{const s=i[a];[...t].forEach(((t,i)=>{const a=s.talents[i],o=parseInt(t);a.fieldName&&(1==a.maxPoints?e[a.fieldName]=1==o:e[a.fieldName]=o)}))})),e}function Wo(e,t){return t.map((t=>t.talents.map((t=>String(Number(e[t.fieldName])))).join("").replace(/0+$/g,""))).join("-").replace(/-+$/g,"")}class Vo{constructor(){t(this,"name"),t(this,"auras"),t(this,"spells"),this.name="",this.auras=[],this.spells=[]}getName(){return this.name}getAuras(){return this.auras.slice()}getSpells(){return this.spells.slice()}async update(e){let t=e.spells.map((e=>({data:e,id:x.fromProto(e.id)}))),i=e.auras.map((e=>({data:e,id:x.fromProto(e.id)})));await Promise.all([...t,...i].map((e=>e.id.fill().then((t=>e.id=t))))),t=t.sort(((e,t)=>Ne(e.id.name,t.id.name))),i=i.sort(((e,t)=>Ne(e.id.name,t.id.name)));let a=!1;return e.name!=this.name&&(this.name=e.name,a=!0),(t.length!=this.spells.length||t.some(((e,t)=>!e.id.equals(this.spells[t].id))))&&(this.spells=t,a=!0),(i.length!=this.auras.length||i.some(((e,t)=>!e.id.equals(this.auras[t].id))))&&(this.auras=i,a=!0),a}}class Fo{constructor(){t(this,"metadatas"),this.metadatas=[]}async update(e){const t=this.metadatas.length;if(e.length>t)for(let a=t;a<e.length;a++)this.metadatas.push(new Vo);else e.length<t&&(this.metadatas=this.metadatas.slice(0,e.length));const i=await Promise.all(e.map(((e,t)=>this.metadatas[t].update(e))));return t!=this.metadatas.length||i.some((e=>e))}asList(){return this.metadatas.slice()}}const zo={};function jo(e){const t=zo[e];if(!t)throw new Error("No config registered for Spec: "+e);return t}const Ho=class{constructor(e,i){t(this,"sim"),t(this,"party"),t(this,"raid"),t(this,"spec"),t(this,"name",""),t(this,"buffs",z.create()),t(this,"consumes",j.create()),t(this,"bonusStats",new H),t(this,"gear",new B({})),t(this,"enableItemSwap",!1),t(this,"itemSwapGear",new q({})),t(this,"race"),t(this,"level",80),t(this,"profession1",0),t(this,"profession2",0),t(this,"aplRotation",$.create()),t(this,"talentsString",""),t(this,"glyphs",K.create()),t(this,"specOptions"),t(this,"reactionTime",0),t(this,"channelClipDelay",0),t(this,"inFrontOfTarget",!1),t(this,"distanceFromTarget",0),t(this,"nibelungAverageCasts",11),t(this,"nibelungAverageCastsSet",!1),t(this,"healingModel",Y.create()),t(this,"healingEnabled",!1),t(this,"autoRotationGenerator",null),t(this,"simpleRotationGenerator",null),t(this,"itemEPCache",new Array),t(this,"gemEPCache",new Map),t(this,"enchantEPCache",new Map),t(this,"talents",null),t(this,"specTypeFunctions"),t(this,"epRatios",new Array(Ho.numEpRatios).fill(0)),t(this,"epWeights",new H),t(this,"currentStats",J.create()),t(this,"metadata",new Vo),t(this,"petMetadatas",new Fo),t(this,"nameChangeEmitter",new l("PlayerName")),t(this,"buffsChangeEmitter",new l("PlayerBuffs")),t(this,"consumesChangeEmitter",new l("PlayerConsumes")),t(this,"bonusStatsChangeEmitter",new l("PlayerBonusStats")),t(this,"gearChangeEmitter",new l("PlayerGear")),t(this,"itemSwapChangeEmitter",new l("PlayerItemSwap")),t(this,"professionChangeEmitter",new l("PlayerProfession")),t(this,"raceChangeEmitter",new l("PlayerRace")),t(this,"levelChangeEmitter",new l("PlayerLevel")),t(this,"rotationChangeEmitter",new l("PlayerRotation")),t(this,"talentsChangeEmitter",new l("PlayerTalents")),t(this,"glyphsChangeEmitter",new l("PlayerGlyphs")),t(this,"specOptionsChangeEmitter",new l("PlayerSpecOptions")),t(this,"inFrontOfTargetChangeEmitter",new l("PlayerInFrontOfTarget")),t(this,"distanceFromTargetChangeEmitter",new l("PlayerDistanceFromTarget")),t(this,"healingModelChangeEmitter",new l("PlayerHealingModel")),t(this,"epWeightsChangeEmitter",new l("PlayerEpWeights")),t(this,"miscOptionsChangeEmitter",new l("PlayerMiscOptions")),t(this,"currentStatsEmitter",new l("PlayerCurrentStats")),t(this,"epRatiosChangeEmitter",new l("PlayerEpRatios")),t(this,"epRefStatChangeEmitter",new l("PlayerEpRefStat")),t(this,"changeEmitter"),this.sim=i,this.party=null,this.raid=null,this.spec=e,this.race=Z[this.spec][0],this.specTypeFunctions=V[this.spec],this.specOptions=this.specTypeFunctions.optionsCreate();const a=zo[this.spec];if(!a)throw new Error("Could not find spec config for spec: "+this.spec);this.autoRotationGenerator=a.autoRotation,a.simpleRotation?this.simpleRotationGenerator=a.simpleRotation:this.simpleRotationGenerator=null;for(let t=0;t<Q.ItemSlotRanged+1;++t)this.itemEPCache[t]=new Map;this.changeEmitter=l.onAny([this.nameChangeEmitter,this.buffsChangeEmitter,this.consumesChangeEmitter,this.bonusStatsChangeEmitter,this.gearChangeEmitter,this.itemSwapChangeEmitter,this.professionChangeEmitter,this.raceChangeEmitter,this.levelChangeEmitter,this.rotationChangeEmitter,this.talentsChangeEmitter,this.glyphsChangeEmitter,this.specOptionsChangeEmitter,this.miscOptionsChangeEmitter,this.inFrontOfTargetChangeEmitter,this.distanceFromTargetChangeEmitter,this.healingModelChangeEmitter,this.epWeightsChangeEmitter,this.epRatiosChangeEmitter,this.epRefStatChangeEmitter],"PlayerChange")}getSpecIcon(){return X(this.spec,this.getTalentsString())}getClass(){return F[this.spec]}getClassColor(){return ee[this.getClass()]}isSpec(e){return this.spec==e}isClass(e){return this.getClass()==e}getParty(){return this.party}getRaid(){return this.raid}getPartyIndex(){if(null==this.party)throw new Error("Can't get party index for player without a party!");return this.party.getPlayers().indexOf(this)}getRaidIndex(){if(null==this.party)throw new Error("Can't get raid index for player without a party!");return 5*this.party.getIndex()+this.getPartyIndex()}setParty(e){null==e?(this.party=null,this.raid=null):(this.party=e,this.raid=e.raid)}getOtherPartyMembers(){return null==this.party?[]:this.party.getPlayers().filter((e=>null!=e&&e!=this))}getItems(e){return this.sim.db.getItems(e).filter((t=>te(t,this.spec,e)))}getEnchants(e){return this.sim.db.getEnchants(e).filter((e=>ie(e,this.spec)))}getGems(e){return this.sim.db.getGems(e)}getEpWeights(){return this.epWeights}setEpWeights(e,t){this.epWeights=t,this.epWeightsChangeEmitter.emit(e),this.gemEPCache=new Map,this.enchantEPCache=new Map;for(let i=0;i<Q.ItemSlotRanged+1;++i)this.itemEPCache[i]=new Map}getDefaultEpRatios(e,t){const i=new Array(Ho.numEpRatios).fill(0);return t?i[1]=1:e?(i[2]=1,i[3]=1):i[0]=1,i}getEpRatios(){return this.epRatios.slice()}setEpRatios(e,t){this.epRatios=t,this.epRatiosChangeEmitter.emit(e)}async computeStatWeights(e,t,i,a,s){return await this.sim.statWeights(this,t,i,a,s)}getCurrentStats(){return J.clone(this.currentStats)}setCurrentStats(e,t){this.currentStats=t,this.currentStatsEmitter.emit(e)}getMetadata(){return this.metadata}getPetMetadatas(){return this.petMetadatas}async updateMetadata(){const e=this.metadata.update(this.currentStats.metadata),t=this.petMetadatas.update(this.currentStats.pets.map((e=>e.metadata))),i=await e,a=await t;return i||a}getName(){return this.name}setName(e,t){t!=this.name&&(this.name=t,this.nameChangeEmitter.emit(e))}getLabel(){return this.party?`${this.name} (#${this.getRaidIndex()+1})`:this.name}getRace(){return this.race}setRace(e,t){t!=this.race&&(this.race=t,this.raceChangeEmitter.emit(e))}getLevel(){return this.level}setLevel(e,t){const i=this.getMinLevel();(t=Math.min(Math.max(t,i),this.getMaxLevel()))!=this.level&&(this.sim.encounter.targets.forEach((e=>{e.level=e.level-this.level+t})),this.level=t,this.levelChangeEmitter.emit(l.nextEventID()))}getMinLevel(){return this.isClass(d.ClassDeathknight)?55:1}getMaxLevel(){return this.sim.getMaxLevel()}getExpansion(){return this.sim.getExpansion()}setExpansion(e,t){const i=this.sim.setExpansion(e,t);this.level>i&&this.setLevel(e,i)}getProfession1(){return this.profession1}setProfession1(e,t){t!=this.profession1&&(this.profession1=t,this.professionChangeEmitter.emit(e))}getProfession2(){return this.profession2}setProfession2(e,t){t!=this.profession2&&(this.profession2=t,this.professionChangeEmitter.emit(e))}getProfessions(){return[this.profession1,this.profession2].filter((e=>e!=ae.ProfessionUnknown))}setProfessions(e,t){l.freezeAllAndDo((()=>{this.setProfession1(e,t[0]||ae.ProfessionUnknown),this.setProfession2(e,t[1]||ae.ProfessionUnknown)}))}hasProfession(e){return this.getProfessions().includes(e)}isBlacksmithing(){return this.hasProfession(ae.Blacksmithing)}canUseExtraSockets(){return this.getExpansion()==se.ExpansionWotlk&&this.getLevel()>=70}getFaction(){return oe[this.getRace()]}getBuffs(){return z.clone(this.buffs)}setBuffs(e,t){z.equals(this.buffs,t)||(this.buffs=z.clone(t),this.buffsChangeEmitter.emit(e))}getConsumes(){return j.clone(this.consumes)}setConsumes(e,t){j.equals(this.consumes,t)||(this.consumes=j.clone(t),this.consumesChangeEmitter.emit(e))}canDualWield2H(){return this.getClass()==d.ClassWarrior&&this.getTalents().titansGrip}equipItem(e,t,i){this.setGear(e,this.gear.withEquippedItem(t,i,this.canDualWield2H()))}getEquippedItem(e){return this.gear.getEquippedItem(e)}hasTrinketEquipped(e){return this.getEquippedItem(Q.ItemSlotTrinket1)?.id==e||this.getEquippedItem(Q.ItemSlotTrinket2)?.id==e}getGear(){return this.gear}setGear(e,t){t.equals(this.gear)||(this.gear=t,this.gearChangeEmitter.emit(e))}getEnableItemSwap(){return this.enableItemSwap}setEnableItemSwap(e,t){t!=this.enableItemSwap&&(this.enableItemSwap=t,this.itemSwapChangeEmitter.emit(e))}equipItemSwapitem(e,t,i){this.setItemSwapGear(e,this.itemSwapGear.withEquippedItem(t,i,this.canDualWield2H()))}getItemSwapItem(e){return this.itemSwapGear.getEquippedItem(e)}getItemSwapGear(){return this.itemSwapGear}setItemSwapGear(e,t){t.equals(this.itemSwapGear)||(this.itemSwapGear=t,this.itemSwapChangeEmitter.emit(e))}getBonusStats(){return this.bonusStats}setBonusStats(e,t){t.equals(this.bonusStats)||(this.bonusStats=t,this.bonusStatsChangeEmitter.emit(e))}getMeleeCritCapInfo(){const e=(this.currentStats.finalStats?.stats[le.StatMeleeCrit]||0)/Zs(this.getLevel()),t=(this.currentStats.finalStats?.stats[le.StatMeleeHit]||0)/Xs(this.getLevel()),i=(this.currentStats.finalStats?.stats[le.StatExpertise]||0)/$s(this.getLevel())/4,a=void 0!==this.getGear().getEquippedItem(Q.ItemSlotOffHand)?.item.weaponSpeed,s=a&&this.spec!=ne.SpecWarrior?27:8,o=this.getInFrontOfTarget()?14:0,l=6.5+o,n=Math.max(s-t,0),r=Math.max(6.5-i,0)+Math.max(o-i,0);let d=0;if(this.spec===ne.SpecEnhancementShaman){d=3*this.getTalents().elementalDevastation}let c=0;const m=this.sim.raid.getDebuffs();(m.totemOfWrath||m.heartOfTheCrusader||m.masterPoisoner)&&(c=3);const h=80.8-n-r-d;return{meleeCrit:e,meleeHit:t,expertise:i,suppression:4.8,glancing:24,debuffCrit:c,hasOffhandWeapon:a,meleeHitCap:s,expertiseCap:l,remainingMeleeHitCap:n,remainingExpertiseCap:r,baseCritCap:h,specSpecificOffset:d,playerCritCapDelta:e-h+c}}getMeleeCritCap(){return this.getMeleeCritCapInfo().playerCritCapDelta}setAplRotation(e,t){$.equals(t,this.aplRotation)||(this.aplRotation=$.clone(t),this.rotationChangeEmitter.emit(e))}getSimpleRotation(){const e=this.aplRotation.simple?.specRotationJson||"";if(!e)return this.specTypeFunctions.rotationCreate();try{const t=JSON.parse(e);return this.specTypeFunctions.rotationFromJson(t)}catch(t){return console.warn(`Error parsing rotation spec options: ${t}\n\nSpec options: '${e}'`),this.specTypeFunctions.rotationCreate()}}setSimpleRotation(e,t){this.specTypeFunctions.rotationEquals(t,this.getSimpleRotation())||(this.aplRotation.simple||(this.aplRotation.simple=re.create()),this.aplRotation.simple.specRotationJson=JSON.stringify(this.specTypeFunctions.rotationToJson(t)),this.rotationChangeEmitter.emit(e))}getSimpleCooldowns(){return de.clone(this.aplRotation.simple?.cooldowns||de.create())}setSimpleCooldowns(e,t){de.equals(this.getSimpleCooldowns(),t)||(this.aplRotation.simple||(this.aplRotation.simple=re.create()),this.aplRotation.simple.cooldowns=t,this.rotationChangeEmitter.emit(e))}getRotationType(){return this.aplRotation.type==ce.TypeUnknown?ce.TypeAPL:this.aplRotation.type}hasSimpleRotationGenerator(){return null!=this.simpleRotationGenerator}getResolvedAplRotation(){const e=this.getRotationType();if(e==ce.TypeAuto&&this.autoRotationGenerator){const e=$.clone(this.autoRotationGenerator(this));return e.type=ce.TypeAuto,e}if(e==ce.TypeSimple&&this.simpleRotationGenerator){const e=this.getSimpleRotation(),t=$.clone(this.simpleRotationGenerator(this,e,this.getSimpleCooldowns()));return t.simple=this.aplRotation.simple,t.type=ce.TypeSimple,t}return this.aplRotation}getTalents(){var e,t;return null==this.talents&&(this.talents=(e=this.spec,t=this.talentsString,Mo(V[e].talentsCreate(),t,Uo[F[e]]))),this.talents}getMaxTalentPoints(){return Math.max(0,this.getLevel()-9)}getMaxPetTalentPoints(){if(this.spec!=ne.SpecHunter)return 0;let e=Math.floor(this.getLevel()/4);return this.getTalents().beastMastery||(e-=4),Math.max(0,e)}getTalentsString(){return this.talentsString}setTalentsString(e,t){t!=this.talentsString&&(this.talentsString=t,this.talents=null,this.talentsChangeEmitter.emit(e))}getTalentTree(){return me(this.getTalentsString())}getTalentTreePoints(){return he(this.getTalentsString())}getTalentTreeIcon(){return X(this.spec,this.getTalentsString())}getGlyphs(){return K.clone(this.glyphs)}setGlyphs(e,t){K.equals(this.glyphs,t)||(this.glyphs=K.clone(t),this.glyphsChangeEmitter.emit(e))}getMajorGlyphs(){return[this.glyphs.major1,this.glyphs.major2,this.glyphs.major3].filter((e=>0!=e))}getMinorGlyphs(){return[this.glyphs.minor1,this.glyphs.minor2,this.glyphs.minor3].filter((e=>0!=e))}getAllGlyphs(){return this.getMajorGlyphs().concat(this.getMinorGlyphs())}getSpecOptions(){return this.specTypeFunctions.optionsCopy(this.specOptions)}setSpecOptions(e,t){this.specTypeFunctions.optionsEquals(t,this.specOptions)||(this.specOptions=this.specTypeFunctions.optionsCopy(t),this.specOptionsChangeEmitter.emit(e))}getReactionTime(){return this.reactionTime}setReactionTime(e,t){t!=this.reactionTime&&(this.reactionTime=t,this.miscOptionsChangeEmitter.emit(e))}getChannelClipDelay(){return this.channelClipDelay}setChannelClipDelay(e,t){t!=this.channelClipDelay&&(this.channelClipDelay=t,this.miscOptionsChangeEmitter.emit(e))}getInFrontOfTarget(){return this.inFrontOfTarget}setInFrontOfTarget(e,t){t!=this.inFrontOfTarget&&(this.inFrontOfTarget=t,this.inFrontOfTargetChangeEmitter.emit(e))}getDistanceFromTarget(){return this.distanceFromTarget}setDistanceFromTarget(e,t){t!=this.distanceFromTarget&&(this.distanceFromTarget=t,this.distanceFromTargetChangeEmitter.emit(e))}getNibelungAverageCasts(){return this.nibelungAverageCasts}setNibelungAverageCastsSet(e,t){t!=this.nibelungAverageCastsSet&&(this.nibelungAverageCastsSet=t)}setNibelungAverageCasts(e,t){t!=this.nibelungAverageCasts&&(this.nibelungAverageCasts=Math.min(t,16),this.miscOptionsChangeEmitter.emit(e))}setDefaultHealingParams(e){const t=this.sim.encounter.primaryTarget,i=t.dualWield;0==e.cadenceSeconds&&(e.cadenceSeconds=1.5*t.swingSpeed,i&&(e.cadenceSeconds/=2)),0==e.hps&&(e.hps=.175*t.minBaseDamage/t.swingSpeed,i&&(e.hps*=1.5))}enableHealing(){this.healingEnabled=!0;const e=this.getHealingModel();0!=e.cadenceSeconds&&0!=e.hps||(this.setDefaultHealingParams(e),this.setHealingModel(0,e))}getHealingModel(){return Y.clone(this.healingModel)}setHealingModel(e,t){Y.equals(this.healingModel,t)||(this.healingModel=Y.clone(t),this.healingEnabled&&this.setDefaultHealingParams(this.healingModel),this.healingModelChangeEmitter.emit(e))}computeStatsEP(e){return null==e?0:e.computeEP(this.epWeights)}computeGemEP(e){if(this.gemEPCache.has(e.id))return this.gemEPCache.get(e.id);const t=this.computeStatsEP(new H(e.stats)),i=pe(this.spec,e,H.fromProto(this.currentStats.finalStats));let a=0;e.unique&&(a-=.01);const s=t+i+a;return this.gemEPCache.set(e.id,s),s}computeEnchantEP(e){if(this.enchantEPCache.has(e.effectId))return this.enchantEPCache.get(e.effectId);const t=this.computeStatsEP(new H(e.stats));return this.enchantEPCache.set(e.effectId,t),t}computeItemEP(e,t){if(null==e)return 0;const i=this.itemEPCache[t].get(e.id);if(void 0!==i)return i;let a=new H(e.stats);if(e.weaponSpeed>0){const i=ue(e);t==Q.ItemSlotMainHand?a=a.withPseudoStat(ge.PseudoStatMainHandDps,i):t==Q.ItemSlotOffHand?a=a.withPseudoStat(ge.PseudoStatOffHandDps,i):t==Q.ItemSlotRanged&&(a=a.withPseudoStat(ge.PseudoStatRangedDps,i))}let s=a.computeEP(this.epWeights);e.unique&&(s-=.01);const o=g(e.gemSockets.map((e=>{const t=this.sim.db.getGems(e).filter((e=>fe(e,this.sim.getExpansion())));return t.length>0?Math.max(...t.map((e=>this.computeGemEP(e)))):0}))),l=g(e.gemSockets.map((e=>{const t=this.sim.db.getGems(e).filter((t=>fe(t,this.sim.getExpansion())&&we(t,e)));return t.length>0?Math.max(...t.map((e=>this.computeGemEP(e)))):0})))+this.computeStatsEP(new H(e.socketBonus));return s+=Math.max(l,o),this.itemEPCache[t].set(e.id,s),s}setWowheadData(e,t){const i=[],a=Bs?Bs+".":"";i.push(`domain=${a}wotlk`);const s=this.hasProfession(ae.Blacksmithing),o=this.canUseExtraSockets();e.gems.length>0&&i.push("gems="+e.curGems(s,o).map((e=>e?e.id:0)).join(":")),null!=e.enchant&&i.push("ench="+e.enchant.effectId),i.push("pcs="+this.gear.asArray().filter((e=>null!=e)).map((e=>e.item.id)).join(":")),e.hasExtraSocket(s,o)&&i.push("sock"),t.dataset.wowhead=i.join("&"),t.dataset.whtticon="false"}filterItemData(e,t,i){const a=this.sim.getFilters(),s=(e,i)=>e.filter((e=>i(t(e))));a.factionRestriction!=be.UNSPECIFIED&&(e=s(e,(e=>e.factionRestriction==a.factionRestriction||e.factionRestriction==be.UNSPECIFIED))),a.sources.includes(Ie.SourceCrafting)||(e=s(e,(e=>!e.sources.some((e=>"crafted"==e.source.oneofKind))))),a.sources.includes(Ie.SourceQuest)||(e=s(e,(e=>!e.sources.some((e=>"quest"==e.source.oneofKind))))),a.minIlvl>0&&(e=s(e,(e=>a.minIlvl<=e.ilvl))),a.maxIlvl>0&&(e=s(e,(e=>a.maxIlvl>=e.ilvl))),a.itemQualities.length>0&&(e=s(e,(e=>a.itemQualities.includes(e.quality))));for(const[o,l]of Object.entries(Ho.DIFFICULTY_SRCS)){const t=parseInt(o);if(!a.sources.includes(t)&&(e=s(e,(e=>!e.sources.some((e=>"drop"==e.source.oneofKind&&e.source.drop.difficulty==l)))),l==xe.DifficultyRaid10H||l==xe.DifficultyRaid25H)){const t=Ho.HEROIC_TO_NORMAL[l];e=s(e,(e=>!e.sources.some((e=>"drop"==e.source.oneofKind&&e.source.drop.difficulty==t&&e.source.drop.category==Te))))}}for(const[o,l]of Object.entries(Ho.RAID_IDS)){const t=parseInt(o);a.raids.includes(t)||(e=s(e,(e=>!e.sources.some((e=>"drop"==e.source.oneofKind&&e.source.drop.zoneId==l)))))}return Ho.ARMOR_SLOTS.includes(i)?e=s(e,(e=>!!a.armorTypes.includes(e.armorType))):Ho.WEAPON_SLOTS.includes(i)?e=s(e,(e=>{if(!a.weaponTypes.includes(e.weaponType))return!1;if(!a.oneHandedWeapons&&e.handType!=Re.HandTypeTwoHand)return!1;if(!a.twoHandedWeapons&&e.handType==Re.HandTypeTwoHand)return!1;const t=i==Q.ItemSlotMainHand?a.minMhWeaponSpeed:a.minOhWeaponSpeed,s=i==Q.ItemSlotMainHand?a.maxMhWeaponSpeed:a.maxOhWeaponSpeed;return!(t>0&&e.weaponSpeed<t)&&!(s>0&&e.weaponSpeed>s)})):i==Q.ItemSlotRanged&&(e=s(e,(e=>{if(!a.rangedWeaponTypes.includes(e.rangedWeaponType))return!1;const t=a.minRangedWeaponSpeed,i=a.maxRangedWeaponSpeed;return!(t>0&&e.weaponSpeed<t)&&!(i>0&&e.weaponSpeed>i)}))),e}filterEnchantData(e,t,i,a){return a?e.filter((e=>{const i=t(e);return!(this.getLevel()<i.level)&&!!ve(i,a.item)})):e}filterGemData(e,t,i,a){const s=this.sim.getFilters(),o=this.hasProfession(ae.Jewelcrafting);return e.filter((e=>{const i=t(e);return!(!o&&i.requiredProfession==ae.Jewelcrafting)&&(!(s.matchingGemsOnly&&!we(i,a))&&!(s.itemQualities.length>0&&!s.itemQualities.includes(i.quality)))}))}makeUnitReference(){return null==this.party?Se():Ee(this.getRaidIndex())}toDatabase(){const e=this.getGear().toDatabase(),t=this.getItemSwapGear().toDatabase();return Pe.mergeSimDatabases(e,t)}toProto(e,t,i){const a=e=>!i||0==i.length||i.includes(e),s=this.getGear(),o=t?this.getResolvedAplRotation():this.aplRotation;let l=r.create({class:this.getClass(),database:e?void 0:this.toDatabase()});return a(Qo.Gear)&&r.mergePartial(l,{equipment:s.asSpec(),bonusStats:this.getBonusStats().toProto(),enableItemSwap:this.getEnableItemSwap(),itemSwap:this.getItemSwapGear().toProto()}),a(Qo.Talents)&&r.mergePartial(l,{talentsString:this.getTalentsString(),glyphs:this.getGlyphs()}),a(Qo.Rotation)&&r.mergePartial(l,{cooldowns:de.create({hpPercentForDefensives:this.getSimpleCooldowns().hpPercentForDefensives}),rotation:o}),a(Qo.Consumes)&&r.mergePartial(l,{consumes:this.getConsumes()}),a(Qo.Miscellaneous)&&(r.mergePartial(l,{name:this.getName(),race:this.getRace(),expansion:this.getExpansion(),level:this.getLevel(),profession1:this.getProfession1(),profession2:this.getProfession2(),reactionTimeMs:this.getReactionTime(),channelClipDelayMs:this.getChannelClipDelay(),inFrontOfTarget:this.getInFrontOfTarget(),distanceFromTarget:this.getDistanceFromTarget(),healingModel:this.getHealingModel(),nibelungAverageCasts:this.getNibelungAverageCasts(),nibelungAverageCastsSet:this.nibelungAverageCastsSet}),l=ke(this.spec,l,this.getSpecOptions())),a(Qo.External)&&r.mergePartial(l,{buffs:this.getBuffs()}),l}fromProto(e,t,i){const a=e=>!i||0==i.length||i.includes(e);t.rotation?.type==ce.TypeLegacy&&(t.rotation.type=ce.TypeAuto),l.freezeAllAndDo((()=>{a(Qo.Gear)&&(this.setGear(e,t.equipment?this.sim.db.lookupEquipmentSpec(t.equipment):new B({})),this.setEnableItemSwap(e,t.enableItemSwap),this.setItemSwapGear(e,t.itemSwap?this.sim.db.lookupItemSwap(t.itemSwap):new q({})),this.setBonusStats(e,H.fromProto(t.bonusStats||Ce.create()))),a(Qo.Talents)&&(this.setTalentsString(e,t.talentsString),this.setGlyphs(e,t.glyphs||K.create())),a(Qo.Rotation)&&(t.rotation?.type!=ce.TypeUnknown&&t.rotation?.type!=ce.TypeLegacy||(t.rotation||(t.rotation=$.create()),t.rotation.type=ce.TypeAuto),this.setAplRotation(e,t.rotation||$.create())),a(Qo.Consumes)&&this.setConsumes(e,t.consumes||j.create()),a(Qo.Miscellaneous)&&(this.setSpecOptions(e,this.specTypeFunctions.optionsFromPlayer(t)),this.setName(e,t.name),this.setRace(e,t.race),this.setProfession1(e,t.profession1),this.setProfession2(e,t.profession2),this.setExpansion(e,t.expansion),this.setLevel(e,t.level),this.setReactionTime(e,t.reactionTimeMs),this.setChannelClipDelay(e,t.channelClipDelayMs),this.setInFrontOfTarget(e,t.inFrontOfTarget),this.setDistanceFromTarget(e,t.distanceFromTarget),this.setNibelungAverageCastsSet(e,t.nibelungAverageCastsSet),this.nibelungAverageCastsSet&&this.setNibelungAverageCasts(e,t.nibelungAverageCasts),this.setHealingModel(e,t.healingModel||Y.create())),a(Qo.External)&&this.setBuffs(e,t.buffs||z.create())}))}clone(e){const t=new Ho(this.spec,this.sim);return t.fromProto(e,this.toProto()),t}applySharedDefaults(e){l.freezeAllAndDo((()=>{this.setEnableItemSwap(e,!1),this.setItemSwapGear(e,new q({})),this.setReactionTime(e,200),this.setInFrontOfTarget(e,_e(this.spec)),this.setHealingModel(e,Y.create({burstWindow:_e(this.spec)?6:0})),this.setSimpleCooldowns(e,de.create({hpPercentForDefensives:_e(this.spec)?.35:0})),this.setBonusStats(e,new H),this.setAplRotation(e,$.create({type:ce.TypeAuto}))}))}};let Bo=Ho;t(Bo,"numEpRatios",6),t(Bo,"ARMOR_SLOTS",[Q.ItemSlotHead,Q.ItemSlotShoulder,Q.ItemSlotChest,Q.ItemSlotWrist,Q.ItemSlotHands,Q.ItemSlotLegs,Q.ItemSlotWaist,Q.ItemSlotFeet]),t(Bo,"WEAPON_SLOTS",[Q.ItemSlotMainHand,Q.ItemSlotOffHand]),t(Bo,"DIFFICULTY_SRCS",{[Ie.SourceDungeon]:xe.DifficultyNormal,[Ie.SourceDungeonH]:xe.DifficultyHeroic,[Ie.SourceRaid10]:xe.DifficultyRaid10,[Ie.SourceRaid10H]:xe.DifficultyRaid10H,[Ie.SourceRaid25]:xe.DifficultyRaid25,[Ie.SourceRaid25H]:xe.DifficultyRaid25H}),t(Bo,"HEROIC_TO_NORMAL",{[xe.DifficultyHeroic]:xe.DifficultyNormal,[xe.DifficultyRaid10H]:xe.DifficultyRaid10,[xe.DifficultyRaid25H]:xe.DifficultyRaid25}),t(Bo,"RAID_IDS",{[ye.RaidNaxxramas]:3456,[ye.RaidEyeOfEternity]:4500,[ye.RaidObsidianSanctum]:4493,[ye.RaidVaultOfArchavon]:4603,[ye.RaidUlduar]:4273,[ye.RaidTrialOfTheCrusader]:4722,[ye.RaidOnyxiasLair]:2159,[ye.RaidIcecrownCitadel]:4812,[ye.RaidRubySanctum]:4987});class qo{constructor(e){t(this,"sim"),t(this,"duration",180),t(this,"durationVariation",5),t(this,"executeProportion20",.2),t(this,"executeProportion25",.25),t(this,"executeProportion35",.35),t(this,"useHealth",!1),t(this,"targets"),t(this,"targetsMetadata"),t(this,"targetsChangeEmitter",new l),t(this,"durationChangeEmitter",new l),t(this,"executeProportionChangeEmitter",new l),t(this,"changeEmitter",new l),this.sim=e,this.targets=[qo.defaultTargetProto()],this.targetsMetadata=new Fo,[this.targetsChangeEmitter,this.durationChangeEmitter,this.executeProportionChangeEmitter].forEach((e=>e.on((e=>this.changeEmitter.emit(e)))))}get primaryTarget(){return Le.clone(this.targets[0])}getDurationVariation(){return this.durationVariation}setDurationVariation(e,t){t!=this.durationVariation&&(this.durationVariation=t,this.durationChangeEmitter.emit(e))}getDuration(){return this.duration}setDuration(e,t){t!=this.duration&&(this.duration=t,this.durationChangeEmitter.emit(e))}getExecuteProportion20(){return this.executeProportion20}setExecuteProportion20(e,t){t!=this.executeProportion20&&(this.executeProportion20=t,this.executeProportionChangeEmitter.emit(e))}getExecuteProportion25(){return this.executeProportion25}setExecuteProportion25(e,t){t!=this.executeProportion25&&(this.executeProportion25=t,this.executeProportionChangeEmitter.emit(e))}getExecuteProportion35(){return this.executeProportion35}setExecuteProportion35(e,t){t!=this.executeProportion35&&(this.executeProportion35=t,this.executeProportionChangeEmitter.emit(e))}getUseHealth(){return this.useHealth}setUseHealth(e,t){t!=this.useHealth&&(this.useHealth=t,this.durationChangeEmitter.emit(e),this.executeProportionChangeEmitter.emit(e))}matchesPreset(e){return e.targets.length==this.targets.length&&this.targets.every(((t,i)=>Le.equals(t,e.targets[i].target)))}applyPreset(e,t){this.targets=t.targets.map((e=>e.target||Le.create())),this.targetsChangeEmitter.emit(e)}applyPresetTarget(e,t,i){this.targets[i]=t.target||Le.create(),this.targetsChangeEmitter.emit(e)}toProto(){return Ge.create({duration:this.duration,durationVariation:this.durationVariation,executeProportion20:this.executeProportion20,executeProportion25:this.executeProportion25,executeProportion35:this.executeProportion35,useHealth:this.useHealth,targets:this.targets})}fromProto(e,t){l.freezeAllAndDo((()=>{this.setDuration(e,t.duration),this.setDurationVariation(e,t.durationVariation),this.setExecuteProportion20(e,t.executeProportion20),this.setExecuteProportion25(e,t.executeProportion25),this.setExecuteProportion35(e,t.executeProportion35),this.setUseHealth(e,t.useHealth),this.targets=t.targets,this.targetsChangeEmitter.emit(e)}))}applyDefaults(e){this.fromProto(e,Ge.create({duration:180,durationVariation:5,executeProportion20:.2,executeProportion25:.25,executeProportion35:.35,targets:[qo.defaultTargetProto()]}))}static defaultTargetProto(){return Le.create({level:83,mobType:Ae.MobTypeGiant,tankIndex:0,swingSpeed:1.5,minBaseDamage:65e3,dualWield:!1,dualWieldPenalty:!1,suppressDodge:!1,parryHaste:!0,spellSchool:De.SpellSchoolPhysical,stats:H.fromMap({[le.StatArmor]:10643,[le.StatAttackPower]:805,[le.StatBlockValue]:76}).asArray(),targetInputs:new Array(0)})}}const $o=8;class Ko{constructor(e){t(this,"buffs",Ue.create()),t(this,"debuffs",Oe.create()),t(this,"tanks",[]),t(this,"targetDummies",0),t(this,"numActiveParties",5),t(this,"compChangeEmitter",new l),t(this,"buffsChangeEmitter",new l),t(this,"debuffsChangeEmitter",new l),t(this,"tanksChangeEmitter",new l),t(this,"targetDummiesChangeEmitter",new l),t(this,"numActivePartiesChangeEmitter",new l),t(this,"changeEmitter"),t(this,"parties"),t(this,"activePlayers"),t(this,"sim"),this.sim=e,this.parties=[...Array(8).keys()].map((t=>{const i=new ro(this,e);return i.compChangeEmitter.on((e=>this.compChangeEmitter.emit(e))),i.changeEmitter.on((e=>this.changeEmitter.emit(e))),i})),this.activePlayers=[],this.numActivePartiesChangeEmitter.on((e=>this.compChangeEmitter.emit(e))),this.changeEmitter=l.onAny([this.compChangeEmitter,this.buffsChangeEmitter,this.debuffsChangeEmitter,this.tanksChangeEmitter,this.targetDummiesChangeEmitter],"RaidChange"),this.changeEmitter.on((()=>{this.activePlayers=[]}))}size(){return g(this.parties.map((e=>e.size())))}isEmpty(){return 0==this.size()}getParties(){return this.parties.slice()}getParty(e){return this.parties[e]}getPlayers(){return this.parties.map((e=>e.getPlayers())).flat()}getPlayer(e){if(-1===e)return null;return this.parties[Math.floor(e/5)].getPlayer(e%5)}getPlayerFromUnitReference(e,t){return e&&e.type!=Me.Unknown?e.type==Me.Player?this.getPlayer(e.index):e.type==Me.Self&&t||null:null}setPlayer(e,t,i){this.parties[Math.floor(t/5)].setPlayer(e,t%5,i)}getClassCount(e){return this.getPlayers().filter((t=>null!=t&&t.getClass()==e)).length}getBuffs(){return Ue.clone(this.buffs)}setBuffs(e,t){if(!Ue.equals(this.buffs,t)){if(this.buffs=Ue.clone(t),this.debuffs.totemOfWrath!=this.buffs.totemOfWrath){var i=Oe.clone(this.debuffs);i.totemOfWrath=this.buffs.totemOfWrath,this.setDebuffs(e,i)}this.buffsChangeEmitter.emit(e)}}getDebuffs(){return Oe.clone(this.debuffs)}setDebuffs(e,t){if(!Oe.equals(this.debuffs,t)){if(this.debuffs=Oe.clone(t),this.debuffs.totemOfWrath!=this.buffs.totemOfWrath){var i=Ue.clone(this.buffs);i.totemOfWrath=this.debuffs.totemOfWrath,this.setBuffs(e,i)}this.debuffsChangeEmitter.emit(e)}}getTanks(){return this.tanks.map((e=>We.clone(e)))}setTanks(e,t){this.tanks.length==t.length&&this.tanks.every(((e,i)=>We.equals(e,t[i])))||(this.tanks=t.map((e=>We.clone(e))),this.tanksChangeEmitter.emit(e))}getTargetDummies(){return this.targetDummies}setTargetDummies(e,t){this.targetDummies!=t&&(this.targetDummies=t,this.targetDummiesChangeEmitter.emit(e))}getNumActiveParties(){return this.numActiveParties}setNumActiveParties(e,t){t!=this.numActiveParties&&t>0&&(this.numActiveParties=t,this.numActivePartiesChangeEmitter.emit(e))}getActivePlayers(){if(0==this.activePlayers.length){const e=this.getParties().filter(((e,t)=>t<this.numActiveParties));this.activePlayers=e.map((e=>e.getPlayers())).flat().filter((e=>null!=e))}return this.activePlayers}toProto(e,t){return Ve.create({parties:this.parties.map((i=>i.toProto(e,t))),buffs:this.getBuffs(),debuffs:this.getDebuffs(),tanks:this.getTanks(),targetDummies:this.getTargetDummies(),numActiveParties:this.getNumActiveParties()})}fromProto(e,t){l.freezeAllAndDo((()=>{this.setBuffs(e,t.buffs||Ue.create()),this.setDebuffs(e,t.debuffs||Oe.create()),this.setTanks(e,t.tanks),this.setTargetDummies(e,t.targetDummies),this.setNumActiveParties(e,t.numActiveParties||5);for(let i=0;i<8;i++)t.parties[i]?this.parties[i].fromProto(e,t.parties[i]):this.parties[i].clear(e)}))}clear(e){l.freezeAllAndDo((()=>{for(let t=0;t<8;t++)this.parties[t].clear(e)}))}}const Yo=`/${Je}/sim_worker.js`;class Jo{constructor(e){t(this,"workers"),this.workers=[];for(let t=0;t<e;t++)this.workers.push(new Zo)}getLeastBusyWorker(){return this.workers.reduce(((e,t)=>e.numTasksRunning<t.numTasksRunning?e:t))}async makeApiCall(e,t){return await this.getLeastBusyWorker().doApiCall(e,t,"")}async computeStats(e){const t=await this.makeApiCall("computeStats",Fe.toBinary(e));return ze.fromBinary(t)}async statWeightsAsync(e,t){console.log("Stat weights request: "+je.toJsonString(e));const i=this.getLeastBusyWorker(),a=i.makeTaskId();i.addPromiseFunc(a+"progress",this.newProgressHandler(a,i,t),(e=>{}));const s=await i.doApiCall("statWeightsAsync",je.toBinary(e),a),o=He.fromBinary(s);return console.log("Stat weights result: "+Be.toJsonString(o.finalWeightResult)),o.finalWeightResult}async bulkSimAsync(e,t){console.log("bulk sim request: "+qe.toJsonString(e,{enumAsInteger:!0}));const i=this.getLeastBusyWorker(),a=i.makeTaskId();i.addPromiseFunc(a+"progress",this.newProgressHandler(a,i,t),(e=>{}));const s=await i.doApiCall("bulkSimAsync",qe.toBinary(e),a),o=He.fromBinary(s),l=$e.toJson(o.finalBulkResult);return console.log("bulk sim result: "+JSON.stringify(l)),o.finalBulkResult}async raidSimAsync(e,t){console.log("Raid sim request: "+Ke.toJsonString(e));const i=this.getLeastBusyWorker(),a=i.makeTaskId();i.addPromiseFunc(a+"progress",this.newProgressHandler(a,i,t),(e=>{}));const s=await i.doApiCall("raidSimAsync",Ke.toBinary(e),a),o=He.fromBinary(s),l=Ye.toJson(o.finalRaidResult);return delete l.logs,console.log("Raid sim result: "+JSON.stringify(l)),o.finalRaidResult}newProgressHandler(e,t,i){return a=>{var s=He.fromBinary(a);i(s),null==s.finalRaidResult&&null==s.finalWeightResult&&t.addPromiseFunc(e+"progress",this.newProgressHandler(e,t,i),(e=>{}))}}}class Zo{constructor(){t(this,"numTasksRunning"),t(this,"taskIdsToPromiseFuncs"),t(this,"worker"),t(this,"onReady"),this.numTasksRunning=0,this.taskIdsToPromiseFuncs={},this.worker=new window.Worker(Yo);let e=null;this.onReady=new Promise(((t,i)=>{e=t})),this.worker.onmessage=t=>{if("ready"==t.data.msg)this.worker.postMessage({msg:"setID",id:"1"}),e();else if("idconfirm"==t.data.msg);else{const e=t.data.id;if(!this.taskIdsToPromiseFuncs[e])return void console.warn("Unrecognized result id: "+e);const i=this.taskIdsToPromiseFuncs[e];delete this.taskIdsToPromiseFuncs[e],this.numTasksRunning--,i[0](t.data.outputData)}}}addPromiseFunc(e,t,i){this.taskIdsToPromiseFuncs[e]=[t,i]}makeTaskId(){let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let i=0;i<16;i++)e+=t.charAt(Math.floor(62*Math.random()));return e}async doApiCall(e,t,i){this.numTasksRunning++,await this.onReady;const a=new Promise(((a,s)=>{i||(i=this.makeTaskId()),this.taskIdsToPromiseFuncs[i]=[a,s],this.worker.postMessage({msg:e,id:i,inputData:t})}));return await a}}var Qo=(e=>(e[e.Gear=0]="Gear",e[e.Talents=1]="Talents",e[e.Rotation=2]="Rotation",e[e.Consumes=3]="Consumes",e[e.Miscellaneous=4]="Miscellaneous",e[e.External=5]="External",e[e.Encounter=6]="Encounter",e[e.UISettings=7]="UISettings",e))(Qo||{});const Xo=class{constructor(){t(this,"workerPool"),t(this,"iterations",3e3),t(this,"expansion",se.ExpansionWotlk),t(this,"faction",Ze.Alliance),t(this,"fixedRngSeed",0),t(this,"filters",Xo.defaultFilters()),t(this,"showDamageMetrics",!0),t(this,"showThreatMetrics",!1),t(this,"showHealingMetrics",!1),t(this,"showExperimental",!1),t(this,"showEPValues",!1),t(this,"language",""),t(this,"raid"),t(this,"encounter"),t(this,"db_",null),t(this,"iterationsChangeEmitter",new l),t(this,"expansionChangeEmitter",new l),t(this,"factionChangeEmitter",new l),t(this,"fixedRngSeedChangeEmitter",new l),t(this,"lastUsedRngSeedChangeEmitter",new l),t(this,"filtersChangeEmitter",new l),t(this,"showDamageMetricsChangeEmitter",new l),t(this,"showThreatMetricsChangeEmitter",new l),t(this,"showHealingMetricsChangeEmitter",new l),t(this,"showExperimentalChangeEmitter",new l),t(this,"showEPValuesChangeEmitter",new l),t(this,"languageChangeEmitter",new l),t(this,"crashEmitter",new l),t(this,"settingsChangeEmitter"),t(this,"unitMetadataEmitter",new l("UnitMetadata")),t(this,"changeEmitter"),t(this,"simResultEmitter",new l),t(this,"bulkSimStartEmitter",new l),t(this,"bulkSimResultEmitter",new l),t(this,"_initPromise"),t(this,"lastUsedRngSeed",0),t(this,"modifyRaidProto",(()=>{})),this.workerPool=new Jo(1),this._initPromise=Pe.get().then((e=>{this.db_=e})),this.raid=new Ko(this),this.encounter=new qo(this),this.settingsChangeEmitter=l.onAny([this.iterationsChangeEmitter,this.expansionChangeEmitter,this.fixedRngSeedChangeEmitter,this.filtersChangeEmitter,this.showDamageMetricsChangeEmitter,this.showThreatMetricsChangeEmitter,this.showHealingMetricsChangeEmitter,this.showExperimentalChangeEmitter,this.showEPValuesChangeEmitter,this.languageChangeEmitter]),this.changeEmitter=l.onAny([this.settingsChangeEmitter,this.raid.changeEmitter,this.encounter.changeEmitter]),l.onAny([this.raid.changeEmitter,this.encounter.changeEmitter,this.expansionChangeEmitter]).on((e=>this.updateCharacterStats(e)))}waitForInit(){return this._initPromise}get db(){return this.db_}setModifyRaidProto(e){this.modifyRaidProto=e}getModifiedRaidProto(){const e=this.raid.toProto(!1,!0);return this.modifyRaidProto(e),e.parties.forEach((e=>{e.players.forEach((e=>{if(!e.equipment)return;let t=this.db.lookupEquipmentSpec(e.equipment),i=!1;const a=[e.profession1,e.profession2].includes(ae.Blacksmithing),s=e.level>=70&&this.expansion==se.ExpansionWotlk;t.hasInactiveMetaGem(a,s)&&(t=t.withoutMetaGem(),i=!0),a&&s||(t=t.withoutSockets(a,s),i=!0),i&&(e.equipment=t.asSpec())}))})),e}makeRaidSimRequest(e){const t=this.getModifiedRaidProto(),i=this.encounter.toProto();return Ke.create({raid:t,encounter:i,simOptions:Qe.create({iterations:e?1:this.getIterations(),randomSeed:BigInt(this.nextRngSeed()),debugFirstIteration:!0})})}async runBulkSim(e,t,i){if(this.raid.isEmpty())throw new Error("Raid is empty! Try adding some players first.");if(this.encounter.targets.length<1)throw new Error("Encounter has no targets! Try adding some targets first.");await this.waitForInit();const a=qe.create({baseSettings:this.makeRaidSimRequest(!1),bulkSettings:e});if(null!=a.baseSettings&&null!=a.baseSettings.simOptions&&(a.baseSettings.simOptions.debugFirstIteration=!1),!a.baseSettings?.raid||0==a.baseSettings?.raid?.parties.length||0==a.baseSettings?.raid?.parties[0].players.length)throw new Error("Raid must contain exactly 1 player for bulk sim.");const s=a.baseSettings.raid.parties[0].players[0].database;s?.items.push(...t.items),s?.enchants.push(...t.enchants),s?.gems.push(...t.gems),this.bulkSimStartEmitter.emit(l.nextEventID(),a);const o=await this.workerPool.bulkSimAsync(a,i);if(""!=o.errorResult)throw new tl(o.errorResult);return this.bulkSimResultEmitter.emit(l.nextEventID(),o),o}async runRaidSim(e,t){if(this.raid.isEmpty())throw new Error("Raid is empty! Try adding some players first.");if(this.encounter.targets.length<1)throw new Error("Encounter has no targets! Try adding some targets first.");await this.waitForInit();const i=this.makeRaidSimRequest(!1),a=await this.workerPool.raidSimAsync(i,t);if(""!=a.errorResult)throw new tl(a.errorResult);const s=await Xe.makeNew(i,a);return this.simResultEmitter.emit(e,s),s}async runRaidSimWithLogs(e){if(this.raid.isEmpty())throw new Error("Raid is empty! Try adding some players first.");if(this.encounter.targets.length<1)throw new Error("Encounter has no targets! Try adding some targets first.");await this.waitForInit();const t=this.makeRaidSimRequest(!0),i=await this.workerPool.raidSimAsync(t,(()=>{}));if(""!=i.errorResult)throw new tl(i.errorResult);const a=await Xe.makeNew(t,i);return this.simResultEmitter.emit(e,a),a}async updateCharacterStats(e){if(0==e)return;e=l.nextEventID(),await this.waitForInit();const t=this.raid.getPlayers(),i=Fe.create({raid:this.getModifiedRaidProto(),encounter:this.encounter.toProto()}),a=await this.workerPool.computeStats(i);""==a.errorResult?l.freezeAllAndDo((async()=>{const i=a.raidStats.parties.map(((i,a)=>i.players.map(((i,s)=>{const o=t[5*a+s];return o?(o.setCurrentStats(e,i),o.updateMetadata()):null})))).flat().filter((e=>null!=e)),s=this.encounter.targetsMetadata.update(a.encounterStats.targets.map((e=>e.metadata)));(await Promise.all(i.concat([s]))).some((e=>e))&&this.unitMetadataEmitter.emit(e)})):this.crashEmitter.emit(e,new tl(a.errorResult))}async statWeights(e,t,i,a,s){if(this.raid.isEmpty())throw new Error("Raid is empty! Try adding some players first.");if(this.encounter.targets.length<1)throw new Error("Encounter has no targets! Try adding some targets first.");if(await this.waitForInit(),null==e.getParty())return console.warn("Trying to get stat weights without a party!"),Be.create();{const o=this.raid.getTanks().map((e=>e.index)).includes(e.getRaidIndex())?[We.create({type:Me.Player,index:0})]:[],l=je.create({player:e.toProto(!1,!0),raidBuffs:this.raid.getBuffs(),partyBuffs:e.getParty().getBuffs(),debuffs:this.raid.getDebuffs(),encounter:this.encounter.toProto(),simOptions:Qe.create({iterations:this.getIterations(),randomSeed:BigInt(this.nextRngSeed()),debug:!1}),tanks:o,statsToWeigh:t,pseudoStatsToWeigh:i,epReferenceStat:a});return await this.workerPool.statWeightsAsync(l,s)}}getUnitMetadata(e,t,i){if(!e||e.type==Me.Unknown)return this.getUnitMetadata(i,t,i);if(e.type==Me.Player)return this.raid.getPlayerFromUnitReference(e)?.getMetadata();if(e.type==Me.Target)return this.encounter.targetsMetadata.asList()[e.index];if(e.type==Me.Pet){const i=this.raid.getPlayerFromUnitReference(e.owner,t);return i?i.getPetMetadatas().asList()[e.index]:void 0}return e.type==Me.Self?t?.getMetadata():e.type==Me.CurrentTarget?this.encounter.targetsMetadata.asList()[0]:void 0}getExpansion(){return this.expansion}setExpansion(e,t){if(t!=this.expansion){const i=this.getFilters();i.maxExpansion=t,this.setFilters(e,i),this.expansion=t,this.expansionChangeEmitter.emit(e)}return this.getMaxLevel()}getMaxLevel(){switch(this.expansion){case se.ExpansionWotlk:return 80;case se.ExpansionTbc:return 70;case se.ExpansionVanilla:return 60;default:return 80}}getFaction(){return this.faction}setFaction(e,t){t!=this.faction&&t&&(this.faction=t,this.factionChangeEmitter.emit(e))}getFixedRngSeed(){return this.fixedRngSeed}setFixedRngSeed(e,t){t!=this.fixedRngSeed&&(this.fixedRngSeed=t,this.fixedRngSeedChangeEmitter.emit(e))}nextRngSeed(){let e=0;return e=this.fixedRngSeed?this.fixedRngSeed:Math.floor(Math.random()*Xo.MAX_RNG_SEED),this.lastUsedRngSeed=e,this.lastUsedRngSeedChangeEmitter.emit(l.nextEventID()),e}getLastUsedRngSeed(){return this.lastUsedRngSeed}getFilters(){return et.clone(this.filters)}setFilters(e,t){et.equals(t,this.filters)||(this.filters=et.clone(t),this.filtersChangeEmitter.emit(e))}getShowDamageMetrics(){return this.showDamageMetrics}setShowDamageMetrics(e,t){t!=this.showDamageMetrics&&(this.showDamageMetrics=t,this.showDamageMetricsChangeEmitter.emit(e))}getShowThreatMetrics(){return this.showThreatMetrics}setShowThreatMetrics(e,t){t!=this.showThreatMetrics&&(this.showThreatMetrics=t,this.showThreatMetricsChangeEmitter.emit(e))}getShowHealingMetrics(){return this.showHealingMetrics}setShowHealingMetrics(e,t){t!=this.showHealingMetrics&&(this.showHealingMetrics=t,this.showHealingMetricsChangeEmitter.emit(e))}getShowExperimental(){return this.showExperimental}setShowExperimental(e,t){t!=this.showExperimental&&(this.showExperimental=t,this.showExperimentalChangeEmitter.emit(e))}getShowEPValues(){return this.showEPValues}setShowEPValues(e,t){t!=this.showEPValues&&(this.showEPValues=t,this.showEPValuesChangeEmitter.emit(e))}getLanguage(){return this.language}setLanguage(e,t){var i;(t=t||function(){const e=(navigator.language||"").substring(0,2);return Object.keys(Hs).includes(e)?e:""}())!=this.language&&(this.language=t,i=this.language,Bs="en"==i?"":i,this.languageChangeEmitter.emit(e))}getIterations(){return this.iterations}setIterations(e,t){t!=this.iterations&&(this.iterations=t,this.iterationsChangeEmitter.emit(e))}toProto(){const e=this.getFilters();return e.armorTypes.length==Xo.ALL_ARMOR_TYPES.length&&(e.armorTypes=[]),e.weaponTypes.length==Xo.ALL_WEAPON_TYPES.length&&(e.weaponTypes=[]),e.rangedWeaponTypes.length==Xo.ALL_RANGED_WEAPON_TYPES.length&&(e.rangedWeaponTypes=[]),e.sources.length==Xo.ALL_SOURCES.length&&(e.sources=[]),e.raids.length==Xo.ALL_RAIDS.length&&(e.raids=[]),e.itemQualities.length==Xo.MOST_USED_QUALITIES.length&&(e.itemQualities=[]),it.create({iterations:this.getIterations(),expansion:this.getExpansion(),fixedRngSeed:BigInt(this.getFixedRngSeed()),showDamageMetrics:this.getShowDamageMetrics(),showThreatMetrics:this.getShowThreatMetrics(),showHealingMetrics:this.getShowHealingMetrics(),showExperimental:this.getShowExperimental(),showEpValues:this.getShowEPValues(),language:this.getLanguage(),faction:this.getFaction(),filters:e})}fromProto(e,t){l.freezeAllAndDo((()=>{this.setIterations(e,t.iterations||3e3),this.setExpansion(e,t.expansion||se.ExpansionWotlk),this.setFixedRngSeed(e,Number(t.fixedRngSeed)),this.setShowDamageMetrics(e,t.showDamageMetrics),this.setShowThreatMetrics(e,t.showThreatMetrics),this.setShowHealingMetrics(e,t.showHealingMetrics),this.setShowExperimental(e,t.showExperimental),this.setShowEPValues(e,t.showEpValues),this.setLanguage(e,t.language),this.setFaction(e,t.faction||Ze.Alliance);const i=t.filters||Xo.defaultFilters();0==i.armorTypes.length&&(i.armorTypes=Xo.ALL_ARMOR_TYPES.slice()),0==i.weaponTypes.length&&(i.weaponTypes=Xo.ALL_WEAPON_TYPES.slice()),0==i.rangedWeaponTypes.length&&(i.rangedWeaponTypes=Xo.ALL_RANGED_WEAPON_TYPES.slice()),0==i.sources.length&&(i.sources=Xo.ALL_SOURCES.slice()),0==i.raids.length&&(i.raids=Xo.ALL_RAIDS.slice()),0==i.itemQualities.length&&(i.itemQualities=Xo.MOST_USED_QUALITIES.slice()),this.setFilters(e,i)}))}applyDefaults(e,t,i){this.fromProto(e,it.create({iterations:3e3,faction:Ze.Alliance,expansion:se.ExpansionWotlk,showDamageMetrics:!i,showThreatMetrics:t,showHealingMetrics:i,language:this.getLanguage(),filters:Xo.defaultFilters(),showEpValues:!1}))}static defaultFilters(){return et.create({oneHandedWeapons:!0,twoHandedWeapons:!0,maxExpansion:se.ExpansionWotlk})}};let el=Xo;t(el,"MAX_RNG_SEED",Math.pow(2,32)-1),t(el,"ALL_ARMOR_TYPES",tt(at).filter((e=>0!=e))),t(el,"ALL_WEAPON_TYPES",tt(st).filter((e=>0!=e))),t(el,"ALL_RANGED_WEAPON_TYPES",tt(ot).filter((e=>0!=e))),t(el,"ALL_SOURCES",tt(Ie).filter((e=>0!=e))),t(el,"ALL_RAIDS",tt(ye).filter((e=>0!=e))),t(el,"MOST_USED_QUALITIES",tt(lt).filter((e=>e>1&&e<6)));class tl extends Error{constructor(e){super(e),t(this,"errorStr"),this.errorStr=e}}class il extends u{constructor(e,i,a){super(e,"number-picker-root",i,a),t(this,"inputElem"),t(this,"float"),t(this,"positive"),t(this,"max"),t(this,"min"),this.float=a.float||!1,this.positive=a.positive||!1,this.min=a.min,this.max=a.max,this.inputElem=document.createElement("input"),this.inputElem.type="text",this.inputElem.classList.add("form-control","number-picker-input"),this.inputElem.onchange=e=>{let t;t=this.float?parseFloat(this.inputElem.value):parseInt(this.inputElem.value),this.positive&&(t=Math.abs(t)),this.min&&(t=Math.max(t,this.min())),this.max&&(t=Math.min(t,this.max())),this.float?this.inputElem.value=t.toFixed(2):this.inputElem.value=t.toString()},this.rootElem.appendChild(this.inputElem),this.init(),this.inputElem.addEventListener("change",(e=>{this.inputChanged(l.nextEventID())})),this.inputElem.addEventListener("input",(e=>{this.updateSize()})),this.updateSize()}getInputElem(){return this.inputElem}getInputValue(){return this.float?parseFloat(this.inputElem.value||"")||0:parseInt(this.inputElem.value||"")||0}setInputValue(e){this.float?this.inputElem.value=e.toFixed(2):this.inputElem.value=String(e)}updateSize(){const e=Math.max(3,this.inputElem.value.length);this.inputElem.size!=e&&(this.inputElem.size=e)}}class al extends m{constructor(e,i,a,s){super(e,"character-stats-root"),t(this,"stats"),t(this,"valueElems"),t(this,"meleeCritCapValueElem"),t(this,"player"),t(this,"modifyDisplayStats"),this.stats=nt.filter((e=>a.includes(e))),this.player=i,this.modifyDisplayStats=s;const o=document.createElement("label");o.classList.add("character-stats-label"),o.textContent="Stats",this.rootElem.appendChild(o);const n=document.createElement("table");if(n.classList.add("character-stats-table"),this.rootElem.appendChild(n),this.valueElems=[],this.stats.forEach((e=>{const t=rt(e,i.getClass()),a=h("tr",{className:"character-stats-table-row"},h("td",{className:"character-stats-table-label"},t),h("td",{className:"character-stats-table-value"},this.bonusStatsLink(e)));n.appendChild(a);const s=a.getElementsByClassName("character-stats-table-value")[0];this.valueElems.push(s)})),this.shouldShowMeleeCritCap(i)){const e=h("tr",{className:"character-stats-table-row"},h("td",{className:"character-stats-table-label"},"Melee Crit Cap"),h("td",{className:"character-stats-table-value"}));n.appendChild(e),this.meleeCritCapValueElem=e.getElementsByClassName("character-stats-table-value")[0]}else this.meleeCritCapValueElem=void 0;this.updateStats(i),l.onAny([i.currentStatsEmitter,i.sim.changeEmitter,i.talentsChangeEmitter]).on((()=>{this.updateStats(i)}))}updateStats(e){const t=e.getCurrentStats(),a=this.modifyDisplayStats?this.modifyDisplayStats(this.player):{talents:new H},s=H.fromProto(t.baseStats),o=H.fromProto(t.gearStats),l=H.fromProto(t.talentsStats),n=H.fromProto(t.buffsStats),r=H.fromProto(t.consumesStats),d=this.getDebuffStats(),c=e.getBonusStats(),m=s,p=o.subtract(s).subtract(c),u=l.subtract(o).add(a.talents),g=n.subtract(l),f=r.subtract(n),w=H.fromProto(t.finalStats).add(a.talents).add(d);if(this.stats.forEach(((e,t)=>{const a=h("a",{href:"javascript:void(0)",className:"stat-value-link",attributes:{role:"button"}},`${this.statDisplayString(w,w,e)} `);this.valueElems[t].querySelector(".stat-value-link")?.remove(),this.valueElems[t].prepend(a);const I=c.getStat(e);0==I?a.classList.add("text-white"):I>0?a.classList.add("text-success"):I<0&&a.classList.add("text-danger");const x=h("div",null,h("div",{className:"character-stats-tooltip-row"},h("span",null,"Base:"),h("span",null,this.statDisplayString(s,m,e))),h("div",{className:"character-stats-tooltip-row"},h("span",null,"Gear:"),h("span",null,this.statDisplayString(o,p,e))),h("div",{className:"character-stats-tooltip-row"},h("span",null,"Talents:"),h("span",null,this.statDisplayString(l,u,e))),h("div",{className:"character-stats-tooltip-row"},h("span",null,"Buffs:"),h("span",null,this.statDisplayString(n,g,e))),h("div",{className:"character-stats-tooltip-row"},h("span",null,"Consumes:"),h("span",null,this.statDisplayString(r,f,e))),0!=d.getStat(e)&&h("div",{className:"character-stats-tooltip-row"},h("span",null,"Debuffs:"),h("span",null,this.statDisplayString(d,d,e))),0!=I&&h("div",{className:"character-stats-tooltip-row"},h("span",null,"Bonus:"),h("span",null,this.statDisplayString(c,c,e))),h("div",{className:"character-stats-tooltip-row"},h("span",null,"Total:"),h("span",null,this.statDisplayString(w,w,e))));i.getOrCreateInstance(a,{title:x,html:!0})})),this.meleeCritCapValueElem){const t=e.getMeleeCritCapInfo(),a=h("a",{href:"javascript:void(0)",className:"stat-value-link",attributes:{role:"button"}},`${this.meleeCritCapDisplayString(e,w)} `),s=t.playerCritCapDelta;0==s?a.classList.add("text-white"):s>0?a.classList.add("text-danger"):s<0&&a.classList.add("text-success"),this.meleeCritCapValueElem.querySelector(".stat-value-link")?.remove(),this.meleeCritCapValueElem.prepend(a);const o=h("div",null,h("div",{className:"character-stats-tooltip-row"},h("span",null,"Glancing:"),h("span",null,`${t.glancing.toFixed(2)}%`)),h("div",{className:"character-stats-tooltip-row"},h("span",null,"Suppression:"),h("span",null,`${t.suppression.toFixed(2)}%`)),h("div",{className:"character-stats-tooltip-row"},h("span",null,"To Hit Cap:"),h("span",null,`${t.remainingMeleeHitCap.toFixed(2)}%`)),h("div",{className:"character-stats-tooltip-row"},h("span",null,"To Exp Cap:"),h("span",null,`${t.remainingExpertiseCap.toFixed(2)}%`)),h("div",{className:"character-stats-tooltip-row"},h("span",null,"Debuffs:"),h("span",null,`${t.debuffCrit.toFixed(2)}%`)),0!=t.specSpecificOffset&&h("div",{className:"character-stats-tooltip-row"},h("span",null,"Spec Offsets:"),h("span",null,`${t.specSpecificOffset.toFixed(2)}%`)),h("div",{className:"character-stats-tooltip-row"},h("span",null,"Final Crit Cap:"),h("span",null,`${t.baseCritCap.toFixed(2)}%`)),h("hr",null),h("div",{className:"character-stats-tooltip-row"},h("span",null,"Can Raise By:"),h("span",null,`${(t.remainingExpertiseCap+t.remainingMeleeHitCap).toFixed(2)}%`)));i.getOrCreateInstance(a,{title:o,html:!0})}}statDisplayString(e,t,i){let a=t.getStat(i);i==le.StatBlockValue&&(a*=e.getPseudoStat(ge.PseudoStatBlockValueMultiplier)||1);const s=this.player.getLevel();let o=String(Math.round(a));if(i==le.StatMeleeHit)o+=` (${(a/Xs(s)).toFixed(2)}%)`;else if(i==le.StatSpellHit)o+=` (${(a/to(s)).toFixed(2)}%)`;else if(i==le.StatMeleeCrit||i==le.StatSpellCrit)o+=` (${(a/Zs(s)).toFixed(2)}%)`;else if(i==le.StatMeleeHaste){let e=1;[d.ClassDruid,d.ClassShaman,d.ClassPaladin,d.ClassDeathknight].includes(this.player.getClass())&&(e=1.3),o+=` (${(a/(Ys(s)/e)).toFixed(2)}%)`}else i==le.StatSpellHaste?o+=` (${(a/Ys(s)).toFixed(2)}%)`:i==le.StatArmorPenetration?o+=` (${(a/function(e){return lo[e]}(s)).toFixed(2)}%)`:i==le.StatExpertise?o+=` (${(a/$s(s)/4).toFixed(2)}%)`:i==le.StatDefense?o+=` (${(5*s+Math.floor(a/ao(s))).toFixed(0)})`:i==le.StatBlock?o+=` (${(a/function(e){return so[e]}(s)+.04*Math.floor(e.getStat(le.StatDefense)/ao(s))+5).toFixed(2)}%)`:i==le.StatDodge?o+=` (${(100*e.getPseudoStat(ge.PseudoStatDodge)).toFixed(2)}%)`:i==le.StatParry?o+=` (${(100*e.getPseudoStat(ge.PseudoStatParry)).toFixed(2)}%)`:i==le.StatResilience&&(o+=` (${(a/function(e){return oo[e]}(s)).toFixed(2)}%)`);return o}getDebuffStats(){let e=new H;const t=this.player.sim.raid.getDebuffs(),i=this.player.getLevel();return(t.misery||t.faerieFire==dt.TristateEffectImproved)&&(e=e.addStat(le.StatSpellHit,3*to(i))),(t.totemOfWrath||t.heartOfTheCrusader||t.masterPoisoner)&&(e=e.addStat(le.StatSpellCrit,3*Zs(i)),e=e.addStat(le.StatMeleeCrit,3*Zs(i))),(t.improvedScorch||t.wintersChill||t.shadowMastery)&&(e=e.addStat(le.StatSpellCrit,5*Zs(i))),e}bonusStatsLink(e){const t=rt(e,this.player.getClass()),i=h("a",{href:"javascript:void(0)",className:"add-bonus-stats text-white ms-2",dataset:{bsToggle:"popover"},attributes:{role:"button"}},h("i",{className:"fas fa-plus-minus"}));let s=null;const o=new il(null,this.player,{label:`Bonus ${t}`,extraCssClasses:["mb-0"],changedEvent:e=>e.bonusStatsChangeEmitter,getValue:t=>t.getBonusStats().getStat(e),setValue:(t,i,a)=>{const o=i.getBonusStats().withStat(e,a);i.setBonusStats(t,o),s?.hide()}});return s=new a(i,{customClass:"bonus-stats-popover",placement:"right",fallbackPlacement:["left"],sanitize:!1,html:!0,content:o.rootElem}),i}shouldShowMeleeCritCap(e){return[ne.SpecDeathknight,ne.SpecEnhancementShaman,ne.SpecRetributionPaladin,ne.SpecRogue,ne.SpecWarrior].includes(e.spec)}meleeCritCapDisplayString(e,t){const i=e.getMeleeCritCap();if(0===i)return"Exact";return`${i>0?"Over by ":"Under by "} ${Math.abs(i).toFixed(2)}%`}}
/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */function sl(e){let t=e.length;for(;--t>=0;)e[t]=0}const ol=256,ll=286,nl=30,rl=15,dl=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),cl=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),ml=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),hl=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),pl=new Array(576);sl(pl);const ul=new Array(60);sl(ul);const gl=new Array(512);sl(gl);const fl=new Array(256);sl(fl);const wl=new Array(29);sl(wl);const Il=new Array(nl);function xl(e,t,i,a,s){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=a,this.max_length=s,this.has_stree=e&&e.length}let yl,bl,vl;function Sl(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}sl(Il);const El=e=>e<256?gl[e]:gl[256+(e>>>7)],Pl=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},kl=(e,t,i)=>{e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,Pl(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},Cl=(e,t,i)=>{kl(e,i[2*t],i[2*t+1])},_l=(e,t)=>{let i=0;do{i|=1&e,e>>>=1,i<<=1}while(--t>0);return i>>>1},Nl=(e,t,i)=>{const a=new Array(16);let s,o,l=0;for(s=1;s<=rl;s++)a[s]=l=l+i[s-1]<<1;for(o=0;o<=t;o++){let t=e[2*o+1];0!==t&&(e[2*o]=_l(a[t]++,t))}},Tl=e=>{let t;for(t=0;t<ll;t++)e.dyn_ltree[2*t]=0;for(t=0;t<nl;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},Rl=e=>{e.bi_valid>8?Pl(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Ll=(e,t,i,a)=>{const s=2*t,o=2*i;return e[s]<e[o]||e[s]===e[o]&&a[t]<=a[i]},Gl=(e,t,i)=>{const a=e.heap[i];let s=i<<1;for(;s<=e.heap_len&&(s<e.heap_len&&Ll(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!Ll(t,a,e.heap[s],e.depth));)e.heap[i]=e.heap[s],i=s,s<<=1;e.heap[i]=a},Al=(e,t,i)=>{let a,s,o,l,n=0;if(0!==e.last_lit)do{a=e.pending_buf[e.d_buf+2*n]<<8|e.pending_buf[e.d_buf+2*n+1],s=e.pending_buf[e.l_buf+n],n++,0===a?Cl(e,s,t):(o=fl[s],Cl(e,o+ol+1,t),l=dl[o],0!==l&&(s-=wl[o],kl(e,s,l)),a--,o=El(a),Cl(e,o,i),l=cl[o],0!==l&&(a-=Il[o],kl(e,a,l)))}while(n<e.last_lit);Cl(e,256,t)},Dl=(e,t)=>{const i=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.elems;let l,n,r,d=-1;for(e.heap_len=0,e.heap_max=573,l=0;l<o;l++)0!==i[2*l]?(e.heap[++e.heap_len]=d=l,e.depth[l]=0):i[2*l+1]=0;for(;e.heap_len<2;)r=e.heap[++e.heap_len]=d<2?++d:0,i[2*r]=1,e.depth[r]=0,e.opt_len--,s&&(e.static_len-=a[2*r+1]);for(t.max_code=d,l=e.heap_len>>1;l>=1;l--)Gl(e,i,l);r=o;do{l=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Gl(e,i,1),n=e.heap[1],e.heap[--e.heap_max]=l,e.heap[--e.heap_max]=n,i[2*r]=i[2*l]+i[2*n],e.depth[r]=(e.depth[l]>=e.depth[n]?e.depth[l]:e.depth[n])+1,i[2*l+1]=i[2*n+1]=r,e.heap[1]=r++,Gl(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const i=t.dyn_tree,a=t.max_code,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.extra_bits,n=t.stat_desc.extra_base,r=t.stat_desc.max_length;let d,c,m,h,p,u,g=0;for(h=0;h<=rl;h++)e.bl_count[h]=0;for(i[2*e.heap[e.heap_max]+1]=0,d=e.heap_max+1;d<573;d++)c=e.heap[d],h=i[2*i[2*c+1]+1]+1,h>r&&(h=r,g++),i[2*c+1]=h,c>a||(e.bl_count[h]++,p=0,c>=n&&(p=l[c-n]),u=i[2*c],e.opt_len+=u*(h+p),o&&(e.static_len+=u*(s[2*c+1]+p)));if(0!==g){do{for(h=r-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[r]--,g-=2}while(g>0);for(h=r;0!==h;h--)for(c=e.bl_count[h];0!==c;)m=e.heap[--d],m>a||(i[2*m+1]!==h&&(e.opt_len+=(h-i[2*m+1])*i[2*m],i[2*m+1]=h),c--)}})(e,t),Nl(i,d,e.bl_count)},Ul=(e,t,i)=>{let a,s,o=-1,l=t[1],n=0,r=7,d=4;for(0===l&&(r=138,d=3),t[2*(i+1)+1]=65535,a=0;a<=i;a++)s=l,l=t[2*(a+1)+1],++n<r&&s===l||(n<d?e.bl_tree[2*s]+=n:0!==s?(s!==o&&e.bl_tree[2*s]++,e.bl_tree[32]++):n<=10?e.bl_tree[34]++:e.bl_tree[36]++,n=0,o=s,0===l?(r=138,d=3):s===l?(r=6,d=3):(r=7,d=4))},Ol=(e,t,i)=>{let a,s,o=-1,l=t[1],n=0,r=7,d=4;for(0===l&&(r=138,d=3),a=0;a<=i;a++)if(s=l,l=t[2*(a+1)+1],!(++n<r&&s===l)){if(n<d)do{Cl(e,s,e.bl_tree)}while(0!=--n);else 0!==s?(s!==o&&(Cl(e,s,e.bl_tree),n--),Cl(e,16,e.bl_tree),kl(e,n-3,2)):n<=10?(Cl(e,17,e.bl_tree),kl(e,n-3,3)):(Cl(e,18,e.bl_tree),kl(e,n-11,7));n=0,o=s,0===l?(r=138,d=3):s===l?(r=6,d=3):(r=7,d=4)}};let Ml=!1;const Wl=(e,t,i,a)=>{kl(e,0+(a?1:0),3),((e,t,i,a)=>{Rl(e),a&&(Pl(e,i),Pl(e,~i)),e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i})(e,t,i,!0)};var Vl={_tr_init:e=>{Ml||((()=>{let e,t,i,a,s;const o=new Array(16);for(i=0,a=0;a<28;a++)for(wl[a]=i,e=0;e<1<<dl[a];e++)fl[i++]=a;for(fl[i-1]=a,s=0,a=0;a<16;a++)for(Il[a]=s,e=0;e<1<<cl[a];e++)gl[s++]=a;for(s>>=7;a<nl;a++)for(Il[a]=s<<7,e=0;e<1<<cl[a]-7;e++)gl[256+s++]=a;for(t=0;t<=rl;t++)o[t]=0;for(e=0;e<=143;)pl[2*e+1]=8,e++,o[8]++;for(;e<=255;)pl[2*e+1]=9,e++,o[9]++;for(;e<=279;)pl[2*e+1]=7,e++,o[7]++;for(;e<=287;)pl[2*e+1]=8,e++,o[8]++;for(Nl(pl,287,o),e=0;e<nl;e++)ul[2*e+1]=5,ul[2*e]=_l(e,5);yl=new xl(pl,dl,257,ll,rl),bl=new xl(ul,cl,0,nl,rl),vl=new xl(new Array(0),ml,0,19,7)})(),Ml=!0),e.l_desc=new Sl(e.dyn_ltree,yl),e.d_desc=new Sl(e.dyn_dtree,bl),e.bl_desc=new Sl(e.bl_tree,vl),e.bi_buf=0,e.bi_valid=0,Tl(e)},_tr_stored_block:Wl,_tr_flush_block:(e,t,i,a)=>{let s,o,l=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<ol;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),Dl(e,e.l_desc),Dl(e,e.d_desc),l=(e=>{let t;for(Ul(e,e.dyn_ltree,e.l_desc.max_code),Ul(e,e.dyn_dtree,e.d_desc.max_code),Dl(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*hl[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),s=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=s&&(s=o)):s=o=i+5,i+4<=s&&-1!==t?Wl(e,t,i,a):4===e.strategy||o===s?(kl(e,2+(a?1:0),3),Al(e,pl,ul)):(kl(e,4+(a?1:0),3),((e,t,i,a)=>{let s;for(kl(e,t-257,5),kl(e,i-1,5),kl(e,a-4,4),s=0;s<a;s++)kl(e,e.bl_tree[2*hl[s]+1],3);Ol(e,e.dyn_ltree,t-1),Ol(e,e.dyn_dtree,i-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),Al(e,e.dyn_ltree,e.dyn_dtree)),Tl(e),a&&Rl(e)},_tr_tally:(e,t,i)=>(e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(fl[i]+ol+1)]++,e.dyn_dtree[2*El(t)]++),e.last_lit===e.lit_bufsize-1),_tr_align:e=>{kl(e,2,3),Cl(e,256,pl),(e=>{16===e.bi_valid?(Pl(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var Fl=(e,t,i,a)=>{let s=65535&e|0,o=e>>>16&65535|0,l=0;for(;0!==i;){l=i>2e3?2e3:i,i-=l;do{s=s+t[a++]|0,o=o+s|0}while(--l);s%=65521,o%=65521}return s|o<<16|0};const zl=new Uint32Array((()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var a=0;a<8;a++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t})());var jl=(e,t,i,a)=>{const s=zl,o=a+i;e^=-1;for(let l=a;l<o;l++)e=e>>>8^s[255&(e^t[l])];return-1^e},Hl={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Bl={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:ql,_tr_stored_block:$l,_tr_flush_block:Kl,_tr_tally:Yl,_tr_align:Jl}=Vl,{Z_NO_FLUSH:Zl,Z_PARTIAL_FLUSH:Ql,Z_FULL_FLUSH:Xl,Z_FINISH:en,Z_BLOCK:tn,Z_OK:an,Z_STREAM_END:sn,Z_STREAM_ERROR:on,Z_DATA_ERROR:ln,Z_BUF_ERROR:nn,Z_DEFAULT_COMPRESSION:rn,Z_FILTERED:dn,Z_HUFFMAN_ONLY:cn,Z_RLE:mn,Z_FIXED:hn,Z_DEFAULT_STRATEGY:pn,Z_UNKNOWN:un,Z_DEFLATED:gn}=Bl,fn=258,wn=262,In=103,xn=113,yn=666,bn=(e,t)=>(e.msg=Hl[t],t),vn=e=>(e<<1)-(e>4?9:0),Sn=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let En=(e,t,i)=>(t<<e.hash_shift^i)&e.hash_mask;const Pn=e=>{const t=e.state;let i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))},kn=(e,t)=>{Kl(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Pn(e.strm)},Cn=(e,t)=>{e.pending_buf[e.pending++]=t},_n=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Nn=(e,t,i,a)=>{let s=e.avail_in;return s>a&&(s=a),0===s?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),i),1===e.state.wrap?e.adler=Fl(e.adler,t,s,i):2===e.state.wrap&&(e.adler=jl(e.adler,t,s,i)),e.next_in+=s,e.total_in+=s,s)},Tn=(e,t)=>{let i,a,s=e.max_chain_length,o=e.strstart,l=e.prev_length,n=e.nice_match;const r=e.strstart>e.w_size-wn?e.strstart-(e.w_size-wn):0,d=e.window,c=e.w_mask,m=e.prev,h=e.strstart+fn;let p=d[o+l-1],u=d[o+l];e.prev_length>=e.good_match&&(s>>=2),n>e.lookahead&&(n=e.lookahead);do{if(i=t,d[i+l]===u&&d[i+l-1]===p&&d[i]===d[o]&&d[++i]===d[o+1]){o+=2,i++;do{}while(d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&d[++o]===d[++i]&&o<h);if(a=fn-(h-o),o=h-fn,a>l){if(e.match_start=t,l=a,a>=n)break;p=d[o+l-1],u=d[o+l]}}}while((t=m[t&c])>r&&0!=--s);return l<=e.lookahead?l:e.lookahead},Rn=e=>{const t=e.w_size;let i,a,s,o,l;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-wn)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,a=e.hash_size,i=a;do{s=e.head[--i],e.head[i]=s>=t?s-t:0}while(--a);a=t,i=a;do{s=e.prev[--i],e.prev[i]=s>=t?s-t:0}while(--a);o+=t}if(0===e.strm.avail_in)break;if(a=Nn(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=a,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=En(e,e.ins_h,e.window[l+1]);e.insert&&(e.ins_h=En(e,e.ins_h,e.window[l+3-1]),e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<wn&&0!==e.strm.avail_in)},Ln=(e,t)=>{let i,a;for(;;){if(e.lookahead<wn){if(Rn(e),e.lookahead<wn&&t===Zl)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=En(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-wn&&(e.match_length=Tn(e,i)),e.match_length>=3)if(a=Yl(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=En(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=En(e,e.ins_h,e.window[e.strstart+1]);else a=Yl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(a&&(kn(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===en?(kn(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(kn(e,!1),0===e.strm.avail_out)?1:2},Gn=(e,t)=>{let i,a,s;for(;;){if(e.lookahead<wn){if(Rn(e),e.lookahead<wn&&t===Zl)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=En(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-wn&&(e.match_length=Tn(e,i),e.match_length<=5&&(e.strategy===dn||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-3,a=Yl(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=s&&(e.ins_h=En(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,a&&(kn(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(a=Yl(e,0,e.window[e.strstart-1]),a&&kn(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(a=Yl(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===en?(kn(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(kn(e,!1),0===e.strm.avail_out)?1:2};function An(e,t,i,a,s){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=a,this.func=s}const Dn=[new An(0,0,0,0,((e,t)=>{let i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Rn(e),0===e.lookahead&&t===Zl)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;const a=e.block_start+i;if((0===e.strstart||e.strstart>=a)&&(e.lookahead=e.strstart-a,e.strstart=a,kn(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-wn&&(kn(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===en?(kn(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(kn(e,!1),e.strm.avail_out),1)})),new An(4,4,8,4,Ln),new An(4,5,16,8,Ln),new An(4,6,32,32,Ln),new An(4,4,16,16,Gn),new An(8,16,32,32,Gn),new An(8,16,128,128,Gn),new An(8,32,128,256,Gn),new An(32,128,258,1024,Gn),new An(32,258,258,4096,Gn)];function Un(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=gn,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Sn(this.dyn_ltree),Sn(this.dyn_dtree),Sn(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Sn(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Sn(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const On=e=>{if(!e||!e.state)return bn(e,on);e.total_in=e.total_out=0,e.data_type=un;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:xn,e.adler=2===t.wrap?0:1,t.last_flush=Zl,ql(t),an},Mn=e=>{const t=On(e);var i;return t===an&&((i=e.state).window_size=2*i.w_size,Sn(i.head),i.max_lazy_match=Dn[i.level].max_lazy,i.good_match=Dn[i.level].good_length,i.nice_match=Dn[i.level].nice_length,i.max_chain_length=Dn[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),t},Wn=(e,t,i,a,s,o)=>{if(!e)return on;let l=1;if(t===rn&&(t=6),a<0?(l=0,a=-a):a>15&&(l=2,a-=16),s<1||s>9||i!==gn||a<8||a>15||t<0||t>9||o<0||o>hn)return bn(e,on);8===a&&(a=9);const n=new Un;return e.state=n,n.strm=e,n.wrap=l,n.gzhead=null,n.w_bits=a,n.w_size=1<<n.w_bits,n.w_mask=n.w_size-1,n.hash_bits=s+7,n.hash_size=1<<n.hash_bits,n.hash_mask=n.hash_size-1,n.hash_shift=~~((n.hash_bits+3-1)/3),n.window=new Uint8Array(2*n.w_size),n.head=new Uint16Array(n.hash_size),n.prev=new Uint16Array(n.w_size),n.lit_bufsize=1<<s+6,n.pending_buf_size=4*n.lit_bufsize,n.pending_buf=new Uint8Array(n.pending_buf_size),n.d_buf=1*n.lit_bufsize,n.l_buf=3*n.lit_bufsize,n.level=t,n.strategy=o,n.method=i,Mn(e)};var Vn={deflateInit:(e,t)=>Wn(e,t,gn,15,8,pn),deflateInit2:Wn,deflateReset:Mn,deflateResetKeep:On,deflateSetHeader:(e,t)=>e&&e.state?2!==e.state.wrap?on:(e.state.gzhead=t,an):on,deflate:(e,t)=>{let i,a;if(!e||!e.state||t>tn||t<0)return e?bn(e,on):on;const s=e.state;if(!e.output||!e.input&&0!==e.avail_in||s.status===yn&&t!==en)return bn(e,0===e.avail_out?nn:on);s.strm=e;const o=s.last_flush;if(s.last_flush=t,42===s.status)if(2===s.wrap)e.adler=0,Cn(s,31),Cn(s,139),Cn(s,8),s.gzhead?(Cn(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),Cn(s,255&s.gzhead.time),Cn(s,s.gzhead.time>>8&255),Cn(s,s.gzhead.time>>16&255),Cn(s,s.gzhead.time>>24&255),Cn(s,9===s.level?2:s.strategy>=cn||s.level<2?4:0),Cn(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(Cn(s,255&s.gzhead.extra.length),Cn(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=jl(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(Cn(s,0),Cn(s,0),Cn(s,0),Cn(s,0),Cn(s,0),Cn(s,9===s.level?2:s.strategy>=cn||s.level<2?4:0),Cn(s,3),s.status=xn);else{let t=gn+(s.w_bits-8<<4)<<8,i=-1;i=s.strategy>=cn||s.level<2?0:s.level<6?1:6===s.level?2:3,t|=i<<6,0!==s.strstart&&(t|=32),t+=31-t%31,s.status=xn,_n(s,t),0!==s.strstart&&(_n(s,e.adler>>>16),_n(s,65535&e.adler)),e.adler=1}if(69===s.status)if(s.gzhead.extra){for(i=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>i&&(e.adler=jl(e.adler,s.pending_buf,s.pending-i,i)),Pn(e),i=s.pending,s.pending!==s.pending_buf_size));)Cn(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>i&&(e.adler=jl(e.adler,s.pending_buf,s.pending-i,i)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){i=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(e.adler=jl(e.adler,s.pending_buf,s.pending-i,i)),Pn(e),i=s.pending,s.pending===s.pending_buf_size)){a=1;break}a=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,Cn(s,a)}while(0!==a);s.gzhead.hcrc&&s.pending>i&&(e.adler=jl(e.adler,s.pending_buf,s.pending-i,i)),0===a&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){i=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(e.adler=jl(e.adler,s.pending_buf,s.pending-i,i)),Pn(e),i=s.pending,s.pending===s.pending_buf_size)){a=1;break}a=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,Cn(s,a)}while(0!==a);s.gzhead.hcrc&&s.pending>i&&(e.adler=jl(e.adler,s.pending_buf,s.pending-i,i)),0===a&&(s.status=In)}else s.status=In;if(s.status===In&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&Pn(e),s.pending+2<=s.pending_buf_size&&(Cn(s,255&e.adler),Cn(s,e.adler>>8&255),e.adler=0,s.status=xn)):s.status=xn),0!==s.pending){if(Pn(e),0===e.avail_out)return s.last_flush=-1,an}else if(0===e.avail_in&&vn(t)<=vn(o)&&t!==en)return bn(e,nn);if(s.status===yn&&0!==e.avail_in)return bn(e,nn);if(0!==e.avail_in||0!==s.lookahead||t!==Zl&&s.status!==yn){let i=s.strategy===cn?((e,t)=>{let i;for(;;){if(0===e.lookahead&&(Rn(e),0===e.lookahead)){if(t===Zl)return 1;break}if(e.match_length=0,i=Yl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(kn(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===en?(kn(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(kn(e,!1),0===e.strm.avail_out)?1:2})(s,t):s.strategy===mn?((e,t)=>{let i,a,s,o;const l=e.window;for(;;){if(e.lookahead<=fn){if(Rn(e),e.lookahead<=fn&&t===Zl)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(s=e.strstart-1,a=l[s],a===l[++s]&&a===l[++s]&&a===l[++s])){o=e.strstart+fn;do{}while(a===l[++s]&&a===l[++s]&&a===l[++s]&&a===l[++s]&&a===l[++s]&&a===l[++s]&&a===l[++s]&&a===l[++s]&&s<o);e.match_length=fn-(o-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=Yl(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=Yl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(kn(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===en?(kn(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(kn(e,!1),0===e.strm.avail_out)?1:2})(s,t):Dn[s.level].func(s,t);if(3!==i&&4!==i||(s.status=yn),1===i||3===i)return 0===e.avail_out&&(s.last_flush=-1),an;if(2===i&&(t===Ql?Jl(s):t!==tn&&($l(s,0,0,!1),t===Xl&&(Sn(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),Pn(e),0===e.avail_out))return s.last_flush=-1,an}return t!==en?an:s.wrap<=0?sn:(2===s.wrap?(Cn(s,255&e.adler),Cn(s,e.adler>>8&255),Cn(s,e.adler>>16&255),Cn(s,e.adler>>24&255),Cn(s,255&e.total_in),Cn(s,e.total_in>>8&255),Cn(s,e.total_in>>16&255),Cn(s,e.total_in>>24&255)):(_n(s,e.adler>>>16),_n(s,65535&e.adler)),Pn(e),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?an:sn)},deflateEnd:e=>{if(!e||!e.state)return on;const t=e.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&t!==In&&t!==xn&&t!==yn?bn(e,on):(e.state=null,t===xn?bn(e,ln):an)},deflateSetDictionary:(e,t)=>{let i=t.length;if(!e||!e.state)return on;const a=e.state,s=a.wrap;if(2===s||1===s&&42!==a.status||a.lookahead)return on;if(1===s&&(e.adler=Fl(e.adler,t,i,0)),a.wrap=0,i>=a.w_size){0===s&&(Sn(a.head),a.strstart=0,a.block_start=0,a.insert=0);let e=new Uint8Array(a.w_size);e.set(t.subarray(i-a.w_size,i),0),t=e,i=a.w_size}const o=e.avail_in,l=e.next_in,n=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,Rn(a);a.lookahead>=3;){let e=a.strstart,t=a.lookahead-2;do{a.ins_h=En(a,a.ins_h,a.window[e+3-1]),a.prev[e&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=e,e++}while(--t);a.strstart=e,a.lookahead=2,Rn(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=2,a.match_available=0,e.next_in=l,e.input=n,e.avail_in=o,a.wrap=s,an},deflateInfo:"pako deflate (from Nodeca project)"};const Fn=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var zn={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const t in i)Fn(i,t)&&(e[t]=i[t])}}return e},flattenChunks:e=>{let t=0;for(let a=0,s=e.length;a<s;a++)t+=e[a].length;const i=new Uint8Array(t);for(let a=0,s=0,o=e.length;a<o;a++){let t=e[a];i.set(t,s),s+=t.length}return i}};let jn=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(sg){jn=!1}const Hn=new Uint8Array(256);for(let og=0;og<256;og++)Hn[og]=og>=252?6:og>=248?5:og>=240?4:og>=224?3:og>=192?2:1;Hn[254]=Hn[254]=1;var Bn={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,i,a,s,o,l=e.length,n=0;for(s=0;s<l;s++)i=e.charCodeAt(s),55296==(64512&i)&&s+1<l&&(a=e.charCodeAt(s+1),56320==(64512&a)&&(i=65536+(i-55296<<10)+(a-56320),s++)),n+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(n),o=0,s=0;o<n;s++)i=e.charCodeAt(s),55296==(64512&i)&&s+1<l&&(a=e.charCodeAt(s+1),56320==(64512&a)&&(i=65536+(i-55296<<10)+(a-56320),s++)),i<128?t[o++]=i:i<2048?(t[o++]=192|i>>>6,t[o++]=128|63&i):i<65536?(t[o++]=224|i>>>12,t[o++]=128|i>>>6&63,t[o++]=128|63&i):(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63,t[o++]=128|i>>>6&63,t[o++]=128|63&i);return t},buf2string:(e,t)=>{const i=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let a,s;const o=new Array(2*i);for(s=0,a=0;a<i;){let t=e[a++];if(t<128){o[s++]=t;continue}let l=Hn[t];if(l>4)o[s++]=65533,a+=l-1;else{for(t&=2===l?31:3===l?15:7;l>1&&a<i;)t=t<<6|63&e[a++],l--;l>1?o[s++]=65533:t<65536?o[s++]=t:(t-=65536,o[s++]=55296|t>>10&1023,o[s++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&jn)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let i="";for(let a=0;a<t;a++)i+=String.fromCharCode(e[a]);return i})(o,s)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let i=t-1;for(;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+Hn[e[i]]>t?i:t}};var qn=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const $n=Object.prototype.toString,{Z_NO_FLUSH:Kn,Z_SYNC_FLUSH:Yn,Z_FULL_FLUSH:Jn,Z_FINISH:Zn,Z_OK:Qn,Z_STREAM_END:Xn,Z_DEFAULT_COMPRESSION:er,Z_DEFAULT_STRATEGY:tr,Z_DEFLATED:ir}=Bl;function ar(e){this.options=zn.assign({level:er,method:ir,chunkSize:16384,windowBits:15,memLevel:8,strategy:tr},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new qn,this.strm.avail_out=0;let i=Vn.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==Qn)throw new Error(Hl[i]);if(t.header&&Vn.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?Bn.string2buf(t.dictionary):"[object ArrayBuffer]"===$n.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,i=Vn.deflateSetDictionary(this.strm,e),i!==Qn)throw new Error(Hl[i]);this._dict_set=!0}}function sr(e,t){const i=new ar(t);if(i.push(e,!0),i.err)throw i.msg||Hl[i.err];return i.result}ar.prototype.push=function(e,t){const i=this.strm,a=this.options.chunkSize;let s,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?Zn:Kn,"string"==typeof e?i.input=Bn.string2buf(e):"[object ArrayBuffer]"===$n.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(a),i.next_out=0,i.avail_out=a),(o===Yn||o===Jn)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(s=Vn.deflate(i,o),s===Xn)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),s=Vn.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===Qn;if(0!==i.avail_out){if(o>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},ar.prototype.onData=function(e){this.chunks.push(e)},ar.prototype.onEnd=function(e){e===Qn&&(this.result=zn.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var or={Deflate:ar,deflate:sr,deflateRaw:function(e,t){return(t=t||{}).raw=!0,sr(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,sr(e,t)},constants:Bl};var lr=function(e,t){let i,a,s,o,l,n,r,d,c,m,h,p,u,g,f,w,I,x,y,b,v,S,E,P;const k=e.state;i=e.next_in,E=e.input,a=i+(e.avail_in-5),s=e.next_out,P=e.output,o=s-(t-e.avail_out),l=s+(e.avail_out-257),n=k.dmax,r=k.wsize,d=k.whave,c=k.wnext,m=k.window,h=k.hold,p=k.bits,u=k.lencode,g=k.distcode,f=(1<<k.lenbits)-1,w=(1<<k.distbits)-1;e:do{p<15&&(h+=E[i++]<<p,p+=8,h+=E[i++]<<p,p+=8),I=u[h&f];t:for(;;){if(x=I>>>24,h>>>=x,p-=x,x=I>>>16&255,0===x)P[s++]=65535&I;else{if(!(16&x)){if(0==(64&x)){I=u[(65535&I)+(h&(1<<x)-1)];continue t}if(32&x){k.mode=12;break e}e.msg="invalid literal/length code",k.mode=30;break e}y=65535&I,x&=15,x&&(p<x&&(h+=E[i++]<<p,p+=8),y+=h&(1<<x)-1,h>>>=x,p-=x),p<15&&(h+=E[i++]<<p,p+=8,h+=E[i++]<<p,p+=8),I=g[h&w];i:for(;;){if(x=I>>>24,h>>>=x,p-=x,x=I>>>16&255,!(16&x)){if(0==(64&x)){I=g[(65535&I)+(h&(1<<x)-1)];continue i}e.msg="invalid distance code",k.mode=30;break e}if(b=65535&I,x&=15,p<x&&(h+=E[i++]<<p,p+=8,p<x&&(h+=E[i++]<<p,p+=8)),b+=h&(1<<x)-1,b>n){e.msg="invalid distance too far back",k.mode=30;break e}if(h>>>=x,p-=x,x=s-o,b>x){if(x=b-x,x>d&&k.sane){e.msg="invalid distance too far back",k.mode=30;break e}if(v=0,S=m,0===c){if(v+=r-x,x<y){y-=x;do{P[s++]=m[v++]}while(--x);v=s-b,S=P}}else if(c<x){if(v+=r+c-x,x-=c,x<y){y-=x;do{P[s++]=m[v++]}while(--x);if(v=0,c<y){x=c,y-=x;do{P[s++]=m[v++]}while(--x);v=s-b,S=P}}}else if(v+=c-x,x<y){y-=x;do{P[s++]=m[v++]}while(--x);v=s-b,S=P}for(;y>2;)P[s++]=S[v++],P[s++]=S[v++],P[s++]=S[v++],y-=3;y&&(P[s++]=S[v++],y>1&&(P[s++]=S[v++]))}else{v=s-b;do{P[s++]=P[v++],P[s++]=P[v++],P[s++]=P[v++],y-=3}while(y>2);y&&(P[s++]=P[v++],y>1&&(P[s++]=P[v++]))}break}}break}}while(i<a&&s<l);y=p>>3,i-=y,p-=y<<3,h&=(1<<p)-1,e.next_in=i,e.next_out=s,e.avail_in=i<a?a-i+5:5-(i-a),e.avail_out=s<l?l-s+257:257-(s-l),k.hold=h,k.bits=p};const nr=15,rr=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),dr=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),cr=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),mr=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var hr=(e,t,i,a,s,o,l,n)=>{const r=n.bits;let d,c,m,h,p,u,g=0,f=0,w=0,I=0,x=0,y=0,b=0,v=0,S=0,E=0,P=null,k=0;const C=new Uint16Array(16),_=new Uint16Array(16);let N,T,R,L=null,G=0;for(g=0;g<=nr;g++)C[g]=0;for(f=0;f<a;f++)C[t[i+f]]++;for(x=r,I=nr;I>=1&&0===C[I];I--);if(x>I&&(x=I),0===I)return s[o++]=20971520,s[o++]=20971520,n.bits=1,0;for(w=1;w<I&&0===C[w];w++);for(x<w&&(x=w),v=1,g=1;g<=nr;g++)if(v<<=1,v-=C[g],v<0)return-1;if(v>0&&(0===e||1!==I))return-1;for(_[1]=0,g=1;g<nr;g++)_[g+1]=_[g]+C[g];for(f=0;f<a;f++)0!==t[i+f]&&(l[_[t[i+f]]++]=f);if(0===e?(P=L=l,u=19):1===e?(P=rr,k-=257,L=dr,G-=257,u=256):(P=cr,L=mr,u=-1),E=0,f=0,g=w,p=o,y=x,b=0,m=-1,S=1<<x,h=S-1,1===e&&S>852||2===e&&S>592)return 1;for(;;){N=g-b,l[f]<u?(T=0,R=l[f]):l[f]>u?(T=L[G+l[f]],R=P[k+l[f]]):(T=96,R=0),d=1<<g-b,c=1<<y,w=c;do{c-=d,s[p+(E>>b)+c]=N<<24|T<<16|R|0}while(0!==c);for(d=1<<g-1;E&d;)d>>=1;if(0!==d?(E&=d-1,E+=d):E=0,f++,0==--C[g]){if(g===I)break;g=t[i+l[f]]}if(g>x&&(E&h)!==m){for(0===b&&(b=x),p+=w,y=g-b,v=1<<y;y+b<I&&(v-=C[y+b],!(v<=0));)y++,v<<=1;if(S+=1<<y,1===e&&S>852||2===e&&S>592)return 1;m=E&h,s[m]=x<<24|y<<16|p-o|0}}return 0!==E&&(s[p+E]=g-b<<24|64<<16|0),n.bits=x,0};const{Z_FINISH:pr,Z_BLOCK:ur,Z_TREES:gr,Z_OK:fr,Z_STREAM_END:wr,Z_NEED_DICT:Ir,Z_STREAM_ERROR:xr,Z_DATA_ERROR:yr,Z_MEM_ERROR:br,Z_BUF_ERROR:vr,Z_DEFLATED:Sr}=Bl,Er=12,Pr=30,kr=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Cr(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const _r=e=>{if(!e||!e.state)return xr;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,fr},Nr=e=>{if(!e||!e.state)return xr;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,_r(e)},Tr=(e,t)=>{let i;if(!e||!e.state)return xr;const a=e.state;return t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?xr:(null!==a.window&&a.wbits!==t&&(a.window=null),a.wrap=i,a.wbits=t,Nr(e))},Rr=(e,t)=>{if(!e)return xr;const i=new Cr;e.state=i,i.window=null;const a=Tr(e,t);return a!==fr&&(e.state=null),a};let Lr,Gr,Ar=!0;const Dr=e=>{if(Ar){Lr=new Int32Array(512),Gr=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(hr(1,e.lens,0,288,Lr,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;hr(2,e.lens,0,32,Gr,0,e.work,{bits:5}),Ar=!1}e.lencode=Lr,e.lenbits=9,e.distcode=Gr,e.distbits=5},Ur=(e,t,i,a)=>{let s;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),a>=o.wsize?(o.window.set(t.subarray(i-o.wsize,i),0),o.wnext=0,o.whave=o.wsize):(s=o.wsize-o.wnext,s>a&&(s=a),o.window.set(t.subarray(i-a,i-a+s),o.wnext),(a-=s)?(o.window.set(t.subarray(i-a,i),0),o.wnext=a,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0};var Or={inflateReset:Nr,inflateReset2:Tr,inflateResetKeep:_r,inflateInit:e=>Rr(e,15),inflateInit2:Rr,inflate:(e,t)=>{let i,a,s,o,l,n,r,d,c,m,h,p,u,g,f,w,I,x,y,b,v,S,E=0;const P=new Uint8Array(4);let k,C;const _=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return xr;i=e.state,i.mode===Er&&(i.mode=13),l=e.next_out,s=e.output,r=e.avail_out,o=e.next_in,a=e.input,n=e.avail_in,d=i.hold,c=i.bits,m=n,h=r,S=fr;e:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;c<16;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}if(2&i.wrap&&35615===d){i.check=0,P[0]=255&d,P[1]=d>>>8&255,i.check=jl(i.check,P,2,0),d=0,c=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",i.mode=Pr;break}if((15&d)!==Sr){e.msg="unknown compression method",i.mode=Pr;break}if(d>>>=4,c-=4,v=8+(15&d),0===i.wbits)i.wbits=v;else if(v>i.wbits){e.msg="invalid window size",i.mode=Pr;break}i.dmax=1<<i.wbits,e.adler=i.check=1,i.mode=512&d?10:Er,d=0,c=0;break;case 2:for(;c<16;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}if(i.flags=d,(255&i.flags)!==Sr){e.msg="unknown compression method",i.mode=Pr;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=Pr;break}i.head&&(i.head.text=d>>8&1),512&i.flags&&(P[0]=255&d,P[1]=d>>>8&255,i.check=jl(i.check,P,2,0)),d=0,c=0,i.mode=3;case 3:for(;c<32;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}i.head&&(i.head.time=d),512&i.flags&&(P[0]=255&d,P[1]=d>>>8&255,P[2]=d>>>16&255,P[3]=d>>>24&255,i.check=jl(i.check,P,4,0)),d=0,c=0,i.mode=4;case 4:for(;c<16;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}i.head&&(i.head.xflags=255&d,i.head.os=d>>8),512&i.flags&&(P[0]=255&d,P[1]=d>>>8&255,i.check=jl(i.check,P,2,0)),d=0,c=0,i.mode=5;case 5:if(1024&i.flags){for(;c<16;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}i.length=d,i.head&&(i.head.extra_len=d),512&i.flags&&(P[0]=255&d,P[1]=d>>>8&255,i.check=jl(i.check,P,2,0)),d=0,c=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(p=i.length,p>n&&(p=n),p&&(i.head&&(v=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(a.subarray(o,o+p),v)),512&i.flags&&(i.check=jl(i.check,a,p,o)),n-=p,o+=p,i.length-=p),i.length))break e;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===n)break e;p=0;do{v=a[o+p++],i.head&&v&&i.length<65536&&(i.head.name+=String.fromCharCode(v))}while(v&&p<n);if(512&i.flags&&(i.check=jl(i.check,a,p,o)),n-=p,o+=p,v)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===n)break e;p=0;do{v=a[o+p++],i.head&&v&&i.length<65536&&(i.head.comment+=String.fromCharCode(v))}while(v&&p<n);if(512&i.flags&&(i.check=jl(i.check,a,p,o)),n-=p,o+=p,v)break e}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;c<16;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}if(d!==(65535&i.check)){e.msg="header crc mismatch",i.mode=Pr;break}d=0,c=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=Er;break;case 10:for(;c<32;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}e.adler=i.check=kr(d),d=0,c=0,i.mode=11;case 11:if(0===i.havedict)return e.next_out=l,e.avail_out=r,e.next_in=o,e.avail_in=n,i.hold=d,i.bits=c,Ir;e.adler=i.check=1,i.mode=Er;case Er:if(t===ur||t===gr)break e;case 13:if(i.last){d>>>=7&c,c-=7&c,i.mode=27;break}for(;c<3;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}switch(i.last=1&d,d>>>=1,c-=1,3&d){case 0:i.mode=14;break;case 1:if(Dr(i),i.mode=20,t===gr){d>>>=2,c-=2;break e}break;case 2:i.mode=17;break;case 3:e.msg="invalid block type",i.mode=Pr}d>>>=2,c-=2;break;case 14:for(d>>>=7&c,c-=7&c;c<32;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}if((65535&d)!=(d>>>16^65535)){e.msg="invalid stored block lengths",i.mode=Pr;break}if(i.length=65535&d,d=0,c=0,i.mode=15,t===gr)break e;case 15:i.mode=16;case 16:if(p=i.length,p){if(p>n&&(p=n),p>r&&(p=r),0===p)break e;s.set(a.subarray(o,o+p),l),n-=p,o+=p,r-=p,l+=p,i.length-=p;break}i.mode=Er;break;case 17:for(;c<14;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}if(i.nlen=257+(31&d),d>>>=5,c-=5,i.ndist=1+(31&d),d>>>=5,c-=5,i.ncode=4+(15&d),d>>>=4,c-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=Pr;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;c<3;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}i.lens[_[i.have++]]=7&d,d>>>=3,c-=3}for(;i.have<19;)i.lens[_[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,k={bits:i.lenbits},S=hr(0,i.lens,0,19,i.lencode,0,i.work,k),i.lenbits=k.bits,S){e.msg="invalid code lengths set",i.mode=Pr;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;E=i.lencode[d&(1<<i.lenbits)-1],f=E>>>24,w=E>>>16&255,I=65535&E,!(f<=c);){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}if(I<16)d>>>=f,c-=f,i.lens[i.have++]=I;else{if(16===I){for(C=f+2;c<C;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}if(d>>>=f,c-=f,0===i.have){e.msg="invalid bit length repeat",i.mode=Pr;break}v=i.lens[i.have-1],p=3+(3&d),d>>>=2,c-=2}else if(17===I){for(C=f+3;c<C;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}d>>>=f,c-=f,v=0,p=3+(7&d),d>>>=3,c-=3}else{for(C=f+7;c<C;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}d>>>=f,c-=f,v=0,p=11+(127&d),d>>>=7,c-=7}if(i.have+p>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=Pr;break}for(;p--;)i.lens[i.have++]=v}}if(i.mode===Pr)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=Pr;break}if(i.lenbits=9,k={bits:i.lenbits},S=hr(1,i.lens,0,i.nlen,i.lencode,0,i.work,k),i.lenbits=k.bits,S){e.msg="invalid literal/lengths set",i.mode=Pr;break}if(i.distbits=6,i.distcode=i.distdyn,k={bits:i.distbits},S=hr(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,k),i.distbits=k.bits,S){e.msg="invalid distances set",i.mode=Pr;break}if(i.mode=20,t===gr)break e;case 20:i.mode=21;case 21:if(n>=6&&r>=258){e.next_out=l,e.avail_out=r,e.next_in=o,e.avail_in=n,i.hold=d,i.bits=c,lr(e,h),l=e.next_out,s=e.output,r=e.avail_out,o=e.next_in,a=e.input,n=e.avail_in,d=i.hold,c=i.bits,i.mode===Er&&(i.back=-1);break}for(i.back=0;E=i.lencode[d&(1<<i.lenbits)-1],f=E>>>24,w=E>>>16&255,I=65535&E,!(f<=c);){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}if(w&&0==(240&w)){for(x=f,y=w,b=I;E=i.lencode[b+((d&(1<<x+y)-1)>>x)],f=E>>>24,w=E>>>16&255,I=65535&E,!(x+f<=c);){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}d>>>=x,c-=x,i.back+=x}if(d>>>=f,c-=f,i.back+=f,i.length=I,0===w){i.mode=26;break}if(32&w){i.back=-1,i.mode=Er;break}if(64&w){e.msg="invalid literal/length code",i.mode=Pr;break}i.extra=15&w,i.mode=22;case 22:if(i.extra){for(C=i.extra;c<C;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}i.length+=d&(1<<i.extra)-1,d>>>=i.extra,c-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;E=i.distcode[d&(1<<i.distbits)-1],f=E>>>24,w=E>>>16&255,I=65535&E,!(f<=c);){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}if(0==(240&w)){for(x=f,y=w,b=I;E=i.distcode[b+((d&(1<<x+y)-1)>>x)],f=E>>>24,w=E>>>16&255,I=65535&E,!(x+f<=c);){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}d>>>=x,c-=x,i.back+=x}if(d>>>=f,c-=f,i.back+=f,64&w){e.msg="invalid distance code",i.mode=Pr;break}i.offset=I,i.extra=15&w,i.mode=24;case 24:if(i.extra){for(C=i.extra;c<C;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}i.offset+=d&(1<<i.extra)-1,d>>>=i.extra,c-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=Pr;break}i.mode=25;case 25:if(0===r)break e;if(p=h-r,i.offset>p){if(p=i.offset-p,p>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=Pr;break}p>i.wnext?(p-=i.wnext,u=i.wsize-p):u=i.wnext-p,p>i.length&&(p=i.length),g=i.window}else g=s,u=l-i.offset,p=i.length;p>r&&(p=r),r-=p,i.length-=p;do{s[l++]=g[u++]}while(--p);0===i.length&&(i.mode=21);break;case 26:if(0===r)break e;s[l++]=i.length,r--,i.mode=21;break;case 27:if(i.wrap){for(;c<32;){if(0===n)break e;n--,d|=a[o++]<<c,c+=8}if(h-=r,e.total_out+=h,i.total+=h,h&&(e.adler=i.check=i.flags?jl(i.check,s,h,l-h):Fl(i.check,s,h,l-h)),h=r,(i.flags?d:kr(d))!==i.check){e.msg="incorrect data check",i.mode=Pr;break}d=0,c=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;c<32;){if(0===n)break e;n--,d+=a[o++]<<c,c+=8}if(d!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=Pr;break}d=0,c=0}i.mode=29;case 29:S=wr;break e;case Pr:S=yr;break e;case 31:return br;default:return xr}return e.next_out=l,e.avail_out=r,e.next_in=o,e.avail_in=n,i.hold=d,i.bits=c,(i.wsize||h!==e.avail_out&&i.mode<Pr&&(i.mode<27||t!==pr))&&Ur(e,e.output,e.next_out,h-e.avail_out),m-=e.avail_in,h-=e.avail_out,e.total_in+=m,e.total_out+=h,i.total+=h,i.wrap&&h&&(e.adler=i.check=i.flags?jl(i.check,s,h,e.next_out-h):Fl(i.check,s,h,e.next_out-h)),e.data_type=i.bits+(i.last?64:0)+(i.mode===Er?128:0)+(20===i.mode||15===i.mode?256:0),(0===m&&0===h||t===pr)&&S===fr&&(S=vr),S},inflateEnd:e=>{if(!e||!e.state)return xr;let t=e.state;return t.window&&(t.window=null),e.state=null,fr},inflateGetHeader:(e,t)=>{if(!e||!e.state)return xr;const i=e.state;return 0==(2&i.wrap)?xr:(i.head=t,t.done=!1,fr)},inflateSetDictionary:(e,t)=>{const i=t.length;let a,s,o;return e&&e.state?(a=e.state,0!==a.wrap&&11!==a.mode?xr:11===a.mode&&(s=1,s=Fl(s,t,i,0),s!==a.check)?yr:(o=Ur(e,t,i,i),o?(a.mode=31,br):(a.havedict=1,fr))):xr},inflateInfo:"pako inflate (from Nodeca project)"};var Mr=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Wr=Object.prototype.toString,{Z_NO_FLUSH:Vr,Z_FINISH:Fr,Z_OK:zr,Z_STREAM_END:jr,Z_NEED_DICT:Hr,Z_STREAM_ERROR:Br,Z_DATA_ERROR:qr,Z_MEM_ERROR:$r}=Bl;function Kr(e){this.options=zn.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new qn,this.strm.avail_out=0;let i=Or.inflateInit2(this.strm,t.windowBits);if(i!==zr)throw new Error(Hl[i]);if(this.header=new Mr,Or.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Bn.string2buf(t.dictionary):"[object ArrayBuffer]"===Wr.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=Or.inflateSetDictionary(this.strm,t.dictionary),i!==zr)))throw new Error(Hl[i])}function Yr(e,t){const i=new Kr(t);if(i.push(e),i.err)throw i.msg||Hl[i.err];return i.result}Kr.prototype.push=function(e,t){const i=this.strm,a=this.options.chunkSize,s=this.options.dictionary;let o,l,n;if(this.ended)return!1;for(l=t===~~t?t:!0===t?Fr:Vr,"[object ArrayBuffer]"===Wr.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(a),i.next_out=0,i.avail_out=a),o=Or.inflate(i,l),o===Hr&&s&&(o=Or.inflateSetDictionary(i,s),o===zr?o=Or.inflate(i,l):o===qr&&(o=Hr));i.avail_in>0&&o===jr&&i.state.wrap>0&&0!==e[i.next_in];)Or.inflateReset(i),o=Or.inflate(i,l);switch(o){case Br:case qr:case Hr:case $r:return this.onEnd(o),this.ended=!0,!1}if(n=i.avail_out,i.next_out&&(0===i.avail_out||o===jr))if("string"===this.options.to){let e=Bn.utf8border(i.output,i.next_out),t=i.next_out-e,s=Bn.buf2string(i.output,e);i.next_out=t,i.avail_out=a-t,t&&i.output.set(i.output.subarray(e,e+t),0),this.onData(s)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(o!==zr||0!==n){if(o===jr)return o=Or.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},Kr.prototype.onData=function(e){this.chunks.push(e)},Kr.prototype.onEnd=function(e){e===zr&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=zn.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Jr={Inflate:Kr,inflate:Yr,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Yr(e,t)},ungzip:Yr,constants:Bl};const{Deflate:Zr,deflate:Qr,deflateRaw:Xr,gzip:ed}=or,{Inflate:td,inflate:id,inflateRaw:ad,ungzip:sd}=Jr;var od={Deflate:Zr,deflate:Qr,deflateRaw:Xr,gzip:ed,Inflate:td,inflate:id,inflateRaw:ad,ungzip:sd,constants:Bl};const ld={fixed:!1};class nd extends m{constructor(e,i,a={}){super(e,"close-button",document.createElement("a")),t(this,"config"),this.config={...ld,...a},this.config.fixed&&this.rootElem.classList.add("position-fixed"),this.rootElem.setAttribute("href","javascript:void(0)"),this.rootElem.setAttribute("role","button"),this.rootElem.addEventListener("click",(()=>i())),this.rootElem.insertAdjacentHTML("beforeend",'<i class="fas fa-times fa-2xl ms-1"></i>')}}const rd={closeButton:{},footer:!1,header:!0,scrollContents:!1,size:"lg",title:null};class dd extends m{constructor(e,i,a={}){super(e,"modal"),t(this,"modalConfig"),t(this,"modal"),t(this,"dialog"),t(this,"header"),t(this,"body"),t(this,"footer"),this.modalConfig={...rd,...a};const o=this.modalConfig.size&&"md"!=this.modalConfig.size?`modal-${this.modalConfig.size}`:"";this.rootElem.classList.add("fade"),this.rootElem.innerHTML=`\n\t\t\t<div class="modal-dialog ${i} ${o}">\n\t\t\t\t<div class="modal-content"></div>\n\t\t\t</div>\n\t\t`,this.dialog=this.rootElem.querySelector(".modal-dialog"),this.modalConfig.scrollContents&&this.dialog.classList.add("modal-overflow-scroll");const l=this.rootElem.querySelector(".modal-content");this.modalConfig.header&&(this.header=document.createElement("div"),this.header.classList.add("modal-header"),l.appendChild(this.header),this.modalConfig.title&&this.header.insertAdjacentHTML("afterbegin",`<h5 class="modal-title">${this.modalConfig.title}</h5>`)),this.body=document.createElement("div"),this.body.classList.add("modal-body"),l.appendChild(this.body),this.addCloseButton(),this.modalConfig.footer&&(this.footer=document.createElement("div"),this.footer.classList.add("modal-footer"),l.appendChild(this.footer)),this.modal=new s(this.rootElem),this.open(),this.rootElem.addEventListener("hidden.bs.modal",(e=>{this.rootElem.remove(),this.dispose()}))}addCloseButton(){new nd(this.header?this.header:this.body,(()=>this.close()),this.modalConfig.closeButton)}onShow(e){}open(){this.rootElem.addEventListener("show.bs.modal",(async e=>{e.stopImmediatePropagation();const t=await new Promise((e=>{setTimeout((()=>{this.modal._backdrop._element&&e(this.modal._backdrop._element)}),100)}));this.rootElem.insertAdjacentElement("afterend",t),this.onShow(e)})),this.rootElem.addEventListener("hide.bs.modal",(e=>{e.stopImmediatePropagation()})),this.rootElem.addEventListener("hidden.bs.modal",(e=>{e.stopPropagation()})),this.modal.show()}close(){this.modal.hide()}}class cd extends dd{constructor(e,i,a,s){super(e,"importer",{title:a,footer:!0}),t(this,"textElem"),t(this,"descriptionElem"),t(this,"importButton"),t(this,"includeFile"),this.includeFile=s;const o="upload-input-"+a.toLowerCase().replaceAll(" ","-");if(this.body.innerHTML='\n\t\t\t<div class="import-description"></div>\n\t\t\t<textarea spellCheck="false" class="importer-textarea form-control"></textarea>\n\t\t',this.footer.innerHTML=`\n\t\t\t${this.includeFile?`\n\t\t\t\t<label for="${o}" class="importer-button btn btn-primary upload-button me-2">\n\t\t\t\t\t<i class="fas fa-file-arrow-up"></i>\n\t\t\t\t\tUpload File\n\t\t\t\t</label>\n\t\t\t\t<input type="file" id="${o}" class="importer-upload-input d-none" hidden>\n\t\t\t`:""}\n\t\t\t<button class="importer-button btn btn-primary import-button">\n\t\t\t\t<i class="fa fa-download"></i>\n\t\t\t\tImport\n\t\t\t</button>\n\t\t`,this.textElem=this.rootElem.getElementsByClassName("importer-textarea")[0],this.descriptionElem=this.rootElem.getElementsByClassName("import-description")[0],this.includeFile){this.rootElem.getElementsByClassName("importer-upload-input")[0].addEventListener("change",(async e=>{const t=await e.target.files[0].text();this.textElem.textContent=t}))}this.importButton=this.rootElem.getElementsByClassName("import-button")[0],this.importButton.addEventListener("click",(async()=>{try{await this.onImport(this.textElem.value||"")}catch(e){alert(`Import error:\n${e?.message}`)}}))}async finishIndividualImport(e,t,i,a,s,o,n,r){const d=e.player.getClass();if(t!=d)throw new Error(`Wrong Class! Expected ${wt.get(d)} but found ${wt.get(t)}!`);await Pe.loadLeftoversIfNecessary(s);const c=e.sim.db.lookupEquipmentSpec(s),m=s.items.map((e=>e.enchant)),h=c.asSpec().items.map((e=>e.enchant)),p=m.filter((e=>0!=e&&!h.includes(e))),u=s.items.map((e=>e.id)),g=c.asSpec().items.map((e=>e.id)),f=u.filter((e=>!g.includes(e))),w=l.nextEventID();l.freezeAllAndDo((()=>{e.player.setRace(w,i),e.player.setGear(w,c),e.player.setLevel(w,a),o&&"--"!=o&&e.player.setTalentsString(w,o),n&&e.player.setGlyphs(w,n),r.length>0&&e.player.setProfessions(w,r)})),this.close(),0==f.length&&0==p.length?alert("Import successful!"):alert("Import successful, but the following IDs were not found in the sim database:"+(0==f.length?"":"\n\nItems: "+f.join(", "))+(0==p.length?"":"\n\nEnchants: "+p.join(", ")))}}const md=class{static tryParseUrlLocation(e){let t=e.hash;if(t.length<=1)return null;t=t.substring(1);const i=atob(t),a=new Uint8Array(i.length);for(let r=0;r<a.length;r++)a[r]=i.charCodeAt(r);const s=od.inflate(a),o=ct.fromBinary(s);let l=md.DEFAULT_CATEGORIES;const n=new URLSearchParams(window.location.search);if(n.has(md.CATEGORY_PARAM)){l=n.get(md.CATEGORY_PARAM).split("").map((e=>[...md.CATEGORY_KEYS.entries()].find((t=>t[1]==e)))).filter((e=>e)).map((e=>e[0]))}return{settings:o,categories:l}}};let hd=md;t(hd,"DEFAULT_CATEGORIES",tt(Qo).filter((e=>e!=Qo.UISettings))),t(hd,"CATEGORY_PARAM","i"),t(hd,"CATEGORY_KEYS",(()=>{const e=new Map;return e.set(Qo.Gear,"g"),e.set(Qo.Talents,"t"),e.set(Qo.Rotation,"r"),e.set(Qo.Consumes,"c"),e.set(Qo.Miscellaneous,"m"),e.set(Qo.External,"x"),e.set(Qo.Encounter,"e"),e.set(Qo.UISettings,"u"),e})());class pd extends cd{constructor(e,i){super(e,i,"JSON Import",!0),t(this,"simUI"),this.simUI=i,this.descriptionElem.innerHTML="\n\t\t\t<p>Import settings from a JSON file, which can be created using the JSON Export feature.</p>\n\t\t\t<p>To import, upload the file or paste the text below, then click, 'Import'.</p>\n\t\t"}async onImport(e){const t=ct.fromJsonString(e,{ignoreUnknownFields:!0});t.player?.equipment&&await Pe.loadLeftoversIfNecessary(t.player.equipment),this.simUI.isWithinRaidSim?t.player&&this.simUI.player.fromProto(l.nextEventID(),t.player):this.simUI.fromProto(l.nextEventID(),t),this.close()}}class ud extends cd{constructor(e,i){super(e,i,"80 Upgrades Import",!0),t(this,"simUI"),this.simUI=i,this.descriptionElem.innerHTML='\n\t\t\t<p>\n\t\t\t\tImport settings from <a href="https://eightyupgrades.com" target="_blank">Eighty Upgrades</a>.\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\tThis feature imports gear, race, and (optionally) talents. It does NOT import buffs, debuffs, consumes, rotation, or custom stats.\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\tTo import, paste the output from the site\'s export option below and click, \'Import\'.\n\t\t\t</p>\n\t\t'}async onImport(e){const t=JSON.parse(e),i=t?.character?.level,a=mt(t?.character?.gameClass||"");if(a==d.ClassUnknown)throw new Error("Could not parse Class!");const s=ht(t?.character?.race||"");if(s==pt.RaceUnknown)throw new Error("Could not parse Race!");let o="";if(t?.talents?.length>0){o=function(e,t){return Uo[e].map((e=>e.talents.map((e=>{const i=e.spellIds.findIndex((e=>t.includes(e)));return-1==i?"0":String(i+1)})).join("").replace(/0+$/g,""))).join("-").replace(/-+$/g,"")}(a,t.talents.map((e=>e.spellId)))}const l=gt.create();t.items.forEach((e=>{const t=ft.create();t.id=e.id,e.enchant?.id&&(t.enchant=e.enchant.id),e.gems&&(t.gems=e.gems.filter((e=>e?.id)).map((e=>e.id))),l.items.push(t)})),this.simUI.sim.db.lookupEquipmentSpec(l),this.finishIndividualImport(this.simUI,a,s,i,l,o,null,[])}}const gd=class extends cd{constructor(e,i){super(e,i,"Wowhead Import",!0),t(this,"simUI"),this.simUI=i,this.descriptionElem.innerHTML='\n\t\t\t<p>\n\t\t\t\tImport settings from <a href="https://www.wowhead.com/wotlk/gear-planner" target="_blank">Wowhead Gear Planner</a>.\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\tThis feature imports gear, race, and (optionally) talents. It does NOT import buffs, debuffs, consumes, rotation, or custom stats.\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\tTo import, paste the gear planner link below and click, \'Import\'.\n\t\t\t</p>\n\t\t'}async onImport(e){const t=e.match(/www\.wowhead\.com\/wotlk\/gear-planner\/([a-z\-]+)\/([a-z\-]+)\/([a-zA-Z0-9_\-]+)/);if(!t)throw new Error(`Invalid WowHead URL ${e}, must look like "https://www.wowhead.com/wotlk/gear-planner/CLASS/RACE/XXXX"`);const i=mt(t[1].replaceAll("-",""));if(i==d.ClassUnknown)throw new Error("Could not parse Class: "+t[1]);const a=ht(t[2].replaceAll("-",""));if(a==pt.RaceUnknown)throw new Error("Could not parse Race: "+t[2]);const s=t[3].replaceAll("_","/").replaceAll("-","+"),o=Uint8Array.from(atob(s),(e=>e.charCodeAt(0))),l=o[2],n=o[3],r=o.subarray(4,4+n),c=ut(r).split("f").slice(0,3).join("-");let m=4+n;const h=o[m];m++;const p=o.subarray(m,m+h),u=o.subarray(m+h);m=1;let g=!1;const f="0123456789abcdefghjkmnpqrstvwxyz",w=String.fromCharCode(...p),I=[0,0,0,0,0,0];for(;m<p.length;){const e=f.indexOf(w[m]);m++;const t=0+(f.indexOf(w[m+0])<<15)+(f.indexOf(w[m+1])<<10)+(f.indexOf(w[m+2])<<5)+(f.indexOf(w[m+3])<<0),i=this.simUI.sim.db.glyphSpellToItemId(t);g=!0,I[e]=i,m+=4}const x=K.create({major1:I[0],major2:I[1],major3:I[2],minor1:I[3],minor2:I[4],minor3:I[5]}),y=gt.create();for(m=0;m<u.length;){const e=ft.create(),t=63&u[m],i=Boolean(128&u[m]);Boolean(64&u[m]),m++;const a=(224&u[m])>>5,s=31&u[m];if(m++,e.id=(s<<16)+(u[m]<<8)+u[m+1],m+=2,i){const t=(u[m]<<16)+(u[m+1]<<8)+u[m+2];e.enchant=this.simUI.sim.db.enchantSpellIdToEffectId(t),m+=3}for(let o=0;o<a;o++){const t=(224&u[m])>>5,i=31&u[m];m++;const a=(i<<16)+(u[m]<<8)+u[m+1];for(m+=2,e.gems||(e.gems=[]);e.gems.length<t;)e.gems.push(0);e.gems[t]=a}null!=Object.entries(gd.slotIDs).find((e=>e[1]==t))&&y.items.push(e)}this.simUI.sim.db.lookupEquipmentSpec(y),this.finishIndividualImport(this.simUI,i,a,l,y,c,g?x:null,[])}};let fd=gd;t(fd,"slotIDs",{[Q.ItemSlotHead]:1,[Q.ItemSlotNeck]:2,[Q.ItemSlotShoulder]:3,[Q.ItemSlotBack]:15,[Q.ItemSlotChest]:5,[Q.ItemSlotWrist]:9,[Q.ItemSlotHands]:10,[Q.ItemSlotWaist]:6,[Q.ItemSlotLegs]:7,[Q.ItemSlotFeet]:8,[Q.ItemSlotFinger1]:11,[Q.ItemSlotFinger2]:12,[Q.ItemSlotTrinket1]:13,[Q.ItemSlotTrinket2]:14,[Q.ItemSlotMainHand]:16,[Q.ItemSlotOffHand]:17,[Q.ItemSlotRanged]:18});class wd extends cd{constructor(e,i){super(e,i,"Addon Import",!0),t(this,"simUI"),this.simUI=i,this.descriptionElem.innerHTML='\n\t\t\t<p>\n\t\t\t\tImport settings from the <a href="https://github.com/WoWLegacySims/exporter/releases" target="_blank">WoWSims Importer In-Game Addon</a>.\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\tThis feature imports gear, race, talents, glyphs, and professions. It does NOT import buffs, debuffs, consumes, rotation, or custom stats.\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\tTo import, paste the output from the addon below and click, \'Import\'.\n\t\t\t</p>\n\t\t'}async onImport(e){const t=JSON.parse(e),i=mt(t.class||"");if(i==d.ClassUnknown)throw new Error("Could not parse Class!");const a=ht(t.race||"");if(a==pt.RaceUnknown)throw new Error("Could not parse Race!");const s=t.level,o=t.professions.map((e=>It(e.name)));o.forEach(((e,i)=>{if(e==ae.ProfessionUnknown)throw new Error(`Could not parse profession '${t.professions[i]}'`)}));const l=t.talents||"",n=Oo[i],r=await Pe.get(),c=t.glyphs.major.map((e=>Id(e,r,n.majorGlyphs))),m=t.glyphs.minor.map((e=>Id(e,r,n.minorGlyphs))),h=K.create({major1:c[0]||0,major2:c[1]||0,major3:c[2]||0,minor1:m[0]||0,minor2:m[1]||0,minor3:m[2]||0}),p=t.gear;p.items=p.items.filter((e=>null!=e)),delete p.version,p.items.forEach((e=>{e.gems&&(e.gems=e.gems.map((e=>e||0)))}));const u=gt.fromJson(p);this.finishIndividualImport(this.simUI,i,s,a,u,l,h,o)}}function Id(e,t,i){return"string"==typeof e?function(e,t){if(!e)return 0;for(const i in t)if(t[i].name==e)return parseInt(i);throw new Error(`Unknown glyph name '${e}'`)}(e,i):t.glyphSpellToItemId(e.spellID)}class xd extends dd{constructor(e,i,a){if(super(e,"exporter",{title:a.title,header:a.header,footer:!0}),t(this,"textElem"),t(this,"changedEvent",new l),this.body.innerHTML='\n\t\t\t<textarea spellCheck="false" class="exporter-textarea form-control"></textarea>\n\t\t',this.textElem=this.rootElem.getElementsByClassName("exporter-textarea")[0],new co(this.footer,{extraCssClasses:["btn-primary","me-2"],getContent:()=>this.textElem.innerHTML,text:"Copy",tooltip:"Copy to clipboard"}),a.allowDownload){const e=p();this.footer.appendChild(h("button",{className:"exporter-button btn btn-primary download-button",ref:e},h("i",{className:"fa fa-download me-1"}),"Download"));e.value.addEventListener("click",(e=>{const t=this.textElem.textContent;St(t,"wowsims.json")}))}}init(){this.changedEvent.on((()=>this.updateContent())),this.updateContent()}updateContent(){this.textElem.textContent=this.getData()}}const yd=class extends xd{constructor(e,i){super(e,i,{title:"Sharable Link",header:!0}),t(this,"simUI"),t(this,"exportCategories"),this.simUI=i;const a={};tt(Qo).forEach((e=>a[e]=hd.DEFAULT_CATEGORIES.includes(e))),this.exportCategories=a;const s=document.createElement("div");s.classList.add("link-exporter-pickers"),this.body.prepend(s),yd.exportPickerConfigs.forEach((e=>{const t=e.category;new xt(s,this,{label:e.label,labelTooltip:e.labelTooltip,inline:!0,getValue:()=>this.exportCategories[t],setValue:(e,i,a)=>{this.exportCategories[t]=a,this.changedEvent.emit(e)},changedEvent:()=>this.changedEvent})})),this.init()}getData(){return yd.createLink(this.simUI,tt(Qo).filter((e=>this.exportCategories[e])))}static createLink(e,t){t||(t=hd.DEFAULT_CATEGORIES);const i=e.toProto(t),a=ct.toBinary(i),s=od.deflate(a,{to:"string"}),o=btoa(String.fromCharCode(...s)),l=new URL(window.location.href);if(l.hash=o,yt(t,hd.DEFAULT_CATEGORIES))l.searchParams.delete(hd.CATEGORY_PARAM);else{const e=t.map((e=>hd.CATEGORY_KEYS.get(e))).join("");l.searchParams.set(hd.CATEGORY_PARAM,e)}return l.toString()}};let bd=yd;t(bd,"exportPickerConfigs",[{category:Qo.Gear,label:"Gear",labelTooltip:"Also includes bonus stats and weapon swaps."},{category:Qo.Talents,label:"Talents",labelTooltip:"Talents and Glyphs."},{category:Qo.Rotation,label:"Rotation",labelTooltip:"Includes everything found in the Rotation tab."},{category:Qo.Consumes,label:"Consumes",labelTooltip:"Flask, pots, food, etc."},{category:Qo.External,label:"Buffs & Debuffs",labelTooltip:"All settings which are applied by other raid members."},{category:Qo.Miscellaneous,label:"Misc",labelTooltip:"Spec-specific settings, front/back of target, distance from target, etc."},{category:Qo.Encounter,label:"Encounter",labelTooltip:"Fight-related settings."}]);class vd extends xd{constructor(e,i){super(e,i,{title:"JSON Export",allowDownload:!0}),t(this,"simUI"),this.simUI=i,this.init()}getData(){return Et(ct.toJson(this.simUI.toProto()),2,((e,t)=>!!["stats","pseudoStats"].includes(t[t.length-1])||(["player","equipment","items"].every(((e,i)=>t[i]==e))||!("player"!=t[0]||"rotation"!=t[1]||!["prepullActions","priorityList"].includes(t[2])))&&t.length>3))}}class Sd extends xd{constructor(e,i){super(e,i,{title:"Wowhead Export",allowDownload:!0}),t(this,"simUI"),this.simUI=i,this.init()}getData(){const e=this.simUI.player,t=`https://www.wowhead.com/wotlk/gear-planner/${wt.get(e.getClass()).replaceAll(" ","-").toLowerCase()}/${Pt.get(e.getRace()).replaceAll(" ","-").toLowerCase()}/`;let i=[];i.push(6),i.push(0),i.push(e.getLevel());let a=e.getTalentsString().replaceAll("-","f")+"f";a.length%2==1&&(a+="0"),i.push(a.length/2);for(let u=0;u<a.length;u+=2)i.push(parseInt(a.substring(u,u+2),16));const s=[];let o="";const l=e.getGlyphs(),n="0123456789abcdefghjkmnpqrstvwxyz",r=(e,t)=>{const i=this.simUI.sim.db.glyphItemToSpellId(e);i&&(o+=n[t],o+=n[i>>15&31],o+=n[i>>10&31],o+=n[i>>5&31],o+=n[i>>0&31])};if(r(l.major1,0),r(l.major2,1),r(l.major3,2),r(l.minor1,3),r(l.minor2,4),r(l.minor3,5),o){s.push(48);for(let e=0;e<o.length;e++)s.push(o.charCodeAt(e))}i.push(s.length),i=i.concat(s);const d=e=>[(65280&e)>>8,255&e],c=e.getGear(),m=e.isBlacksmithing(),h=e.canUseExtraSockets();c.getItemSlots().sort(((e,t)=>fd.slotIDs[e]-fd.slotIDs[t])).forEach((e=>{const t=c.getEquippedItem(e);if(!t)return;let a=fd.slotIDs[e];t.enchant&&(a|=128),i.push(a),i.push(t.curEquippedGems(m,h).length<<5),i=i.concat(d(t.item.id)),t.enchant&&(i.push(0),i=i.concat(d(t.enchant.spellId))),t.gems.slice(0,t.numSockets(m,h)).forEach(((e,t)=>{e&&(i.push(t<<5),i=i.concat(d(e.id)))}))}));const p=String.fromCharCode(...i);return t+btoa(p).replaceAll("/","_").replaceAll("+","-").replace(/=+$/,"")}}const Ed=class extends xd{constructor(e,i){super(e,i,{title:"80Upgrades EP Export",allowDownload:!0}),t(this,"simUI"),this.simUI=i,this.init()}getData(){const e=this.simUI.player,t=e.getEpWeights(),i=bt.getAll(),a={};return i.forEach((e=>{const i=Ed.getName(e),s=t.getUnitStat(e);0!=s&&""!=i&&(a[i]?a[i]+=s:a[i]=s)})),`https://eightyupgrades.com/ep/import?name=${encodeURIComponent(`${vt[e.spec]} WoWSims Weights`)}`+Object.keys(a).map((e=>`&${e}=${a[e].toFixed(3)}`)).join("")}static getName(e){return e.isStat()?Ed.statNames[e.getStat()]:Ed.pseudoStatNames[e.getPseudoStat()]||""}};let Pd=Ed;t(Pd,"statNames",{[le.StatStrength]:"strength",[le.StatAgility]:"agility",[le.StatStamina]:"stamina",[le.StatIntellect]:"intellect",[le.StatSpirit]:"spirit",[le.StatSpellPower]:"spellDamage",[le.StatMP5]:"mp5",[le.StatSpellHit]:"hitRating",[le.StatSpellCrit]:"critRating",[le.StatSpellHaste]:"hasteRating",[le.StatSpellPenetration]:"spellPen",[le.StatAttackPower]:"attackPower",[le.StatMeleeHit]:"hitRating",[le.StatMeleeCrit]:"critRating",[le.StatMeleeHaste]:"hasteRating",[le.StatArmorPenetration]:"armorPenRating",[le.StatExpertise]:"expertiseRating",[le.StatMana]:"mana",[le.StatEnergy]:"energy",[le.StatRage]:"rage",[le.StatArmor]:"armor",[le.StatRangedAttackPower]:"attackPower",[le.StatDefense]:"defenseRating",[le.StatBlock]:"blockRating",[le.StatBlockValue]:"blockValue",[le.StatDodge]:"dodgeRating",[le.StatParry]:"parryRating",[le.StatResilience]:"resilienceRating",[le.StatHealth]:"health",[le.StatArcaneResistance]:"arcaneResistance",[le.StatFireResistance]:"fireResistance",[le.StatFrostResistance]:"frostResistance",[le.StatNatureResistance]:"natureResistance",[le.StatShadowResistance]:"shadowResistance",[le.StatBonusArmor]:"armorBonus",[le.StatRunicPower]:"runicPower",[le.StatBloodRune]:"bloodRune",[le.StatFrostRune]:"frostRune",[le.StatUnholyRune]:"unholyRune",[le.StatDeathRune]:"deathRune"}),t(Pd,"pseudoStatNames",{[ge.PseudoStatMainHandDps]:"dps",[ge.PseudoStatRangedDps]:"rangedDps"});const kd=class extends xd{constructor(e,i){super(e,i,{title:"Pawn EP Export",allowDownload:!0}),t(this,"simUI"),this.simUI=i,this.init()}getData(){const e=this.simUI.player,t=e.getEpWeights(),i=bt.getAll(),a={};return i.forEach((e=>{const i=kd.getName(e),s=t.getUnitStat(e);0!=s&&""!=i&&(a[i]?a[i]+=s:a[i]=s)})),`( Pawn: v1: "${vt[e.spec]} WoWSims Weights": Class=${wt.get(e.getClass())},`+Object.keys(a).map((e=>`${e}=${a[e].toFixed(3)}`)).join(",")+" )"}static getName(e){return e.isStat()?kd.statNames[e.getStat()]:kd.pseudoStatNames[e.getPseudoStat()]||""}};let Cd=kd;t(Cd,"statNames",{[le.StatStrength]:"Strength",[le.StatAgility]:"Agility",[le.StatStamina]:"Stamina",[le.StatIntellect]:"Intellect",[le.StatSpirit]:"Spirit",[le.StatSpellPower]:"SpellDamage",[le.StatMP5]:"Mp5",[le.StatSpellHit]:"HitRating",[le.StatSpellCrit]:"CritRating",[le.StatSpellHaste]:"HasteRating",[le.StatSpellPenetration]:"SpellPen",[le.StatAttackPower]:"Ap",[le.StatMeleeHit]:"HitRating",[le.StatMeleeCrit]:"CritRating",[le.StatMeleeHaste]:"HasteRating",[le.StatArmorPenetration]:"ArmorPenetration",[le.StatExpertise]:"ExpertiseRating",[le.StatMana]:"Mana",[le.StatEnergy]:"Energy",[le.StatRage]:"Rage",[le.StatArmor]:"Armor",[le.StatRangedAttackPower]:"Ap",[le.StatDefense]:"DefenseRating",[le.StatBlock]:"BlockRating",[le.StatBlockValue]:"BlockValue",[le.StatDodge]:"DodgeRating",[le.StatParry]:"ParryRating",[le.StatResilience]:"ResilienceRating",[le.StatHealth]:"Health",[le.StatArcaneResistance]:"ArcaneResistance",[le.StatFireResistance]:"FireResistance",[le.StatFrostResistance]:"FrostResistance",[le.StatNatureResistance]:"NatureResistance",[le.StatShadowResistance]:"ShadowResistance",[le.StatBonusArmor]:"Armor2",[le.StatRunicPower]:"RunicPower",[le.StatBloodRune]:"BloodRune",[le.StatFrostRune]:"FrostRune",[le.StatUnholyRune]:"UnholyRune",[le.StatDeathRune]:"DeathRune"}),t(Cd,"pseudoStatNames",{[ge.PseudoStatMainHandDps]:"MeleeDps",[ge.PseudoStatRangedDps]:"RangedDps"});class _d extends xd{constructor(e,i){super(e,i,{title:"CLI Export",allowDownload:!0}),t(this,"simUI"),this.simUI=i,this.init()}getData(){const e=Ke.toJson(this.simUI.sim.makeRaidSimRequest(!1));return delete e.raid?.parties[0]?.players[0]?.database,JSON.stringify(e,null,2)}}class Nd extends m{constructor(e,i,a){super(e,"content-block",a.rootElem),t(this,"headerElement"),t(this,"bodyElement"),t(this,"config"),this.config=a,this.rootElem.classList.add(i),a.extraCssClasses&&this.rootElem.classList.add(...a.extraCssClasses),this.headerElement=this.buildHeader(),this.bodyElement=this.buildBody(),a.bodyClasses?.forEach((e=>{this.bodyElement.classList.add(e)}))}buildHeader(){if(this.config.header&&Object.keys(this.config.header).length){let e=this.config.header.titleTag||"h6",t=h("div",{className:"content-block-header"},h(e,{className:"content-block-title"},this.config.header.title));return this.config.header.extraCssClasses&&t.classList.add(...this.config.header.extraCssClasses),this.config.header.tooltip&&i.getOrCreateInstance(t.querySelector(".content-block-title"),{html:!0,title:this.config.header.tooltip}),this.rootElem.appendChild(t),t}return null}buildBody(){let e=document.createElement("div");return e.classList.add("content-block-body"),this.rootElem.appendChild(e),e}}const Td={[lt.ItemQualityJunk]:"item-quality-junk",[lt.ItemQualityCommon]:"item-quality-common",[lt.ItemQualityUncommon]:"item-quality-uncommon",[lt.ItemQualityRare]:"item-quality-rare",[lt.ItemQualityEpic]:"item-quality-epic",[lt.ItemQualityLegendary]:"item-quality-legendary",[lt.ItemQualityArtifact]:"item-quality-artifact",[lt.ItemQualityHeirloom]:"item-quality-heirloom"};function Rd(e,t){Object.values(Td).forEach((t=>e.classList.remove(t))),t&&e.classList.add(Td[t])}let Ld=null;async function Gd(e){return(await(null==Ld&&(Ld=fetch("/sims/wotlk/all/assets/enchants/descriptions.json").then((e=>e.json())).then((e=>{const t={};for(let i in e)t[parseInt(i)]=e[i];return t}))),Ld))[e.effectId]||e.name}function Ad(e){return e.effectId+"-"+e.type}class Dd extends u{constructor(e,i,a){super(e,"enum-picker-root",i,a),t(this,"selectElem"),this.selectElem=document.createElement("select"),this.selectElem.classList.add("enum-picker-selector","form-select"),a.values.forEach((e=>{const t=document.createElement("option");t.value=String(e.value),t.textContent=e.name,this.selectElem.appendChild(t),e.tooltip&&(t.title=e.tooltip)})),this.rootElem.appendChild(this.selectElem),this.init(),this.selectElem.addEventListener("change",(e=>{this.inputChanged(l.nextEventID())}))}getInputElem(){return this.selectElem}getInputValue(){return parseInt(this.selectElem.value)}setInputValue(e){this.selectElem.value=String(e)}}const Ud={[be.UNSPECIFIED]:"None",[be.ALLIANCE_ONLY]:"Alliance only",[be.HORDE_ONLY]:"Horde only"},Od={[lt.ItemQualityJunk]:"Junk",[lt.ItemQualityCommon]:"Common",[lt.ItemQualityUncommon]:"Uncommon",[lt.ItemQualityRare]:"Rare",[lt.ItemQualityEpic]:"Epic",[lt.ItemQualityLegendary]:"Legendary",[lt.ItemQualityHeirloom]:"Heirloom",[lt.ItemQualityArtifact]:"Artifact"};class Md extends dd{constructor(e,t){super(e,"filters-menu",{size:"md",title:"Filters"})}newSection(e){const t=document.createElement("div");return t.classList.add("menu-section"),this.body.appendChild(t),t.innerHTML=`\n\t\t\t<div class="menu-section-header">\n\t\t\t\t<h6 class="menu-section-title">${e}</h6>\n\t\t\t</div>\n\t\t\t<div class="menu-section-content"></div>\n\t\t`,t.getElementsByClassName("menu-section-content")[0]}}class Wd extends Md{constructor(e,t){super(e,t);const i=this.newSection("Item Quality");i.classList.add("filters-menu-section-bool-list"),[lt.ItemQualityCommon,lt.ItemQualityUncommon,lt.ItemQualityRare,lt.ItemQualityEpic].forEach((e=>{new xt(i,t.sim,{label:Od[e],inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:t=>t.getFilters().itemQualities.includes(e),setValue:(t,i,a)=>{const s=i.getFilters();a?s.itemQualities.push(e):s.itemQualities=s.itemQualities.filter((t=>t!=e)),i.setFilters(t,s)}})}))}}class Vd extends Md{constructor(e,t,i){super(e,t);const a=this.newSection("Item Level");a.classList.add("filters-menu-section-number-list"),new il(a,t.sim,{label:"Min Item Level",float:!1,positive:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().minIlvl,setValue:(e,t,i)=>{const a=t.getFilters();a.minIlvl=i,t.setFilters(e,a)}}),new il(a,t.sim,{label:"Max Item Level",float:!1,positive:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().maxIlvl,setValue:(e,t,i)=>{const a=t.getFilters();a.maxIlvl=i,t.setFilters(e,a)}});let s=this.newSection("Item Quality");s.classList.add("filters-menu-section-bool-list"),[lt.ItemQualityJunk,lt.ItemQualityCommon,lt.ItemQualityUncommon,lt.ItemQualityRare,lt.ItemQualityEpic,lt.ItemQualityLegendary,lt.ItemQualityHeirloom].forEach((e=>{new xt(s,t.sim,{label:Od[e],inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:t=>t.getFilters().itemQualities.includes(e),setValue:(t,i,a)=>{const s=i.getFilters();a?s.itemQualities.push(e):s.itemQualities=s.itemQualities.filter((t=>t!=e)),i.setFilters(t,s)}})})),s=this.newSection("Factions"),new Dd(s,t.sim,{label:"Faction Restrictions",values:[be.UNSPECIFIED,be.ALLIANCE_ONLY,be.HORDE_ONLY].map((e=>({name:Ud[e],value:e}))),changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().factionRestriction,setValue:(e,t,i)=>{const a=t.getFilters();a.factionRestriction=i,t.setFilters(e,a)}}),s=this.newSection("Source"),s.classList.add("filters-menu-section-bool-list");el.ALL_SOURCES.filter((e=>e!=Ie.SourceUnknown)).forEach((e=>{new xt(s,t.sim,{label:kt.get(e),inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:t=>t.getFilters().sources.includes(e),setValue:(t,i,a)=>{const s=i.getFilters();a?s.sources.push(e):s.sources=s.sources.filter((t=>t!=e)),i.setFilters(t,s)}})})),s=this.newSection("Raids"),s.classList.add("filters-menu-section-bool-list");if(el.ALL_RAIDS.filter((e=>e!=ye.RaidUnknown)).forEach((e=>{new xt(s,t.sim,{label:Ct.get(e),inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:t=>t.getFilters().raids.includes(e),setValue:(t,i,a)=>{const s=i.getFilters();a?s.raids.push(e):s.raids=s.raids.filter((t=>t!=e)),i.setFilters(t,s)}})})),Bo.ARMOR_SLOTS.includes(i)){const e=_t[t.getClass()];if(e>=at.ArmorTypeLeather){const i=this.newSection("Armor Type");i.classList.add("filters-menu-section-bool-list");tt(at).filter((e=>e!=at.ArmorTypeUnknown)).filter((t=>t<=e)).forEach((e=>{new xt(i,t.sim,{label:Nt.get(e),inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:t=>t.getFilters().armorTypes.includes(e),setValue:(t,i,a)=>{const s=i.getFilters();a?s.armorTypes.push(e):s.armorTypes=s.armorTypes.filter((t=>t!=e)),i.setFilters(t,s)}})}))}}else if(Bo.WEAPON_SLOTS.includes(i)){const e=this.newSection("Weapon Type");e.classList.add("filters-menu-section-bool-list");Tt[t.getClass()].map((e=>e.weaponType)).forEach((i=>{new xt(e,t.sim,{label:Rt.get(i),inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().weaponTypes.includes(i),setValue:(e,t,a)=>{const s=t.getFilters();a?s.weaponTypes.push(i):s.weaponTypes=s.weaponTypes.filter((e=>e!=i)),t.setFilters(e,s)}})}));const i=this.newSection("Weapon Speed");i.classList.add("filters-menu-section-number-list"),new il(i,t.sim,{label:"Min MH Speed",float:!0,positive:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().minMhWeaponSpeed,setValue:(e,t,i)=>{const a=t.getFilters();a.minMhWeaponSpeed=i,t.setFilters(e,a)}}),new il(i,t.sim,{label:"Max MH Speed",float:!0,positive:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().maxMhWeaponSpeed,setValue:(e,t,i)=>{const a=t.getFilters();a.maxMhWeaponSpeed=i,t.setFilters(e,a)}}),Lt(t.spec)&&(new il(i,t.sim,{label:"Min OH Speed",float:!0,positive:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().minOhWeaponSpeed,setValue:(e,t,i)=>{const a=t.getFilters();a.minOhWeaponSpeed=i,t.setFilters(e,a)}}),new il(i,t.sim,{label:"Max OH Speed",float:!0,positive:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().maxOhWeaponSpeed,setValue:(e,t,i)=>{const a=t.getFilters();a.maxOhWeaponSpeed=i,t.setFilters(e,a)}}))}else if(i==Q.ItemSlotRanged){const e=Gt[t.getClass()];if(e.length<=1)return;const i=this.newSection("Ranged Weapon Type");i.classList.add("filters-menu-section-bool-list"),e.forEach((e=>{new xt(i,t.sim,{label:At.get(e),inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:t=>t.getFilters().rangedWeaponTypes.includes(e),setValue:(t,i,a)=>{const s=i.getFilters();a?s.rangedWeaponTypes.push(e):s.rangedWeaponTypes=s.rangedWeaponTypes.filter((t=>t!=e)),i.setFilters(t,s)}})}));const a=this.newSection("Ranged Weapon Speed");a.classList.add("filters-menu-section-number-list"),new il(a,t.sim,{label:"Min Ranged Speed",float:!0,positive:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().minRangedWeaponSpeed,setValue:(e,t,i)=>{const a=t.getFilters();a.minRangedWeaponSpeed=i,t.setFilters(e,a)}}),new il(a,t.sim,{label:"Max Ranged Speed",float:!0,positive:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().maxRangedWeaponSpeed,setValue:(e,t,i)=>{const a=t.getFilters();a.maxRangedWeaponSpeed=i,t.setFilters(e,a)}})}}}const Fd={type:"number",label:"Reaction Time",labelTooltip:"Reaction time of the player, in milliseconds. Used with certain APL values (such as 'Aura Is Active With Reaction Time').",changedEvent:e=>e.miscOptionsChangeEmitter,getValue:e=>e.getReactionTime(),setValue:(e,t,i)=>{t.setReactionTime(e,i)}},zd={type:"number",label:"Channel Clip Delay",labelTooltip:"Clip delay following channeled spells, in milliseconds. This delay occurs following any full or partial channel ending after the GCD becomes available, due to the player not being able to queue the next spell.",changedEvent:e=>e.miscOptionsChangeEmitter,getValue:e=>e.getChannelClipDelay(),setValue:(e,t,i)=>{t.setChannelClipDelay(e,i)}},jd={type:"boolean",label:"In Front of Target",labelTooltip:"Stand in front of the target, causing Blocks and Parries to be included in the attack table.",changedEvent:e=>e.inFrontOfTargetChangeEmitter,getValue:e=>e.getInFrontOfTarget(),setValue:(e,t,i)=>{t.setInFrontOfTarget(e,i)}},Hd={type:"number",label:"Distance From Target",labelTooltip:"Distance from targets, in yards. Used to calculate travel time for certain spells.",changedEvent:e=>e.distanceFromTargetChangeEmitter,getValue:e=>e.getDistanceFromTarget(),setValue:(e,t,i)=>{t.setDistanceFromTarget(e,i)}},Bd={type:"number",label:"Nibelung's Valkyr Survival (in # of casts)",labelTooltip:"Number of casts of Nibelung's summoned Valkyrs get out before they die (max 16)",changedEvent:e=>e.changeEmitter,getValue:e=>e.getNibelungAverageCasts(),setValue:(e,t,i)=>{t.setNibelungAverageCastsSet(e,!0),t.setNibelungAverageCasts(e,i)},showWhen:e=>[49992,50648].includes(e.getEquippedItem(Q.ItemSlotMainHand)?.id||0)},qd={type:"enum",extraCssClasses:["tank-selector","threat-metrics","within-raid-sim-hide"],label:"Tank Assignment",labelTooltip:"Determines which mobs will be tanked. Most mobs default to targeting the Main Tank, but in preset multi-target encounters this is not always true.",values:[{name:"None",value:-1},{name:"Main Tank",value:0},{name:"Tank 2",value:1},{name:"Tank 3",value:2},{name:"Tank 4",value:3}],changedEvent:e=>e.getRaid().tanksChangeEmitter,getValue:e=>(e.getRaid()?.getTanks()||[]).findIndex((t=>We.equals(t,e.makeUnitReference()))),setValue:(e,t,i)=>{const a=[];if(-1!=i){for(let e=0;e<i;e++)a.push(Se());a.push(t.makeUnitReference())}t.getRaid().setTanks(e,a)}},$d={type:"number",label:"Incoming HPS",labelTooltip:"\n\t\t<p>Average amount of healing received per second. Used for calculating chance of death.</p>\n\t\t<p>If set to 0, defaults to 17.5% of the primary target's base DPS.</p>\n\t",changedEvent:e=>e.getRaid().changeEmitter,getValue:e=>e.getHealingModel().hps,setValue:(e,t,i)=>{const a=t.getHealingModel();a.hps=i,t.setHealingModel(e,a)},enableWhen:e=>null!=(e.getRaid()?.getTanks()||[]).find((t=>We.equals(t,e.makeUnitReference())))},Kd={type:"number",float:!0,label:"Healing Cadence",labelTooltip:"\n\t\t<p>How often the incoming heal 'ticks', in seconds. Generally, longer durations favor Effective Hit Points (EHP) for minimizing Chance of Death, while shorter durations favor avoidance.</p>\n\t\t<p>Example: if Incoming HPS is set to 1000 and this is set to 1s, then every 1s a heal will be received for 1000. If this is instead set to 2s, then every 2s a heal will be recieved for 2000.</p>\n\t\t<p>If set to 0, defaults to 1.5 times the primary target's base swing timer, and half that for dual wielding targets.</p>\n\t",changedEvent:e=>e.getRaid().changeEmitter,getValue:e=>e.getHealingModel().cadenceSeconds,setValue:(e,t,i)=>{const a=t.getHealingModel();a.cadenceSeconds=i,t.setHealingModel(e,a)},enableWhen:e=>null!=(e.getRaid()?.getTanks()||[]).find((t=>We.equals(t,e.makeUnitReference())))},Yd={type:"number",float:!0,label:"Cadence +/-",labelTooltip:"\n\t\t<p>Magnitude of random variation in healing intervals, in seconds.</p>\n\t\t<p>Example: if Healing Cadence is set to 1s with 0.5s variation, then the interval between successive heals will vary uniformly between 0.5 and 1.5s. If the variation is instead set to 2s, then 50% of healing intervals will fall between 0s and 1s, and the other 50% will fall between 1s and 3s.</p>\n\t\t<p>The amount of healing per 'tick' is automatically scaled up or down based on the randomized time since the last tick, so as to keep HPS constant.</p>\n\t",changedEvent:e=>e.getRaid().changeEmitter,getValue:e=>e.getHealingModel().cadenceVariation,setValue:(e,t,i)=>{const a=t.getHealingModel();a.cadenceVariation=i,t.setHealingModel(e,a)},enableWhen:e=>null!=(e.getRaid()?.getTanks()||[]).find((t=>We.equals(t,e.makeUnitReference())))},Jd={type:"number",float:!1,label:"TMI Burst Window",labelTooltip:"\n\t\t<p>Size in whole seconds of the burst window for calculating TMI. It is important to use a consistent setting when comparing this metric.</p>\n\t\t<p>Default is 6 seconds. If set to 0, TMI calculations are disabled.</p>\n\t",changedEvent:e=>e.getRaid().changeEmitter,getValue:e=>e.getHealingModel().burstWindow,setValue:(e,t,i)=>{const a=t.getHealingModel();a.burstWindow=i,t.setHealingModel(e,a)},enableWhen:e=>null!=(e.getRaid()?.getTanks()||[]).find((t=>We.equals(t,e.makeUnitReference())))},Zd={type:"number",float:!0,label:"HP % for Defensive CDs",labelTooltip:"\n\t\t<p>% of Maximum Health, below which defensive cooldowns are allowed to be used.</p>\n\t\t<p>If set to 0, this restriction is disabled.</p>\n\t",changedEvent:e=>e.rotationChangeEmitter,getValue:e=>100*e.getSimpleCooldowns().hpPercentForDefensives,setValue:(e,t,i)=>{const a=t.getSimpleCooldowns();a.hpPercentForDefensives=i/100,t.setSimpleCooldowns(e,a)}},Qd={type:"number",float:!0,label:"Inspiration % Uptime",labelTooltip:"\n\t\t<p>% average of Encounter Duration, during which you have the Inspiration buff.</p>\n\t\t<p>If set to 0, the buff isn't applied.</p>\n\t",changedEvent:e=>e.healingModelChangeEmitter,getValue:e=>100*e.getHealingModel().inspirationUptime,setValue:(e,t,i)=>{const a=t.getHealingModel();a.inspirationUptime=i/100,t.setHealingModel(e,a)}};let Xd={rows_in_block:50,blocks_in_cluster:4,tag:null,show_no_data_row:!0,no_data_class:"clusterize-no-data",no_data_text:"No data",keep_parity:!0,callbacks:{}};function ec(e,t){return window.getComputedStyle(t)[e]}class tc{constructor(e,i){t(this,"options"),t(this,"scroll_elem"),t(this,"content_elem"),t(this,"displayedRows"),t(this,"last_cluster",0),t(this,"scroll_debounce",0),t(this,"pointer_events_set",!1),t(this,"resize_debounce",0),t(this,"ds"),t(this,"cache",{}),this.options={rows_in_block:void 0!==i.rows_in_block?i.rows_in_block:Xd.rows_in_block,blocks_in_cluster:void 0!==i.blocks_in_cluster?i.blocks_in_cluster:Xd.blocks_in_cluster,show_no_data_row:void 0!==i.show_no_data_row?i.show_no_data_row:Xd.show_no_data_row,no_data_class:void 0!==i.no_data_class?i.no_data_class:Xd.no_data_class,no_data_text:void 0!==i.no_data_text?i.no_data_text:Xd.no_data_text,keep_parity:void 0!==i.keep_parity?i.keep_parity:Xd.keep_parity,tag:void 0!==i.tag?i.tag:Xd.tag,callbacks:void 0!==i.callbacks?i.callbacks:Xd.callbacks,cluster_height:0,item_height:void 0!==i.item_height?i.item_height:0,content_tag:"",block_height:0,scroll_top:0,rows_in_cluster:0},this.ds=e,this.displayedRows=i.rows,this.scroll_elem=i.scroll_elem,this.content_elem=i.content_elem,this.content_elem.hasAttribute("tabindex")||this.content_elem.setAttribute("tabindex","0");let a=this.scroll_elem.scrollTop;this.getRowsHeight(i.rows),this.insertToDom(i.rows,this.cache),this.scroll_elem.scrollTop=a,this.scroll_elem.addEventListener("scroll",this.scrollEv.bind(this)),window.addEventListener("resize",this.resizeEv.bind(this))}destroy(e){this.scroll_elem.removeEventListener("scroll",this.scrollEv.bind(this)),window.removeEventListener("resize",this.resizeEv.bind(this)),e&&this.setContentElemRows(this.generateEmptyRow())}dispose(){this.destroy()}refresh(e){(this.getRowsHeight(this.displayedRows)||e)&&this.update()}update(){let e=this.scroll_elem.scrollTop;this.ds.getNumberOfRows()*this.options.item_height<e&&(this.scroll_elem.scrollTop=0,this.last_cluster=0),this.insertToDom(this.displayedRows,this.cache),this.scroll_elem.scrollTop=e}elementUpdate(e){for(let t of this.displayedRows)e(t)}getScrollProgress(){return this.options.scroll_top/(this.ds.getNumberOfRows()*this.options.item_height)*100||0}scrollEv(){navigator.platform.toLowerCase().indexOf("mac")+1&&(this.pointer_events_set||(this.content_elem.style.pointerEvents="none"),this.pointer_events_set=!0,clearTimeout(this.scroll_debounce),this.scroll_debounce=window.setTimeout((()=>{this.content_elem.style.pointerEvents="auto",this.pointer_events_set=!1}),50)),this.last_cluster!=(this.last_cluster=this.getClusterNum(this.ds.getNumberOfRows()))&&this.insertToDom(this.displayedRows,this.cache),this.options.callbacks.scrollingProgress&&this.options.callbacks.scrollingProgress(this.getScrollProgress())}resizeEv(){clearTimeout(this.resize_debounce),this.resize_debounce=window.setTimeout(this.refresh.bind(this),100)}insertToDom(e,t){this.options.cluster_height||this.exploreEnvironment(e,t);let i=this.generate(),a=i.rows;this.displayedRows=i.rows;let s=this.checkChanges("data",a,t),o=this.checkChanges("top",i.top_offset,t),l=this.checkChanges("bottom",i.bottom_offset,t),n=this.options.callbacks,r=[];if(s||o){if(i.top_offset){if(this.options.keep_parity){let e=this.renderExtraTag("keep-parity");e.hidden=!0,r.push(e)}r.push(this.renderExtraTag("top-space",i.top_offset))}r.push(...a),i.bottom_offset&&r.push(this.renderExtraTag("bottom-space",i.bottom_offset)),n.clusterWillChange&&n.clusterWillChange(),this.setContentElemRows(r),"ol"==this.options.content_tag&&this.content_elem.setAttribute("start",i.rows_above.toString()),this.content_elem.style.counterIncrement="clusterize-counter "+(i.rows_above-1),n.clusterChanged&&n.clusterChanged()}else l&&(this.content_elem.lastChild.style.height=i.bottom_offset+"px")}exploreEnvironment(e,t){let i=this.options;i.content_tag=this.content_elem.tagName.toLowerCase(),e.length&&(this.content_elem.children.length<=1&&this.setContentElemRows([e[0],e[0],e[0]]),i.tag||(i.tag=this.content_elem.children[0].tagName.toLowerCase()),this.getRowsHeight(e))}setContentElemRows(e){this.content_elem.innerHTML="",this.content_elem.append(...e)}getRowsHeight(e){let t=this.options,i=t.item_height;t.cluster_height=0;let a=this.content_elem.children;if(e.length&&a.length){let e=a[Math.floor(a.length/2)];if(t.item_height=e.offsetHeight,"tr"==t.tag&&"collapse"!=ec("borderCollapse",this.content_elem)&&(t.item_height+=parseInt(ec("borderSpacing",this.content_elem),10)||0),"tr"!=t.tag){let i=parseInt(ec("marginTop",e),10)||0,a=parseInt(ec("marginBottom",e),10)||0;t.item_height+=Math.max(i,a)}}return t.block_height=t.item_height*t.rows_in_block,t.rows_in_cluster=t.blocks_in_cluster*t.rows_in_block,t.cluster_height=t.blocks_in_cluster*t.block_height,i!=t.item_height}generate(){let e=this.options,t=this.ds.getNumberOfRows();if(t<e.rows_in_block){let e=this.ds.generateRows(0,t);return{top_offset:0,bottom_offset:0,rows_above:0,rows:t?e:this.generateEmptyRow()}}let i=Math.max((e.rows_in_cluster-e.rows_in_block)*this.getClusterNum(t),0),a=i+e.rows_in_cluster,s=Math.max(i*e.item_height,0),o=Math.max((t-a)*e.item_height,0),l=[],n=i;return s<1&&n++,l=this.ds.generateRows(i,a),{top_offset:s,bottom_offset:o,rows_above:n,rows:l}}generateEmptyRow(){let e=this.options;if(!e.tag||!e.show_no_data_row)return[];let t,i=document.createElement(e.tag),a=document.createTextNode(e.no_data_text);return i.className=e.no_data_class,"tr"==e.tag&&(t=document.createElement("td"),t.colSpan=100,t.appendChild(a)),i.appendChild(t||a),[i]}getClusterNum(e){let t=this.options;t.scroll_top=this.scroll_elem.scrollTop;let i=Math.max(t.cluster_height-t.block_height,1),a=Math.floor(t.scroll_top/i),s=Math.floor(e*t.item_height/i);return Math.min(a,s)}renderExtraTag(e,t){let i=document.createElement(this.options.tag),a="clusterize-";return i.className=[a+"extra-row",a+e].join(" "),i.style.marginTop="0",i.style.marginBottom="0",t&&(i.style.height=t+"px"),i}checkChanges(e,t,i){var a=t!=i[e];return i[e]=t,a}}const ic=()=>h("span",{className:"heroic-label"},"[H]"),ac=(e,t)=>{const i=p(),a=h("div",{className:"gem-socket-container"},h("img",{ref:i,className:"gem-icon "+(null==t?"hide":"")}),h("img",{className:"socket-icon",src:Mt(e)}));return null!=t&&x.fromItemId(t.id).fill().then((e=>{i.value.src=e.iconUrl})),a};class sc extends m{constructor(e,i,a){super(e,"gear-picker-root"),t(this,"itemPickers");const s=document.createElement("div");s.classList.add("gear-picker-left","tab-panel-col"),this.rootElem.appendChild(s);const o=document.createElement("div");o.classList.add("gear-picker-right","tab-panel-col"),this.rootElem.appendChild(o);const l=[Q.ItemSlotHead,Q.ItemSlotNeck,Q.ItemSlotShoulder,Q.ItemSlotBack,Q.ItemSlotChest,Q.ItemSlotWrist,Q.ItemSlotMainHand,Q.ItemSlotOffHand,Q.ItemSlotRanged].map((e=>new lc(s,i,a,e))),n=[Q.ItemSlotHands,Q.ItemSlotWaist,Q.ItemSlotLegs,Q.ItemSlotFeet,Q.ItemSlotFinger1,Q.ItemSlotFinger2,Q.ItemSlotTrinket1,Q.ItemSlotTrinket2].map((e=>new lc(o,i,a,e)));this.itemPickers=l.concat(n).sort(((e,t)=>e.slot-t.slot))}}class oc extends m{constructor(e,i,a){super(e,"item-picker-root",i),t(this,"player"),t(this,"iconElem"),t(this,"nameElem"),t(this,"ilvlElem"),t(this,"enchantElem"),t(this,"socketsContainerElem"),this.player=a;const s=p(),o=p(),l=p(),n=p(),r=p();this.rootElem.appendChild(h(w,null,h("div",{className:"item-picker-icon-wrapper"},h("span",{className:"item-picker-ilvl",ref:l}),h("a",{ref:s,className:"item-picker-icon",href:"javascript:void(0)",attributes:{role:"button"}},h("div",{ref:r,className:"item-picker-sockets-container"}))),h("div",{className:"item-picker-labels-container"},h("a",{ref:o,className:"item-picker-name",href:"javascript:void(0)",attributes:{role:"button"}}),h("a",{ref:n,className:"item-picker-enchant",href:"javascript:void(0)",attributes:{role:"button"}})))),this.iconElem=s.value,this.nameElem=o.value,this.ilvlElem=l.value,this.enchantElem=n.value,this.socketsContainerElem=r.value}clear(){this.nameElem.removeAttribute("data-wowhead"),this.nameElem.removeAttribute("href"),this.iconElem.removeAttribute("data-wowhead"),this.iconElem.removeAttribute("href"),this.enchantElem.removeAttribute("data-wowhead"),this.enchantElem.removeAttribute("href"),this.iconElem.removeAttribute("href"),this.iconElem.style.backgroundImage="",this.enchantElem.innerText="",this.socketsContainerElem.innerText="",this.nameElem.textContent="",this.ilvlElem.replaceChildren()}update(e){this.nameElem.textContent=e.item.name,e.item.heroic?this.nameElem.insertAdjacentElement("beforeend",ic()):this.nameElem.querySelector(".heroic-label")?.remove(),this.ilvlElem.textContent=e.item.ilvl.toString(),Rd(this.nameElem,e.item.quality),this.player.setWowheadData(e,this.iconElem),this.player.setWowheadData(e,this.nameElem),e.asActionId().fill().then((e=>{e.setBackgroundAndHref(this.iconElem,this.player.getLevel()),e.setWowheadHref(this.nameElem,this.player.getLevel())})),e.enchant&&(Gd(e.enchant).then((e=>{this.enchantElem.textContent=e})),e.enchant.spellId?(this.enchantElem.href=x.makeSpellUrl(e.enchant.spellId,this.player.getLevel()),this.enchantElem.dataset.wowhead=`domain=wotlk&spell=${e.enchant.spellId}`):(this.enchantElem.href=x.makeItemUrl(e.enchant.itemId,this.player.getLevel()),this.enchantElem.dataset.wowhead=`domain=wotlk&item=${e.enchant.itemId}`),this.enchantElem.dataset.whtticon="false"),e.allSocketColors().forEach(((t,i)=>{const a=ac(t,e.gems[i]);if(i==e.numPossibleSockets-1&&[qt.ItemTypeWrist,qt.ItemTypeHands,qt.ItemTypeWaist].includes(e.item.type)){const t=()=>{(e.item.type==qt.ItemTypeWaist||this.player.isBlacksmithing())&&this.player.canUseExtraSockets()?a.classList.remove("hide"):a.classList.add("hide")};l.onAny([this.player.professionChangeEmitter,this.player.levelChangeEmitter,this.player.sim.expansionChangeEmitter]).on(t),t()}this.socketsContainerElem.appendChild(a)}))}}class lc extends m{constructor(e,i,a,s){super(e,"item-picker-root"),t(this,"slot"),t(this,"simUI"),t(this,"player"),t(this,"itemElem"),t(this,"_items",[]),t(this,"_enchants",[]),t(this,"_equippedItem",null),this.slot=s,this.simUI=i,this.player=a,this.itemElem=new oc(e,this.rootElem,a),this.item=a.getEquippedItem(s),a.sim.waitForInit().then((()=>{this._items=this.player.getItems(this.slot),this._enchants=this.player.getEnchants(this.slot);const e={equipItem:(e,t)=>{this.player.equipItem(e,this.slot,t)},getEquippedItem:()=>this.player.getEquippedItem(this.slot),changeEvent:a.gearChangeEmitter},t=t=>{t.preventDefault(),this.openSelectorModal(rc.Items,e)};this.itemElem.iconElem.addEventListener("click",t),this.itemElem.nameElem.addEventListener("click",t),this.itemElem.enchantElem.addEventListener("click",(t=>{t.preventDefault(),this.openSelectorModal(rc.Enchants,e)}))})),a.gearChangeEmitter.on((()=>{this.item=a.getEquippedItem(s)})),l.onAny([a.professionChangeEmitter,a.levelChangeEmitter,i.sim.expansionChangeEmitter]).on((()=>{null!=this._equippedItem&&this.player.setWowheadData(this._equippedItem,this.itemElem.iconElem)}))}set item(e){this.itemElem.clear(),this.itemElem.nameElem.textContent=Dt.get(this.slot)??"",Rd(this.itemElem.nameElem,null),null!=e?this.itemElem.update(e):this.itemElem.iconElem.style.backgroundImage=`url('${mc(this.slot)}')`,this._equippedItem=e}openSelectorModal(e,t){new dc(this.simUI.rootElem,this.simUI,this.player,{selectedTab:e,slot:this.slot,equippedItem:this._equippedItem,eligibleItems:this._items,eligibleEnchants:this._enchants,gearData:t})}}class nc extends m{constructor(e,i,a,s){super(e,"icon-picker-root"),t(this,"iconAnchor"),t(this,"socketsContainerElem"),t(this,"player"),t(this,"slot"),t(this,"_items",[]),t(this,"_enchants",[]),this.rootElem.classList.add("icon-picker"),this.player=a,this.slot=s,this.iconAnchor=document.createElement("a"),this.iconAnchor.classList.add("icon-picker-button"),this.iconAnchor.target="_blank",this.rootElem.prepend(this.iconAnchor),this.socketsContainerElem=document.createElement("div"),this.socketsContainerElem.classList.add("item-picker-sockets-container"),this.iconAnchor.appendChild(this.socketsContainerElem),a.sim.waitForInit().then((()=>{this._items=this.player.getItems(s),this._enchants=this.player.getEnchants(s);const e={equipItem:(e,t)=>{a.equipItemSwapitem(e,this.slot,t)},getEquippedItem:()=>a.getItemSwapItem(this.slot),changeEvent:a.itemSwapChangeEmitter};this.iconAnchor.addEventListener("click",(t=>{t.preventDefault(),new dc(i.rootElem,i,this.player,{selectedTab:rc.Items,slot:this.slot,equippedItem:this.player.getItemSwapGear().getEquippedItem(s),eligibleItems:this._items,eligibleEnchants:this._enchants,gearData:e})}))})),a.itemSwapChangeEmitter.on((()=>{this.update(a.getItemSwapGear().getEquippedItem(s))}))}update(e){this.iconAnchor.style.backgroundImage=`url('${mc(this.slot)}')`,this.iconAnchor.removeAttribute("data-wowhead"),this.iconAnchor.href="#",this.socketsContainerElem.innerText="",e?(this.iconAnchor.classList.add("active"),e.asActionId().fillAndSet(this.iconAnchor,!0,!0,this.player.getLevel()),this.player.setWowheadData(e,this.iconAnchor),e.allSocketColors().forEach(((t,i)=>{this.socketsContainerElem.appendChild(ac(t,e.gems[i]))}))):this.iconAnchor.classList.remove("active")}}var rc=(e=>(e.Items="Items",e.Enchants="Enchants",e.Gem1="Gem1",e.Gem2="Gem2",e.Gem3="Gem3",e))(rc||{});class dc extends dd{constructor(e,i,a,s){super(e,"selector-modal"),t(this,"simUI"),t(this,"player"),t(this,"config"),t(this,"ilists"),t(this,"tabsElem"),t(this,"contentElem"),this.simUI=i,this.player=a,this.config=s,this.ilists=[],window.scrollTo({top:0}),this.header.insertAdjacentElement("afterbegin",h("ul",{className:"nav nav-tabs selector-modal-tabs"})),this.body.appendChild(h("div",{className:"tab-content selector-modal-tab-content"})),this.tabsElem=this.rootElem.querySelector(".selector-modal-tabs"),this.contentElem=this.rootElem.querySelector(".selector-modal-tab-content"),this.setData(),this.body.appendChild(h("div",{className:"d-flex align-items-center form-text mt-3"},h("i",{className:"fas fa-circle-exclamation fa-xl me-2"}),h("span",null,"If gear is missing, check the selected expansion and your gear filters.",h("br",null),"If the problem persists, save any un-saved data, click the",h("i",{className:"fas fa-cog mx-1"}),'to open your sim options, then click the "Restore Defaults".')))}openTabName(e){Array.from(this.tabsElem.getElementsByClassName("selector-modal-item-tab")).forEach((t=>{t.getAttribute("data-content-id")==e+"-tab"&&t.click()}))}openTab(e){this.tabsElem.getElementsByClassName("selector-modal-item-tab")[e].click()}setData(){this.tabsElem.innerText="",this.contentElem.innerText="";const{slot:e,equippedItem:t,eligibleItems:i,eligibleEnchants:a,gearData:s}=this.config;this.addTab("Items",i.map((t=>({item:t,id:t.id,actionId:x.fromItem(t),name:t.name,quality:t.quality,heroic:t.heroic,ilvl:t.ilvl,baseEP:this.player.computeItemEP(t,e),ignoreEPFilter:!1,expansion:t.expansion,onEquip:(e,t)=>{const i=s.getEquippedItem();i?s.equipItem(e,i.withItem(t)):s.equipItem(e,new Ut(t))}}))),(t=>this.player.computeItemEP(t,e)),(e=>e?.item),Ot.GemColorUnknown,(e=>{s.equipItem(e,null),this.removeTabs("Gem")})),this.addTab("Enchants",a.map((e=>({item:e,id:e.effectId,actionId:e.spellId?x.fromSpellId(e.spellId):x.fromItemId(e.itemId),name:e.name,quality:e.quality,baseEP:this.player.computeStatsEP(new H(e.stats)),ignoreEPFilter:!0,heroic:!1,expansion:e.expansion,onEquip:(e,t)=>{const i=s.getEquippedItem();i&&s.equipItem(e,i.withEnchant(t))}}))),(e=>this.player.computeEnchantEP(e)),(e=>e?.enchant),Ot.GemColorUnknown,(e=>{const t=s.getEquippedItem();t&&s.equipItem(e,t.withEnchant(null))})),this.addGemTabs(e,t,s)}onShow(e){const t=e.target.querySelector(".active").dataset.contentId;t.includes("Item")?this.ilists[0].sizeRefresh():t.includes("Enchant")&&this.ilists[1].sizeRefresh()}addGemTabs(e,t,i){if(null==t)return;const a=this.player.computeStatsEP(new H(t.item.socketBonus))/(t.item.gemSockets.length||1);t.curSocketColors(this.player.isBlacksmithing(),this.player.canUseExtraSockets()).forEach(((e,t)=>{this.addTab("Gem "+(t+1),this.player.getGems(e).map((e=>({item:e,id:e.id,actionId:x.fromItemId(e.id),name:e.name,quality:e.quality,heroic:!1,baseEP:this.player.computeStatsEP(new H(e.stats)),ignoreEPFilter:!0,expansion:e.expansion,onEquip:(e,a)=>{const s=i.getEquippedItem();s&&i.equipItem(e,s.withGem(a,t))}}))),(t=>{let i=this.player.computeGemEP(t);return we(t,e)&&(i+=a),i}),(e=>e?.gems[t]),e,(e=>{const a=i.getEquippedItem();a&&i.equipItem(e,a.withGem(null,t))}),(a=>{const s=ac(e,null);a.appendChild(s),a.classList.add("selector-modal-tab-gem");const o=a.querySelector(".gem-icon"),l=Mt(e),n=()=>{const e=i.getEquippedItem(),a=e?.gems[t];a?(o.classList.remove("hide"),x.fromItemId(a.id).fill().then((e=>{o.setAttribute("src",e.iconUrl)}))):(o.classList.add("hide"),o.setAttribute("src",l))};i.changeEvent.on(n),this.addOnDisposeCallback((()=>i.changeEvent.off(n))),n()}))}))}addTab(e,t,i,a,s,o,n){if(0==t.length)return;const{slot:r,gearData:d}=this.config,c=(e+"-tab").split(" ").join(""),m=e===this.config.selectedTab,u=p();if(this.tabsElem.appendChild(h("li",{className:"nav-item"},h("a",{ref:u,className:"nav-link selector-modal-item-tab "+(m?"active":""),dataset:{label:e,contentId:c,bsToggle:"tab",bsTarget:`#${c}`},attributes:{role:"tab","aria-selected":m},type:"button"}))),n?n(u.value):u.value.textContent=e,0==t.length)return;const g=new hc(this.contentElem,this.simUI,this.config,this.player,e,t,i,a,s,o,(e=>{const t=e.item;e.onEquip(l.nextEventID(),t),Wt.is(t)&&(this.removeTabs("Gem"),this.addGemTabs(r,d.getEquippedItem(),d))})),f=()=>{g.updateSelected()},w=()=>{g.applyFilters()},I=()=>{g.hideOrShowEPValues()};d.changeEvent.on(f),this.player.sim.filtersChangeEmitter.on(w),this.player.sim.showEPValuesChangeEmitter.on(I),this.addOnDisposeCallback((()=>{d.changeEvent.off(f),this.player.sim.filtersChangeEmitter.off(w),this.player.sim.showEPValuesChangeEmitter.off(I),g.dispose()})),u.value.addEventListener("shown.bs.tab",(e=>{g.sizeRefresh()})),this.ilists.push(g)}removeTabs(e){const t=Array.prototype.slice.call(this.tabsElem.getElementsByClassName("selector-modal-item-tab")).filter((t=>t.dataset.label.includes(e))),i=t.map((e=>document.getElementById(e.dataset.contentId))).filter((e=>Boolean(e)));t.forEach((e=>e.parentElement.remove())),i.forEach((e=>e.remove()))}}const cc={[Q.ItemSlotHead]:"/sims/wotlk/all/assets/item_slots/head.jpg",[Q.ItemSlotNeck]:"/sims/wotlk/all/assets/item_slots/neck.jpg",[Q.ItemSlotShoulder]:"/sims/wotlk/all/assets/item_slots/shoulders.jpg",[Q.ItemSlotBack]:"/sims/wotlk/all/assets/item_slots/shirt.jpg",[Q.ItemSlotChest]:"/sims/wotlk/all/assets/item_slots/chest.jpg",[Q.ItemSlotWrist]:"/sims/wotlk/all/assets/item_slots/wrists.jpg",[Q.ItemSlotHands]:"/sims/wotlk/all/assets/item_slots/hands.jpg",[Q.ItemSlotWaist]:"/sims/wotlk/all/assets/item_slots/waist.jpg",[Q.ItemSlotLegs]:"/sims/wotlk/all/assets/item_slots/legs.jpg",[Q.ItemSlotFeet]:"/sims/wotlk/all/assets/item_slots/feet.jpg",[Q.ItemSlotFinger1]:"/sims/wotlk/all/assets/item_slots/finger.jpg",[Q.ItemSlotFinger2]:"/sims/wotlk/all/assets/item_slots/finger.jpg",[Q.ItemSlotTrinket1]:"/sims/wotlk/all/assets/item_slots/trinket.jpg",[Q.ItemSlotTrinket2]:"/sims/wotlk/all/assets/item_slots/trinket.jpg",[Q.ItemSlotMainHand]:"/sims/wotlk/all/assets/item_slots/mainhand.jpg",[Q.ItemSlotOffHand]:"/sims/wotlk/all/assets/item_slots/offhand.jpg",[Q.ItemSlotRanged]:"/sims/wotlk/all/assets/item_slots/ranged.jpg"};function mc(e){return cc[e]}class hc{constructor(e,a,s,o,n,r,c,m,u,g,f){t(this,"listElem"),t(this,"player"),t(this,"label"),t(this,"slot"),t(this,"itemData"),t(this,"itemsToDisplay"),t(this,"currentFilters"),t(this,"searchInput"),t(this,"socketColor"),t(this,"computeEP"),t(this,"equippedToItemFn"),t(this,"gearData"),t(this,"tabContent"),t(this,"onItemClick"),t(this,"scroller"),this.label=n,this.player=o,this.itemData=r,this.socketColor=u,this.computeEP=c,this.equippedToItemFn=m,this.onItemClick=f;const{slot:w,gearData:I}=s;this.slot=w,this.gearData=I,this.currentFilters=this.player.sim.getFilters();const x=(n+"-tab").split(" ").join(""),y=n===s.selectedTab,b=p();if(this.tabContent=h("div",{id:x,className:"selector-modal-tab-pane tab-pane fade "+(y?"active show":"")},h("div",{className:"selector-modal-filters"},h("input",{className:"selector-modal-search form-control",type:"text",placeholder:"Search..."}),"Enchants"!=n&&h("button",{className:"selector-modal-filters-button btn btn-primary"},"Filters"),h("div",{className:"selector-modal-expansion-selector"}),h("div",{className:"sim-input selector-modal-boolean-option selector-modal-show-1h-weapons"}),h("div",{className:"sim-input selector-modal-boolean-option selector-modal-show-2h-weapons"}),h("div",{className:"sim-input selector-modal-boolean-option selector-modal-show-matching-gems"}),h("div",{className:"sim-input selector-modal-boolean-option selector-modal-show-ep-values"}),h("button",{className:"selector-modal-simall-button btn btn-warning"},"Add to Batch Sim"),h("button",{className:"selector-modal-remove-button btn btn-danger"},"Unequip Item")),h("div",{className:"selector-modal-list-labels"},h("label",{className:"item-label"},h("small",null,"Item")),h("label",{className:"source-label"},h("small",null,"Source")),h("label",{className:"ilvl-label"},h("small",null,"ILvl")),h("label",{className:"ep-label"},h("small",null,"EP"),h("i",{className:"fa-solid fa-plus-minus fa-2xs"}),h("button",{ref:b,className:"btn btn-link p-0 ms-1"},h("i",{className:"far fa-question-circle fa-lg"}))),h("label",{className:"favorite-label"})),h("ul",{className:"selector-modal-list"})),e.appendChild(this.tabContent),new i(b.value,{title:"\n\tEP (Equivalence Points) is way of comparing items by multiplying the raw stats of an item with your current stat weights.\n\tMore EP does not necessarily mean more DPS, as EP doesn't take into account stat caps and non-linear stat calculations.\n"}),function(e,t){new xt(e,t,{extraCssClasses:["show-1h-weapons-selector","mb-0"],label:"1H",inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().oneHandedWeapons,setValue:(e,t,i)=>{const a=t.getFilters();a.oneHandedWeapons=i,t.setFilters(e,a)}})}(this.tabContent.getElementsByClassName("selector-modal-show-1h-weapons")[0],o.sim),function(e,t){new xt(e,t,{extraCssClasses:["show-2h-weapons-selector","mb-0"],label:"2H",inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().twoHandedWeapons,setValue:(e,t,i)=>{const a=t.getFilters();a.twoHandedWeapons=i,t.setFilters(e,a)}})}(this.tabContent.getElementsByClassName("selector-modal-show-2h-weapons")[0],o.sim),"Items"==n&&(w==Q.ItemSlotMainHand||w==Q.ItemSlotOffHand&&o.getClass()==d.ClassWarrior)||(this.tabContent.getElementsByClassName("selector-modal-show-1h-weapons")[0].style.display="none",this.tabContent.getElementsByClassName("selector-modal-show-2h-weapons")[0].style.display="none"),function(e,t){new xt(e,t,{extraCssClasses:["show-ep-values-selector","input-inline","mb-0"],label:"Show EP",inline:!0,changedEvent:e=>e.showEPValuesChangeEmitter,getValue:e=>e.getShowEPValues(),setValue:(e,t,i)=>{t.setShowEPValues(e,i)}})}(this.tabContent.getElementsByClassName("selector-modal-show-ep-values")[0],o.sim),function(e,t){new xt(e,t,{extraCssClasses:["show-matching-gems-selector","input-inline","mb-0"],label:"Match Socket",inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().matchingGemsOnly,setValue:(e,t,i)=>{const a=t.getFilters();a.matchingGemsOnly=i,t.setFilters(e,a)}})}(this.tabContent.getElementsByClassName("selector-modal-show-matching-gems")[0],o.sim),n.startsWith("Gem")||(this.tabContent.getElementsByClassName("selector-modal-show-matching-gems")[0].style.display="none"),function(e,t){new Dd(e,t,{extraCssClasses:["expansion-selector"],values:[{name:"Vanilla",value:se.ExpansionVanilla},{name:"TBC",value:se.ExpansionTbc},{name:"WOTLK",value:se.ExpansionWotlk}],changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().maxExpansion,setValue:(e,t,i)=>{const a=t.getFilters();a.maxExpansion=i,t.setFilters(e,a)},defaultValue:t.getExpansion()})}(this.tabContent.getElementsByClassName("selector-modal-expansion-selector")[0],o.sim),"Items"==n){this.tabContent.getElementsByClassName("selector-modal-filters-button")[0].addEventListener("click",(()=>new Vd(e,o,w)))}else if("Enchants"!=n){this.tabContent.getElementsByClassName("selector-modal-filters-button")[0].addEventListener("click",(()=>new Wd(e,o)))}this.listElem=this.tabContent.getElementsByClassName("selector-modal-list")[0],this.itemsToDisplay=[],this.scroller=new tc({getNumberOfRows:()=>this.itemsToDisplay.length,generateRows:(e,t)=>{const i=[];for(let a=e;a<t&&!(a>=this.itemsToDisplay.length);++a)i.push(this.createItemElem({idx:this.itemsToDisplay[a],data:this.itemData[this.itemsToDisplay[a]]}));return i}},{rows:[],scroll_elem:this.listElem,content_elem:this.listElem,item_height:56,show_no_data_row:!1,no_data_text:"",tag:"li",rows_in_block:16,blocks_in_cluster:2});const v=this.tabContent.getElementsByClassName("selector-modal-remove-button")[0];v.addEventListener("click",(e=>{g(l.nextEventID())})),n.startsWith("Enchants")?v.textContent="Remove Enchant":n.startsWith("Gem")&&(v.textContent="Remove Gem"),this.updateSelected(),this.searchInput=this.tabContent.getElementsByClassName("selector-modal-search")[0],this.searchInput.addEventListener("input",(()=>this.applyFilters()));const S=this.tabContent.getElementsByClassName("selector-modal-simall-button")[0];"Items"==n?(S.hidden=!o.sim.getShowExperimental(),o.sim.showExperimentalChangeEmitter.on((()=>{S.hidden=!o.sim.getShowExperimental()})),S.addEventListener("click",(e=>{if(a instanceof Xu){const e=Array(),t=this.slot==Q.ItemSlotRanged||this.slot==Q.ItemSlotTrinket1||this.slot==Q.ItemSlotTrinket2,i=this.equippedToItemFn(this.player.getEquippedItem(this.slot));let s=0;null!=i&&(s=this.computeEP(i));for(const a of this.itemsToDisplay){const i=this.itemData[a];!t&&s>0&&i.baseEP<s/2||(i.baseEP>0||t)&&e.push(ft.create({id:i.id}))}a.bt.addItems(e)}}))):S.hidden=!0}sizeRefresh(){this.scroller.refresh(!0),this.applyFilters()}dispose(){this.scroller.dispose()}updateSelected(){const e=this.gearData.getEquippedItem(),t=this.equippedToItemFn(e),i=t?"Enchants"==this.label?t.effectId:t.id:0,a=t?this.computeEP(t):0;this.scroller.elementUpdate((e=>{const t=e.dataset.idx,s=this.itemData[parseFloat(t)];s.id==i?e.classList.add("active"):e.classList.remove("active");const o=e.getElementsByClassName("selector-modal-list-item-ep-delta")[0];if(o&&(o.textContent="",s.item)){const e=this.computeEP(s.item);a!=e&&Vt(o,a,e,0)}}))}applyFilters(){this.currentFilters=this.player.sim.getFilters();let e=new Array(this.itemData.length);for(let s=0;s<this.itemData.length;++s)e[s]=s;const t=this.player.getEquippedItem(this.slot);"Items"==this.label?e=this.player.filterItemData(e,(e=>this.itemData[e].item),this.slot):"Enchants"==this.label?e=this.player.filterEnchantData(e,(e=>this.itemData[e].item),this.slot,t):this.label.startsWith("Gem")&&(e=this.player.filterGemData(e,(e=>this.itemData[e].item),this.slot,this.socketColor));const i=this.player.sim.getFilters();let a;e=e.filter((e=>{const t=this.itemData[e];if(t.expansion>i.maxExpansion)return!1;if(this.searchInput.value.length>0){const e=this.searchInput.value.toLowerCase().replaceAll(/[^a-zA-Z0-9\s]/g,"").split(" "),i=t.name.toLowerCase().replaceAll(/[^a-zA-Z0-9\s]/g,"");let a=!0;if(e.forEach((e=>{i.includes(e)||(a=!1)})),!a)return!1}return!0})),a=this.slot==Q.ItemSlotTrinket1||this.slot==Q.ItemSlotTrinket2?(e,t)=>t.ilvl-e.ilvl:(e,t)=>{const i=this.computeEP(t)-this.computeEP(e);return Math.abs(i)<.01?t.ilvl-e.ilvl:i},e=e.sort(((e,t)=>{const i=this.itemData[e],s=this.itemData[t];return this.isItemFavorited(i)&&!this.isItemFavorited(s)?-1:this.isItemFavorited(s)&&!this.isItemFavorited(i)?1:a(i.item,s.item)})),this.itemsToDisplay=e,this.scroller.update(),this.hideOrShowEPValues()}hideOrShowEPValues(){const e=this.tabContent.getElementsByClassName("ep-label"),t=this.tabContent.getElementsByClassName("selector-modal-list"),i=this.player.sim.getShowEPValues(),a=i?"":"none";for(const s of e)s.style.display=a;for(const s of t)i?s.classList.remove("hide-ep"):s.classList.add("hide-ep")}createItemElem(e){const t=e.data,a=this.computeEP(t.item),s=this.equippedToItemFn(this.gearData.getEquippedItem()),o=s?"Enchants"==this.label?s.effectId:s.id:0,n=s?this.computeEP(s):0,r=p(),d=p(),c=p(),m=h("li",{className:"selector-modal-list-item "+(o==t.id?"active":""),dataset:{idx:e.idx.toString()}},h("div",{className:"selector-modal-list-label-cell"},h("a",{className:"selector-modal-list-item-link",ref:d,dataset:{whtticon:"false"}},h("img",{className:"selector-modal-list-item-icon",ref:c}),h("label",{className:"selector-modal-list-item-name",ref:r},t.name,t.heroic&&ic()))));"Items"==this.label&&(m.appendChild(h("div",{className:"selector-modal-list-item-source-container"},this.getSourceInfo(t.item,this.player.sim))),m.appendChild(h("div",{className:"selector-modal-list-item-ilvl-container"},t.item.ilvl))),this.slot!=Q.ItemSlotTrinket1&&this.slot!=Q.ItemSlotTrinket2&&m.appendChild(h("div",{className:"selector-modal-list-item-ep"},h("span",{className:"selector-modal-list-item-ep-value"},a<9.95?a.toFixed(1).toString():Math.round(a).toString()),h("span",{className:"selector-modal-list-item-ep-delta",ref:e=>t.item&&n!=a&&Vt(e,n,a,0)})));const u=p();m.appendChild(h("div",null,h("button",{className:"selector-modal-list-item-favorite btn btn-link p-0",ref:u,onclick:()=>g("false"==m.dataset.fav)},h("i",{className:"fa-star fa-xl"})))),d.value.addEventListener("click",(e=>{if(e.preventDefault(),e.target===u.value)return!1;this.onItemClick(t)})),t.actionId.fill().then((e=>{e.setWowheadHref(d.value,this.player.getLevel()),c.value.src=e.iconUrl})),Rd(r.value,t.quality),new i(u.value,{title:"Add to favorites"});const g=e=>{const i=this.player.sim.getFilters();if("Items"==this.label){const a=t.id;if(e)i.favoriteItems.push(a);else{const e=i.favoriteItems.indexOf(a);-1!=e&&i.favoriteItems.splice(e,1)}}else if("Enchants"==this.label){const a=Ad(t.item);if(e)i.favoriteEnchants.push(a);else{const e=i.favoriteEnchants.indexOf(a);-1!=e&&i.favoriteEnchants.splice(e,1)}}else if(this.label.startsWith("Gem")){const a=t.id;if(e)i.favoriteGems.push(a);else{const e=i.favoriteGems.indexOf(a);-1!=e&&i.favoriteGems.splice(e,1)}}u.value.children[0].classList.toggle("fas"),u.value.children[0].classList.toggle("far"),m.dataset.fav=e.toString(),this.player.sim.setFilters(l.nextEventID(),i)};return this.isItemFavorited(t)?(u.value.children[0].classList.add("fas"),m.dataset.fav="true"):(u.value.children[0].classList.add("far"),m.dataset.fav="false"),m}isItemFavorited(e){return"Items"==this.label?this.currentFilters.favoriteItems.includes(e.id):"Enchants"==this.label?this.currentFilters.favoriteEnchants.includes(Ad(e.item)):!!this.label.startsWith("Gem")&&this.currentFilters.favoriteGems.includes(e.id)}getSourceInfo(e,t){const i=(e,t)=>h("a",{href:e,target:"_blank",dataset:{whtticon:"false"}},h("small",null,t));if(!e.sources||0==e.sources.length)return h(w,null);let a=e.sources[0];if("crafted"==a.source.oneofKind){const t=a.source.crafted;return t.spellId?i(x.makeSpellUrl(t.spellId,this.player.getLevel()),Ft.get(t.profession)??"Unknown"):i(x.makeItemUrl(e.id,this.player.getLevel()),Ft.get(t.profession)??"Unknown")}if("drop"==a.source.oneofKind){const s=a.source.drop,o=t.db.getZone(s.zoneId),l=t.db.getNpc(s.npcId);if(!o)throw new Error("No zone found for item: "+e);const n=s.category?` - ${s.category}`:"";return l?i(x.makeNpcUrl(l.id),h("span",null,o.name," (",zt.get(s.difficulty)??"Unknown",")",h("br",null),l.name+n)):s.otherName?i(x.makeZoneUrl(o.id),h("span",null,o.name,h("br",null),s.otherName)):i(x.makeZoneUrl(o.id),o.name)}if("quest"==a.source.oneofKind&&a.source.quest.name){const t=a.source.quest;return i(x.makeQuestUrl(t.id),h("span",null,"Quest",e.factionRestriction==be.ALLIANCE_ONLY&&h("img",{src:"/sims/wotlk/all/assets/img/alliance.png",className:"ms-1",width:"15",height:"15"}),e.factionRestriction==be.HORDE_ONLY&&h("img",{src:"/sims/wotlk/all/assets/img/horde.png",className:"ms-1",width:"15",height:"15"}),h("br",null),t.name))}if("rep"==(a=e.sources.find((e=>"rep"==e.source.oneofKind))??a).source.oneofKind){const t=e.sources.filter((e=>"rep"==e.source.oneofKind)).map((e=>"rep"==e.source.oneofKind?jt[e.source.rep.repFactionId]:jt[Ht.RepFactionUnknown])),s=a.source.rep;return i(x.makeItemUrl(e.id,this.player.getLevel()),h(w,null,t.map((t=>h("span",null,t,e.factionRestriction==be.ALLIANCE_ONLY&&h("img",{src:"/sims/wotlk/all/assets/img/alliance.png",className:"ms-1",width:"15",height:"15"}),e.factionRestriction==be.HORDE_ONLY&&h("img",{src:"/sims/wotlk/all/assets/img/horde.png",className:"ms-1",width:"15",height:"15"}),h("br",null)))),h("span",null,Bt[s.repLevel])))}if("soldBy"==a.source.oneofKind){const e=a.source.soldBy;return i(x.makeNpcUrl(e.npcId),h("span",null,"Sold by",h("br",null),e.npcName))}return h(w,null)}}class pc extends m{constructor(e){super(e,"results-viewer"),t(this,"pendingElem"),t(this,"contentElem"),t(this,"warningElem"),t(this,"warningsLink"),t(this,"warnings",[]),this.rootElem.appendChild(h(w,null,h("div",{className:"results-pending"},h("div",{className:"loader"})),h("div",{className:"results-content"}),h("div",{className:"warning-zone",style:"text-align: center"}))),this.pendingElem=this.rootElem.getElementsByClassName("results-pending")[0],this.contentElem=this.rootElem.getElementsByClassName("results-content")[0],this.warningElem=this.rootElem.getElementsByClassName("warning-zone")[0],this.warningsLink=this.addWarningsLink(),this.updateWarnings(),this.hideAll()}addWarningLink(e){let t=h("div",{className:"sim-toolbar-item"},h("a",{href:e.href?e.href:"javascript:void(0)",target:e.href?"_blank":"_self",className:e.classes},e.icon&&h("i",{className:e.icon}),e.text?e.text:"")),a=t.children[0];e.onclick&&a.addEventListener("click",(()=>{e.onclick&&e.onclick()}));let s={};return e.tooltip&&(s={title:e.tooltip,html:!0,placement:"bottom"},a.setAttribute("data-bs-title",e.tooltip)),new i(a,s),e.parent.appendChild(t),t}addWarningsLink(){return this.addWarningLink({parent:this.warningElem,icon:"fas fa-exclamation-triangle fa-3x",tooltip:"<ul class='text-start ps-3 mb-0'></ul>",classes:"warning link-warning"}).children[0]}addWarning(e){this.warnings.push(e),e.updateOn.on((()=>this.updateWarnings())),this.updateWarnings()}updateWarnings(){const e=this.warnings.map((e=>e.getContent())).flat().filter((e=>""!=e));let t=document.createElement("fragment");t.innerHTML=this.warningsLink.getAttribute("data-bs-title");let a=t.children[0];a.innerHTML="",0==e.length?this.warningsLink.parentElement?.classList?.add("hide"):(this.warningsLink.parentElement?.classList?.remove("hide"),e.forEach((e=>{let t=document.createElement("li");t.innerHTML=e,a.appendChild(t)}))),this.warningsLink.setAttribute("data-bs-title",a.outerHTML),new i(this.warningsLink,{title:a.outerHTML,html:!0,placement:"bottom"})}hideAll(){this.contentElem.style.display="none",this.pendingElem.style.display="none"}setPending(){this.contentElem.style.display="none",this.pendingElem.style.display="block"}setContent(e){this.contentElem.innerHTML=e,this.contentElem.style.display="block",this.pendingElem.style.display="none"}}class uc extends m{constructor(e,i,a){super(e,"sim-tab"),t(this,"simUI"),t(this,"config"),t(this,"navItem"),t(this,"navLink"),t(this,"contentContainer"),this.rootElem.classList.add(a.identifier),this.simUI=i,this.config=a,this.rootElem.id=this.config.identifier,this.rootElem.classList.add("tab-pane","fade"),0==e.childNodes.length&&this.rootElem.classList.add("active","show"),this.navItem=this.buildNavItem(),this.navLink=this.navItem.children[0],this.contentContainer=document.createElement("div"),this.contentContainer.classList.add("tab-pane-content-container"),this.rootElem.appendChild(this.contentContainer),this.simUI.simHeader.addSimTabLink(this)}buildNavItem(){const e=document.createElement("fragment");return e.innerHTML=`\n\t\t\t<li class="${this.config.identifier} nav-item" role="presentation">\n\t\t\t\t<a\n\t\t\t\t\tclass="nav-link"\n\t\t\t\t\tdata-bs-toggle="tab"\n\t\t\t\t\tdata-bs-target="#${this.config.identifier}"\n\t\t\t\t\ttype="button"\n\t\t\t\t\trole="tab"\n\t\t\t\t\taria-controls="${this.config.identifier}"\n\t\t\t\t>${this.config.title}</a>\n\t\t\t</li>\n\t\t`,e.children[0]}buildColumn(e,t){let i=document.createElement("div");return i.classList.add("tab-panel-col",`${t}-${e}`),i}}class gc extends cd{constructor(e,i,a){super(e,i,"Bag Item Import",!0),t(this,"simUI"),t(this,"bulkUI"),this.simUI=i,this.bulkUI=a,this.descriptionElem.innerHTML="\n      <p>Import bag items from a JSON file, which can be created by the WowSimsExporter in-game AddOn.</p>\n      <p>To import, upload the file or paste the text below, then click, 'Import'.</p>\n    "}async onImport(e){try{const t=gt.fromJsonString(e,{ignoreUnknownFields:!0});if(t?.items?.length>0){const e=await Pe.loadLeftoversIfNecessary(t),i=t.items.filter((t=>t.id>0&&e.lookupItemSpec(t)));i.length>0&&this.bulkUI.addItems(i)}this.close()}catch(t){console.warn(t),alert(t.toString())}}}class fc{constructor(e,t,i,a){const s=document.createElement("div");s.classList.add("results-sim");const o=document.createElement("div");o.classList.add("bulk-result-body-dps","bulk-items-text-line","results-sim-dps","damage-metrics"),s.appendChild(o);const n=document.createElement("span");n.textContent=this.formatDps(i.unitMetrics?.dps?.avg),n.classList.add("topline-result-avg"),o.appendChild(n);const r=i.unitMetrics?.dps?.avg-a.unitMetrics?.dps?.avg,d=document.createElement("span");d.textContent=`${this.formatDpsDelta(r)}`,d.classList.add(r>=0?"bulk-result-header-positive":"bulk-result-header-negative"),o.appendChild(d);const c=document.createElement("div");c.classList.add("bulk-gear-combo"),e.appendChild(c),e.appendChild(s);const m=document.createElement("p");if(m.classList.add("talent-loadout-text"),i.talentLoadout&&"object"==typeof i.talentLoadout?"string"==typeof i.talentLoadout.name&&(m.textContent="Talent loadout used: "+i.talentLoadout.name):m.textContent="Current talents",o.appendChild(m),i.itemsAdded&&i.itemsAdded.length>0){const a=document.createElement("button");a.textContent="Equip",a.classList.add("btn","btn-primary","bulk-equipit"),a.onclick=()=>{i.itemsAdded.forEach((e=>{const i=t.sim.db.lookupItemSpec(e.item);t.player.equipItem(l.nextEventID(),e.slot,i),t.simHeader.activateTab("gear-tab")}))},e.appendChild(a);for(const s of i.itemsAdded){const i=t.sim.db.lookupItemSpec(s.item),a=new oc(e,c,t.player);a.update(i);const o=document.createElement("a");o.classList.add("bulk-result-item-slot"),o.textContent=this.itemSlotName(s),a.nameElem.appendChild(o)}}else if(!i.talentLoadout||"object"!=typeof i.talentLoadout){const t=document.createElement("p");t.textContent="No changes - this is your currently equipped gear!",e.appendChild(t),d.textContent=""}}formatDps(e){return(Math.round(100*e)/100).toFixed(2)}formatDpsDelta(e){return(e>=0?"+":"")+this.formatDps(e)}itemSlotName(e){return JSON.parse(ti.toJsonString(e,{emitDefaultValues:!0})).slot.replace("ItemSlot","")}}class wc extends m{constructor(e,i,a,s,o){super(e,"bulk-item-picker"),t(this,"itemElem"),t(this,"simUI"),t(this,"bulkUI"),t(this,"index"),t(this,"item"),this.simUI=i,this.bulkUI=a,this.index=o,this.item=s,this.itemElem=new oc(e,this.rootElem,i.player),this.simUI.sim.waitForInit().then((()=>{this.setItem(s);const e=ii(this.item.item)[0],t=this.simUI.sim.db.getEnchants(e),i=i=>{i.preventDefault();const s=new l,o=new dc(this.bulkUI.rootElem,this.simUI,this.simUI.player,{selectedTab:rc.Enchants,slot:e,equippedItem:this.item,eligibleItems:new Array,eligibleEnchants:t,gearData:{equipItem:(e,t)=>{if(t){const e=this.bulkUI.getItems();e[this.index]=t.asSpec(),this.item=t,this.bulkUI.setItems(e),s.emit(l.nextEventID())}},getEquippedItem:()=>this.item,changeEvent:s}});t.length>0?o.openTabName("Enchants"):this.item._gems.length>0&&o.openTabName("Gem1");const n=document.createElement("button");n.textContent="Remove from Batch",n.classList.add("btn","btn-danger"),n.onclick=()=>{a.setItems(a.getItems().filter(((e,t)=>t!=this.index))),o.close()};const r=o.header?.querySelector(".close-button");null!=r&&o.header?.insertBefore(n,r)};this.itemElem.iconElem.addEventListener("click",i),this.itemElem.nameElem.addEventListener("click",i),this.itemElem.enchantElem.addEventListener("click",i)}))}setItem(e){this.itemElem.clear(),null!=e?(this.itemElem.update(e),this.item=e):(this.itemElem.rootElem.style.opacity="30%",this.itemElem.iconElem.style.backgroundImage="url('/sims/wotlk/all/assets/item_slots/empty.jpg')",this.itemElem.nameElem.textContent="Add new item (not implemented)",this.itemElem.rootElem.style.alignItems="center")}}class Ic extends uc{constructor(e,i){super(e,i,{identifier:"bulk-tab",title:"Batch"}),t(this,"simUI"),t(this,"itemsChangedEmitter",new l),t(this,"leftPanel"),t(this,"rightPanel"),t(this,"column1",this.buildColumn(1,"raid-settings-col")),t(this,"items",new Array),t(this,"pendingResults"),t(this,"pendingDiv"),t(this,"doCombos"),t(this,"fastMode"),t(this,"autoGem"),t(this,"simTalents"),t(this,"autoEnchant"),t(this,"defaultGems"),t(this,"savedTalents"),t(this,"gemIconElements"),this.simUI=i,this.leftPanel=document.createElement("div"),this.leftPanel.classList.add("bulk-tab-left","tab-panel-left"),this.leftPanel.appendChild(this.column1),this.rightPanel=document.createElement("div"),this.rightPanel.classList.add("bulk-tab-right","tab-panel-right"),this.pendingDiv=document.createElement("div"),this.pendingDiv.classList.add("results-pending-overlay"),this.pendingResults=new pc(this.pendingDiv),this.pendingResults.hideAll(),this.contentContainer.appendChild(this.leftPanel),this.contentContainer.appendChild(this.rightPanel),this.contentContainer.appendChild(this.pendingDiv),this.doCombos=!0,this.fastMode=!0,this.autoGem=!0,this.autoEnchant=!0,this.savedTalents=[],this.simTalents=!1,this.defaultGems=[$t.create(),$t.create(),$t.create(),$t.create()],this.gemIconElements=[],this.buildTabContent(),this.simUI.sim.waitForInit().then((()=>{this.loadSettings()}))}getSettingsKey(){return this.simUI.getStorageKey("bulk-settings.v1")}loadSettings(){const e=window.localStorage.getItem(this.getSettingsKey());if(null!=e){const t=Kt.fromJsonString(e,{ignoreUnknownFields:!0});this.doCombos=t.combinations,this.fastMode=t.fastMode,this.autoEnchant=t.autoEnchant,this.savedTalents=t.talentsToSim,this.autoGem=t.autoGem,this.simTalents=t.simTalents,this.defaultGems=new Array(Yt.create({id:t.defaultRedGem}),Yt.create({id:t.defaultYellowGem}),Yt.create({id:t.defaultBlueGem}),Yt.create({id:t.defaultMetaGem})),this.defaultGems.forEach(((e,t)=>{x.fromItemId(e.id).fill().then((e=>{this.gemIconElements[t].src=e.iconUrl}))}))}}storeSettings(){const e=this.createBulkSettings(),t=Kt.toJsonString(e,{enumAsInteger:!0});window.localStorage.setItem(this.getSettingsKey(),t)}createBulkSettings(){return Kt.create({items:this.items,combinations:this.doCombos,fastMode:this.fastMode,autoEnchant:this.autoEnchant,autoGem:this.autoGem,simTalents:this.simTalents,talentsToSim:this.savedTalents,defaultRedGem:this.defaultGems[0].id,defaultYellowGem:this.defaultGems[1].id,defaultBlueGem:this.defaultGems[2].id,defaultMetaGem:this.defaultGems[3].id,iterationsPerCombo:this.simUI.sim.getIterations()})}createBulkItemsDatabase(){const e=Jt.create();for(const t of this.items){const i=this.simUI.sim.db.lookupItemSpec(t);if(!i)throw new Error(`item with ID ${t.id} not found in database`);e.items.push(Zt.fromJson(Wt.toJson(i.item),{ignoreUnknownFields:!0})),i.enchant&&e.enchants.push(Qt.fromJson(Xt.toJson(i.enchant),{ignoreUnknownFields:!0}));for(const t of i.gems)t&&e.gems.push(Yt.fromJson($t.toJson(t),{ignoreUnknownFields:!0}))}for(const t of this.defaultGems)t.id>0&&e.gems.push(t);return e}addItems(e){0==this.items.length?this.items=e:this.items=this.items.concat(e),this.itemsChangedEmitter.emit(l.nextEventID())}setItems(e){this.items=e,this.itemsChangedEmitter.emit(l.nextEventID())}clearItems(){this.items=new Array,this.itemsChangedEmitter.emit(l.nextEventID())}getItems(){const e=new Array;return this.items.forEach((t=>{e.push(ft.clone(t))})),e}setCombinations(e){this.doCombos=e,this.itemsChangedEmitter.emit(l.nextEventID())}setFastMode(e){this.fastMode=e,this.itemsChangedEmitter.emit(l.nextEventID())}async runBulkSim(e){this.pendingResults.setPending();try{await this.simUI.sim.runBulkSim(this.createBulkSettings(),this.createBulkItemsDatabase(),e)}catch(t){this.simUI.handleCrash(t)}}buildTabContent(){const e=new Nd(this.column1,"bulk-items",{header:{title:"Items"}});e.bodyElement.classList.add("gear-picker-root");const t=document.createElement("div");t.classList.add("bulk-items-text-line"),e.bodyElement.appendChild(t),t.innerHTML="<i>Notice: This is under very early but active development and experimental. You may also need to update your WoW AddOn if you want to import your bags.</i>";const i=document.createElement("div");i.classList.add("bulk-items-text-line"),e.bodyElement.appendChild(i);const a=document.createElement("div");a.classList.add("tab-panel-col","bulk-gear-combo"),e.bodyElement.appendChild(a),this.itemsChangedEmitter.on((()=>{if(a.innerHTML="",this.items.length>0){i.textContent="The following items will be simmed together with your equipped gear.";for(let e=0;e<this.items.length;++e){const t=this.items[e],i=this.simUI.sim.db.lookupItemSpec(t);new wc(a,this.simUI,this,i,e)}}})),this.clearItems();const s=new Nd(this.column1,"bulk-results",{header:{title:"Results",extraCssClasses:["bulk-results-header"]}});s.rootElem.hidden=!0,s.bodyElement.classList.add("gear-picker-root","tab-panel-col"),this.simUI.sim.bulkSimStartEmitter.on((()=>{s.rootElem.hidden=!0})),this.simUI.sim.bulkSimResultEmitter.on(((e,t)=>{s.rootElem.hidden=0==t.results.length,s.bodyElement.innerHTML="";for(const i of t.results){const e=new Nd(s.bodyElement,"bulk-result",{header:{title:""},bodyClasses:["bulk-results-body"]});new fc(e.bodyElement,this.simUI,i,t.equippedGearResult)}}));const o=new Nd(this.rightPanel,"bulk-settings",{header:{title:"Setup"}}),l=document.createElement("button");l.classList.add("btn","btn-primary","w-100","bulk-settings-button"),l.textContent="Simulate Batch",l.addEventListener("click",(()=>{this.pendingDiv.style.display="flex",this.leftPanel.classList.add("blurred"),this.rightPanel.classList.add("blurred");const e=l.innerHTML;l.disabled=!0,l.classList.add(".disabled"),l.innerHTML='<i class="fa fa-spinner fa-spin"></i>&nbsp;Running';let t=(new Date).getTime(),i=0,a=0,s=0,o=0;this.runBulkSim((n=>{console.log(n);const r=(new Date).getTime()-t,d=n.completedIterations/(r/1e3);0==o&&(o=n.totalSims),this.fastMode&&(0==a&&n.totalSims>0&&(a=Math.ceil(Math.log(n.totalSims/20)/Math.log(2))+1,s=1),n.totalSims<i&&(s+=1,t=(new Date).getTime())),this.setSimProgress(n,d,s,a,o),i=n.totalSims,null!=n.finalBulkResult&&(this.pendingDiv.style.display="none",this.leftPanel.classList.remove("blurred"),this.rightPanel.classList.remove("blurred"),this.pendingResults.hideAll(),l.disabled=!1,l.classList.remove(".disabled"),l.innerHTML=e)}))})),o.bodyElement.appendChild(l);const n=document.createElement("button");n.classList.add("btn","btn-secondary","w-100","bulk-settings-button"),n.innerHTML='<i class="fa fa-download"></i> Import From Bags',n.addEventListener("click",(()=>new gc(this.simUI.rootElem,this.simUI,this))),o.bodyElement.appendChild(n);const r=document.createElement("button");r.classList.add("btn","btn-secondary","w-100","bulk-settings-button"),r.innerHTML='<i class="fa fa-download"></i> Import Favorites',r.addEventListener("click",(()=>{const e=this.simUI.player.sim.getFilters().favoriteItems.map((e=>ft.create({id:e})));this.addItems(e)})),o.bodyElement.appendChild(r);const d=document.createElement("button"),c=document.createElement("input");c.type="text",c.placeholder="search...",c.style.display="none";const m=document.createElement("ul");m.classList.add("batch-search-results");let h=Array();c.addEventListener("keyup",(e=>{if("Enter"==e.key){const e=Array();m.childNodes.forEach((t=>{const i=t.getAttribute("data-item-id");null!=i&&e.push(ft.create({id:Number.parseInt(i)}))})),this.addItems(e)}})),c.addEventListener("input",(e=>{const t=c.value;if(m.innerHTML="",0==t.length)return;const i=t.split(" ");let a=0;h.every((e=>{let t=!0;const s=e.name.toLowerCase(),o=e.setName.toLowerCase();if(i.forEach((e=>{const i=e.toLowerCase();return!(!s.includes(i)&&!o.includes(i))||(t=!1,!1)})),t){const t=document.createElement("li");if(t.innerHTML=`<span>${e.name}</span>`,t.setAttribute("data-item-id",e.id.toString()),t.addEventListener("click",(t=>{this.addItems(Array(ft.create({id:e.id})))})),e.heroic){const e=document.createElement("span");e.style.color="green",e.innerText="[H]",t.appendChild(e)}if(e.factionRestriction==be.HORDE_ONLY){const e=document.createElement("span");e.style.color="red",e.innerText="(H)",t.appendChild(e)}if(e.factionRestriction==be.ALLIANCE_ONLY){const e=document.createElement("span");e.style.color="blue",e.innerText="(A)",t.appendChild(e)}m.append(t),a++}return a<10}))})),d.classList.add("btn","btn-secondary","w-100","bulk-settings-button");const p='<i class="fa fa-search"></i> Add Item';d.innerHTML=p,d.addEventListener("click",(()=>{"none"==c.style.display?(d.innerHTML="Close Search Results",h=this.simUI.sim.db.getAllItems().filter((e=>te(e,this.simUI.player.spec,void 0))),c.style.display="block",c.focus()):(d.innerHTML=p,c.style.display="none",m.innerHTML="")})),o.bodyElement.appendChild(d),o.bodyElement.appendChild(c),o.bodyElement.appendChild(m);const u=document.createElement("button");u.classList.add("btn","btn-secondary","w-100","bulk-settings-button"),u.textContent="Clear All",u.addEventListener("click",(()=>{this.clearItems(),s.rootElem.hidden=!0,s.bodyElement.innerHTML=""})),o.bodyElement.appendChild(u);const g=document.createElement("div");this.simTalents?g.style.display="flex":g.style.display="none",g.classList.add("talents-picker-container");const f=document.createElement("label");f.innerText="Pick talents to sim (will increase time to sim)",g.appendChild(f);const w=document.createElement("div");w.classList.add("talents-container");const I=window.localStorage.getItem(this.simUI.getSavedTalentsStorageKey());let y;try{null!==I&&(y=JSON.parse(I))}catch(k){console.warn("Invalid json for local storage value: "+I)}const b=(e,t)=>{const i=e.querySelector(".saved-data-set-chip"),a=this.savedTalents.some((e=>e.name===t.name));if(console.log("Exists:",a),console.log("Load Object:",t),console.log("Saved Talents Before Update:",this.savedTalents),a){const e=this.savedTalents.findIndex((e=>e.name===t.name));this.savedTalents.splice(e,1),i?.classList.remove("active")}else this.savedTalents.push(t),i?.classList.add("active");console.log("Updated savedTalents:",this.savedTalents)};for(const x in y)try{console.log(x,y[x]);const e=ei.fromJson(y[x]);var v={talentsString:e.talentsString,glyphs:e.glyphs,name:x};const t=this.savedTalents.findIndex((e=>JSON.stringify(e)===JSON.stringify(v))),i=document.createElement("fragment");i.innerHTML=`\n\t\t\t\t\t<div class="saved-data-set-chip badge rounded-pill ${-1!==t?"active":""}">\n\t\t\t\t\t\t<a href="javascript:void(0)" class="saved-data-set-name" role="button">${x}</a>\n\t\t\t\t\t</div>`,console.log("Adding event for loadout",v),function(e,t){e.addEventListener("click",(()=>b(e,t)))}(i,v),w.appendChild(i)}catch(k){console.log(k),console.warn("Failed parsing saved data: "+y[x])}g.append(w);const S=document.createElement("div");this.autoGem?S.style.display="flex":S.style.display="none",S.classList.add("default-gem-container");const E=document.createElement("label");E.innerText="Defaults for Auto Gem",S.appendChild(E);const P=document.createElement("div");P.classList.add("sockets-container"),Array(Ot.GemColorRed,Ot.GemColorYellow,Ot.GemColorBlue,Ot.GemColorMeta).forEach(((e,t)=>{const i=document.createElement("fragment");i.innerHTML='\n          <div class="gem-socket-container">\n            <img class="gem-icon" />\n            <img class="socket-icon" />\n          </div>\n        ';const a=i.children[0];this.gemIconElements.push(a.querySelector(".gem-icon"));let s;a.querySelector(".socket-icon").src=Mt(e);const o=e=>{this.defaultGems[t]=e.item,this.storeSettings(),x.fromItemId(e.id).fill().then((e=>{this.gemIconElements[t].src=e.iconUrl})),s.close()},l=(t,i)=>t=>{null==s&&(s=new xc(this.simUI.rootElem,this.simUI,e,o)),s.show()};this.gemIconElements[t].addEventListener("click",l()),a.addEventListener("click",l()),P.appendChild(a)})),S.appendChild(P),new xt(o.bodyElement,this,{label:"Fast Mode",labelTooltip:"Fast mode reduces accuracy but will run faster.",changedEvent:e=>this.itemsChangedEmitter,getValue:e=>this.fastMode,setValue:(e,t,i)=>{t.fastMode=i}}),new xt(o.bodyElement,this,{label:"Combinations",labelTooltip:"When checked bulk simulator will create all possible combinations of the items. When disabled trinkets and rings will still run all combinations becausee they have two slots to fill each.",changedEvent:e=>this.itemsChangedEmitter,getValue:e=>this.doCombos,setValue:(e,t,i)=>{t.doCombos=i}}),new xt(o.bodyElement,this,{label:"Auto Enchant",labelTooltip:"When checked bulk simulator apply the current enchant for a slot to each replacement item it can.",changedEvent:e=>this.itemsChangedEmitter,getValue:e=>this.autoEnchant,setValue:(e,t,i)=>{t.autoEnchant=i,S.style.display=i?"flex":"none"}}),new xt(o.bodyElement,this,{label:"Auto Gem",labelTooltip:"When checked bulk simulator will fill any un-filled gem sockets with default gems.",changedEvent:e=>this.itemsChangedEmitter,getValue:e=>this.autoGem,setValue:(e,t,i)=>{t.autoGem=i,S.style.display=i?"flex":"none"}}),new xt(o.bodyElement,this,{label:"Sim Talents",labelTooltip:"When checked bulk simulator will sim chosen talent setups. Warning, it might cause the bulk sim to run for a lot longer",changedEvent:e=>this.itemsChangedEmitter,getValue:e=>this.simTalents,setValue:(e,t,i)=>{t.simTalents=i,g.style.display=i?"flex":"none"}}),o.bodyElement.appendChild(S),o.bodyElement.appendChild(g)}setSimProgress(e,t,i,a,s){const o=((e.totalIterations-e.completedIterations)/t).toFixed();let l="";a>0&&(l=`${i} / ${a} refining rounds`),this.pendingResults.setContent(`\n      <div class="results-sim">\n        <div class="">${s} total combinations.</div>\n        <div class="">${l}</div>\n        <div class=""> ${e.completedSims} / ${e.totalSims}<br>simulations complete</div>\n        <div class="">\n          ${e.completedIterations} / ${e.totalIterations}<br>iterations complete\n        </div>\n        <div class="">\n          ${o} seconds remaining.\n        </div>\n      </div>\n    `)}}class xc extends dd{constructor(e,i,a,s){super(e,"selector-modal"),t(this,"simUI"),t(this,"contentElem"),t(this,"ilist"),t(this,"socketColor"),t(this,"onSelect"),this.simUI=i,this.onSelect=s,this.socketColor=a,this.ilist=null,window.scrollTo({top:0}),this.header.insertAdjacentHTML("afterbegin","<span>Choose Default Gem</span>"),this.body.innerHTML='<div class="tab-content selector-modal-tab-content"></div>',this.contentElem=this.rootElem.querySelector(".selector-modal-tab-content")}show(){if(null==this.ilist){this.ilist=new hc(this.body,this.simUI,{selectedTab:rc.Gem1,slot:Q.ItemSlotHead,equippedItem:null,eligibleItems:new Array,eligibleEnchants:new Array,gearData:{equipItem:(e,t)=>{},getEquippedItem:()=>null,changeEvent:new l}},this.simUI.player,"Gem1",this.simUI.player.getGems(this.socketColor).map((e=>({item:e,id:e.id,actionId:x.fromItemId(e.id),name:e.name,quality:e.quality,expansion:e.expansion,heroic:!1,baseEP:0,ignoreEPFilter:!0,onEquip:(e,t)=>{}}))),(e=>this.simUI.player.computeGemEP(e)),(()=>null),this.socketColor,(()=>{}),this.onSelect);const e=()=>{this.ilist?.applyFilters()};this.addOnDisposeCallback((()=>this.ilist?.dispose())),this.simUI.sim.filtersChangeEmitter.on(e)}this.open()}}class yc extends m{constructor(e,i,a){super(e,"saved-data-manager-root"),t(this,"modObject"),t(this,"config"),t(this,"userData"),t(this,"presets"),t(this,"savedDataDiv"),t(this,"presetDataDiv"),t(this,"customDataDiv"),t(this,"saveInput"),t(this,"frozen"),this.modObject=i,this.config=a,this.userData=[],this.presets=[],this.frozen=!1;let s=new Nd(this.rootElem,"saved-data",{header:a.header});s.bodyElement.innerHTML='\n\t\t\t<div class="saved-data-container hide">\n\t\t\t\t<div class="saved-data-presets"></div>\n\t\t\t\t<div class="saved-data-custom"></div>\n\t\t\t</div>\n\t\t',this.savedDataDiv=s.bodyElement.querySelector(".saved-data-container"),this.presetDataDiv=s.bodyElement.querySelector(".saved-data-presets"),this.customDataDiv=s.bodyElement.querySelector(".saved-data-custom"),a.presetsOnly||(s.bodyElement.appendChild(this.buildCreateContainer()),this.saveInput=s.bodyElement.querySelector(".saved-data-save-input"))}addSavedData(e){this.savedDataDiv.classList.remove("hide");const t=this.makeSavedData(e),i=e.isPreset?this.presets:this.userData,a=i.findIndex((t=>t.name==e.name));-1==a?(e.isPreset?this.presetDataDiv.appendChild(t.elem):this.customDataDiv.appendChild(t.elem),i.push(t)):(i[a].elem.replaceWith(t.elem),i[a]=t)}makeSavedData(e){const t=document.createElement("fragment");t.innerHTML=`\n\t\t\t<div class="saved-data-set-chip badge rounded-pill">\n\t\t\t\t<a href="javascript:void(0)" class="saved-data-set-name" role="button">${e.name}</a>\n\t\t\t</div>\n\t\t`;const a=t.children[0];if(a.addEventListener("click",(t=>{this.config.setData(l.nextEventID(),this.modObject,e.data),this.saveInput&&(this.saveInput.value=e.name)})),!e.isPreset){let t=document.createElement("fragment");t.innerHTML='\n\t\t\t\t<a\n\t\t\t\t\thref="javascript:void(0)"\n\t\t\t\t\tclass="saved-data-set-delete"\n\t\t\t\t\trole="button"\n\t\t\t\t>\n\t\t\t\t\t<i class="fa fa-times fa-lg"></i>\n\t\t\t\t</a>\n\t\t\t';const s=t.children[0];a.appendChild(s);const o=i.getOrCreateInstance(s,{title:`Delete saved ${this.config.label}`});s.addEventListener("click",(t=>{t.stopPropagation();if(!confirm(`Delete saved ${this.config.label} '${e.name}'?`))return;o.dispose();const i=this.userData.findIndex((t=>t.name==e.name));this.userData[i].elem.remove(),this.userData.splice(i,1),this.saveUserData()}))}e.tooltip&&i.getOrCreateInstance(a,{title:e.tooltip,placement:"bottom",html:!0});const s=()=>{this.config.equals(e.data,this.config.getData(this.modObject))?a.classList.add("active"):a.classList.remove("active"),e.enableWhen&&!e.enableWhen(this.modObject)?a.classList.add("disabled"):a.classList.remove("disabled")};return s(),this.config.changeEmitters.forEach((e=>e.on(s))),{name:e.name,data:e.data,elem:a,enableWhen:e.enableWhen}}saveUserData(){const e={};this.userData.forEach((t=>{e[t.name]=this.config.toJson(t.data)})),0==this.userData.length&&0==this.presets.length&&this.savedDataDiv.classList.add("hide"),window.localStorage.setItem(this.config.storageKey,JSON.stringify(e))}loadUserData(){const e=window.localStorage.getItem(this.config.storageKey);if(!e)return;let t;try{t=JSON.parse(e)}catch(i){console.warn("Invalid json for local storage value: "+e)}for(let a in t)try{this.addSavedData({name:a,data:this.config.fromJson(t[a])})}catch(i){console.warn("Failed parsing saved data: "+t[a])}}freeze(){this.frozen=!0,this.rootElem.classList.add("frozen")}buildCreateContainer(){let e=document.createElement("fragment");e.innerHTML=`\n\t\t\t<div class="saved-data-create-container">\n\t\t\t\t<label class="form-label">${this.config.label} Name</label>\n\t\t\t\t<input class="saved-data-save-input form-control" type="text" placeholder="Name">\n\t\t\t\t<button class="saved-data-save-button btn btn-primary">Save ${this.config.label}</button>\n\t\t\t</div>\n\t\t`;return e.querySelector(".saved-data-save-button").addEventListener("click",(e=>{if(this.frozen)return;const t=this.saveInput?.value;t?t in this.presets?alert(`${this.config.label} with name ${t} already exists.`):(this.addSavedData({name:t,data:this.config.getData(this.modObject)}),this.saveUserData()):alert(`Choose a label for your saved ${this.config.label}!`)})),e.children[0]}}class bc extends m{constructor(e,i,a){super(e,"gem-summary-root"),t(this,"simUI"),t(this,"player"),t(this,"container"),this.simUI=i,this.player=a,this.container=new Nd(this.rootElem,"gem-summary-container",{header:{title:"Gem Summary"}}),l.onAny([a.levelChangeEmitter,a.sim.expansionChangeEmitter,a.gearChangeEmitter]).on((()=>this.updateTable()));const s=this.container.headerElement;if(s){const e=h("button",{className:"btn btn-sm btn-link gem-reset-button",onclick:()=>{this.unequipAllGems()}},h("i",{className:"fas fa-times me-1"}),"Unequip All Gems");s.appendChild(e)}}unequipAllGems(){this.player.setGear(l.nextEventID(),this.player.getGear().withoutGems())}updateTable(){this.container.bodyElement.innerHTML="";const e=this.player.getGear().getAllGems(this.player.isBlacksmithing(),this.player.canUseExtraSockets()),t={};for(const i of e)t[i.name]?t[i.name].count+=1:t[i.name]={gem:i,count:1};for(const i of Object.keys(t)){const e=t[i],a=document.createElement("div");a.classList.add("d-flex","align-items-center","justify-content-between"),a.innerHTML=`\n\t\t\t\t<a class="gem-summary-link" data-whtticon="false" target="_blank">\n\t\t\t\t\t<img class="gem-icon"/>\n\t\t\t\t\t<div>${i}</div>\n\t\t\t\t</a>\n\t\t\t\t<div>${e.count.toFixed(0)}</div>\n\t\t\t`;const s=a.querySelector(".gem-summary-link"),o=a.querySelector(".gem-icon");Rd(s,e.gem.quality),x.fromItemId(e.gem.id).fill().then((e=>{o.src=e.iconUrl,e.setWowheadHref(s)})),this.container.bodyElement.appendChild(a)}}}class vc extends uc{constructor(e,i){super(e,i,{identifier:"gear-tab",title:"Gear"}),t(this,"simUI"),t(this,"leftPanel"),t(this,"rightPanel"),this.simUI=i,this.leftPanel=document.createElement("div"),this.leftPanel.classList.add("gear-tab-left","tab-panel-left"),this.rightPanel=document.createElement("div"),this.rightPanel.classList.add("gear-tab-right","tab-panel-right"),this.contentContainer.appendChild(this.leftPanel),this.contentContainer.appendChild(this.rightPanel),this.buildTabContent()}buildTabContent(){this.buildGearPickers(),this.buildGemSummary(),this.buildSavedGearsetPicker()}buildGearPickers(){new sc(this.leftPanel,this.simUI,this.simUI.player)}buildGemSummary(){new bc(this.leftPanel,this.simUI,this.simUI.player)}buildSavedGearsetPicker(){const e=new yc(this.rightPanel,this.simUI.player,{header:{title:"Gear Sets"},label:"Gear Set",storageKey:this.simUI.getSavedGearStorageKey(),getData:e=>ai.create({gear:e.getGear().asSpec(),bonusStatsStats:e.getBonusStats().toProto()}),setData:(e,t,i)=>{l.freezeAllAndDo((()=>{t.setGear(e,this.simUI.sim.db.lookupEquipmentSpec(i.gear||gt.create())),t.setBonusStats(e,H.fromProto(i.bonusStatsStats||Ce.create()))}))},changeEmitters:[this.simUI.player.changeEmitter],equals:(e,t)=>ai.equals(e,t),toJson:e=>ai.toJson(e),fromJson:e=>ai.fromJson(e)});this.simUI.sim.waitForInit().then((()=>{e.loadUserData(),this.simUI.individualConfig.presets.gear.forEach((t=>{e.addSavedData({name:t.name,tooltip:t.tooltip,isPreset:!0,data:ai.create({gear:this.simUI.sim.db.lookupEquipmentSpec(t.gear).asSpec(),bonusStatsStats:(new H).toProto()}),enableWhen:t.enableWhen})}))}))}}const Sc="Specify Paladin Blessings for each role, in order of priority. Blessings in the 1st column will be used if there is at least 1 Paladin in the raid, 2nd column if at least 2, etc.",Ec="<p>Preset gear lists are intended as rough approximations of BIS, and will often not be the absolute highest-DPS setup for you. Your optimal gear setup will depend on many factors; that's why we have a sim!</p><p>Items may also be omitted from the presets if they are highly contested and clearly better utilized on other classes, to encourage equitable gearing for the raid as a whole.</p>";class Pc extends u{constructor(e,a,s,o){super(e,"icon-enum-picker-root",a,s),t(this,"config"),t(this,"currentValue"),t(this,"buttonElem"),t(this,"buttonText"),t(this,"dropdownMenu"),t(this,"simUI"),this.rootElem.classList.add("icon-picker","dropdown"),this.config=s,this.currentValue=this.config.zeroValue,this.simUI=o,s.tooltip&&i.getOrCreateInstance(this.rootElem,{html:!0,title:s.tooltip}),this.rootElem.appendChild(h(w,null,h("a",{href:"javascript:void(0)",className:"icon-picker-button",attributes:{"aria-expanded":"false",role:"button"},dataset:{bsToggle:"dropdown",bsPlacement:"bottom",whtticon:"false",disableWowheadTouchTooltip:"true"}},h("span",{className:"icon-picker-label"})),h("ul",{className:"dropdown-menu"}))),this.buttonElem=this.rootElem.querySelector(".icon-picker-button"),this.buttonText=this.buttonElem.querySelector(".icon-picker-label"),this.dropdownMenu=this.rootElem.querySelector(".dropdown-menu"),this.config.numColumns&&(this.dropdownMenu.style.gridTemplateColumns=`repeat(${this.config.numColumns}, 1fr)`),"Horizontal"==this.config.direction&&(this.dropdownMenu.style.gridAutoFlow="column"),this.buildPickers(),this.init()}setActionImage(e,t){t.fillAndSet(e,!0,!0)}buildPickers(){this.dropdownMenu.replaceChildren();const e=this.config.values.map((e=>{const t=document.createElement("li");t.classList.add("icon-dropdown-option","dropdown-option"),this.dropdownMenu.appendChild(t);const a=document.createElement("a");if(a.classList.add("icon-picker-button"),a.dataset.whtticon="false",a.dataset.disableWowheadTouchTooltip="true",t.appendChild(a),this.setImage(a,e),null!=e.text){const t=document.createElement("div");t.classList.add("icon-picker-label"),t.textContent=e.text,a.append(t)}e.tooltip&&i.getOrCreateInstance(a,{html:!0,title:e.tooltip});const s=!e.showWhen||e.showWhen(this.modObject);return s||t.classList.add("hide"),a.addEventListener("click",(t=>{t.preventDefault(),this.currentValue=e.value,this.inputChanged(l.nextEventID())})),s&&!this.config.equals(e.value,this.config.zeroValue)})).filter((e=>e)).length>0,t=this.config.showWhen&&this.config.showWhen(this.modObject);e&&t?this.buttonElem.classList.remove("hide"):this.buttonElem.classList.add("hide")}setImage(e,t){if(t.actionId)if(t.actionId instanceof si){const i=t.actionId.getActionId(this.simUI.getLevel());i&&this.setActionImage(e,i),this.simUI.levelChangeEmitter.on((()=>{const i=t.actionId.getActionId(this.simUI.getLevel());i&&this.setActionImage(e,i)}))}else this.setActionImage(e,t.actionId);else e.style.backgroundImage="",e.style.backgroundColor=t.color}update(){super.update(),this.buildPickers(),this.updateState(this.currentValue)}getInputElem(){return this.buttonElem}getInputValue(){return this.currentValue}setInputValue(e){this.currentValue=e,this.updateState(this.currentValue),this.buttonText.textContent="",this.buttonText.style.display="none";const t=this.config.values.find((e=>this.config.equals(e.value,this.currentValue)));if(t)this.setImage(this.buttonElem,t),null!=t.text&&(this.buttonText.style.display="block",this.buttonText.textContent=t.text);else if(this.config.backupIconUrl){const e=this.config.backupIconUrl(this.currentValue);this.setActionImage(this.buttonElem,e),this.setActive(!1)}}updateState(e){const t=this.config.values.find((t=>this.config.equals(e,t.value)));!t||t.showWhen&&!t.showWhen(this.modObject)?(this.setError(!0),this.setActive(!1)):(this.setError(!1),this.enabled&&!this.config.equals(e,this.config.zeroValue)?this.setActive(!0):this.setActive(!1))}setActive(e){e?this.buttonElem.classList.add("active"):this.buttonElem.classList.remove("active")}setError(e){e?this.buttonElem.classList.add("error"):this.buttonElem.classList.remove("error")}}class kc extends u{constructor(e,i,a,s){super(e,"icon-picker-root",i,a),t(this,"active"),t(this,"config"),t(this,"rootAnchor"),t(this,"improvedAnchor"),t(this,"improvedAnchor2"),t(this,"counterElem"),t(this,"simUI"),t(this,"currentValue"),t(this,"currentID"),t(this,"handleLeftClick",(e=>{0==this.config.states||this.currentValue+1<this.config.states?(this.currentValue++,this.inputChanged(l.nextEventID())):this.currentValue>0&&(this.currentValue=0,this.inputChanged(l.nextEventID())),e.preventDefault()})),t(this,"handleRightClick",(e=>{this.currentValue>0?this.currentValue--:0===this.config.states?this.currentValue=1:this.currentValue=this.config.states-1,this.inputChanged(l.nextEventID())})),this.rootElem.classList.add("icon-picker"),this.active=!1,this.config=a,this.currentValue=0,this.simUI=s,this.rootAnchor=document.createElement("a"),this.rootAnchor.classList.add("icon-picker-button"),this.rootAnchor.dataset.whtticon="false",this.rootAnchor.dataset.disableWowheadTouchTooltip="true",this.rootAnchor.target="_blank",this.rootElem.prepend(this.rootAnchor),a.actionId instanceof si?this.currentID=a.actionId.getActionId(s.getLevel()):this.currentID=a.actionId;const o=Boolean(this.config.improvedId);o&&this.rootAnchor.classList.add("use-improved-icons"),this.config.improvedId2&&this.rootAnchor.classList.add("use-improved-icons2"),!o&&this.config.states>2&&this.rootAnchor.classList.add("use-counter");const n=p(),r=p(),d=p();this.rootAnchor.appendChild(h("div",{className:"icon-input-level-container"},h("a",{ref:n,className:"icon-picker-button icon-input-improved icon-input-improved1",dataset:{whtticon:"false",disableWowheadTouchTooltip:"true"}}),h("a",{ref:r,className:"icon-picker-button icon-input-improved icon-input-improved2",dataset:{whtticon:"false",disableWowheadTouchTooltip:"true"}}),h("span",{ref:d,className:"icon-picker-label "+(this.config.states>2?"":"hide")}))),this.improvedAnchor=n.value,this.improvedAnchor2=r.value,this.counterElem=d.value,this.currentID&&this.currentID.fillAndSet(this.rootAnchor,!0,!0,s.getLevel()),a.actionId instanceof si&&s.levelChangeEmitter.on((()=>{this.currentID=a.actionId.getActionId(s.getLevel()),this.currentID&&this.currentID.fillAndSet(this.rootAnchor,!0,!0,s.getLevel())})),this.config.states>=3&&this.config.improvedId&&this.config.improvedId.fillAndSet(this.improvedAnchor,!0,!0,s.getLevel()),this.config.states>=4&&this.config.improvedId2&&this.config.improvedId2.fillAndSet(this.improvedAnchor2,!0,!0,s.getLevel()),this.init(),this.rootAnchor.addEventListener("click",(e=>{this.handleLeftClick(e)})),this.rootAnchor.addEventListener("contextmenu",(e=>{e.preventDefault()})),this.rootAnchor.addEventListener("mousedown",(e=>{I(e)&&(this.handleRightClick(e),e.preventDefault())}))}getInputElem(){return this.rootAnchor}getInputValue(){return 2==this.config.states?Boolean(this.currentValue):this.currentValue}getActionId(){const e=Number(this.config.getValue(this.modObject));return 0==e?null:1==e?this.currentID:2==e&&this.config.improvedId?this.config.improvedId:3==e&&this.config.improvedId2?this.config.improvedId2:this.currentID}setInputValue(e){this.currentValue=Number(e),this.currentValue>0?(this.active=!0,this.rootAnchor.classList.add("active"),this.counterElem.classList.add("active")):(this.active=!1,this.rootAnchor.classList.remove("active"),this.counterElem.classList.remove("active")),this.config.states>=3&&this.config.improvedId&&(this.currentValue>1?this.improvedAnchor.classList.add("active"):this.improvedAnchor.classList.remove("active")),this.config.states>=4&&this.config.improvedId2&&(this.currentValue>2?(this.improvedAnchor2.classList.add("active"),this.improvedAnchor.hidden=!0,this.improvedAnchor2.hidden=!1):(this.improvedAnchor2.classList.remove("active"),this.improvedAnchor.hidden=!1,this.improvedAnchor2.hidden=!0)),!this.config.improvedId&&(this.config.states>3||0==this.config.states)&&(this.counterElem.textContent=String(this.currentValue))}}function Cc(e,t,i){return{inputs:e,label:t,categoryId:i,showWhen:t=>e.filter((e=>!e.showWhen||e.showWhen(t))).length>0}}function _c(e){const t=e.getModObject;return{type:"boolean",label:e.label,labelTooltip:e.labelTooltip,changedEvent:i=>e.changedEvent(t(i)),getValue:i=>e.getValue(t(i)),setValue:(i,a,s)=>e.setValue(i,t(a),s),enableWhen:e.enableWhen?i=>e.enableWhen(t(i)):void 0,showWhen:e.showWhen?i=>e.showWhen(t(i)):void 0,extraCssClasses:e.extraCssClasses}}function Nc(e){return _c({label:e.label,labelTooltip:e.labelTooltip,getModObject:e=>e,getValue:e.getValue||(t=>t.getSpecOptions()[e.fieldName]),setValue:e.setValue||((t,i,a)=>{const s=i.getSpecOptions();s[e.fieldName]=a,i.setSpecOptions(t,s)}),changedEvent:e.changeEmitter||(e=>e.specOptionsChangeEmitter),enableWhen:e.enableWhen,showWhen:e.showWhen,extraCssClasses:e.extraCssClasses})}function Tc(e){return _c({label:e.label,labelTooltip:e.labelTooltip,getModObject:e=>e,getValue:e.getValue||(t=>t.getSimpleRotation()[e.fieldName]),setValue:e.setValue||((t,i,a)=>{const s=i.getSimpleRotation();s[e.fieldName]=a,i.setSimpleRotation(t,s)}),changedEvent:e.changeEmitter||(e=>e.rotationChangeEmitter),enableWhen:e.enableWhen,showWhen:e.showWhen,extraCssClasses:e.extraCssClasses})}function Rc(e){const t=e.getModObject;return{type:"number",label:e.label,labelTooltip:e.labelTooltip,float:e.float,positive:e.positive,changedEvent:i=>e.changedEvent(t(i)),getValue:i=>e.getValue(t(i)),setValue:(i,a,s)=>e.setValue(i,t(a),s),enableWhen:e.enableWhen?i=>e.enableWhen(t(i)):void 0,showWhen:e.showWhen?i=>e.showWhen(t(i)):void 0,extraCssClasses:e.extraCssClasses}}function Lc(e){const t={label:e.label,labelTooltip:e.labelTooltip,float:e.float,positive:e.positive,getModObject:e=>e,getValue:e.getValue||(t=>t.getSpecOptions()[e.fieldName]),setValue:e.setValue||((t,i,a)=>{const s=i.getSpecOptions();s[e.fieldName]=a,i.setSpecOptions(t,s)}),changedEvent:e.changeEmitter||(e=>e.specOptionsChangeEmitter),enableWhen:e.enableWhen,showWhen:e.showWhen,extraCssClasses:e.extraCssClasses};if(e.percent){const e=t.getValue;t.getValue=t=>100*e(t);const i=t.setValue;t.setValue=(e,t,a)=>i(e,t,a/100)}return Rc(t)}function Gc(e){const t={label:e.label,labelTooltip:e.labelTooltip,float:e.float,positive:e.positive,getModObject:e=>e,getValue:e.getValue||(t=>t.getSimpleRotation()[e.fieldName]),setValue:e.setValue||((t,i,a)=>{const s=i.getSimpleRotation();s[e.fieldName]=a,i.setSimpleRotation(t,s)}),changedEvent:e.changeEmitter||(e=>e.rotationChangeEmitter),enableWhen:e.enableWhen,showWhen:e.showWhen,extraCssClasses:e.extraCssClasses};if(e.percent){const e=t.getValue;t.getValue=t=>100*e(t);const i=t.setValue;t.setValue=(e,t,a)=>i(e,t,a/100)}return Rc(t)}function Ac(e){const t=e.getModObject;return{type:"enum",label:e.label,labelTooltip:e.labelTooltip,values:e.values,changedEvent:i=>e.changedEvent(t(i)),getValue:i=>e.getValue(t(i)),setValue:(i,a,s)=>e.setValue(i,t(a),s),enableWhen:e.enableWhen?i=>e.enableWhen(t(i)):void 0,showWhen:e.showWhen?i=>e.showWhen(t(i)):void 0}}function Dc(e){return Ac({label:e.label,labelTooltip:e.labelTooltip,values:e.values,getModObject:e=>e,getValue:e.getValue||(t=>t.getSpecOptions()[e.fieldName]),setValue:e.setValue||((t,i,a)=>{const s=i.getSpecOptions();s[e.fieldName]=a,i.setSpecOptions(t,s)}),changedEvent:e.changeEmitter||(e=>e.specOptionsChangeEmitter),enableWhen:e.enableWhen,showWhen:e.showWhen})}function Uc(e){return Ac({label:e.label,labelTooltip:e.labelTooltip,values:e.values,getModObject:e=>e,getValue:e.getValue||(t=>t.getSimpleRotation()[e.fieldName]),setValue:e.setValue||((t,i,a)=>{const s=i.getSimpleRotation();s[e.fieldName]=a,i.setSimpleRotation(t,s)}),changedEvent:e.changeEmitter||(e=>e.rotationChangeEmitter),enableWhen:e.enableWhen,showWhen:e.showWhen})}function Oc(e){const t=e.getModObject;return{type:"icon",actionId:e.actionId,states:e.states,changedEvent:i=>e.changedEvent(t(i)),getValue:i=>e.getValue(t(i)),setValue:(i,a,s)=>e.setValue(i,t(a),s),extraCssClasses:e.extraCssClasses,showWhen:i=>!e.showWhen||e.showWhen(t(i))}}function Mc(e,t,i,a){return Oc({getModObject:e.getModObject,actionId:t,states:2,changedEvent:e.changeEmitter,showWhen:e.showWhen,getValue:e.getFieldValue||(t=>a?e.getValue(t)[i]==a:e.getValue(t)[i]),setValue:e.setFieldValue||((t,s,o)=>{const l=e.getValue(s);a?o?l[i]=a:l[i]==a&&(l[i]=0):l[i]=o,e.setValue(t,s,l)}),extraCssClasses:e.extraCssClasses})}function Wc(e){return Mc({getModObject:e=>e,getValue:e=>e.getSpecOptions(),setValue:(e,t,i)=>t.setSpecOptions(e,i),changeEmitter:e.changeEmitter||(e=>l.onAny([e.specOptionsChangeEmitter,e.levelChangeEmitter])),extraCssClasses:e.extraCssClasses,getFieldValue:e.getValue,setFieldValue:e.setValue,showWhen:e.showWhen},e.id,e.fieldName,e.value)}function Vc(e,t,i,a){return Oc({getModObject:e.getModObject,actionId:t,states:0,changedEvent:e.changeEmitter,getValue:t=>e.getValue(t)[i],setValue:(t,s,o)=>{const l=e.getValue(s);if(a){const e=o-l[i];o+=(a-1)*e}o<0&&(o=0),l[i]=o,e.setValue(t,s,l)},showWhen:e.showWhen})}function Fc(e,t,i,a){const s=Vc(e,t,a);return s.states=3,s.improvedId=i,s}function zc(e,t,i,a,s){const o=Vc(e,t,a,s);return o.states=i,o}function jc(e){return function(e){const t=e.getModObject;return{type:"iconEnum",numColumns:e.numColumns,values:e.values.map((e=>{if(e.showWhen){const i=e.showWhen;e.showWhen=e=>i(t(e))}return e})),equals:e.equals,showWhen:i=>!e.showWhen||e.showWhen(t(i)),zeroValue:e.zeroValue,changedEvent:i=>e.changedEvent(t(i)),getValue:i=>e.getValue(t(i)),setValue:(i,a,s)=>e.setValue(i,t(a),s),extraCssClasses:e.extraCssClasses}}({numColumns:e.numColumns||1,values:e.values,equals:(e,t)=>e==t,showWhen:e.showWhen,zeroValue:0,getModObject:e=>e,getValue:e.getValue||(t=>t.getSpecOptions()[e.fieldName]),setValue:e.setValue||((t,i,a)=>{const s=i.getSpecOptions();s[e.fieldName]=a,i.setSpecOptions(t,s)}),changedEvent:e.changeEmitter||(e=>l.onAny([e.specOptionsChangeEmitter,e.levelChangeEmitter])),extraCssClasses:e.extraCssClasses})}const Hc=(e,t,i)=>(e.classList.remove("hide"),"icon"==i.type?new kc(e,t.player,i,t):"iconEnum"==i.type?new Pc(e,t.player,i,t):void 0);function Bc(e,t){return e.label=t,e}function qc(e){return Mc({getModObject:e=>e,showWhen:t=>(!e.faction||e.faction==t.getFaction())&&(!e.showWhen||e.showWhen(t)),getValue:e=>e.getRaid().getBuffs(),setValue:(e,t,i)=>t.getRaid().setBuffs(e,i),changeEmitter:e=>l.onAny([e.getRaid().buffsChangeEmitter,e.raceChangeEmitter,e.levelChangeEmitter])},e.actionId,e.fieldName,e.value)}function $c(e){return Mc({getModObject:e=>e.getParty(),getValue:e=>e.getBuffs(),setValue:(e,t,i)=>t.setBuffs(e,i),changeEmitter:e=>l.onAny([e.buffsChangeEmitter,e.getPlayer(0).levelChangeEmitter]),showWhen:t=>!e.showWhen||e.showWhen(t.getPlayer(0))},e.actionId,e.fieldName,e.value)}function Kc(e){return Mc({getModObject:e=>e,showWhen:t=>(!e.faction||e.faction==t.getFaction())&&(!e.showWhen||e.showWhen(t)),getValue:e=>e.getBuffs(),setValue:(e,t,i)=>t.setBuffs(e,i),changeEmitter:e=>l.onAny([e.buffsChangeEmitter,e.raceChangeEmitter,e.levelChangeEmitter])},e.actionId,e.fieldName,e.value)}function Yc(e){return Mc({getModObject:e=>e,getValue:e=>e.getConsumes(),setValue:(e,t,i)=>t.setConsumes(e,i),changeEmitter:e=>l.onAny([e.consumesChangeEmitter])},e.actionId,e.fieldName,e.value)}function Jc(e){return Mc({getModObject:e=>e,getValue:e=>e.getRaid().getDebuffs(),setValue:(e,t,i)=>t.getRaid().setDebuffs(e,i),changeEmitter:e=>l.onAny([e.getRaid().debuffsChangeEmitter,e.levelChangeEmitter]),showWhen:e.showWhen},e.actionId,e.fieldName,e.value)}function Zc(e){return Fc({getModObject:e=>e,showWhen:t=>(!e.faction||e.faction==t.getFaction())&&(!e.showWhen||e.showWhen(t)),getValue:e=>e.getRaid().getBuffs(),setValue:(e,t,i)=>t.getRaid().setBuffs(e,i),changeEmitter:e=>l.onAny([e.getRaid().buffsChangeEmitter,e.raceChangeEmitter,e.levelChangeEmitter])},e.actionId,e.impId,e.fieldName)}function Qc(e){return Fc({getModObject:e=>e,showWhen:t=>(!e.faction||e.faction==t.getFaction())&&(!e.showWhen||e.showWhen(t)),getValue:e=>e.getBuffs(),setValue:(e,t,i)=>t.setBuffs(e,i),changeEmitter:e=>l.onAny([e.buffsChangeEmitter,e.raceChangeEmitter,e.levelChangeEmitter])},e.actionId,e.impId,e.fieldName)}function Xc(e){return Fc({getModObject:e=>e.getRaid(),getValue:e=>e.getDebuffs(),setValue:(e,t,i)=>t.setDebuffs(e,i),changeEmitter:e=>l.onAny([e.debuffsChangeEmitter,e.getPlayer(0).levelChangeEmitter]),showWhen:t=>!e.showWhen||e.showWhen(t.getPlayer(0))},e.actionId,e.impId,e.fieldName)}function em(e){return zc({getModObject:e=>e,showWhen:t=>(!e.faction||e.faction==t.getFaction())&&(!e.showWhen||e.showWhen(t)),getValue:e=>e.getBuffs(),setValue:(e,t,i)=>t.setBuffs(e,i),changeEmitter:e=>l.onAny([e.buffsChangeEmitter,e.raceChangeEmitter,e.levelChangeEmitter])},e.actionId,e.numStates,e.fieldName,e.multiplier)}function tm(e,t,i,a,s){return zc({getModObject:e=>e,getValue:e=>e.getBuffs(),setValue:(e,t,i)=>t.setBuffs(e,i),changeEmitter:e=>l.onAny([e.buffsChangeEmitter,e.levelChangeEmitter]),showWhen:s},e,t,a,i)}const im={actions:{create:{useIcon:!1}}};var am=null;class sm extends u{constructor(e,a,s){if(super(e,"list-picker-root",a,s),t(this,"config"),t(this,"itemsDiv"),t(this,"itemPickerPairs"),this.config={...im,...s},this.itemPickerPairs=[],this.rootElem.appendChild(h(w,null,s.title&&h("label",{className:"list-picker-title form-label"},s.title),h("div",{className:"list-picker-items"}))),this.config.hideUi&&this.rootElem.classList.add("d-none"),this.config.horizontalLayout&&(this.config.inlineMenuBar=!0,this.rootElem.classList.add("horizontal")),this.config.titleTooltip){let e={title:this.config.titleTooltip};i.getOrCreateInstance(this.rootElem.querySelector(".list-picker-title"),e)}if(this.itemsDiv=this.rootElem.getElementsByClassName("list-picker-items")[0],this.actionEnabled("create")){let e=null,t=null;this.config.actions?.create?.useIcon?(e=sm.makeActionElem("link-success","fa-plus"),t=i.getOrCreateInstance(e,{title:`New ${s.itemLabel}`})):(e=document.createElement("button"),e.classList.add("btn","btn-primary"),e.textContent=`New ${s.itemLabel}`),e.classList.add("list-picker-new-button"),e.addEventListener("click",(e=>{const i=this.config.newItem(),a=this.config.getValue(this.modObject).concat([i]);this.config.setValue(l.nextEventID(),this.modObject,a),t&&t.hide()})),this.rootElem.appendChild(e)}this.init()}getInputElem(){return this.rootElem}getInputValue(){return this.itemPickerPairs.map((e=>e.picker.getInputValue()))}setInputValue(e){if(e.length<this.itemPickerPairs.length)this.itemPickerPairs.slice(e.length).forEach((e=>e.elem.remove())),this.itemPickerPairs=this.itemPickerPairs.slice(0,e.length);else if(e.length>this.itemPickerPairs.length){const t=e.length-this.itemPickerPairs.length;for(let e=0;e<t;e++)this.addNewPicker()}e.forEach(((e,t)=>this.itemPickerPairs[t].picker.setInputValue(e)))}actionEnabled(e){return!this.config.allowedActions||this.config.allowedActions.includes(e)}addNewPicker(){const e=this.itemPickerPairs.length,t=document.createElement("div");t.classList.add("list-picker-item-container"),this.config.inlineMenuBar&&t.classList.add("inline"),this.itemsDiv.appendChild(t);const a=document.createElement("div");a.classList.add("list-picker-item");const s=document.createElement("div");if(s.classList.add("list-picker-item-header"),this.config.inlineMenuBar)t.appendChild(a),t.appendChild(s);else if(t.appendChild(s),t.appendChild(a),this.config.itemLabel){const e=document.createElement("h6");e.classList.add("list-picker-item-title"),e.textContent=`${this.config.itemLabel} ${this.itemPickerPairs.length+1}`,s.appendChild(e)}const o=this.config.newItemPicker(a,this,e,{changedEvent:this.config.changedEvent,getValue:t=>this.getSourceValue()[e],setValue:(t,i,a)=>{const s=this.getSourceValue();s[e]=a,this.config.setValue(t,i,s)}}),n={elem:t,picker:o,idx:e};if(this.actionEnabled("move")){const a=sm.makeActionElem("list-picker-item-move","fa-arrows-up-down");s.appendChild(a);const o=i.getOrCreateInstance(a,{title:"Move (Drag+Drop)"});a.addEventListener("click",(e=>{o.hide()})),a.draggable=!0,a.ondragstart=e=>{e.target==a&&(e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",t.classList.add("dragfrom"),am={listPicker:this,item:n})};let r=0;t.ondragenter=e=>{am&&am.listPicker==this&&(e.preventDefault(),r++,t.classList.add("dragto"))},t.ondragleave=e=>{am&&am.listPicker==this&&(e.preventDefault(),r--,r<=0&&t.classList.remove("dragto"))},t.ondragover=e=>{am&&am.listPicker==this&&e.preventDefault()},t.ondrop=i=>{if(!am||am.listPicker!=this)return;i.preventDefault(),r=0,t.classList.remove("dragto"),am.item.elem.classList.remove("dragfrom");const a=am.item.idx,s=e,o=this.config.getValue(this.modObject),n=o[a];o.splice(a,1),o.splice(s,0,n),this.config.setValue(l.nextEventID(),this.modObject,o),am=null}}if(this.actionEnabled("copy")){const t=sm.makeActionElem("list-picker-item-copy","fa-copy");s.appendChild(t);const a=i.getOrCreateInstance(t,{title:`Copy to New ${this.config.itemLabel}`});t.addEventListener("click",(t=>{const i=this.config.getValue(this.modObject).slice();i.splice(e,0,this.config.copyItem(i[e])),this.config.setValue(l.nextEventID(),this.modObject,i),a.hide()}))}if(this.actionEnabled("delete")){const t=sm.makeActionElem("list-picker-item-delete","fa-times");t.classList.add("link-danger"),s.appendChild(t);const a=i.getOrCreateInstance(t,{title:`Delete ${this.config.itemLabel}`});t.addEventListener("click",(t=>{const i=this.config.getValue(this.modObject);i.splice(e,1),this.config.setValue(l.nextEventID(),this.modObject,i),a.hide()}))}this.itemPickerPairs.push(n)}static makeActionElem(e,t){const i=document.createElement("a");i.classList.add("list-picker-item-action",e),i.href="javascript:void(0)",i.setAttribute("role","button");const a=document.createElement("i");return a.classList.add("fa","fa-xl",t),i.appendChild(a),i}static getItemHeaderElem(e){const t=e.rootElem.parentElement,i=t.nextElementSibling||t.previousElementSibling;if(!i?.classList.contains("list-picker-item-header"))throw new Error("Could not find list item header");return i}}class om extends u{constructor(e,i,a){super(e,"adaptive-string-picker-root",i,a),t(this,"inputElem"),this.inputElem=document.createElement("input"),this.inputElem.type="text",this.inputElem.classList.add("form-control"),this.rootElem.appendChild(this.inputElem),this.init(),this.inputElem.addEventListener("change",(e=>{this.inputChanged(l.nextEventID())})),this.inputElem.addEventListener("input",(e=>{this.updateSize()})),this.updateSize()}getInputElem(){return this.inputElem}getInputValue(){return this.inputElem.value}setInputValue(e){this.inputElem.value=e,this.updateSize()}updateSize(){const e=Math.max(3,this.inputElem.value.length);this.inputElem.size!=e&&(this.inputElem.size=e)}}const lm={auras:{defaultLabel:"Aura",getActionIDs:async e=>e.getAuras().map((e=>({value:e.id})))},stackable_auras:{defaultLabel:"Aura",getActionIDs:async e=>e.getAuras().filter((e=>e.data.maxStacks>0)).map((e=>({value:e.id})))},icd_auras:{defaultLabel:"Aura",getActionIDs:async e=>e.getAuras().filter((e=>e.data.hasIcd)).map((e=>({value:e.id})))},exclusive_effect_auras:{defaultLabel:"Aura",getActionIDs:async e=>e.getAuras().filter((e=>e.data.hasExclusiveEffect)).map((e=>({value:e.id})))},spells:{defaultLabel:"Spell",getActionIDs:async e=>e.getSpells().filter((e=>e.data.isCastable)).map((e=>({value:e.id})))},castable_spells:{defaultLabel:"Spell",getActionIDs:async e=>{const t=e.getSpells().filter((e=>e.data.isCastable)),{spells:i,cooldowns:a}=pi(t,(e=>e.data.isMajorCooldown?"cooldowns":"spells")),s=[x.fromOtherId(ui.OtherActionPotion)];return[[{value:x.fromEmpty(),headerText:"Spells",submenu:["Spells"]}],(i||[]).map((e=>({value:e.id,submenu:["Spells"],extraCssClasses:e.data.prepullOnly?["apl-prepull-actions-only"]:e.data.encounterOnly?["apl-priority-list-only"]:[]}))),[{value:x.fromEmpty(),headerText:"Cooldowns",submenu:["Cooldowns"]}],(a||[]).map((e=>({value:e.id,submenu:["Cooldowns"],extraCssClasses:e.data.prepullOnly?["apl-prepull-actions-only"]:e.data.encounterOnly?["apl-priority-list-only"]:[]}))),[{value:x.fromEmpty(),headerText:"Placeholders",submenu:["Placeholders"]}],s.map((e=>({value:e,submenu:["Placeholders"],tooltip:"The Prepull Potion if CurrentTime < 0, or the Combat Potion if combat has started."})))].flat()}},non_instant_spells:{defaultLabel:"Non-instant Spell",getActionIDs:async e=>e.getSpells().filter((e=>e.data.isCastable&&e.data.hasCastTime)).map((e=>({value:e.id})))},channel_spells:{defaultLabel:"Channeled Spell",getActionIDs:async e=>e.getSpells().filter((e=>e.data.isCastable&&e.data.isChanneled)).map((e=>({value:e.id})))},dot_spells:{defaultLabel:"DoT Spell",getActionIDs:async e=>e.getSpells().filter((e=>e.data.hasDot)).map((e=>({value:e.id})))},shield_spells:{defaultLabel:"Shield Spell",getActionIDs:async e=>e.getSpells().filter((e=>e.data.hasShield)).map((e=>({value:e.id})))}};class nm extends ci{constructor(e,t,i){const a=lm[i.actionIdSet];super(e,t,{...i,sourceToValue:e=>e?x.fromProto(e):x.fromEmpty(),valueToSource:e=>e.toProto(),defaultLabel:a.defaultLabel,equals:(e,t)=>null==e==(null==t)&&(!e||e.equals(t)),setOptionContent:(e,i)=>{const a=i.value,s=document.createElement("a");s.classList.add("apl-actionid-item-icon"),s.dataset.whtticon="false",s.classList.add("apl-actionid-item-icon"),a.setBackgroundAndHref(s,t.getLevel()),e.appendChild(s);const o=document.createTextNode(a.name);e.appendChild(o)},createMissingValue:e=>0==e.anyId()?new Promise((()=>{a.defaultLabel})):e.fill().then((e=>({value:e}))),values:[]});const s=i.getUnitRef,o="self"==i.defaultUnitRef?We.create({type:Me.Self}):We.create({type:Me.CurrentTarget}),n=a.getActionIDs,r=async()=>{const e=s(t),i=t.sim.getUnitMetadata(e,t,o);if(i){const e=await n(i);this.setOptions(e)}};r(),l.onAny([t.sim.unitMetadataEmitter,t.rotationChangeEmitter]).on(r)}}const rm={aura_sources:{getUnits:e=>[void 0,e.getPetMetadatas().asList().map(((e,t)=>We.create({type:Me.Pet,index:t,owner:We.create({type:Me.Self})}))),We.create({type:Me.CurrentTarget}),e.sim.encounter.targetsMetadata.asList().map(((e,t)=>We.create({type:Me.Target,index:t})))].flat()},aura_sources_targets_first:{targetUI:!0,getUnits:e=>[void 0,e.sim.encounter.targetsMetadata.asList().map(((e,t)=>We.create({type:Me.Target,index:t}))),We.create({type:Me.Self}),e.getPetMetadatas().asList().map(((e,t)=>We.create({type:Me.Pet,index:t,owner:We.create({type:Me.Self})})))].flat()},targets:{targetUI:!0,getUnits:e=>[void 0,e.sim.encounter.targetsMetadata.asList().map(((e,t)=>We.create({type:Me.Target,index:t})))].flat()}};class dm extends mi{constructor(e,i,a){const s=!!rm[a.unitSet].targetUI;super(e,i,{...a,sourceToValue:e=>dm.refToValue(e,i,s),valueToSource:e=>e.value,values:[],hideLabelWhenDefaultSelected:!0}),t(this,"unitSet"),this.unitSet=a.unitSet,this.rootElem.classList.add("apl-unit-picker"),this.updateValues(),i.sim.unitMetadataEmitter.on((()=>this.updateValues()))}static refToValue(e,t,i){if(!e||e.type==Me.Unknown)return{value:e,iconUrl:i?"fa-bullseye":"fa-user",text:i?"Current Target":"Self"};if(e.type==Me.Self)return{value:e,iconUrl:"fa-user",text:"Self"};if(e.type==Me.CurrentTarget)return{value:e,iconUrl:"fa-bullseye",text:"Current Target"};if(e.type==Me.Player){const i=t.sim.raid.getPlayer(e.index);if(i)return{value:e,iconUrl:i.getSpecIcon(),text:`Player ${e.index+1}`}}else if(e.type==Me.Target){if(t.sim.encounter.targetsMetadata.asList()[e.index])return{value:e,iconUrl:hi,text:`Target ${e.index+1}`}}else if(e.type==Me.Pet){const i=t.sim.getUnitMetadata(e,t,We.create({type:Me.Self}));let a=`Pet ${e.index+1}`,s="fa-paw";if(i){const e=i.getName();if(e){const t=e.indexOf(" - ");a=e.substring(t+3),s=gi(a)||s}}return{value:e,iconUrl:s,text:a}}return{value:e}}updateValues(){const e=rm[this.unitSet],t=e.getUnits(this.modObject);this.setOptions(t.map((t=>{const i={value:dm.refToValue(t,this.modObject,e.targetUI)};return t&&t.type==Me.Pet&&(e.targetUI?i.submenu=[dm.refToValue(t.owner,this.modObject,e.targetUI)]:i.submenu=[dm.refToValue(void 0,this.modObject,e.targetUI)]),i})))}}class cm extends u{constructor(e,i,a){super(e,"apl-picker-builder-root",i,a),t(this,"config"),t(this,"fieldPickers"),this.config=a,this.fieldPickers=a.fields.map((e=>cm.makeFieldPicker(this,e))),this.init()}static makeFieldPicker(e,t){const i=t.field,a=t.factory(e.rootElem,e.modObject,{label:t.label,labelTooltip:t.labelTooltip,changedEvent:e=>e.rotationChangeEmitter,getValue:()=>{const a=e.getSourceValue();return a[i]||(a[i]=t.newValue()),a[i]},setValue:(t,a,s)=>{e.getSourceValue()[i]=s,a.rotationChangeEmitter.emit(t)}},(()=>e.getSourceValue()));return"vals"!==i&&"actions"!==i||a.rootElem.classList.add("apl-picker-builder-multi"),{...t,picker:a}}getInputElem(){return this.rootElem}getInputValue(){const e=this.config.newValue();return this.fieldPickers.forEach((t=>{e[t.field]=t.picker.getInputValue()})),e}setInputValue(e){this.fieldPickers.forEach((t=>{t.picker.setInputValue(e[t.field])}))}}function mm(e,t,i,a,s){return{field:e,newValue:()=>oi.create(),factory:(e,s,o,l)=>new nm(e,s,{...o,actionIdSet:t,getUnitRef:()=>i?l()[i]:We.create(),defaultUnitRef:a||"self"}),...s||{}}}function hm(e,t,i){return{field:e,newValue:()=>{},factory:(e,i,a)=>new dm(e,i,{...a,unitSet:t}),...i||{}}}function pm(e,t,i){return{field:e,newValue:()=>!1,factory:(e,t,i)=>(i.extraCssClasses=["input-inline"].concat(i.extraCssClasses||[]),new xt(e,t,i)),...i||{},label:t}}function um(e,t,i){return{field:e,newValue:()=>0,factory:(e,i,a)=>{const s=a;return s.float=t,s.extraCssClasses=["input-inline"].concat(a.extraCssClasses||[]),new il(e,i,s)},...i||{}}}function gm(e,t){return{field:e,newValue:()=>"",factory:(e,t,i)=>(i.extraCssClasses=["input-inline"].concat(i.extraCssClasses||[]),new om(e,t,i)),...t||{}}}function fm(e,t){const i=[{value:li.RuneBlood,label:"Blood"},{value:li.RuneFrost,label:"Frost"},{value:li.RuneUnholy,label:"Unholy"}];return t&&i.push({value:li.RuneDeath,label:"Death"}),{field:e,newValue:()=>li.RuneBlood,factory:(e,t,a)=>new ni(e,t,{...a,defaultLabel:"None",equals:(e,t)=>e==t,values:i})}}function wm(e){return{field:e,newValue:()=>ri.SlotLeftBlood,factory:(e,t,i)=>new ni(e,t,{...i,defaultLabel:"None",equals:(e,t)=>e==t,values:[{value:ri.SlotLeftBlood,label:"Blood Left"},{value:ri.SlotRightBlood,label:"Blood Right"},{value:ri.SlotLeftFrost,label:"Frost Left"},{value:ri.SlotRightFrost,label:"Frost Right"},{value:ri.SlotLeftUnholy,label:"Unholy Left"},{value:ri.SlotRightUnholy,label:"Unholy Right"}]})}}function Im(e,t){return(i,a,s)=>new cm(i,a,{...s,newValue:e,fields:t})}class xm extends u{constructor(e,i,a){super(e,"apl-value-picker-root",i,a),t(this,"kindPicker"),t(this,"currentKind"),t(this,"valuePicker");const s=null!=this.rootElem.closest(".apl-prepull-action-picker"),o=Object.keys(Sm).filter((e=>Sm[e].includeIf?.(i,s)??!0));this.kindPicker=new ni(this.rootElem,i,{defaultLabel:"No Condition",values:[{value:void 0,label:"<None>"}].concat(o.map((e=>{const t=Sm[e];return{value:e,label:t.label,submenu:t.submenu,tooltip:t.fullDescription?`<p>${t.shortDescription}</p> ${t.fullDescription}`:t.shortDescription}}))),equals:(e,t)=>e==t,changedEvent:e=>e.rotationChangeEmitter,getValue:e=>this.getSourceValue()?.value.oneofKind,setValue:(e,t,i)=>{const a=this.getSourceValue(),s=a?.value.oneofKind;if(s!=i){if(i){const t=Sm[i];let o=this.makeAPLValue(i,t.newValue());a&&s&&this.valuePicker&&("not"==i?o.value.not.val=this.makeAPLValue(s,this.valuePicker.getInputValue()):"not"==a.value.oneofKind&&a.value.not.val?.value.oneofKind==i?o=a.value.not.val:"and"==i?"or"==a.value.oneofKind?o.value.and.vals=a.value.or.vals:o.value.and.vals=[this.makeAPLValue(s,this.valuePicker.getInputValue())]:"or"==i?"and"==a.value.oneofKind?o.value.or.vals=a.value.and.vals:o.value.or.vals=[this.makeAPLValue(s,this.valuePicker.getInputValue())]:"min"==i?"max"==a.value.oneofKind?o.value.min.vals=a.value.max.vals:o.value.min.vals=[this.makeAPLValue(s,this.valuePicker.getInputValue())]:"max"==i?"min"==a.value.oneofKind?o.value.max.vals=a.value.min.vals:o.value.max.vals=[this.makeAPLValue(s,this.valuePicker.getInputValue())]:"and"==a.value.oneofKind&&a.value.and.vals?.[0]?.value.oneofKind==i?o=a.value.and.vals[0]:"or"==a.value.oneofKind&&a.value.or.vals?.[0]?.value.oneofKind==i?o=a.value.or.vals[0]:"min"==a.value.oneofKind&&a.value.min.vals?.[0]?.value.oneofKind==i?o=a.value.min.vals[0]:"max"==a.value.oneofKind&&a.value.max.vals?.[0]?.value.oneofKind==i?o=a.value.max.vals[0]:"cmp"==i&&(o.value.cmp.lhs=this.makeAPLValue(s,this.valuePicker.getInputValue()))),a?a.value=o.value:this.setSourceValue(e,o)}else this.setSourceValue(e,void 0);t.rotationChangeEmitter.emit(e)}}}),this.currentKind=void 0,this.valuePicker=null,this.init()}getInputElem(){return this.rootElem}getInputValue(){const e=this.kindPicker.getInputValue();return e?Ta.create({value:{oneofKind:e,...(()=>{const t={};return e&&this.valuePicker&&(t[e]=this.valuePicker.getInputValue()),t})()}}):void 0}setInputValue(e){const t=e?.value.oneofKind;this.updateValuePicker(t),t&&e&&this.valuePicker.setInputValue(e.value[t])}makeAPLValue(e,t){if(!e)return Ta.create();const i={oneofKind:e};return i[e]=t,Ta.create({value:i})}updateValuePicker(e){const t=this.currentKind;if(e==t)return;if(this.currentKind=e,this.valuePicker&&(this.valuePicker.rootElem.remove(),this.valuePicker=null),!e)return;this.kindPicker.setInputValue(e);const i=Sm[e];this.valuePicker=i.factory(this.rootElem,this.modObject,{changedEvent:e=>e.rotationChangeEmitter,getValue:()=>{const t=this.getSourceValue();return t&&t.value[e]||i.newValue()},setValue:(t,i,a)=>{const s=this.getSourceValue();s&&(s.value[e]=a),i.rotationChangeEmitter.emit(t)}})}}function ym(e,t){return{field:e,newValue:Ta.create,factory:(e,t,i)=>new xm(e,t,i),...t||{}}}function bm(e){return{field:e,newValue:()=>[],factory:(e,t,i)=>new sm(e,t,{...i,setValue:(e,t,a)=>{i.setValue(e,t,a.map((e=>e||Ta.create())))},itemLabel:"Value",newItem:Ta.create,copyItem:e=>e?Ta.clone(e):e,newItemPicker:(e,i,a,s)=>new xm(e,t,s),allowedActions:["create","delete"],actions:{create:{useIcon:!0}}})}}function vm(e){return{label:e.label,submenu:e.submenu,shortDescription:e.shortDescription,fullDescription:e.fullDescription,newValue:e.newValue,includeIf:e.includeIf,factory:Im(e.newValue,e.fields)}}const Sm={const:vm({label:"Const",shortDescription:"A fixed value.",fullDescription:"\n\t\t<p>\n\t\t\tExamples:\n\t\t\t<ul>\n\t\t\t\t<li><b>Number:</b> '123', '0.5', '-10'</li>\n\t\t\t\t<li><b>Time:</b> '100ms', '5s', '3m'</li>\n\t\t\t\t<li><b>Percentage:</b> '30%'</li>\n\t\t\t</ul>\n\t\t</p>\n\t\t",newValue:fi.create,fields:[gm("val")]}),cmp:vm({label:"Compare",submenu:["Logic"],shortDescription:"Compares two values.",newValue:wi.create,fields:[ym("lhs"),(Em="op",{field:Em,newValue:()=>ka.OpEq,factory:(e,t,i)=>new ni(e,t,{...i,defaultLabel:"None",equals:(e,t)=>e==t,values:[{value:ka.OpEq,label:"=="},{value:ka.OpNe,label:"!="},{value:ka.OpGe,label:">="},{value:ka.OpGt,label:">"},{value:ka.OpLe,label:"<="},{value:ka.OpLt,label:"<"}]})}),ym("rhs")]}),math:vm({label:"Math",submenu:["Logic"],shortDescription:"Do basic math on two values.",newValue:Ii.create,fields:[ym("lhs"),function(e){return{field:e,newValue:()=>Ca.OpAdd,factory:(e,t,i)=>new ni(e,t,{...i,defaultLabel:"None",equals:(e,t)=>e==t,values:[{value:Ca.OpAdd,label:"+"},{value:Ca.OpSub,label:"-"},{value:Ca.OpMul,label:"*"},{value:Ca.OpDiv,label:"/"}]})}}("op"),ym("rhs")]}),max:vm({label:"Max",submenu:["Logic"],shortDescription:"Returns the largest value among the subvalues.",newValue:xi.create,fields:[bm("vals")]}),min:vm({label:"Min",submenu:["Logic"],shortDescription:"Returns the smallest value among the subvalues.",newValue:yi.create,fields:[bm("vals")]}),and:vm({label:"All of",submenu:["Logic"],shortDescription:"Returns <b>True</b> if all of the sub-values are <b>True</b>, otherwise <b>False</b>",newValue:bi.create,fields:[bm("vals")]}),or:vm({label:"Any of",submenu:["Logic"],shortDescription:"Returns <b>True</b> if any of the sub-values are <b>True</b>, otherwise <b>False</b>",newValue:vi.create,fields:[bm("vals")]}),not:vm({label:"Not",submenu:["Logic"],shortDescription:"Returns the opposite of the inner value, i.e. <b>True</b> if the value is <b>False</b> and vice-versa.",newValue:Si.create,fields:[ym("val")]}),currentTime:vm({label:"Current Time",submenu:["Encounter"],shortDescription:"Elapsed time of the current sim iteration.",newValue:Ei.create,fields:[]}),currentTimePercent:vm({label:"Current Time (%)",submenu:["Encounter"],shortDescription:"Elapsed time of the current sim iteration, as a percentage.",newValue:Pi.create,fields:[]}),remainingTime:vm({label:"Remaining Time",submenu:["Encounter"],shortDescription:"Elapsed time of the remaining sim iteration.",newValue:ki.create,fields:[]}),remainingTimePercent:vm({label:"Remaining Time (%)",submenu:["Encounter"],shortDescription:"Elapsed time of the remaining sim iteration, as a percentage.",newValue:Ci.create,fields:[]}),isExecutePhase:vm({label:"Is Execute Phase",submenu:["Encounter"],shortDescription:"<b>True</b> if the encounter is in Execute Phase, meaning the target's health is less than the given threshold, otherwise <b>False</b>.",newValue:_i.create,fields:[function(e){return{field:e,newValue:()=>_a.E20,factory:(e,t,i)=>new ni(e,t,{...i,defaultLabel:"None",equals:(e,t)=>e==t,values:[{value:_a.E20,label:"20%"},{value:_a.E25,label:"25%"},{value:_a.E35,label:"35%"}]})}}("threshold")]}),numberTargets:vm({label:"Number of Targets",submenu:["Encounter"],shortDescription:"Count of targets in the current encounter",newValue:Ni.create,fields:[]}),frontOfTarget:vm({label:"Front of Target",submenu:["Encounter"],shortDescription:"<b>True</b> if facing from of target",newValue:Ti.create,fields:[]}),bossSpellIsCasting:vm({label:"Spell is Casting",submenu:["Boss"],shortDescription:"",newValue:Ri.create,fields:[hm("targetUnit","targets"),mm("spellId","non_instant_spells","targetUnit","currentTarget")]}),bossSpellTimeToReady:vm({label:"Spell Time to Ready",submenu:["Boss"],shortDescription:"",newValue:Li.create,fields:[hm("targetUnit","targets"),mm("spellId","spells","targetUnit","currentTarget")]}),currentHealth:vm({label:"Health",submenu:["Resources"],shortDescription:"Amount of currently available Health.",newValue:Gi.create,fields:[hm("sourceUnit","aura_sources")]}),currentHealthPercent:vm({label:"Health (%)",submenu:["Resources"],shortDescription:"Amount of currently available Health, as a percentage.",newValue:Ai.create,fields:[hm("sourceUnit","aura_sources")]}),currentMana:vm({label:"Mana",submenu:["Resources"],shortDescription:"Amount of currently available Mana.",newValue:Di.create,fields:[]}),currentManaPercent:vm({label:"Mana (%)",submenu:["Resources"],shortDescription:"Amount of currently available Mana, as a percentage.",newValue:Ui.create,fields:[]}),currentRage:vm({label:"Rage",submenu:["Resources"],shortDescription:"Amount of currently available Rage.",newValue:Oi.create,fields:[]}),currentEnergy:vm({label:"Energy",submenu:["Resources"],shortDescription:"Amount of currently available Energy.",newValue:Mi.create,fields:[]}),currentComboPoints:vm({label:"Combo Points",submenu:["Resources"],shortDescription:"Amount of currently available Combo Points.",newValue:Wi.create,fields:[]}),currentRunicPower:vm({label:"Runic Power",submenu:["Resources"],shortDescription:"Amount of currently available Runic Power.",newValue:Vi.create,includeIf:(e,t)=>e.getClass()==d.ClassDeathknight,fields:[]}),currentRuneCount:vm({label:"Num Runes",submenu:["Resources","Runes"],shortDescription:"Amount of currently available Runes of certain type including Death.",newValue:Fi.create,includeIf:(e,t)=>e.getClass()==d.ClassDeathknight,fields:[fm("runeType",!0)]}),currentNonDeathRuneCount:vm({label:"Num Non Death Runes",submenu:["Resources","Runes"],shortDescription:"Amount of currently available Runes of certain type ignoring Death",newValue:zi.create,includeIf:(e,t)=>e.getClass()==d.ClassDeathknight,fields:[fm("runeType",!1)]}),currentRuneActive:vm({label:"Rune Is Ready",submenu:["Resources","Runes"],shortDescription:"Is the rune of a certain slot currently available.",newValue:ji.create,includeIf:(e,t)=>e.getClass()==d.ClassDeathknight,fields:[wm("runeSlot")]}),currentRuneDeath:vm({label:"Rune Is Death",submenu:["Resources","Runes"],shortDescription:"Is the rune of a certain slot currently converted to Death.",newValue:Hi.create,includeIf:(e,t)=>e.getClass()==d.ClassDeathknight,fields:[wm("runeSlot")]}),runeCooldown:vm({label:"Rune Cooldown",submenu:["Resources","Runes"],shortDescription:"Amount of time until a rune of certain type is ready to use.<br><b>NOTE:</b> Returns 0 if there is a rune available",newValue:Bi.create,includeIf:(e,t)=>e.getClass()==d.ClassDeathknight,fields:[fm("runeType",!1)]}),nextRuneCooldown:vm({label:"Next Rune Cooldown",submenu:["Resources","Runes"],shortDescription:"Amount of time until a 2nd rune of certain type is ready to use.<br><b>NOTE:</b> Returns 0 if there are 2 runes available",newValue:qi.create,includeIf:(e,t)=>e.getClass()==d.ClassDeathknight,fields:[fm("runeType",!1)]}),runeSlotCooldown:vm({label:"Rune Slot Cooldown",submenu:["Resources","Runes"],shortDescription:"Amount of time until a rune of certain slot is ready to use.<br><b>NOTE:</b> Returns 0 if rune is ready",newValue:$i.create,includeIf:(e,t)=>e.getClass()==d.ClassDeathknight,fields:[wm("runeSlot")]}),runeGrace:vm({label:"Rune Grace Period",submenu:["Resources","Runes"],shortDescription:"Amount of rune grace period available for certain rune type.",newValue:Ki.create,includeIf:(e,t)=>e.getClass()==d.ClassDeathknight,fields:[fm("runeType",!1)]}),runeSlotGrace:vm({label:"Rune Slot Grace Period",submenu:["Resources","Runes"],shortDescription:"Amount of rune grace period available for certain rune slot.",newValue:Yi.create,includeIf:(e,t)=>e.getClass()==d.ClassDeathknight,fields:[wm("runeSlot")]}),gcdIsReady:vm({label:"GCD Is Ready",submenu:["GCD"],shortDescription:"<b>True</b> if the GCD is not on cooldown, otherwise <b>False</b>.",newValue:Ji.create,fields:[]}),gcdTimeToReady:vm({label:"GCD Time To Ready",submenu:["GCD"],shortDescription:"Amount of time remaining before the GCD comes off cooldown, or <b>0</b> if it is not on cooldown.",newValue:Zi.create,fields:[]}),autoTimeToNext:vm({label:"Time To Next Auto",submenu:["Auto"],shortDescription:"Amount of time remaining before the next Main-hand or Off-hand melee attack, or <b>0</b> if autoattacks are not engaged.",newValue:Qi.create,fields:[]}),spellCurrentCost:vm({label:"Current Cost",submenu:["Spell"],shortDescription:"Returns current resource cost of spell",newValue:Xi.create,fields:[mm("spellId","castable_spells","")]}),spellCanCast:vm({label:"Can Cast",submenu:["Spell"],shortDescription:"<b>True</b> if all requirements for casting the spell are currently met, otherwise <b>False</b>.",fullDescription:"\n\t\t\t<p>The <b>Cast Spell</b> action does not need to be conditioned on this, because it applies this check automatically.</p>\n\t\t",newValue:ea.create,fields:[mm("spellId","castable_spells","")]}),spellIsReady:vm({label:"Is Ready",submenu:["Spell"],shortDescription:"<b>True</b> if the spell is not on cooldown, otherwise <b>False</b>.",newValue:ta.create,fields:[mm("spellId","castable_spells","")]}),spellTimeToReady:vm({label:"Time To Ready",submenu:["Spell"],shortDescription:"Amount of time remaining before the spell comes off cooldown, or <b>0</b> if it is not on cooldown.",newValue:ia.create,fields:[mm("spellId","castable_spells","")]}),spellCastTime:vm({label:"Cast Time",submenu:["Spell"],shortDescription:"Amount of time to cast the spell including any haste and spell cast time adjustments.",newValue:aa.create,fields:[mm("spellId","castable_spells","")]}),spellTravelTime:vm({label:"Travel Time",submenu:["Spell"],shortDescription:"Amount of time for the spell to travel to the target.",newValue:sa.create,fields:[mm("spellId","castable_spells","")]}),spellCpm:vm({label:"CPM",submenu:["Spell"],shortDescription:"Casts Per Minute for the spell so far in the current iteration.",newValue:oa.create,fields:[mm("spellId","castable_spells","")]}),spellIsChanneling:vm({label:"Is Channeling",submenu:["Spell"],shortDescription:"<b>True</b> if this spell is currently being channeled, otherwise <b>False</b>.",newValue:la.create,fields:[mm("spellId","channel_spells","")]}),spellChanneledTicks:vm({label:"Channeled Ticks",submenu:["Spell"],shortDescription:"The number of completed ticks in the current channel of this spell, or <b>0</b> if the spell is not being channeled.",newValue:na.create,fields:[mm("spellId","channel_spells","")]}),channelClipDelay:vm({label:"Channel Clip Delay",submenu:["Spell"],shortDescription:"The amount of time specified by the <b>Channel Clip Delay</b> setting.",newValue:ra.create,fields:[]}),auraIsActive:vm({label:"Aura Active",submenu:["Aura"],shortDescription:"<b>True</b> if the aura is currently active, otherwise <b>False</b>.",newValue:da.create,fields:[hm("sourceUnit","aura_sources"),mm("auraId","auras","sourceUnit")]}),auraIsActiveWithReactionTime:vm({label:"Aura Active (with Reaction Time)",submenu:["Aura"],shortDescription:"<b>True</b> if the aura is currently active AND it has been active for at least as long as the player reaction time (configured in Settings), otherwise <b>False</b>.",newValue:ca.create,fields:[hm("sourceUnit","aura_sources"),mm("auraId","auras","sourceUnit")]}),auraRemainingTime:vm({label:"Aura Remaining Time",submenu:["Aura"],shortDescription:"Time remaining before this aura will expire, or 0 if the aura is not currently active.",newValue:ma.create,fields:[hm("sourceUnit","aura_sources"),mm("auraId","auras","sourceUnit")]}),auraNumStacks:vm({label:"Aura Num Stacks",submenu:["Aura"],shortDescription:"Number of stacks of the aura.",newValue:ha.create,fields:[hm("sourceUnit","aura_sources"),mm("auraId","stackable_auras","sourceUnit")]}),auraInternalCooldown:vm({label:"Aura Remaining ICD",submenu:["Aura"],shortDescription:"Time remaining before this aura's internal cooldown will be ready, or <b>0</b> if the ICD is ready now.",newValue:pa.create,fields:[hm("sourceUnit","aura_sources"),mm("auraId","icd_auras","sourceUnit")]}),auraIcdIsReadyWithReactionTime:vm({label:"Aura ICD Is Ready (with Reaction Time)",submenu:["Aura"],shortDescription:"<b>True</b> if the aura's ICD is currently ready OR it was put on CD recently, within the player's reaction time (configured in Settings), otherwise <b>False</b>.",newValue:ua.create,fields:[hm("sourceUnit","aura_sources"),mm("auraId","icd_auras","sourceUnit")]}),auraShouldRefresh:vm({label:"Should Refresh Aura",submenu:["Aura"],shortDescription:"Whether this aura should be refreshed, e.g. for the purpose of maintaining a debuff.",fullDescription:"\n\t\t<p>This condition checks not only the specified aura but also any other auras on the same unit, including auras applied by other raid members, which apply the same debuff category.</p>\n\t\t<p>For example, 'Should Refresh Debuff(Sunder Armor)' will return <b>False</b> if the unit has an active Expose Armor aura.</p>\n\t\t",newValue:()=>ga.create({maxOverlap:{value:{oneofKind:"const",const:{val:"0ms"}}}}),fields:[hm("sourceUnit","aura_sources_targets_first"),mm("auraId","exclusive_effect_auras","sourceUnit","currentTarget"),ym("maxOverlap",{label:"Overlap",labelTooltip:"Maximum amount of time before the aura expires when it may be refreshed."})]}),dotIsActive:vm({label:"Dot Is Active",submenu:["DoT"],shortDescription:"<b>True</b> if the specified dot is currently ticking, otherwise <b>False</b>.",newValue:fa.create,fields:[hm("targetUnit","targets"),mm("spellId","dot_spells","")]}),dotRemainingTime:vm({label:"Dot Remaining Time",submenu:["DoT"],shortDescription:"Time remaining before the last tick of this DoT will occur, or 0 if the DoT is not currently ticking.",newValue:wa.create,fields:[hm("targetUnit","targets"),mm("spellId","dot_spells","")]}),sequenceIsComplete:vm({label:"Sequence Is Complete",submenu:["Sequence"],shortDescription:"<b>True</b> if there are no more subactions left to execute in the sequence, otherwise <b>False</b>.",newValue:Ia.create,fields:[gm("sequenceName")]}),sequenceIsReady:vm({label:"Sequence Is Ready",submenu:["Sequence"],shortDescription:"<b>True</b> if the next subaction in the sequence is ready to be executed, otherwise <b>False</b>.",newValue:xa.create,fields:[gm("sequenceName")]}),sequenceTimeToReady:vm({label:"Sequence Time To Ready",submenu:["Sequence"],shortDescription:"Returns the amount of time remaining until the next subaction in the sequence will be ready.",newValue:ya.create,fields:[gm("sequenceName")]}),totemRemainingTime:vm({label:"Totem Remaining Time",submenu:["Shaman"],shortDescription:"Returns the amount of time remaining until the totem will expire.",newValue:ba.create,includeIf:(e,t)=>e.getClass()==d.ClassShaman,fields:[function(e){return{field:e,newValue:()=>Na.Water,factory:(e,t,i)=>new ni(e,t,{...i,defaultLabel:"None",equals:(e,t)=>e==t,values:[{value:Na.Earth,label:"Earth"},{value:Na.Air,label:"Air"},{value:Na.Fire,label:"Fire"},{value:Na.Water,label:"Water"}]})}}("totemType")]}),catExcessEnergy:vm({label:"Excess Energy",submenu:["Feral Druid"],shortDescription:"Returns the amount of excess energy available, after subtracting energy that will be needed to maintain DoTs.",newValue:va.create,includeIf:(e,t)=>e.spec==ne.SpecFeralDruid,fields:[]}),catNewSavageRoarDuration:vm({label:"New Savage Roar Duration",submenu:["Feral Druid"],shortDescription:"Returns duration of savage roar based on current combo points",newValue:Sa.create,includeIf:(e,t)=>e.spec==ne.SpecFeralDruid,fields:[]}),warlockShouldRecastDrainSoul:vm({label:"Should Recast Drain Soul",submenu:["Warlock"],shortDescription:"Returns <b>True</b> if the current Drain Soul channel should be immediately recast, to get a better snapshot.",newValue:Ea.create,includeIf:(e,t)=>e.getClass()==d.ClassWarlock,fields:[]}),warlockShouldRefreshCorruption:vm({label:"Should Refresh Corruption",submenu:["Warlock"],shortDescription:"Returns <b>True</b> if the current Corruption has expired, or should be refreshed to get a better snapshot.",newValue:Pa.create,includeIf:(e,t)=>e.getClass()==d.ClassWarlock,fields:[hm("targetUnit","targets")]})};var Em;class Pm extends u{constructor(e,i,a){super(e,"apl-action-picker-root",i,a),t(this,"kindPicker"),t(this,"actionDiv"),t(this,"currentKind"),t(this,"actionPicker"),t(this,"conditionPicker"),this.conditionPicker=new xm(this.rootElem,this.modObject,{label:"If:",changedEvent:e=>e.rotationChangeEmitter,getValue:e=>this.getSourceValue()?.condition,setValue:(e,t,i)=>{const a=this.getSourceValue();a?(a.condition=i,t.rotationChangeEmitter.emit(e)):this.setSourceValue(e,Ka.create({condition:i}))}}),this.conditionPicker.rootElem.classList.add("apl-action-condition","apl-priority-list-only"),this.actionDiv=document.createElement("div"),this.actionDiv.classList.add("apl-action-picker-action"),this.rootElem.appendChild(this.actionDiv);const s=null!=this.rootElem.closest(".apl-prepull-action-picker"),o=Object.keys(_m).filter((e=>_m[e].includeIf?.(i,s)??!0));this.kindPicker=new ni(this.actionDiv,i,{defaultLabel:"Action",values:o.map((e=>{const t=_m[e];return{value:e,label:t.label,submenu:t.submenu,tooltip:t.fullDescription?`<p>${t.shortDescription}</p> ${t.fullDescription}`:t.shortDescription}})),equals:(e,t)=>e==t,changedEvent:e=>e.rotationChangeEmitter,getValue:e=>this.getSourceValue()?.action.oneofKind,setValue:(e,t,i)=>{const a=this.getSourceValue(),s=a?.action.oneofKind;if(s!=i){if(i){const t=_m[i];let o=this.makeAPLAction(i,t.newValue());a&&s&&this.actionPicker&&("sequence"==i?"strictSequence"==a.action.oneofKind?o.action.sequence.actions=a.action.strictSequence.actions:o.action.sequence.actions=[this.makeAPLAction(s,this.actionPicker.getInputValue())]:"strictSequence"==i?"sequence"==a.action.oneofKind?o.action.strictSequence.actions=a.action.sequence.actions:o.action.strictSequence.actions=[this.makeAPLAction(s,this.actionPicker.getInputValue())]:"sequence"==a.action.oneofKind&&a.action.sequence.actions?.[0]?.action.oneofKind==i?o=a.action.sequence.actions[0]:"strictSequence"==a.action.oneofKind&&a.action.strictSequence.actions?.[0]?.action.oneofKind==i&&(o=a.action.strictSequence.actions[0])),a?a.action=o.action:this.setSourceValue(e,o)}else a.action={oneofKind:i};t.rotationChangeEmitter.emit(e)}}}),this.currentKind=void 0,this.actionPicker=null,this.init()}getInputElem(){return this.rootElem}getInputValue(){const e=this.kindPicker.getInputValue();return Ka.create({condition:this.conditionPicker.getInputValue(),action:{oneofKind:e,...(()=>{const t={};return e&&this.actionPicker&&(t[e]=this.actionPicker.getInputValue()),t})()}})}setInputValue(e){if(!e)return;this.conditionPicker.setInputValue(e.condition||Ta.create());const t=e.action.oneofKind;this.updateActionPicker(t),t&&this.actionPicker.setInputValue(e.action[t])}makeAPLAction(e,t){if(!e)return Ka.create();const i={oneofKind:e};return i[e]=t,Ka.create({action:i})}updateActionPicker(e){const t=this.currentKind;if(e==t)return;if(this.currentKind=e,this.actionPicker&&(this.actionPicker.rootElem.remove(),this.actionPicker=null),!e)return;this.kindPicker.setInputValue(e);const i=_m[e];this.actionPicker=i.factory(this.actionDiv,this.modObject,{changedEvent:e=>e.rotationChangeEmitter,getValue:()=>this.getSourceValue()?.action?.[e]||i.newValue(),setValue:(t,i,a)=>{const s=this.getSourceValue();s&&((s?.action)[e]=a),i.rotationChangeEmitter.emit(t)}}),this.actionPicker.rootElem.classList.add("apl-action-"+e)}}function km(e){return{field:e,newValue:()=>[],factory:(e,t,i)=>new sm(e,t,{...i,setValue:(e,t,a)=>{i.setValue(e,t,a.map((e=>e||Ka.create())))},itemLabel:"Action",newItem:Ka.create,copyItem:e=>e?Ka.clone(e):e,newItemPicker:(e,i,a,s)=>new Pm(e,t,s),allowedActions:["create","delete","move"],actions:{create:{useIcon:!0}}})}}function Cm(e){return{label:e.label,submenu:e.submenu,shortDescription:e.shortDescription,fullDescription:e.fullDescription,includeIf:e.includeIf,newValue:e.newValue,factory:Im(e.newValue,e.fields)}}const _m={castSpell:Cm({label:"Cast",shortDescription:"Casts the spell if possible, i.e. resource/cooldown/GCD/etc requirements are all met.",newValue:Ra.create,fields:[mm("spellId","castable_spells",""),hm("target","targets")]}),multidot:Cm({label:"Multi Dot",submenu:["Casting"],shortDescription:"Keeps a DoT active on multiple targets by casting the specified spell.",includeIf:(e,t)=>!t,newValue:()=>La.create({maxDots:3,maxOverlap:{value:{oneofKind:"const",const:{val:"0ms"}}}}),fields:[mm("spellId","dot_spells",""),um("maxDots",!1,{label:"Max Dots",labelTooltip:"Maximum number of DoTs to simultaneously apply."}),ym("maxOverlap",{label:"Overlap",labelTooltip:"Maximum amount of time before a DoT expires when it may be refreshed."})]}),multishield:Cm({label:"Multi Shield",submenu:["Casting"],shortDescription:"Keeps a Shield active on multiple targets by casting the specified spell.",includeIf:(e,t)=>!t&&Ga(e.spec),newValue:()=>Aa.create({maxShields:3,maxOverlap:{value:{oneofKind:"const",const:{val:"0ms"}}}}),fields:[mm("spellId","shield_spells",""),um("maxShields",!1,{label:"Max Shields",labelTooltip:"Maximum number of Shields to simultaneously apply."}),ym("maxOverlap",{label:"Overlap",labelTooltip:"Maximum amount of time before a Shield expires when it may be refreshed."})]}),channelSpell:Cm({label:"Channel",submenu:["Casting"],shortDescription:"Channels the spell if possible, i.e. resource/cooldown/GCD/etc requirements are all met.",fullDescription:"\n\t\t\t<p>The difference between channeling a spell vs casting the spell is that channels can be interrupted. If the <b>Interrupt If</b> parameter is empty, this action is equivalent to <b>Cast</b>.</p>\n\t\t\t<p>The channel will be interrupted only if all of the following are true:</p>\n\t\t\t<ul>\n\t\t\t\t<li>Immediately following a tick of the channel</li>\n\t\t\t\t<li>The <b>Interrupt If</b> condition evaluates to <b>True</b></li>\n\t\t\t\t<li>Another action in the APL list is available</li>\n\t\t\t</ul>\n\t\t\t<p>Note that if you simply want to allow other actions to interrupt the channel, set <b>Interrupt If</b> to <b>True</b>.</p>\n\t\t",newValue:()=>Da.create({interruptIf:{value:{oneofKind:"gcdIsReady",gcdIsReady:{}}}}),fields:[mm("spellId","channel_spells",""),hm("target","targets"),ym("interruptIf",{label:"Interrupt If",labelTooltip:"Condition which must be true to allow the channel to be interrupted."}),pm("allowRecast","Recast",{labelTooltip:"If checked, interrupts of this channel will recast the spell."})]}),autocastOtherCooldowns:Cm({label:"Autocast Other Cooldowns",submenu:["Casting"],shortDescription:"Auto-casts cooldowns as soon as they are ready.",fullDescription:"\n\t\t\t<ul>\n\t\t\t\t<li>Does not auto-cast cooldowns which are already controlled by other actions in the priority list.</li>\n\t\t\t\t<li>Cooldowns are usually cast immediately upon becoming ready, but there are some basic smart checks in place, e.g. don't use Mana CDs when near full mana.</li>\n\t\t\t</ul>\n\t\t",includeIf:(e,t)=>!t,newValue:Ua.create,fields:[]}),wait:Cm({label:"Wait",submenu:["Timing"],shortDescription:"Pauses all APL actions for a specified amount of time.",includeIf:(e,t)=>!t,newValue:()=>Oa.create({duration:{value:{oneofKind:"const",const:{val:"1000ms"}}}}),fields:[ym("duration")]}),waitUntil:Cm({label:"Wait Until",submenu:["Timing"],shortDescription:"Pauses all APL actions until the specified condition is <b>True</b>.",includeIf:(e,t)=>!t,newValue:()=>Ma.create(),fields:[ym("condition")]}),schedule:Cm({label:"Scheduled Action",submenu:["Timing"],shortDescription:"Executes the inner action once at each specified timing.",includeIf:(e,t)=>!t,newValue:()=>Wa.create({schedule:"0s, 60s",innerAction:{action:{oneofKind:"castSpell",castSpell:{}}}}),fields:[gm("schedule",{label:"Do At",labelTooltip:"Comma-separated list of timings. The inner action will be performed once at each timing."}),function(e){return{field:e,newValue:Ta.create,factory:(e,t,i)=>new Pm(e,t,i)}}("innerAction")]}),sequence:Cm({label:"Sequence",submenu:["Sequences"],shortDescription:"A list of sub-actions to execute in the specified order.",fullDescription:"\n\t\t\t<p>Once one of the sub-actions has been performed, the next sub-action will not necessarily be immediately executed next. The system will restart at the beginning of the whole actions list (not the sequence). If the sequence is executed again, it will perform the next sub-action.</p>\n\t\t\t<p>When all actions have been performed, the sequence does NOT automatically reset; instead, it will be skipped from now on. Use the <b>Reset Sequence</b> action to reset it, if desired.</p>\n\t\t",includeIf:(e,t)=>!t,newValue:Va.create,fields:[gm("name"),km("actions")]}),resetSequence:Cm({label:"Reset Sequence",submenu:["Sequences"],shortDescription:"Restarts a sequence, so that the next time it executes it will perform its first sub-action.",fullDescription:"\n\t\t\t<p>Use the <b>name</b> field to refer to the sequence to be reset. The desired sequence must have the same (non-empty) value for its <b>name</b>.</p>\n\t\t",includeIf:(e,t)=>!t,newValue:Fa.create,fields:[gm("sequenceName")]}),strictSequence:Cm({label:"Strict Sequence",submenu:["Sequences"],shortDescription:"Like a regular <b>Sequence</b>, except all sub-actions are executed immediately after each other and the sequence resets automatically upon completion.",fullDescription:"\n\t\t\t<p>Strict Sequences do not begin unless ALL sub-actions are ready.</p>\n\t\t",includeIf:(e,t)=>!t,newValue:za.create,fields:[km("actions")]}),changeTarget:Cm({label:"Change Target",submenu:["Misc"],shortDescription:"Sets the current target, which is the target of auto attacks and most casts by default.",newValue:()=>ja.create(),fields:[hm("newTarget","targets")]}),activateAura:Cm({label:"Activate Aura",submenu:["Misc"],shortDescription:"Activates an aura",includeIf:(e,t)=>t,newValue:()=>Ha.create(),fields:[mm("auraId","auras")]}),cancelAura:Cm({label:"Cancel Aura",submenu:["Misc"],shortDescription:"Deactivates an aura, equivalent to /cancelaura.",newValue:()=>Ba.create(),fields:[mm("auraId","auras")]}),triggerIcd:Cm({label:"Trigger ICD",submenu:["Misc"],shortDescription:"Triggers an aura's ICD, putting it on cooldown. Example usage would be to desync an ICD cooldown before combat starts.",includeIf:(e,t)=>t,newValue:()=>qa.create(),fields:[mm("auraId","icd_auras")]}),itemSwap:Cm({label:"Item Swap",submenu:["Misc"],shortDescription:"Swaps items, using the swap set specified in Settings.",includeIf:(e,t)=>Qu.includes(e.spec),newValue:()=>Ya.create(),fields:[function(e){return{field:e,newValue:()=>Za.Swap1,factory:(e,t,i)=>new ni(e,t,{...i,defaultLabel:"None",equals:(e,t)=>e==t,values:[{value:Za.Main,label:"Main"},{value:Za.Swap1,label:"Swapped"}]})}}("swapSet")]}),customRotation:Cm({label:"Custom Rotation",shortDescription:"INTERNAL ONLY",includeIf:(e,t)=>!1,newValue:()=>Ja.create(),fields:[]}),catOptimalRotationAction:Cm({label:"Optimal Rotation Action",submenu:["Feral Druid"],shortDescription:"Executes optimized Feral DPS rotation using hardcoded legacy algorithm.",includeIf:(e,t)=>e.spec==ne.SpecFeralDruid,newValue:()=>$a.create({rotationType:di.SingleTarget,manualParams:!0,maxFfDelay:.1,minRoarOffset:25,ripLeeway:4,useRake:!0,useBite:!0,biteTime:4,flowerWeave:!1}),fields:[function(e){const t=[{value:di.SingleTarget,label:"Single Target"},{value:di.Aoe,label:"AOE"}];return{field:e,label:"Type",newValue:()=>di.SingleTarget,factory:(e,i,a)=>new ni(e,i,{...a,defaultLabel:"Single Target",equals:(e,t)=>e==t,values:t})}}("rotationType"),pm("manualParams","Manual Advanced Parameters",{labelTooltip:"Manually specify advanced parameters, otherwise will use preset defaults."}),um("maxFfDelay",!0,{label:"Max FF Delay",labelTooltip:"Max allowed FF delay to fit in damage casts. Ignored if not using manual advanced parameters."}),um("minRoarOffset",!0,{label:"Roar Offset",labelTooltip:"Targeted offset in Rip/Roar timings. Ignored for AOE rotation or if not using manual advanced parameters."}),um("ripLeeway",!1,{label:"Rip Leeway",labelTooltip:"Rip leeway when optimizing Roar clips. Ignored for AOE rotation or if not using manual advanced parameters."}),pm("useRake","Use Rake",{labelTooltip:"Use Rake during rotation. Ignored for AOE rotation or if not using manual advanced parameters."}),pm("useBite","Bite during rotation",{labelTooltip:"Use Bite during rotation rather than exclusively at end of fight. Ignored for AOE rotation or if not using manual advanced parameters."}),um("biteTime",!0,{label:"Bite Time",labelTooltip:"Min seconds remaining on Rip/Roar to allow a Bite. Ignored if not Biting during rotation."}),pm("flowerWeave","Flower Weave",{labelTooltip:"Fish for Clearcasting procs during AOE rotation with GotW. Ignored for Single Target rotation or if not using manual advanced parameters."})]})};class Nm extends m{constructor(e,t,i){super(e,"apl-rotation-picker-root"),new sm(this.rootElem,i,{extraCssClasses:["apl-prepull-action-picker"],title:"Prepull Actions",titleTooltip:"Actions to perform before the pull.",itemLabel:"Prepull Action",changedEvent:e=>e.rotationChangeEmitter,getValue:e=>e.aplRotation.prepullActions,setValue:(e,t,i)=>{t.aplRotation.prepullActions=i,t.rotationChangeEmitter.emit(e)},newItem:()=>Qa.create({action:{},doAtValue:{value:{oneofKind:"const",const:{val:"-1s"}}}}),copyItem:e=>Qa.clone(e),newItemPicker:(e,t,a,s)=>new Tm(e,i,s,a),inlineMenuBar:!0}),new sm(this.rootElem,i,{extraCssClasses:["apl-list-item-picker"],title:"Priority List",titleTooltip:"At each decision point, the simulation will perform the first valid action from this list.",itemLabel:"Action",changedEvent:e=>e.rotationChangeEmitter,getValue:e=>e.aplRotation.priorityList,setValue:(e,t,i)=>{t.aplRotation.priorityList=i,t.rotationChangeEmitter.emit(e)},newItem:()=>Xa.create({action:{}}),copyItem:e=>Xa.clone(e),newItemPicker:(e,t,a,s)=>new Rm(e,i,s,a),inlineMenuBar:!0})}}class Tm extends u{constructor(e,i,a,s){a.enableWhen=()=>!this.getItem().hide,super(e,"apl-list-item-picker-root",i,a),t(this,"player"),t(this,"hidePicker"),t(this,"doAtPicker"),t(this,"actionPicker"),this.player=i;const o=sm.getItemHeaderElem(this);Lm(o,i,(e=>e.getCurrentStats().rotationStats?.prepullActions[s]?.warnings||[])),this.hidePicker=new Gm(o,i,{changedEvent:()=>this.player.rotationChangeEmitter,getValue:()=>this.getItem().hide,setValue:(e,t,i)=>{this.getItem().hide=i,this.player.rotationChangeEmitter.emit(e)}}),this.doAtPicker=new om(this.rootElem,this.player,{label:"Do At",labelTooltip:"Time before pull to do the action. Should be negative, and formatted like, '-1s' or '-2500ms'.",extraCssClasses:["apl-prepull-actions-doat"],changedEvent:()=>this.player.rotationChangeEmitter,getValue:()=>this.getItem().doAtValue?.value?.const.val||"",setValue:(e,t,i)=>{this.getItem().doAtValue=i?Ta.create({value:{oneofKind:"const",const:{val:i}}}):void 0,this.player.rotationChangeEmitter.emit(e)},inline:!0}),this.actionPicker=new Pm(this.rootElem,this.player,{changedEvent:()=>this.player.rotationChangeEmitter,getValue:()=>this.getItem().action,setValue:(e,t,i)=>{this.getItem().action=i,this.player.rotationChangeEmitter.emit(e)}}),this.init()}getItem(){return this.getSourceValue()||Qa.create({action:{}})}getInputElem(){return this.rootElem}getInputValue(){return Qa.create({hide:this.hidePicker.getInputValue(),doAtValue:{value:{oneofKind:"const",const:{val:this.doAtPicker.getInputValue()}}},action:this.actionPicker.getInputValue()})}setInputValue(e){e&&(this.hidePicker.setInputValue(e.hide),this.doAtPicker.setInputValue(e.doAtValue?.value?.const.val||""),this.actionPicker.setInputValue(e.action||Ka.create()))}}class Rm extends u{constructor(e,i,a,s){a.enableWhen=()=>!this.getItem().hide,super(e,"apl-list-item-picker-root",i,a),t(this,"player"),t(this,"hidePicker"),t(this,"actionPicker"),this.player=i;const o=sm.getItemHeaderElem(this);Lm(o,i,(e=>e.getCurrentStats().rotationStats?.priorityList[s]?.warnings||[])),this.hidePicker=new Gm(o,i,{changedEvent:()=>this.player.rotationChangeEmitter,getValue:()=>this.getItem().hide,setValue:(e,t,i)=>{this.getItem().hide=i,this.player.rotationChangeEmitter.emit(e)}}),this.actionPicker=new Pm(this.rootElem,this.player,{changedEvent:()=>this.player.rotationChangeEmitter,getValue:()=>this.getItem().action,setValue:(e,t,i)=>{this.getItem().action=i,this.player.rotationChangeEmitter.emit(e)}}),this.init()}getItem(){return this.getSourceValue()||Xa.create({action:{}})}getInputElem(){return this.rootElem}getInputValue(){return Xa.create({hide:this.hidePicker.getInputValue(),action:this.actionPicker.getInputValue()})}setInputValue(e){e&&(this.hidePicker.setInputValue(e.hide),this.actionPicker.setInputValue(e.action||Ka.create()))}}function Lm(e,t,a){const s=sm.makeActionElem("apl-warnings","fa-exclamation-triangle");s.classList.add("warning","link-warning"),s.setAttribute("data-bs-html","true");const o=i.getOrCreateInstance(s,{customClass:"dropdown-tooltip",title:"Warnings",html:!0});e.appendChild(s);const n=async()=>{o.setContent({".tooltip-inner":""});const e=a(t);if(0==e.length)s.style.visibility="hidden";else{s.style.visibility="visible";const t=await Promise.all(e.map((e=>x.replaceAllInString(e))));o.setContent({".tooltip-inner":`\n\t\t\t\t<p>This action has warnings, and might not behave as expected.</p>\n\t\t\t\t<ul>\n\t\t\t\t\t${t.map((e=>`<li>${e}</li>`)).join("")}\n\t\t\t\t</ul>\n\t\t\t`})}};n(),l.onAny([t.currentStatsEmitter,t.levelChangeEmitter]).on(n)}class Gm extends u{constructor(e,a,s){super(e,"hide-picker-root",a,s),t(this,"inputElem"),t(this,"iconElem"),t(this,"tooltip"),this.inputElem=sm.makeActionElem("hide-picker-button","fa-eye"),this.iconElem=this.inputElem.childNodes[0],this.rootElem.appendChild(this.inputElem),this.tooltip=i.getOrCreateInstance(this.inputElem,{title:"Enable/Disable"}),this.init(),this.inputElem.addEventListener("click",(()=>{this.setInputValue(!this.getInputValue()),this.inputChanged(l.nextEventID())}))}getInputElem(){return this.inputElem}getInputValue(){return this.iconElem.classList.contains("fa-eye-slash")}setInputValue(e){e?(this.iconElem.classList.add("fa-eye-slash"),this.iconElem.classList.remove("fa-eye"),this.tooltip.setContent({".tooltip-inner":"Enable Action"})):(this.iconElem.classList.add("fa-eye"),this.iconElem.classList.remove("fa-eye-slash"),this.tooltip.setContent({".tooltip-inner":"Disable Action"}))}}class Am extends u{constructor(e,i,a){super(e,"number-list-picker-root",i,a),t(this,"inputElem"),this.inputElem=document.createElement("input"),this.inputElem.type="text",this.inputElem.placeholder=a.placeholder||"",this.inputElem.classList.add("number-list-picker-input","form-control"),this.rootElem.appendChild(this.inputElem),this.init(),this.inputElem.addEventListener("change",(e=>{this.inputChanged(l.nextEventID())}))}getInputElem(){return this.inputElem}getInputValue(){const e=this.inputElem.value;return e?e.split(",").map(parseFloat).filter((e=>!isNaN(e))):[]}setInputValue(e){yt(this.getInputValue(),e)||(this.inputElem.value=e.map((e=>String(e))).join(","))}}class Dm extends m{constructor(e,i){super(e,"cooldowns-picker-root"),t(this,"simUI"),t(this,"player"),t(this,"cooldownPickers"),this.simUI=i,this.player=i.player,this.cooldownPickers=[],l.onAny([this.player.rotationChangeEmitter,this.player.sim.unitMetadataEmitter]).on((e=>{this.update()})),this.update()}update(){this.rootElem.innerHTML="";const e=this.player.getSimpleCooldowns().cooldowns;this.cooldownPickers=[];for(let t=0;t<e.length+1;t++){const a=e[t],s=document.createElement("div");s.classList.add("cooldown-picker"),t==e.length&&s.classList.add("add-cooldown-picker"),this.rootElem.appendChild(s),this.makeActionPicker(s,t);const o=document.createElement("label");o.classList.add("cooldown-picker-label","form-label"),a&&a.id&&x.fromProto(a.id).fill(this.player.getRaidIndex()).then((e=>o.textContent=e.name)),s.appendChild(o),this.makeTimingsPicker(s,t);const n=document.createElement("fragment");n.innerHTML='\n\t\t\t\t<a\n\t\t\t\t\thref="javascript:void(0)"\n\t\t\t\t\tclass="delete-cooldown link-danger"\n\t\t\t\t\trole="button"\n\t\t\t\t>\n\t\t\t\t\t<i class="fa fa-times fa-xl"></i>\n\t\t\t\t</a>\n\t\t\t';const r=n.children[0],d=i.getOrCreateInstance(r,{title:"Delete Cooldown"});r.addEventListener("click",(e=>{const i=this.player.getSimpleCooldowns();i.cooldowns.splice(t,1),this.player.setSimpleCooldowns(l.nextEventID(),i),d.hide()})),s.appendChild(r),this.cooldownPickers.push(s)}}makeActionPicker(e,t){const i=this.player.getMetadata().getSpells().filter((e=>e.data.isMajorCooldown)).map((e=>e.id));return new Pc(e,this.player,{extraCssClasses:["cooldown-action-picker"],numColumns:3,values:[{color:"#grey",value:oi.create()}].concat(i.map((e=>({actionId:e,value:e.toProto()})))),equals:(e,t)=>oi.equals(e,t),zeroValue:oi.create(),backupIconUrl:e=>x.fromProto(e),changedEvent:e=>e.rotationChangeEmitter,getValue:e=>e.getSimpleCooldowns().cooldowns[t]?.id||oi.create(),setValue:(e,i,a)=>{const s=i.getSimpleCooldowns();for(;s.cooldowns.length<t;)s.cooldowns.push(es.create());s.cooldowns[t]=es.create({id:a,timings:[]}),i.setSimpleCooldowns(e,s)}},this.simUI)}makeTimingsPicker(e,t){return new Am(e,this.player,{extraCssClasses:["cooldown-timings-picker"],placeholder:"20, 40, ...",changedEvent:e=>e.rotationChangeEmitter,getValue:e=>e.getSimpleCooldowns().cooldowns[t]?.timings||[],setValue:(e,i,a)=>{const s=i.getSimpleCooldowns();s.cooldowns[t].timings=a,i.setSimpleCooldowns(e,s)},enableWhen:e=>{const i=e.getSimpleCooldowns().cooldowns[t];return i&&!oi.equals(i.id,oi.create())}})}}class Um extends uc{constructor(e,i){super(e,i,{identifier:"rotation-tab",title:"Rotation"}),t(this,"simUI"),t(this,"leftPanel"),t(this,"rightPanel"),this.simUI=i,this.leftPanel=document.createElement("div"),this.leftPanel.classList.add("rotation-tab-left","tab-panel-left"),this.rightPanel=document.createElement("div"),this.rightPanel.classList.add("rotation-tab-right","tab-panel-right"),this.contentContainer.appendChild(this.leftPanel),this.contentContainer.appendChild(this.rightPanel),this.buildTabContent(),this.updateSections(),this.simUI.player.rotationChangeEmitter.on((()=>this.updateSections()))}buildTabContent(){this.buildHeader(),this.buildAutoContent(),this.buildAplContent(),this.buildSimpleContent(),this.buildSavedDataPickers()}updateSections(){this.rootElem.classList.remove("rotation-type-auto"),this.rootElem.classList.remove("rotation-type-simple"),this.rootElem.classList.remove("rotation-type-apl"),this.rootElem.classList.remove("rotation-type-legacy");const e=this.simUI.player.getRotationType();e==ce.TypeAuto?this.rootElem.classList.add("rotation-type-auto"):e==ce.TypeSimple?this.rootElem.classList.add("rotation-type-simple"):e==ce.TypeAPL?this.rootElem.classList.add("rotation-type-apl"):e==ce.TypeLegacy&&this.rootElem.classList.add("rotation-type-legacy")}buildHeader(){const e=document.createElement("div");e.classList.add("rotation-tab-header"),this.leftPanel.appendChild(e),new Dd(e,this.simUI.player,{label:"Rotation Type",labelTooltip:"Which set of options to use for specifying the rotation.",inline:!0,values:this.simUI.player.hasSimpleRotationGenerator()?[{value:ce.TypeAuto,name:"Auto"},{value:ce.TypeSimple,name:"Simple"},{value:ce.TypeAPL,name:"APL"}]:[{value:ce.TypeAuto,name:"Auto"},{value:ce.TypeAPL,name:"APL"}],changedEvent:e=>e.rotationChangeEmitter,getValue:e=>e.getRotationType(),setValue:(e,t,i)=>{t.aplRotation.type=i,t.rotationChangeEmitter.emit(e)}})}buildAutoContent(){const e=document.createElement("div");e.classList.add("rotation-tab-auto"),this.leftPanel.appendChild(e)}buildAplContent(){const e=document.createElement("div");e.classList.add("rotation-tab-apl"),this.leftPanel.appendChild(e),new Nm(e,this.simUI,this.simUI.player)}buildSimpleContent(){if(!this.simUI.player.hasSimpleRotationGenerator()||!this.simUI.individualConfig.rotationInputs)return;const e="rotation-tab-simple",t=new Nd(this.leftPanel,"rotation-settings",{header:{title:"Rotation"}});t.rootElem.classList.add(e);const i=u.newGroupContainer();i.classList.add("rotation-icon-group","icon-group"),t.bodyElement.appendChild(i),this.simUI.individualConfig.rotationIconInputs?.length&&this.configureIconSection(i,this.simUI.individualConfig.rotationIconInputs.map((e=>Hc(i,this.simUI,e))),!0),this.configureInputSection(t.bodyElement,this.simUI.individualConfig.rotationInputs),t.bodyElement.querySelectorAll(".input-root").forEach((e=>{e.classList.add("input-inline")}));const a=new Nd(this.leftPanel,"cooldown-settings",{header:{title:"Cooldowns",tooltip:"Specify cooldown timings, in seconds. Cooldowns will be used as soon as possible after their specified timings. When not specified, cooldowns will be used when ready and it is sensible to do so.<br><br>Multiple timings can be provided by separating with commas. Any cooldown usages after the last provided timing will use the default logic."}});a.rootElem.classList.add(e),new Dm(a.bodyElement,this.simUI)}configureInputSection(e,t){t.inputs.forEach((t=>{"number"==t.type?new il(e,this.simUI.player,t):"boolean"==t.type?new xt(e,this.simUI.player,{...t}):"enum"==t.type&&new Dd(e,this.simUI.player,t)}))}configureIconSection(e,t,i){0==t.length?e.classList.add("hide"):i&&(t.length<=4?e.style.gridTemplateColumns=`repeat(${t.length}, 1fr)`:t.length>4&&t.length<8&&(e.style.gridTemplateColumns=`repeat(${Math.ceil(t.length/2)}, 1fr)`))}buildSavedDataPickers(){const e=new yc(this.rightPanel,this.simUI.player,{label:"Rotation",header:{title:"Saved Rotations"},storageKey:this.simUI.getSavedRotationStorageKey(),getData:e=>ts.create({rotation:$.clone(e.aplRotation)}),setData:(e,t,i)=>{l.freezeAllAndDo((()=>{t.setAplRotation(e,i.rotation||$.create())}))},changeEmitters:[this.simUI.player.rotationChangeEmitter,this.simUI.player.talentsChangeEmitter],equals:(e,t)=>ts.equals(e,t),toJson:e=>ts.toJson(e),fromJson:e=>ts.fromJson(e)});this.simUI.sim.waitForInit().then((()=>{e.loadUserData(),(this.simUI.individualConfig.presets.rotations||[]).forEach((t=>{const i=t.rotation;i.rotation||(i.rotation=$.create()),e.addSavedData({name:t.name,tooltip:t.tooltip,isPreset:!0,data:i,enableWhen:t.enableWhen})}))}))}}class Om extends m{constructor(e,t,i,a){super(e,"encounter-picker-root"),Fm(this.rootElem,t,i.showExecuteProportion),t.sim.waitForInit().then((()=>{const e=t.sim.db.getAllPresetTargets();new Dd(this.rootElem,t,{extraCssClasses:["damage-metrics","npc-picker"],label:"NPC",labelTooltip:"Selects a preset NPC configuration.",values:[{name:"Custom",value:-1}].concat(e.map(((e,t)=>({name:e.path,value:t})))),changedEvent:e=>e.changeEmitter,getValue:t=>e.findIndex((e=>jm(t.primaryTarget,e.target))),setValue:(t,i,a)=>{-1!=a&&i.applyPresetTarget(t,e[a],0)}}),a.isIndividualSim()&&Ga(a.player.spec)&&new il(this.rootElem,a.sim.raid,{label:"Num Allies",labelTooltip:"Number of allied players in the raid.",changedEvent:e=>e.targetDummiesChangeEmitter,getValue:e=>e.getTargetDummies(),setValue:(e,t,i)=>{t.setTargetDummies(e,i)}}),a.isIndividualSim()&&_e(a.player.spec)&&new il(this.rootElem,t,{label:"Min Base Damage",labelTooltip:"Base damage for auto attacks, i.e. lowest roll with 0 AP against a 0-armor Player.",changedEvent:e=>e.changeEmitter,getValue:e=>e.primaryTarget.minBaseDamage,setValue:(e,t,i)=>{t.primaryTarget.minBaseDamage=i,t.targetsChangeEmitter.emit(e)}});const i=e.findIndex((e=>t.primaryTarget.id==e.target?.id)),s=e[i]?.target?.targetInputs||[];(s.length!=t.primaryTarget.targetInputs.length||t.primaryTarget.targetInputs.some(((e,t)=>e.label!=s[t].label)))&&(t.primaryTarget.targetInputs=s,t.targetsChangeEmitter.emit(l.nextEventID())),zm(this.rootElem,t,0);const o=document.createElement("button");o.classList.add("advanced-button","btn","btn-primary"),o.textContent="Advanced",o.addEventListener("click",(()=>new Mm(a.rootElem,a,t))),this.rootElem.appendChild(o)}))}}class Mm extends dd{constructor(e,i,a){super(e,"advanced-encounter-picker-modal"),t(this,"encounter"),this.encounter=a,this.addHeader(),this.body.innerHTML='\n\t\t\t<div class="encounter-header"></div>\n\t\t\t<div class="encounter-targets"></div>\n\t\t';const s=this.rootElem.getElementsByClassName("encounter-header")[0],o=this.rootElem.getElementsByClassName("encounter-targets")[0];Fm(s,this.encounter,!0),i.isIndividualSim()||new xt(s,a,{label:"Use Health",labelTooltip:"Uses a damage limit in place of a duration limit. Damage limit is equal to sum of all targets health.",inline:!0,changedEvent:e=>e.changeEmitter,getValue:e=>e.getUseHealth(),setValue:(e,t,i)=>{t.setUseHealth(e,i)}}),new sm(o,this.encounter,{extraCssClasses:["targets-picker","mb-0"],itemLabel:"Target",changedEvent:e=>e.targetsChangeEmitter,getValue:e=>e.targets,setValue:(e,t,i)=>{t.targets=i,t.targetsChangeEmitter.emit(e)},newItem:()=>qo.defaultTargetProto(),copyItem:e=>Le.clone(e),newItemPicker:(e,t,s,o)=>new Wm(e,a,s,o,i)})}addHeader(){const e=this.encounter.sim.db.getAllPresetEncounters();new Dd(this.header,this.encounter,{label:"Encounter",extraCssClasses:["encounter-picker","mb-0","pe-2"],values:[{name:"Custom",value:-1}].concat(e.map(((e,t)=>({name:e.path,value:t})))),changedEvent:e=>e.changeEmitter,getValue:t=>e.findIndex((e=>t.matchesPreset(e))),setValue:(t,i,a)=>{-1!=a&&i.applyPreset(t,e[a])}})}}class Wm extends u{constructor(e,i,a,s,o){super(e,"target-picker-root",i,s),t(this,"encounter"),t(this,"targetIndex"),t(this,"simUi"),t(this,"aiPicker"),t(this,"levelPicker"),t(this,"mobTypePicker"),t(this,"tankIndexPicker"),t(this,"statPickers"),t(this,"swingSpeedPicker"),t(this,"minBaseDamagePicker"),t(this,"dualWieldPicker"),t(this,"dwMissPenaltyPicker"),t(this,"parryHastePicker"),t(this,"spellSchoolPicker"),t(this,"suppressDodgePicker"),t(this,"damageSpreadPicker"),t(this,"targetInputPickers"),this.encounter=i,this.targetIndex=a,this.simUi=o,this.rootElem.innerHTML='\n\t\t\t<div class="target-picker-section target-picker-section1"></div>\n\t\t\t<div class="target-picker-section target-picker-section2"></div>\n\t\t\t<div class="target-picker-section target-picker-section3 threat-metrics"></div>\n\t\t';const l=this.rootElem.getElementsByClassName("target-picker-section1")[0],n=this.rootElem.getElementsByClassName("target-picker-section2")[0],r=this.rootElem.getElementsByClassName("target-picker-section3")[0],d=i.sim.db.getAllPresetTargets();new Dd(l,null,{extraCssClasses:["npc-picker"],label:"NPC",labelTooltip:"Selects a preset NPC configuration.",values:[{name:"Custom",value:-1}].concat(d.map(((e,t)=>({name:e.path,value:t})))),changedEvent:()=>i.targetsChangeEmitter,getValue:()=>d.findIndex((e=>jm(this.getTarget(),e.target))),setValue:(e,t,a)=>{-1!=a&&(i.applyPresetTarget(e,d[a],this.targetIndex),i.targetsChangeEmitter.emit(e))}}),this.aiPicker=new Dd(l,null,{extraCssClasses:["ai-picker"],label:"AI",labelTooltip:"\n\t\t\t\t<p>Determines the target's ability rotation.</p>\n\t\t\t\t<p>Note that most rotations are not yet implemented.</p>\n\t\t\t",values:[{name:"None",value:0}].concat(d.map((e=>({name:e.path,value:e.target.id})))),changedEvent:()=>i.targetsChangeEmitter,getValue:()=>this.getTarget().id,setValue:(e,t,a)=>{const s=this.getTarget();s.id=a,s.targetInputs=(d.find((e=>s.id==e.target?.id))?.target?.targetInputs||[]).map((e=>is.clone(e))),i.targetsChangeEmitter.emit(e)}});const c=this.simUi.isIndividualSim()?this.simUi.player:null;this.levelPicker=new Dd(l,null,{label:"Level",values:this.genLevels(c),changedEvent:()=>i.targetsChangeEmitter,getValue:()=>this.getTarget().level,setValue:(e,t,a)=>{this.getTarget().level=a,i.targetsChangeEmitter.emit(e)}}),this.mobTypePicker=new Dd(l,null,{label:"Mob Type",values:Bm,changedEvent:()=>i.targetsChangeEmitter,getValue:()=>this.getTarget().mobType,setValue:(e,t,a)=>{this.getTarget().mobType=a,i.targetsChangeEmitter.emit(e)}}),this.tankIndexPicker=new Dd(l,null,{extraCssClasses:["threat-metrics"],label:"Tanked By",labelTooltip:"Determines which player in the raid this enemy will attack. If no player is assigned to the specified tank slot, this enemy will not attack.",values:[{name:"None",value:-1},{name:"Main Tank",value:0},{name:"Tank 2",value:1},{name:"Tank 3",value:2},{name:"Tank 4",value:3}],changedEvent:()=>i.targetsChangeEmitter,getValue:()=>this.getTarget().tankIndex,setValue:(e,t,a)=>{this.getTarget().tankIndex=a,i.targetsChangeEmitter.emit(e)}}),this.targetInputPickers=zm(l,i,this.targetIndex),this.statPickers=Hm.map((e=>{const t=e.stat;return new il(n,null,{inline:!0,extraCssClasses:e.extraCssClasses,label:as.get(t),labelTooltip:e.tooltip,changedEvent:()=>i.targetsChangeEmitter,getValue:()=>this.getTarget().stats[t],setValue:(e,a,s)=>{this.getTarget().stats[t]=s,i.targetsChangeEmitter.emit(e)}})})),this.swingSpeedPicker=new il(r,null,{label:"Swing Speed",labelTooltip:"Time in seconds between auto attacks. Set to 0 to disable auto attacks.",float:!0,changedEvent:()=>i.targetsChangeEmitter,getValue:()=>this.getTarget().swingSpeed,setValue:(e,t,a)=>{this.getTarget().swingSpeed=a,i.targetsChangeEmitter.emit(e)}}),this.minBaseDamagePicker=new il(r,null,{label:"Min Base Damage",labelTooltip:"Base damage for auto attacks, i.e. lowest roll with 0 AP against a 0-armor Player.",changedEvent:()=>i.targetsChangeEmitter,getValue:()=>this.getTarget().minBaseDamage,setValue:(e,t,a)=>{this.getTarget().minBaseDamage=a,i.targetsChangeEmitter.emit(e)}}),this.damageSpreadPicker=new il(r,null,{label:"Damage Spread",labelTooltip:"Fractional spread between the minimum and maximum auto-attack damage from this enemy at 0 Attack Power.",float:!0,changedEvent:()=>i.targetsChangeEmitter,getValue:()=>this.getTarget().damageSpread,setValue:(e,t,a)=>{this.getTarget().damageSpread=a,i.targetsChangeEmitter.emit(e)}}),this.dualWieldPicker=new xt(r,null,{label:"Dual Wield",labelTooltip:"Uses 2 separate weapons to attack.",inline:!0,reverse:!0,changedEvent:()=>i.targetsChangeEmitter,getValue:()=>this.getTarget().dualWield,setValue:(e,t,a)=>{this.getTarget().dualWield=a,i.targetsChangeEmitter.emit(e)}}),this.dwMissPenaltyPicker=new xt(r,null,{label:"DW Miss Penalty",labelTooltip:"Enables the Dual Wield Miss Penalty (+19% chance to miss) if dual wielding. Bosses in Hyjal/BT/SWP usually have this disabled to stop tanks from avoidance stacking.",inline:!0,reverse:!0,changedEvent:()=>i.targetsChangeEmitter,getValue:()=>this.getTarget().dualWieldPenalty,setValue:(e,t,a)=>{this.getTarget().dualWieldPenalty=a,i.targetsChangeEmitter.emit(e)},enableWhen:()=>this.getTarget().dualWield}),this.parryHastePicker=new xt(r,null,{label:"Parry Haste",labelTooltip:"Whether this enemy will gain parry haste when parrying attacks.",inline:!0,reverse:!0,changedEvent:()=>i.targetsChangeEmitter,getValue:()=>this.getTarget().parryHaste,setValue:(e,t,a)=>{this.getTarget().parryHaste=a,i.targetsChangeEmitter.emit(e)}}),this.spellSchoolPicker=new Dd(r,null,{label:"Spell School",labelTooltip:"Type of damage caused by auto attacks. This is usually Physical, but some enemies have elemental attacks.",values:[{name:"Physical",value:De.SpellSchoolPhysical},{name:"Arcane",value:De.SpellSchoolArcane},{name:"Fire",value:De.SpellSchoolFire},{name:"Frost",value:De.SpellSchoolFrost},{name:"Holy",value:De.SpellSchoolHoly},{name:"Nature",value:De.SpellSchoolNature},{name:"Shadow",value:De.SpellSchoolShadow}],changedEvent:()=>i.targetsChangeEmitter,getValue:()=>this.getTarget().spellSchool,setValue:(e,t,a)=>{this.getTarget().spellSchool=a,i.targetsChangeEmitter.emit(e)}}),this.suppressDodgePicker=new xt(r,null,{label:"Chill of the Throne",labelTooltip:"Reduces the chance for this enemy's attacks to be dodged by 20%. Active in Icecrown Citadel.",inline:!0,reverse:!0,changedEvent:()=>i.targetsChangeEmitter,getValue:()=>this.getTarget().suppressDodge,setValue:(e,t,a)=>{this.getTarget().suppressDodge=a,i.targetsChangeEmitter.emit(e)},enableWhen:()=>83==this.getTarget().level}),this.init()}getTarget(){return this.encounter.targets[this.targetIndex]||Le.create()}genLevels(e){const t=e?e.getLevel():80,i=new Array;for(let a=t+3;a>=t;a--)i.push({name:a.toString(),value:a});return i}getInputElem(){return null}getInputValue(){return Le.create({id:this.aiPicker.getInputValue(),level:this.levelPicker.getInputValue(),mobType:this.mobTypePicker.getInputValue(),tankIndex:this.tankIndexPicker.getInputValue(),swingSpeed:this.swingSpeedPicker.getInputValue(),minBaseDamage:this.minBaseDamagePicker.getInputValue(),suppressDodge:this.suppressDodgePicker.getInputValue(),dualWield:this.dualWieldPicker.getInputValue(),dualWieldPenalty:this.dwMissPenaltyPicker.getInputValue(),parryHaste:this.parryHastePicker.getInputValue(),spellSchool:this.spellSchoolPicker.getInputValue(),damageSpread:this.damageSpreadPicker.getInputValue(),stats:this.statPickers.map((e=>e.getInputValue())).map(((e,t)=>(new H).withStat(Hm[t].stat,e))).reduce(((e,t)=>e.add(t))).asArray(),targetInputs:this.targetInputPickers.getInputValue()})}setInputValue(e){e&&(this.aiPicker.setInputValue(e.id),this.levelPicker.setInputValue(e.level),this.mobTypePicker.setInputValue(e.mobType),this.tankIndexPicker.setInputValue(e.tankIndex),this.swingSpeedPicker.setInputValue(e.swingSpeed),this.minBaseDamagePicker.setInputValue(e.minBaseDamage),this.suppressDodgePicker.setInputValue(e.suppressDodge),this.dualWieldPicker.setInputValue(e.dualWield),this.dwMissPenaltyPicker.setInputValue(e.dualWieldPenalty),this.parryHastePicker.setInputValue(e.parryHaste),this.spellSchoolPicker.setInputValue(e.spellSchool),this.damageSpreadPicker.setInputValue(e.damageSpread),Hm.forEach(((t,i)=>this.statPickers[i].setInputValue(e.stats[t.stat]))),this.targetInputPickers.setInputValue(e.targetInputs))}}class Vm extends u{constructor(e,i,a,s,o){super(e,"target-input-picker-root",i,o),t(this,"encounter"),t(this,"targetIndex"),t(this,"targetInputIndex"),t(this,"boolPicker"),t(this,"numberPicker"),this.encounter=i,this.targetIndex=a,this.targetInputIndex=s,this.boolPicker=null,this.numberPicker=null,this.init()}getTargetInput(){return this.encounter.targets[this.targetIndex].targetInputs[this.targetInputIndex]||is.create()}getInputElem(){return this.rootElem}getInputValue(){return is.create({boolValue:this.boolPicker?this.boolPicker.getInputValue():void 0,numberValue:this.numberPicker?this.numberPicker.getInputValue():void 0})}setInputValue(e){e&&(e.inputType!=ss.Number||this.numberPicker?e.inputType!=ss.Bool||this.boolPicker||(this.numberPicker&&(this.numberPicker.rootElem.remove(),this.numberPicker=null),this.boolPicker=new xt(this.rootElem,null,{label:e.label,labelTooltip:e.tooltip,changedEvent:()=>this.encounter.targetsChangeEmitter,getValue:()=>this.getTargetInput().boolValue,setValue:(e,t,i)=>{this.getTargetInput().boolValue=i,this.encounter.targetsChangeEmitter.emit(e)}})):(this.boolPicker&&(this.boolPicker.rootElem.remove(),this.boolPicker=null),this.numberPicker=new il(this.rootElem,null,{label:e.label,labelTooltip:e.tooltip,changedEvent:()=>this.encounter.targetsChangeEmitter,getValue:()=>this.getTargetInput().numberValue,setValue:(e,t,i)=>{this.getTargetInput().numberValue=i,this.encounter.targetsChangeEmitter.emit(e)}})))}}function Fm(e,t,i){const a=u.newGroupContainer();if(e.appendChild(a),new il(a,t,{label:"Duration",labelTooltip:"The fight length for each sim iteration, in seconds.",changedEvent:e=>e.changeEmitter,getValue:e=>e.getDuration(),setValue:(e,t,i)=>{t.setDuration(e,i)},enableWhen:e=>!t.getUseHealth()}),new il(a,t,{label:"Duration +/-",labelTooltip:"Adds a random amount of time, in seconds, between [value, -1 * value] to each sim iteration. For example, setting Duration to 180 and Duration +/- to 10 will result in random durations between 170s and 190s.",changedEvent:e=>e.changeEmitter,getValue:e=>e.getDurationVariation(),setValue:(e,t,i)=>{t.setDurationVariation(e,i)},enableWhen:e=>!t.getUseHealth()}),i){const i=u.newGroupContainer();i.classList.add("execute-group"),e.appendChild(i),new il(i,t,{label:"Execute Duration 20 (%)",labelTooltip:"Percentage of the total encounter duration, for which the targets will be considered to be in execute range (< 20% HP) for the purpose of effects like Warrior Execute or Mage Molten Fury.",changedEvent:e=>e.changeEmitter,getValue:e=>100*e.getExecuteProportion20(),setValue:(e,t,i)=>{t.setExecuteProportion20(e,i/100)},enableWhen:e=>!t.getUseHealth()}),new il(i,t,{label:"Execute Duration 25 (%)",labelTooltip:"Percentage of the total encounter duration, for which the targets will be considered to be in execute range (< 25% HP) for the purpose of effects like Warlock's Drain Soul.",changedEvent:e=>e.changeEmitter,getValue:e=>100*e.getExecuteProportion25(),setValue:(e,t,i)=>{t.setExecuteProportion25(e,i/100)},enableWhen:e=>!t.getUseHealth()}),new il(i,t,{label:"Execute Duration 35 (%)",labelTooltip:"Percentage of the total encounter duration, for which the targets will be considered to be in execute range (< 35% HP) for the purpose of effects like Warrior Execute or Mage Molten Fury.",changedEvent:e=>e.changeEmitter,getValue:e=>100*e.getExecuteProportion35(),setValue:(e,t,i)=>{t.setExecuteProportion35(e,i/100)},enableWhen:e=>!t.getUseHealth()})}}function zm(e,t,i){return new sm(e,t,{itemLabel:"Target Input",changedEvent:e=>e.targetsChangeEmitter,getValue:e=>e.targets[i].targetInputs,setValue:(e,t,a)=>{t.targets[i].targetInputs=a,t.targetsChangeEmitter.emit(e)},newItem:()=>is.create(),copyItem:e=>is.clone(e),newItemPicker:(e,a,s,o)=>new Vm(e,t,i,s,o),hideUi:!0})}function jm(e,t){if(null==e!=(null==t))return!1;if(null==e)return!0;const i=Le.clone(t);return i.targetInputs=e.targetInputs,Le.equals(e,i)}const Hm=[{stat:le.StatHealth,tooltip:"",extraCssClasses:[]},{stat:le.StatArmor,tooltip:"",extraCssClasses:[]},{stat:le.StatArcaneResistance,tooltip:"",extraCssClasses:[]},{stat:le.StatFireResistance,tooltip:"",extraCssClasses:[]},{stat:le.StatFrostResistance,tooltip:"",extraCssClasses:[]},{stat:le.StatNatureResistance,tooltip:"",extraCssClasses:[]},{stat:le.StatShadowResistance,tooltip:"",extraCssClasses:[]},{stat:le.StatAttackPower,tooltip:"",extraCssClasses:["threat-metrics"]},{stat:le.StatBlockValue,tooltip:"",extraCssClasses:["threat-metrics"]}],Bm=[{name:"None",value:Ae.MobTypeUnknown},{name:"Beast",value:Ae.MobTypeBeast},{name:"Demon",value:Ae.MobTypeDemon},{name:"Dragonkin",value:Ae.MobTypeDragonkin},{name:"Elemental",value:Ae.MobTypeElemental},{name:"Giant",value:Ae.MobTypeGiant},{name:"Humanoid",value:Ae.MobTypeHumanoid},{name:"Mechanical",value:Ae.MobTypeMechanical},{name:"Undead",value:Ae.MobTypeUndead}],qm=[{level:6,id:1130},{level:22,id:14323},{level:40,id:14324},{level:58,id:14325},{level:76,id:53338}],$m=[{level:12,id:588},{level:20,id:7128},{level:30,id:602},{level:40,id:1006},{level:50,id:10951},{level:60,id:10952},{level:69,id:25431},{level:71,id:48040},{level:77,id:48168}],Km=[{level:30,id:2818},{level:38,id:2819},{level:46,id:11353},{level:54,id:11354},{level:60,id:25349},{level:62,id:26968},{level:70,id:27187},{level:76,id:57969},{level:80,id:57970}],Ym=[{level:20,id:8680},{level:28,id:8685},{level:36,id:8689},{level:44,id:11335},{level:52,id:11336},{level:60,id:11337},{level:68,id:26890},{level:73,id:57964},{level:79,id:57965}],Jm=[{level:32,id:13218},{level:40,id:13222},{level:48,id:13223},{level:56,id:13224},{level:64,id:27189},{level:72,id:57974},{level:78,id:57975}],Zm=[{level:28,id:8227},{level:38,id:8249},{level:48,id:10526},{level:58,id:16387},{level:67,id:25557},{level:71,id:58649},{level:75,id:58652},{level:80,id:58656}],Qm=[{level:10,id:8024},{level:18,id:8027},{level:26,id:8030},{level:36,id:16339},{level:46,id:16341},{level:56,id:16342},{level:64,id:25489},{level:71,id:58785},{level:76,id:58789},{level:80,id:58790}],Xm=[{level:20,id:8033},{level:28,id:8038},{level:38,id:10456},{level:48,id:16355},{level:58,id:16356},{level:66,id:25500},{level:71,id:58794},{level:76,id:58795},{level:80,id:58796}],eh=[{level:20,id:5394},{level:30,id:6375},{level:40,id:6377},{level:50,id:10462},{level:60,id:10463},{level:69,id:25567},{level:71,id:58755},{level:76,id:58756},{level:80,id:58757}],th=[{level:8,id:324},{level:16,id:325},{level:24,id:905},{level:32,id:945},{level:40,id:8134},{level:48,id:10431},{level:56,id:10432},{level:63,id:25469},{level:70,id:25472},{level:75,id:49280},{level:80,id:49281}],ih=[{level:26,id:8190},{level:36,id:10585},{level:46,id:10586},{level:56,id:10587},{level:65,id:25552},{level:73,id:58731},{level:78,id:58734}],ah=[{level:26,id:5675},{level:36,id:10495},{level:46,id:10496},{level:56,id:10497},{level:65,id:25570},{level:71,id:58771},{level:76,id:58773},{level:80,id:58774}],sh=[{level:1,id:8017},{level:8,id:8018},{level:16,id:8019},{level:24,id:10399}],oh=[{level:10,id:3599},{level:20,id:6363},{level:30,id:6364},{level:40,id:6365},{level:50,id:10437},{level:60,id:10438},{level:69,id:25533},{level:71,id:58699},{level:75,id:58703},{level:80,id:58704}],lh=[{level:4,id:8071},{level:14,id:8154},{level:24,id:8155},{level:34,id:10406},{level:44,id:10407},{level:54,id:10408},{level:63,id:25508},{level:70,id:25509},{level:73,id:58751},{level:78,id:58753}],nh=[{level:10,id:8075},{level:24,id:8160},{level:38,id:8161},{level:52,id:10442},{level:60,id:25361},{level:65,id:25528},{level:75,id:57622},{level:80,id:58643}],rh=[{level:50,id:30706},{level:60,id:57720},{level:70,id:57721},{level:80,id:57722}],dh=[{level:20,id:52127},{level:28,id:52129},{level:34,id:52131},{level:41,id:52134},{level:48,id:52136},{level:55,id:52138},{level:62,id:24398},{level:69,id:33736},{level:76,id:57960}],ch=[{level:30,id:8232},{level:40,id:8235},{level:50,id:10486},{level:60,id:16362},{level:68,id:25505},{level:71,id:58801},{level:76,id:58803},{level:80,id:58804}],mh=[{level:4,id:702},{level:12,id:1108},{level:22,id:6205},{level:32,id:7646},{level:42,id:11707},{level:52,id:11708},{level:61,id:27224},{level:69,id:30909},{level:71,id:50511}],hh=[{level:62,id:28176},{level:69,id:28189},{level:74,id:47892},{level:79,id:47893}],ph=[{level:28,id:6366},{level:36,id:17951},{level:46,id:17952},{level:56,id:17953},{level:66,id:27250},{level:74,id:60219},{level:80,id:60220}],uh=[{level:36,id:2362},{level:48,id:17727},{level:60,id:17728},{level:66,id:28172},{level:72,id:47886},{level:78,id:47888}],gh=[{level:32,id:54424},{level:42,id:57564},{level:52,id:57565},{level:62,id:57566},{level:72,id:57567}],fh=[{level:1,id:6673},{level:12,id:5242},{level:22,id:6192},{level:32,id:11549},{level:42,id:11550},{level:52,id:11551},{level:60,id:25289},{level:69,id:2048},{level:78,id:47436}],wh=[{level:68,id:469},{level:74,id:47439},{level:80,id:47440}],Ih=[{level:18,id:8024},{level:26,id:8027},{level:36,id:8030},{level:46,id:16339},{level:56,id:16341},{level:64,id:16342},{level:71,id:25489},{level:76,id:58785},{level:80,id:58789}],xh=[{level:1,id:687},{level:10,id:696},{level:20,id:706},{level:30,id:1086},{level:40,id:11733},{level:50,id:11734},{level:60,id:11735},{level:70,id:27260},{level:76,id:47793},{level:80,id:47889}];class yh extends m{constructor(e,i,a,s){super(e,"multi-icon-picker-root"),t(this,"config"),t(this,"currentValue"),t(this,"buttonElem"),t(this,"dropdownMenu"),t(this,"pickers"),this.rootElem.classList.add("icon-picker"),this.config=a,this.currentValue=null,this.rootElem.innerHTML='\n\t\t\t<div class="dropend">\n\t\t\t\t<a\n\t\t\t\t\tclass="icon-picker-button"\n\t\t\t\t\trole="button"\n\t\t\t\t\tdata-bs-toggle="dropdown"\n\t\t\t\t\taria-expanded="false"\n\t\t\t\t\tdata-disable-wowhead-touch-tooltip=\'true\'\n\t\t\t\t\tdata-whtticon=\'false\'\n\t\t\t\t></a>\n\t\t\t\t<ul class="dropdown-menu"></ul>\n\t\t\t</div>\n\t\t\t<label class="multi-icon-picker-label form-label"></label>\n    ';const o=this.rootElem.querySelector(".multi-icon-picker-label");a.label?o.textContent=a.label:o.remove(),this.buttonElem=this.rootElem.querySelector(".icon-picker-button"),this.dropdownMenu=this.rootElem.querySelector(".dropdown-menu"),this.buttonElem.addEventListener("hide.bs.dropdown",(e=>{e.hasOwnProperty("clickEvent")&&e.preventDefault()})),this.buttonElem.addEventListener("contextmenu",(e=>{e.preventDefault()})),this.buttonElem.addEventListener("mousedown",(e=>{I(e)&&this.clearPicker()})),this.buildBlankOption(),this.pickers=a.inputs.map(((e,t)=>{const a=document.createElement("li");return a.classList.add("icon-picker-option","dropdown-option"),this.dropdownMenu.appendChild(a),new kc(a,i,e,s)})),s.sim.waitForInit().then((()=>this.updateButtonImage())),s.changeEmitter.on((()=>this.updateButtonImage())),s.changeEmitter.on((()=>{!this.config.showWhen||this.config.showWhen(s.sim.raid.getPlayer(0))?this.rootElem.classList.remove("hide"):this.rootElem.classList.add("hide")}))}buildBlankOption(){const e=document.createElement("li");this.dropdownMenu.appendChild(e);const t=document.createElement("a");t.classList.add("icon-dropdown-option","dropdown-option"),e.appendChild(t),t.addEventListener("click",(()=>this.clearPicker()))}clearPicker(){l.freezeAllAndDo((()=>{this.pickers.forEach((e=>{e.setInputValue(null),e.inputChanged(l.nextEventID())})),this.updateButtonImage()}))}updateButtonImage(){this.currentValue=this.getMaxValue(),this.currentValue?(this.buttonElem.classList.add("active"),null!=this.config.categoryId?this.config.categoryId.fillAndSet(this.buttonElem,!1,!0):this.currentValue.fillAndSet(this.buttonElem,!1,!0)):(this.buttonElem.classList.remove("active"),null!=this.config.categoryId?this.config.categoryId.fillAndSet(this.buttonElem,!1,!0):this.buttonElem.style.backgroundImage="",this.buttonElem.removeAttribute("href"))}getMaxValue(){return this.pickers.map((e=>e.getActionId())).filter((e=>null!=e))[0]||null}}const bh=Cc([Zc({actionId:si.fromSpellId([{level:1,id:1126},{level:10,id:5232},{level:20,id:6756},{level:30,id:5234},{level:40,id:8907},{level:50,id:9884},{level:60,id:9885},{level:70,id:26990},{level:80,id:48469}]),impId:x.fromSpellId(17051),fieldName:"giftOfTheWild"}),qc({actionId:x.fromItemId(49634),fieldName:"drumsOfTheWild",showWhen:e=>e.getLevel()>=80})],"Stats"),vh=Cc([Kc({actionId:x.fromSpellId(25898),fieldName:"blessingOfKings",showWhen:e=>e.getLevel()>=20}),qc({actionId:x.fromItemId(49633),fieldName:"drumsOfForgottenKings",showWhen:e=>e.getLevel()>=80}),Kc({actionId:x.fromSpellId(25899),fieldName:"blessingOfSanctuary",showWhen:e=>e.getLevel()>=30})],"Stats %"),Sh=Cc([Zc({actionId:si.fromSpellId([{level:1,id:465},{level:10,id:10290},{level:20,id:643},{level:30,id:10291},{level:40,id:1032},{level:50,id:10292},{level:60,id:10293},{level:70,id:27149},{level:74,id:48941},{level:79,id:48942}]),impId:x.fromSpellId(20140),fieldName:"devotionAura"}),Zc({actionId:si.fromSpellId(lh),impId:x.fromSpellId(16293),fieldName:"stoneskinTotem",showWhen:e=>e.getLevel()>=4}),qc({actionId:si.fromSpellId([{level:0,id:8091},{level:15,id:8094},{level:30,id:8095},{level:40,id:12175},{level:50,id:33079},{level:60,id:43196},{level:70,id:58452},{level:80,id:58453}]),fieldName:"scrollOfProtection"})],"Armor"),Eh=Cc([Qc({actionId:si.fromSpellId([{level:4,id:19740},{level:12,id:19834},{level:22,id:19835},{level:32,id:19836},{level:42,id:19837},{level:52,id:19838},{level:60,id:25291},{level:70,id:27140},{level:73,id:48931},{level:79,id:48932}]),impId:x.fromSpellId(20045),fieldName:"blessingOfMight",showWhen:e=>e.getLevel()>=4}),Zc({actionId:si.fromSpellId(fh),impId:x.fromSpellId(12861),fieldName:"battleShout"})],"AP"),Ph=Cc([qc({actionId:x.fromSpellId(53138),fieldName:"abominationsMight",showWhen:e=>e.getLevel()>=58}),qc({actionId:x.fromSpellId(30809),fieldName:"unleashedRage",showWhen:e=>e.getLevel()>=37}),qc({actionId:x.fromSpellId(19506),fieldName:"trueshotAura",showWhen:e=>e.getLevel()>=40})],"Atk Pwr %"),kh=Bc(qc({actionId:x.fromSpellId(2825),fieldName:"bloodlust",showWhen:e=>e.getLevel()>=70}),"Lust"),Ch=Cc([qc({actionId:x.fromSpellId(31869),fieldName:"sanctifiedRetribution",showWhen:e=>e.getLevel()>=30}),qc({actionId:x.fromSpellId(31583),fieldName:"arcaneEmpowerment",showWhen:e=>e.getLevel()>=42}),qc({actionId:x.fromSpellId(34460),fieldName:"ferociousInspiration",showWhen:e=>e.getLevel()>=42})],"Dmg %"),_h=Cc([Kc({actionId:x.fromSpellId(57472),fieldName:"renewedHope",showWhen:e=>e.getLevel()>=45}),Kc({actionId:x.fromSpellId(25899),fieldName:"blessingOfSanctuary",showWhen:e=>e.getLevel()>=30}),Kc({actionId:x.fromSpellId(50720),fieldName:"vigilance",showWhen:e=>e.getLevel()>=40})],"Mit %"),Nh=Cc([em({actionId:x.fromSpellId(6940),numStates:11,fieldName:"handOfSacrifices",showWhen:e=>e.getLevel()>=46}),em({actionId:x.fromSpellId(53530),numStates:11,fieldName:"divineGuardians",showWhen:e=>e.getLevel()>=26}),em({actionId:x.fromSpellId(33206),numStates:11,fieldName:"painSuppressions",showWhen:e=>e.getLevel()>=50}),em({actionId:x.fromSpellId(47788),numStates:11,fieldName:"guardianSpirits",showWhen:e=>e.getLevel()>=60})],"Defensive CDs"),Th=Cc([qc({actionId:x.fromSpellId(53648),fieldName:"swiftRetribution",showWhen:e=>e.getLevel()>=52}),qc({actionId:x.fromSpellId(48396),fieldName:"moonkinAura",value:dt.TristateEffectImproved,showWhen:e=>e.getLevel()>=43})],"Haste %"),Rh=Cc([Zc({actionId:si.fromSpellId(wh),impId:x.fromSpellId(12861),fieldName:"commandingShout",showWhen:e=>e.getLevel()>=68}),Zc({actionId:si.fromSpellId([{level:4,id:6307},{level:14,id:7804},{level:26,id:7805},{level:38,id:11766},{level:50,id:11767},{level:62,id:27268},{level:74,id:47982}]),impId:x.fromSpellId(18696),fieldName:"bloodPact",showWhen:e=>e.getLevel()>=4})],"Health"),Lh=Cc([qc({actionId:si.fromSpellId([{level:1,id:1459},{level:14,id:1460},{level:28,id:1461},{level:42,id:10156},{level:56,id:10157},{level:70,id:27126},{level:80,id:42995}]),fieldName:"arcaneBrilliance"}),Zc({actionId:si.fromSpellId(gh),impId:x.fromSpellId(54038),fieldName:"felIntelligence",showWhen:e=>e.getLevel()>=32}),qc({actionId:si.fromSpellId([{level:0,id:8096},{level:15,id:8097},{level:30,id:8098},{level:40,id:12176},{level:50,id:33078},{level:60,id:43195},{level:70,id:48099},{level:80,id:48100}]),fieldName:"scrollOfIntellect"})],"Int"),Gh=Cc([Zc({actionId:x.fromSpellId(17007),impId:x.fromSpellId(34300),fieldName:"leaderOfThePack",showWhen:e=>e.getLevel()>=40}),qc({actionId:x.fromSpellId(29801),fieldName:"rampage",showWhen:e=>e.getLevel()>=50})],"Melee Crit"),Ah=Cc([qc({actionId:x.fromSpellId(55610),fieldName:"icyTalons",showWhen:e=>e.getLevel()>=58}),Zc({actionId:x.fromSpellId(65990),impId:x.fromSpellId(29193),fieldName:"windfuryTotem",showWhen:e=>e.getLevel()>=30})],"Melee Haste"),Dh=Cc([Qc({actionId:si.fromSpellId([{level:14,id:19742},{level:24,id:19850},{level:34,id:19852},{level:44,id:19853},{level:54,id:19854},{level:60,id:25290},{level:65,id:27142},{level:71,id:48935},{level:77,id:48936}]),impId:x.fromSpellId(20245),fieldName:"blessingOfWisdom",showWhen:e=>e.getLevel()>=14}),Zc({actionId:si.fromSpellId(ah),impId:x.fromSpellId(16206),fieldName:"manaSpringTotem",showWhen:e=>e.getLevel()>=26})],"MP5"),Uh=Cc([Kc({actionId:x.fromSpellId(48160),fieldName:"vampiricTouch",showWhen:e=>e.getLevel()>=50}),Kc({actionId:x.fromSpellId(31878),fieldName:"judgementsOfTheWise",showWhen:e=>e.getLevel()>=40}),Kc({actionId:x.fromSpellId(53292),fieldName:"huntingParty",showWhen:e=>e.getLevel()>=55}),Kc({actionId:x.fromSpellId(54118),fieldName:"improvedSoulLeech",showWhen:e=>e.getLevel()>=45}),Kc({actionId:x.fromSpellId(44561),fieldName:"enduringWinter",showWhen:e=>e.getLevel()>=51})],"Replen"),Oh=Cc([qc({actionId:si.fromSpellId([{level:30,id:976},{level:42,id:10957},{level:56,id:10958},{level:68,id:25433},{level:76,id:48169}]),fieldName:"shadowProtection",showWhen:e=>e.getLevel()>=30}),qc({actionId:si.fromSpellId([{level:28,id:19876},{level:40,id:19895},{level:52,id:19896},{level:63,id:27151},{level:76,id:48943}]),fieldName:"shadowResistanceAura",showWhen:e=>e.getLevel()>=24}),qc({actionId:si.fromSpellId([{level:30,id:10595},{level:44,id:10600},{level:60,id:10601},{level:69,id:25574},{level:75,id:58746},{level:80,id:58749}]),fieldName:"natureResistanceTotem",showWhen:e=>e.getLevel()>=30}),qc({actionId:si.fromSpellId([{level:46,id:20043},{level:56,id:20190},{level:68,id:27045},{level:76,id:49071}]),fieldName:"aspectOfTheWild",showWhen:e=>e.getLevel()>=46}),qc({actionId:si.fromSpellId([{level:32,id:19888},{level:44,id:19897},{level:56,id:19898},{level:68,id:27152},{level:77,id:48945}]),fieldName:"frostResistanceAura",showWhen:e=>e.getLevel()>=32}),qc({actionId:si.fromSpellId([{level:24,id:8181},{level:38,id:10478},{level:54,id:10479},{level:67,id:25560},{level:75,id:58741},{level:80,id:58745}]),fieldName:"frostResistanceTotem",showWhen:e=>e.getLevel()>=24}),qc({actionId:si.fromSpellId([{level:28,id:8184},{level:42,id:10537},{level:58,id:10538},{level:68,id:25563},{level:75,id:58737},{level:80,id:58739}]),fieldName:"fireResistanceTotem",showWhen:e=>e.getLevel()>=24}),qc({actionId:si.fromSpellId([{level:36,id:19891},{level:48,id:19899},{level:60,id:19900},{level:70,id:27153},{level:78,id:48947}]),fieldName:"fireResistanceAura",showWhen:e=>e.getLevel()>=24})],"Resistances"),Mh=Cc([tm(x.fromSpellId(26982),101,10,"revitalizeRejuvination",(e=>e.getLevel()>=42)),tm(x.fromSpellId(53251),101,10,"revitalizeWildGrowth",(e=>e.getLevel()>=60))],"Revit",x.fromSpellId(48545)),Wh=Cc([Zc({actionId:x.fromSpellId(24907),impId:x.fromSpellId(48396),fieldName:"moonkinAura",showWhen:e=>e.getLevel()>=40}),qc({actionId:x.fromSpellId(51470),fieldName:"elementalOath",showWhen:e=>e.getLevel()>=46})],"Spell Crit"),Vh=Bc(qc({actionId:x.fromSpellId(3738),fieldName:"wrathOfAirTotem",showWhen:e=>e.getLevel()>=64}),"Spell Haste"),Fh=Cc([(zh={actionId:x.fromSpellId(47240),numStates:2e3,fieldName:"demonicPactSp",multiplier:20,showWhen:e=>e.getLevel()>=55},zc({getModObject:e=>e,showWhen:e=>(!zh.faction||zh.faction==e.getFaction())&&(!zh.showWhen||zh.showWhen(e)),getValue:e=>e.getRaid().getBuffs(),setValue:(e,t,i)=>t.getRaid().setBuffs(e,i),changeEmitter:e=>l.onAny([e.getRaid().buffsChangeEmitter,e.raceChangeEmitter,e.levelChangeEmitter])},zh.actionId,zh.numStates,zh.fieldName,zh.multiplier)),qc({actionId:si.fromSpellId(rh),fieldName:"totemOfWrath",showWhen:e=>e.getLevel()>=50}),qc({actionId:si.fromSpellId(Zm),fieldName:"flametongueTotem",showWhen:e=>e.getLevel()>=28})],"Spell Power");var zh;const jh=Cc([qc({actionId:si.fromSpellId([{level:30,id:14752},{level:40,id:14818},{level:50,id:14819},{level:60,id:27841},{level:70,id:25312},{level:80,id:48073}]),fieldName:"divineSpirit",showWhen:e=>e.getLevel()>=30}),Zc({actionId:si.fromSpellId(gh),impId:x.fromSpellId(54038),fieldName:"felIntelligence",showWhen:e=>e.getLevel()>=32}),qc({actionId:si.fromSpellId([{level:0,id:8112},{level:15,id:8113},{level:30,id:8114},{level:40,id:12177},{level:50,id:33080},{level:60,id:43197},{level:70,id:48103},{level:80,id:48104}]),fieldName:"scrollOfSpirit"})],"Spirit"),Hh=Cc([Zc({actionId:si.fromSpellId([{level:1,id:1243},{level:12,id:1244},{level:24,id:1245},{level:36,id:2791},{level:48,id:10937},{level:60,id:10938},{level:70,id:25389},{level:80,id:48161}]),impId:x.fromSpellId(14767),fieldName:"powerWordFortitude"}),qc({actionId:si.fromSpellId([{level:0,id:8099},{level:15,id:8100},{level:30,id:8101},{level:40,id:12178},{level:50,id:33081},{level:60,id:43198},{level:70,id:48101},{level:80,id:48102}]),fieldName:"scrollOfStamina"})],"Stamina"),Bh=Cc([Zc({actionId:si.fromSpellId(nh),impId:x.fromSpellId(52456),fieldName:"strengthOfEarthTotem",showWhen:e=>e.getLevel()>=10}),qc({actionId:si.fromSpellId([{level:65,id:57330},{level:75,id:57623}]),fieldName:"hornOfWinter",showWhen:e=>e.getLevel()>=65}),qc({actionId:si.fromSpellId([{level:0,id:8115},{level:15,id:8116},{level:30,id:8117},{level:40,id:12174},{level:50,id:33077},{level:60,id:43194},{level:70,id:58450},{level:80,id:58451}]),fieldName:"scrollOfAgility"}),qc({actionId:si.fromSpellId([{level:0,id:8118},{level:15,id:8119},{level:30,id:8120},{level:40,id:12179},{level:50,id:33082},{level:60,id:43199},{level:70,id:58448},{level:80,id:58449}]),fieldName:"scrollOfStrength"})],"Str/Agi"),qh=qc({actionId:x.fromSpellId(73828),fieldName:"strengthOfWrynn",showWhen:e=>e.getLevel()>=80}),$h=qc({actionId:si.fromSpellId([{level:16,id:7294},{level:26,id:10298},{level:36,id:10299},{level:46,id:10300},{level:56,id:10301},{level:66,id:27150},{level:76,id:54043}]),fieldName:"retributionAura",showWhen:e=>e.getLevel()>=16}),Kh=$c({actionId:x.fromSpellId(31025),fieldName:"braidedEterniumChain",showWhen:e=>e.getLevel()>=70}),Yh=$c({actionId:x.fromSpellId(31035),fieldName:"chainOfTheTwilightOwl",showWhen:e=>e.getLevel()>=70}),Jh=$c({actionId:x.fromSpellId(6562),fieldName:"heroicPresence"}),Zh=$c({actionId:x.fromSpellId(31033),fieldName:"eyeOfTheNight",showWhen:e=>e.getLevel()>=70}),Qh=Zc({actionId:si.fromSpellId([{level:6,id:467},{level:14,id:782},{level:24,id:1075},{level:34,id:8914},{level:44,id:9756},{level:54,id:9910},{level:64,id:26992},{level:74,id:53307}]),impId:x.fromSpellId(16840),fieldName:"thorns",showWhen:e=>e.getLevel()>=6}),Xh=(ep=x.fromSpellId(16190),zc({getModObject:e=>e.getParty(),getValue:e=>e.getBuffs(),setValue:(e,t,i)=>t.setBuffs(e,i),changeEmitter:e=>l.onAny([e.buffsChangeEmitter,e.getPlayer(0).levelChangeEmitter]),showWhen:e=>e.getPlayer(0).getLevel()>=40},ep,5,"manaTideTotems"));var ep;const tp=em({actionId:x.fromSpellId(29166),numStates:11,fieldName:"innervates",showWhen:e=>e.getLevel()>=40}),ip=em({actionId:x.fromSpellId(10060),numStates:11,fieldName:"powerInfusions",showWhen:e=>e.getLevel()>=40}),ap=Kc({actionId:x.fromSpellId(54648),fieldName:"focusMagic",showWhen:e=>e.getLevel()>=20}),sp=em({actionId:x.fromSpellId(57933),numStates:20,fieldName:"tricksOfTheTrades",showWhen:e=>e.getLevel()>=75}),op=em({actionId:x.fromSpellId(49016),numStates:11,fieldName:"unholyFrenzy",showWhen:e=>e.getLevel()>=58}),lp=Cc([Jc({actionId:x.fromSpellId(7386),fieldName:"sunderArmor",showWhen:e=>e.getLevel()>=10}),Jc({actionId:x.fromSpellId(8647),fieldName:"exposeArmor",showWhen:e=>e.getLevel()>=14}),Jc({actionId:x.fromSpellId(55754),fieldName:"acidSpit",showWhen:e=>e.getLevel()>=60})],"Major ArP"),np=Cc([Xc({actionId:x.fromSpellId(770),impId:x.fromSpellId(33602),fieldName:"faerieFire",showWhen:e=>e.getLevel()>=18}),Xc({actionId:si.fromSpellId(mh),impId:x.fromSpellId(18180),fieldName:"curseOfWeakness",showWhen:e=>e.getLevel()>=4}),Jc({actionId:x.fromSpellId(56631),fieldName:"sting",showWhen:e=>e.getLevel()>=60&&e.getExpansion()>=se.ExpansionTbc}),Jc({actionId:x.fromSpellId(53598),fieldName:"sporeCloud",showWhen:e=>e.getLevel()>=60&&e.getExpansion()>=se.ExpansionTbc})],"Minor ArP"),rp=Cc([Jc({actionId:x.fromSpellId(26016),fieldName:"vindication",showWhen:e=>e.getLevel()>=21}),Xc({actionId:si.fromSpellId([{level:14,id:1160},{level:24,id:6190},{level:34,id:11554},{level:44,id:11555},{level:54,id:11556},{level:62,id:25202},{level:70,id:25203},{level:79,id:47437}]),impId:x.fromSpellId(12879),fieldName:"demoralizingShout",showWhen:e=>e.getLevel()>=14}),Xc({actionId:si.fromSpellId([{level:10,id:99},{level:20,id:1735},{level:32,id:9490},{level:42,id:9747},{level:52,id:9898},{level:62,id:26998},{level:71,id:48559},{level:77,id:48560}]),impId:x.fromSpellId(16862),fieldName:"demoralizingRoar",showWhen:e=>e.getLevel()>=10}),Xc({actionId:si.fromSpellId(mh),impId:x.fromSpellId(18180),fieldName:"curseOfWeakness",showWhen:e=>e.getLevel()>=4}),Jc({actionId:si.fromSpellId([{level:1,id:24423},{level:16,id:24577},{level:32,id:24578},{level:48,id:24579},{level:64,id:27051},{level:80,id:55487}]),fieldName:"demoralizingScreech",showWhen:e=>e.getLevel()>=10})],"Atk Pwr"),dp=Cc([Jc({actionId:x.fromSpellId(48564),fieldName:"mangle",showWhen:e=>e.getLevel()>=50}),Jc({actionId:x.fromSpellId(46855),fieldName:"trauma",showWhen:e=>e.getLevel()>=36}),Jc({actionId:x.fromSpellId(57393),fieldName:"stampede",showWhen:e=>e.getLevel()>=68&&e.getExpansion()==se.ExpansionWotlk})],"Bleed"),cp=Cc([Jc({actionId:si.fromSpellId(rh),fieldName:"totemOfWrath",showWhen:e=>e.getLevel()>=50}),Jc({actionId:x.fromSpellId(20337),fieldName:"heartOfTheCrusader",showWhen:e=>e.getLevel()>=17}),Jc({actionId:x.fromSpellId(58410),fieldName:"masterPoisoner",showWhen:e=>e.getLevel()>=52})],"Crit"),mp=Cc([Xc({actionId:si.fromSpellId([{level:6,id:6343},{level:18,id:8198},{level:28,id:8204},{level:38,id:8205},{level:48,id:11580},{level:58,id:11581},{level:67,id:25264},{level:73,id:47501},{level:78,id:47502}]),impId:x.fromSpellId(12666),fieldName:"thunderClap",showWhen:e=>e.getLevel()>=6}),Xc({actionId:x.fromSpellId(55095),impId:x.fromSpellId(51456),fieldName:"frostFever",showWhen:e=>e.getLevel()>=58}),Jc({actionId:x.fromSpellId(53696),fieldName:"judgementsOfTheJust",showWhen:e=>e.getLevel()>=56}),Jc({actionId:x.fromSpellId(48485),fieldName:"infectedWounds",showWhen:e=>e.getLevel()>=47})],"Atk Speed"),hp=Cc([Jc({actionId:x.fromSpellId(65855),fieldName:"insectSwarm",showWhen:e=>e.getLevel()>=30}),Jc({actionId:x.fromSpellId(3043),fieldName:"scorpidSting",showWhen:e=>e.getLevel()>=22})],"Miss"),pp=Cc([Jc({actionId:x.fromSpellId(29859),fieldName:"bloodFrenzy",showWhen:e=>e.getLevel()>=51}),Jc({actionId:x.fromSpellId(58413),fieldName:"savageCombat",showWhen:e=>e.getLevel()>=51})],"Phys Vuln"),up=Cc([Jc({actionId:x.fromSpellId(17803),fieldName:"shadowMastery",showWhen:e=>e.getLevel()>=10}),Jc({actionId:x.fromSpellId(12873),fieldName:"improvedScorch",showWhen:e=>e.getLevel()>=25}),Jc({actionId:x.fromSpellId(28593),fieldName:"wintersChill",showWhen:e=>e.getLevel()>=35})],"Spell Crit"),gp=Cc([Jc({actionId:x.fromSpellId(33198),fieldName:"misery",showWhen:e=>e.getLevel()>=47}),Jc({actionId:x.fromSpellId(33602),fieldName:"faerieFire",value:dt.TristateEffectImproved,showWhen:e=>e.getLevel()>=42})],"Spell Hit"),fp=Cc([Jc({actionId:x.fromSpellId(51161),fieldName:"ebonPlaguebringer",showWhen:e=>e.getLevel()>=58}),Jc({actionId:x.fromSpellId(48511),fieldName:"earthAndMoon",showWhen:e=>e.getLevel()>=57}),Jc({actionId:si.fromSpellId([{level:32,id:1490},{level:46,id:11721},{level:60,id:11722},{level:69,id:27228},{level:78,id:47865}]),fieldName:"curseOfElements",showWhen:e=>e.getLevel()>=32})],"Spell Dmg"),wp=Bc(function(e){return function(e,t,i,a,s){const o=Vc(e,t,s);return o.states=4,o.improvedId=i,o.improvedId2=a,o}({getModObject:e=>e.getRaid(),getValue:e=>e.getDebuffs(),setValue:(e,t,i)=>t.setDebuffs(e,i),changeEmitter:e=>l.onAny([e.debuffsChangeEmitter,e.getPlayer(0).levelChangeEmitter]),showWhen:t=>e.showWhen(t.getPlayer(0))},e.actionId,e.impId,e.impId2,e.fieldName)}({actionId:si.fromSpellId(qm),impId:x.fromSpellId(19423),impId2:x.fromItemId(42907),fieldName:"huntersMark",showWhen:e=>e.getLevel()>=6}),"Mark"),Ip=Bc(Jc({actionId:x.fromSpellId(53408),fieldName:"judgementOfWisdom",showWhen:e=>e.getLevel()>=12}),"JoW"),xp=Jc({actionId:x.fromSpellId(20271),fieldName:"judgementOfLight",showWhen:e=>e.getLevel()>=4}),yp=em({actionId:x.fromSpellId(64382),numStates:20,fieldName:"shatteringThrows",showWhen:e=>e.getLevel()>=80}),bp=Jc({actionId:x.fromSpellId(11374),fieldName:"giftOfArthas",showWhen:e=>e.getLevel()>=38}),vp=Jc({actionId:x.fromSpellId(15235),fieldName:"crystalYield",showWhen:e=>e.getLevel()>=47}),Sp=[{config:bh,picker:yh,stats:[]},{config:vh,picker:yh,stats:[]},{config:Rh,picker:yh,stats:[le.StatHealth]},{config:Sh,picker:yh,stats:[le.StatArmor]},{config:Hh,picker:yh,stats:[le.StatStamina]},{config:Bh,picker:yh,stats:[le.StatStrength,le.StatAgility]},{config:Lh,picker:yh,stats:[le.StatIntellect]},{config:jh,picker:yh,stats:[le.StatSpirit]},{config:Eh,picker:yh,stats:[le.StatAttackPower,le.StatRangedAttackPower]},{config:Ph,picker:yh,stats:[le.StatAttackPower,le.StatRangedAttackPower]},{config:Gh,picker:yh,stats:[le.StatMeleeCrit]},{config:Ah,picker:yh,stats:[le.StatMeleeHaste]},{config:Fh,picker:yh,stats:[le.StatSpellPower]},{config:Wh,picker:yh,stats:[le.StatSpellCrit]},{config:Th,picker:yh,stats:[le.StatMeleeHaste,le.StatSpellHaste]},{config:Ch,picker:yh,stats:[le.StatAttackPower,le.StatRangedAttackPower,le.StatSpellPower]},{config:_h,picker:yh,stats:[le.StatArmor]},{config:Oh,picker:yh,stats:[le.StatNatureResistance,le.StatShadowResistance,le.StatFrostResistance]},{config:Nh,picker:yh,stats:[le.StatArmor]},{config:Dh,picker:yh,stats:[le.StatMP5]},{config:Uh,picker:yh,stats:[le.StatMP5]},{config:kh,picker:kc,stats:[le.StatMeleeHaste,le.StatSpellHaste]},{config:Vh,picker:kc,stats:[le.StatSpellHaste]},{config:Mh,picker:yh,stats:[]}],Ep=[{config:qh,picker:kc,stats:[le.StatAttackPower,le.StatRangedAttackPower,le.StatSpellPower]},{config:Jh,picker:kc,stats:[le.StatMeleeHit,le.StatSpellHit]},{config:Kh,picker:kc,stats:[le.StatMeleeCrit,le.StatSpellCrit]},{config:Yh,picker:kc,stats:[le.StatSpellCrit,le.StatMeleeCrit]},{config:ap,picker:kc,stats:[le.StatSpellCrit]},{config:Zh,picker:kc,stats:[le.StatSpellPower]},{config:Qh,picker:kc,stats:[le.StatArmor]},{config:$h,picker:kc,stats:[le.StatArmor]},{config:Xh,picker:kc,stats:[le.StatMP5]},{config:tp,picker:kc,stats:[le.StatMP5]},{config:ip,picker:kc,stats:[le.StatMP5,le.StatSpellPower]},{config:sp,picker:kc,stats:[le.StatAttackPower,le.StatRangedAttackPower,le.StatSpellPower]},{config:op,picker:kc,stats:[le.StatAttackPower,le.StatRangedAttackPower]}],Pp=[{config:lp,picker:yh,stats:[le.StatArmorPenetration]},{config:np,picker:yh,stats:[le.StatArmorPenetration]},{config:pp,picker:yh,stats:[le.StatAttackPower,le.StatRangedAttackPower]},{config:dp,picker:yh,stats:[le.StatAttackPower,le.StatRangedAttackPower]},{config:fp,picker:yh,stats:[le.StatSpellPower]},{config:gp,picker:yh,stats:[le.StatSpellHit]},{config:up,picker:yh,stats:[le.StatSpellCrit]},{config:cp,picker:yh,stats:[le.StatMeleeCrit,le.StatSpellCrit]},{config:rp,picker:yh,stats:[le.StatArmor]},{config:mp,picker:yh,stats:[le.StatArmor]},{config:hp,picker:yh,stats:[le.StatDodge]},{config:Ip,picker:kc,stats:[le.StatMP5,le.StatIntellect]},{config:wp,picker:kc,stats:[le.StatRangedAttackPower]}],kp=[{config:xp,picker:kc,stats:[le.StatStamina]},{config:yp,picker:kc,stats:[le.StatArmorPenetration]},{config:bp,picker:kc,stats:[le.StatAttackPower,le.StatRangedAttackPower]},{config:vp,picker:kc,stats:[le.StatArmorPenetration]}];function Cp(e,t){return e.filter((e=>0==e.stats.length||e.stats.some((e=>t.individualConfig.epStats.includes(e)))||t.individualConfig.includeBuffDebuffInputs.includes(e.config))).filter((e=>!t.individualConfig.excludeBuffDebuffInputs.includes(e.config)))}class _p extends m{constructor(e,a,s,o){super(e,"item-swap-picker-root"),t(this,"itemSlots"),t(this,"enableItemSwapPicker"),this.itemSlots=o.itemSlots,this.enableItemSwapPicker=new xt(this.rootElem,s,{reverse:!0,label:"Enable Item Swapping",labelTooltip:"Allows configuring an Item Swap Set which is used with the <b>Item Swap</b> APL action.",extraCssClasses:["input-inline"],getValue:e=>e.getEnableItemSwap(),setValue(e,t,i){t.setEnableItemSwap(e,i)},changedEvent:e=>e.itemSwapChangeEmitter});const n=document.createElement("div");let r;n.classList.add("input-root","input-inline"),this.rootElem.appendChild(n),o.note&&(r=this.rootElem.appendChild(h("p",{className:"form-text"},o.note)));const d=()=>{s.getEnableItemSwap()?(n.classList.remove("hide"),r?.classList.remove("hide")):(n.classList.add("hide"),r?.classList.add("hide"))};s.itemSwapChangeEmitter.on(d),d();const c=document.createElement("label");c.classList.add("form-label"),c.textContent="Item Swap",n.appendChild(c);const m=u.newGroupContainer();m.classList.add("icon-group"),n.appendChild(m);const p=document.createElement("fragment");p.innerHTML='\n\t\t\t<a\n\t\t\t\thref="javascript:void(0)"\n\t\t\t\tclass="gear-swap-icon"\n\t\t\t\trole="button"\n\t\t\t\tdata-bs-title="Swap with equipped items"\n\t\t\t>\n\t\t\t\t<i class="fas fa-arrows-rotate me-1"></i>\n\t\t\t</a>\n\t\t';const g=p.children[0];m.appendChild(g),g.addEventListener("click",(e=>this.swapWithGear(l.nextEventID(),s))),i.getOrCreateInstance(g),this.itemSlots.forEach((e=>{new nc(m,a,s,e)}))}swapWithGear(e,t){let i=t.getGear(),a=t.getItemSwapGear();this.itemSlots.forEach((e=>{const s=t.getGear().getEquippedItem(e),o=t.getItemSwapGear().getEquippedItem(e);i=i.withEquippedItem(e,o,t.canDualWield2H()),a=a.withEquippedItem(e,s,t.canDualWield2H())})),l.freezeAllAndDo((()=>{t.setGear(e,i),t.setItemSwapGear(e,a)}))}}function Np(e){return(t,i)=>({type:"iconEnum",tooltip:i,numColumns:t.length>5?2:1,values:[{value:0}].concat(t.map((t=>{const i={actionId:t.config.actionId,showWhen:i=>(!t.config.showWhen||t.config.showWhen(i))&&(t.config.faction||i.getFaction())==i.getFaction()&&(!e.filter||e.filter(t,i))};return t.config.value&&(i.value=t.config.value),i}))),equals:(e,t)=>e==t,zeroValue:0,changedEvent:e=>l.onAny([e.consumesChangeEmitter,e.gearChangeEmitter,e.levelChangeEmitter,e.professionChangeEmitter,e.sim.expansionChangeEmitter]),showWhen:t=>!e.showWhen||e.showWhen(t),getValue:t=>t.getConsumes()[e.consumesFieldName],setValue:(t,i,a)=>{const s=i.getConsumes();s[e.consumesFieldName]!==a&&(s[e.consumesFieldName]=a,l.freezeAllAndDo((()=>{i.setConsumes(t,s),e.onSet&&e.onSet(t,i,a)})))}})}const Tp={actionId:x.fromItemId(12662),value:os.ConjuredDarkRune},Rp={actionId:x.fromItemId(22788),value:os.ConjuredFlameCap},Lp={actionId:x.fromItemId(22105),value:os.ConjuredHealthstone},Gp=[{config:{actionId:x.fromItemId(7676),value:os.ConjuredRogueThistleTea,showWhen:e=>e.getClass()==d.ClassRogue},stats:[]},{config:Lp,stats:[le.StatStamina]},{config:Tp,stats:[le.StatIntellect]},{config:Rp,stats:[]}],Ap=Np({consumesFieldName:"defaultConjured"}),Dp=[{config:{actionId:x.fromItemId(41119),value:ls.ExplosiveSaroniteBomb,showWhen:e=>e.hasProfession(ae.Engineering)},stats:[]},{config:{actionId:x.fromItemId(40771),value:ls.ExplosiveCobaltFragBomb,showWhen:e=>e.hasProfession(ae.Engineering)},stats:[]},{config:{actionId:x.fromItemId(23826),value:ls.TheBiggerOne,showWhen:e=>e.hasProfession(ae.Engineering)},stats:[]},{config:{actionId:x.fromItemId(18588),value:ls.EzThroDynamiteII},stats:[]},{config:{actionId:x.fromItemId(6714),value:ls.EzThroDynamite},stats:[]},{config:{actionId:x.fromItemId(18641),value:ls.DenseDynamite,showWhen:e=>e.hasProfession(ae.Engineering)},stats:[]},{config:{actionId:x.fromItemId(4378),value:ls.HeavyDynamite,showWhen:e=>e.hasProfession(ae.Engineering)},stats:[]}],Up=[{config:{actionId:x.fromItemId(42641),value:ns.ThermalSapper,showWhen:e=>e.hasProfession(ae.Engineering)},stats:[]},{config:{actionId:x.fromItemId(23827),value:ns.SuperSapperCharge,showWhen:e=>e.hasProfession(ae.Engineering)},stats:[]},{config:{actionId:x.fromItemId(10646),value:ns.GoblinSapperCharge,showWhen:e=>e.hasProfession(ae.Engineering)},stats:[]}],Op=[{config:{actionId:x.fromItemId(40536),value:rs.ExplosiveDecoy,showWhen:e=>e.hasProfession(ae.Engineering)},stats:[]}],Mp=Np({consumesFieldName:"explosiveSmall"}),Wp=Np({consumesFieldName:"explosiveBig"}),Vp=Np({consumesFieldName:"explosiveMedium"}),Fp=Np({consumesFieldName:"flask",onSet:(e,t,i)=>{if(i){const i=t.getConsumes();i.battleElixir=hs.BattleElixirUnknown,i.guardianElixir=ps.GuardianElixirUnknown,t.setConsumes(e,i)}},filter:(e,t)=>!e.level||t.getLevel()>=e.level}),zp=Np({consumesFieldName:"battleElixir",onSet:(e,t,i)=>{if(i){const i=t.getConsumes();i.flask=us.FlaskUnknown,t.setConsumes(e,i)}},filter:(e,t)=>!e.level||t.getLevel()>=e.level}),jp=Np({consumesFieldName:"guardianElixir",onSet:(e,t,i)=>{if(i){const i=t.getConsumes();i.flask=us.FlaskUnknown,t.setConsumes(e,i)}},filter:(e,t)=>!e.level||t.getLevel()>=e.level}),Hp=[{config:{actionId:x.fromItemId(20749),value:ds.BrilliantWizardOil},stats:[le.StatSpellCrit,le.StatSpellPower],level:45},{config:{actionId:x.fromItemId(20748),value:ds.BrilliantManaOil},stats:[le.StatMP5,le.StatSpellPower],level:45},{config:{actionId:x.fromItemId(22522),value:ds.SuperiorWizardOil},stats:[le.StatSpellPower],level:58},{config:{actionId:x.fromItemId(22521),value:ds.SuperiorManaOil},stats:[le.StatMP5],level:58},{config:{actionId:x.fromItemId(20750),value:ds.WizardOil},stats:[le.StatSpellPower],level:40},{config:{actionId:x.fromItemId(20747),value:ds.LesserManaOil},stats:[le.StatMP5],level:30},{config:{actionId:x.fromItemId(20746),value:ds.LesserWizardOil},stats:[le.StatSpellPower],level:30},{config:{actionId:x.fromItemId(20745),value:ds.MinorManaOil},stats:[le.StatMP5],level:5},{config:{actionId:x.fromItemId(20744),value:ds.MinorWizardOil},stats:[le.StatSpellPower],level:5},{config:{actionId:x.fromItemId(23529),value:ds.AdamantiteSharpeningStone},stats:[le.StatMeleeCrit,le.StatAttackPower],level:60,type:"sharp"},{config:{actionId:x.fromItemId(28421),value:ds.AdamantiteWeightStone},stats:[le.StatMeleeCrit,le.StatAttackPower],level:60,type:"blunt"},{config:{actionId:x.fromItemId(23528),value:ds.FelSharpeningStone},stats:[le.StatAttackPower],level:50,type:"sharp"},{config:{actionId:x.fromItemId(28420),value:ds.FelWeightstone},stats:[le.StatAttackPower],level:50,type:"blunt"},{config:{actionId:x.fromItemId(18262),value:ds.ElementalSharpeningStone},stats:[le.StatMeleeCrit],level:50},{config:{actionId:x.fromItemId(12404),value:ds.DenseSharpeningStone},stats:[le.StatAttackPower],level:35,type:"sharp"},{config:{actionId:x.fromItemId(12643),value:ds.DenseWeightstone},stats:[le.StatAttackPower],level:35,type:"blunt"},{config:{actionId:x.fromItemId(7964),value:ds.SolidSharpeningStone},stats:[le.StatAttackPower],level:25,type:"sharp"},{config:{actionId:x.fromItemId(7965),value:ds.SolidWeightStone},stats:[le.StatAttackPower],level:25,type:"blunt"},{config:{actionId:x.fromItemId(2871),value:ds.HeavySharpeningStone},stats:[le.StatAttackPower],level:15,type:"sharp"},{config:{actionId:x.fromItemId(3241),value:ds.HeavyWeightStone},stats:[le.StatAttackPower],level:15,type:"blunt"},{config:{actionId:x.fromItemId(2863),value:ds.CoarseSharpeningStone},stats:[le.StatAttackPower],level:5,type:"sharp"},{config:{actionId:x.fromItemId(3240),value:ds.CoarseWeightStone},stats:[le.StatAttackPower],level:5,type:"blunt"},{config:{actionId:x.fromItemId(2862),value:ds.RoughSharpeningStone},stats:[le.StatAttackPower],level:1,type:"sharp"},{config:{actionId:x.fromItemId(3239),value:ds.RoughWeightStone},stats:[le.StatAttackPower],level:1,type:"blunt"},{config:{actionId:x.fromItemId(34539),value:ds.RighteousWeaponCoating},stats:[le.StatAttackPower,le.StatRangedAttackPower],level:70},{config:{actionId:x.fromItemId(34538),value:ds.BlessedWeaponCoating},stats:[le.StatMP5],level:70},{config:{actionId:x.fromItemId(30696),value:ds.ConsecratedWeapon},stats:[le.StatAttackPower],condition:e=>e.isClass(d.ClassPaladin)&&e.getEquippedItem(Q.ItemSlotMainHand).item.ilvl<138&&e.hasTrinketEquipped(30696)}],Bp=Np({consumesFieldName:"mhImbue",showWhen:e=>{const t=e.getGear().getEquippedItem(Q.ItemSlotMainHand);return null!=t&&t?.item.ilvl<=165},filter:(e,t)=>{const i=e;return(!i.level||t.getLevel()>=i.level)&&(!i.type||"sharp"===i.type&&t.getGear().hasSharpMHWeapon()||"blunt"===i.type&&t.getGear().hasBluntMHWeapon())&&(!i.condition||i.condition(t))}}),qp=Np({consumesFieldName:"ohImbue",showWhen:e=>{const t=e.getGear().getEquippedItem(Q.ItemSlotOffHand);return null!=t&&t?.item.ilvl<=165},filter:(e,t)=>{const i=e;return(!i.level||t.getLevel()>=i.level)&&(!i.type||"sharp"===i.type&&t.getGear().hasSharpOHWeapon()||"blunt"===i.type&&t.getGear().hasBluntOHWeapon())&&(!i.condition||i.condition(t))}}),$p=Np({consumesFieldName:"food",filter:(e,t)=>!e.level||t.getLevel()>=e.level}),Kp=Yc({actionId:x.fromItemId(43005),fieldName:"petFood",value:cs.PetFoodSpicedMammothTreats});Yc({actionId:x.fromItemId(27498),fieldName:"petScrollOfAgility",value:5}),Yc({actionId:x.fromItemId(27503),fieldName:"petScrollOfStrength",value:5});const Yp={actionId:x.fromItemId(33447),value:ms.RunicHealingPotion},Jp={actionId:x.fromItemId(41166),value:ms.RunicHealingInjector},Zp={actionId:x.fromItemId(33448),value:ms.RunicManaPotion},Qp={actionId:x.fromItemId(42545),value:ms.RunicManaInjector},Xp={actionId:x.fromItemId(40093),value:ms.IndestructiblePotion},eu={actionId:x.fromItemId(40211),value:ms.PotionOfSpeed},tu={actionId:x.fromItemId(40212),value:ms.PotionOfWildMagic},iu={actionId:x.fromItemId(22839),value:ms.DestructionPotion},au={actionId:x.fromItemId(22838),value:ms.HastePotion};x.fromItemId(13442),ms.MightyRagePotion;const su={actionId:x.fromItemId(22832),value:ms.SuperManaPotion},ou={actionId:x.fromItemId(31677),value:ms.FelManaPotion},lu={actionId:x.fromItemId(22828),value:ms.InsaneStrengthPotion},nu={actionId:x.fromItemId(22849),value:ms.IronshieldPotion},ru={actionId:x.fromItemId(22837),value:ms.HeroicPotion},du=[{config:Yp,stats:[le.StatStamina],level:70},{config:Jp,stats:[le.StatStamina],level:70},{config:Zp,stats:[le.StatIntellect],level:70},{config:Qp,stats:[le.StatIntellect],level:70},{config:Xp,stats:[le.StatArmor],level:70},{config:lu,stats:[le.StatStrength],level:70},{config:ru,stats:[le.StatStamina],level:70},{config:eu,stats:[le.StatMeleeHaste,le.StatSpellHaste],level:70},{config:tu,stats:[le.StatMeleeCrit,le.StatSpellCrit,le.StatSpellPower],level:70},{config:iu,stats:[le.StatMeleeCrit,le.StatSpellCrit,le.StatSpellPower],level:60},{config:au,stats:[le.StatMeleeHaste,le.StatSpellHaste],level:60},{config:nu,stats:[le.StatArmor],level:60},{config:su,stats:[le.StatIntellect],level:60},{config:ou,stats:[le.StatRangedAttackPower],level:60}],cu=[{config:Xp,stats:[le.StatArmor],level:60},{config:lu,stats:[le.StatStrength],level:60},{config:ru,stats:[le.StatStamina],level:60},{config:eu,stats:[le.StatMeleeHaste,le.StatSpellHaste],level:60},{config:tu,stats:[le.StatMeleeCrit,le.StatSpellCrit,le.StatSpellPower],level:60},{config:iu,stats:[le.StatMeleeCrit,le.StatSpellCrit,le.StatSpellPower],level:60},{config:au,stats:[le.StatMeleeHaste,le.StatSpellHaste],level:60},{config:nu,stats:[le.StatArmor],level:60}],mu=Np({consumesFieldName:"defaultPotion"}),hu=Np({consumesFieldName:"prepopPotion"}),pu=[{config:{actionId:x.fromItemId(28104),value:hs.ElixirofMastery},stats:[le.StatStrength,le.StatAgility,le.StatStamina,le.StatIntellect,le.StatSpirit],level:50},{config:{actionId:x.fromItemId(13453),value:hs.ElixirofBruteForce},stats:[le.StatStrength,le.StatStamina],level:45},{config:{actionId:x.fromItemId(13454),value:hs.GreaterArcaneElixir},stats:[le.StatSpellPower,le.StatMeleeCrit,le.StatSpellCrit],level:47},{config:{actionId:x.fromItemId(17708),value:hs.ElixirofFrostPower},stats:[le.StatSpellPower],level:28},{config:{actionId:x.fromItemId(21546),value:hs.ElixirofGreaterFirepower},stats:[le.StatSpellPower],level:40},{config:{actionId:x.fromItemId(22824),value:hs.ElixirofMajorStrength},stats:[le.StatStrength],level:50},{config:{actionId:x.fromItemId(22825),value:hs.ElixirofHealingPower},stats:[le.StatSpirit,le.StatSpellPower],level:50},{config:{actionId:x.fromItemId(22827),value:hs.ElixirofMajorFrostPower},stats:[le.StatSpellPower],level:50},{config:{actionId:x.fromItemId(22831),value:hs.ElixirofMajorAgility},stats:[le.StatAgility,le.StatMeleeCrit,le.StatSpellCrit],level:55},{config:{actionId:x.fromItemId(22833),value:hs.ElixirofMajorFirepower},stats:[le.StatSpellPower],level:50},{config:{actionId:x.fromItemId(22835),value:hs.ElixirofMajorShadowPower},stats:[le.StatSpellPower],level:60},{config:{actionId:x.fromItemId(28102),value:hs.OnslaughtElixir},stats:[le.StatAttackPower,le.StatRangedAttackPower],level:50},{config:{actionId:x.fromItemId(28103),value:hs.AdeptsElixir},stats:[le.StatSpellPower,le.StatMeleeCrit,le.StatSpellCrit],level:50},{config:{actionId:x.fromItemId(2457),value:hs.ElixirofMinorAgility},stats:[le.StatAgility],level:2},{config:{actionId:x.fromItemId(31679),value:hs.FelStrengthElixir},stats:[le.StatAttackPower,le.StatRangedAttackPower,le.StatStamina],level:60},{config:{actionId:x.fromItemId(39666),value:hs.ElixirofMightyAgility},stats:[le.StatAgility],level:70},{config:{actionId:x.fromItemId(40068),value:hs.WrathElixir},stats:[le.StatAttackPower,le.StatRangedAttackPower],level:70},{config:{actionId:x.fromItemId(40070),value:hs.SpellpowerElixir},stats:[le.StatSpellPower],level:70},{config:{actionId:x.fromItemId(40073),value:hs.ElixirofMightyStrength},stats:[le.StatStrength],level:70},{config:{actionId:x.fromItemId(40076),value:hs.GurusElixir},stats:[le.StatStrength,le.StatAgility,le.StatStamina,le.StatIntellect,le.StatSpirit],level:70},{config:{actionId:x.fromItemId(44325),value:hs.ElixirofAccuracy},stats:[le.StatMeleeHit,le.StatSpellHit],level:70},{config:{actionId:x.fromItemId(44327),value:hs.ElixirofDeadlyStrikes},stats:[le.StatMeleeCrit,le.StatSpellCrit],level:70},{config:{actionId:x.fromItemId(44329),value:hs.ElixirofExpertise},stats:[le.StatExpertise],level:70},{config:{actionId:x.fromItemId(44330),value:hs.ElixirofArmorPiercing},stats:[le.StatArmorPenetration],level:70},{config:{actionId:x.fromItemId(44331),value:hs.ElixirofLightningSpeed},stats:[le.StatMeleeHaste,le.StatSpellHaste],level:70},{config:{actionId:x.fromItemId(45621),value:hs.ElixirofMinorAccuracy},stats:[le.StatMeleeHit,le.StatSpellHit],level:15},{config:{actionId:x.fromItemId(13452),value:hs.ElixiroftheMongoose},stats:[le.StatAgility,le.StatMeleeCrit,le.StatSpellCrit],level:46},{config:{actionId:x.fromItemId(6373),value:hs.ElixirofFirepower},stats:[le.StatSpellPower],level:18},{config:{actionId:x.fromItemId(6662),value:hs.ElixirofGiantGrowth},stats:[le.StatStrength],level:8},{config:{actionId:x.fromItemId(8949),value:hs.ElixirofAgility},stats:[le.StatAgility],level:27},{config:{actionId:x.fromItemId(3391),value:hs.ElixirofOgresStrength},stats:[le.StatStrength],level:20},{config:{actionId:x.fromItemId(3390),value:hs.ElixirofLesserAgility},stats:[le.StatAgility],level:18},{config:{actionId:x.fromItemId(9155),value:hs.ArcaneElixir},stats:[le.StatSpellPower],level:37},{config:{actionId:x.fromItemId(9187),value:hs.ElixirofGreaterAgility},stats:[le.StatAgility],level:38},{config:{actionId:x.fromItemId(9206),value:hs.ElixirofGiants},stats:[le.StatStrength],level:38},{config:{actionId:x.fromItemId(9224),value:hs.ElixirofDemonslaying},stats:[le.StatAttackPower,le.StatRangedAttackPower],level:40},{config:{actionId:x.fromItemId(9264),value:hs.ElixirofShadowPower},stats:[le.StatSpellPower],level:40},{config:{actionId:x.fromItemId(2454),value:hs.ElixirofLionsStrength},stats:[le.StatStrength],level:1}],uu=[{config:{actionId:x.fromItemId(40072),value:ps.ElixirofSpirit},stats:[le.StatSpirit],level:70},{config:{actionId:x.fromItemId(13447),value:ps.ElixiroftheSages},stats:[le.StatIntellect,le.StatSpirit],level:44},{config:{actionId:x.fromItemId(44332),value:ps.ElixirofMightyThoughts},stats:[le.StatIntellect],level:70},{config:{actionId:x.fromItemId(32063),value:ps.EarthenElixir},stats:[],level:50},{config:{actionId:x.fromItemId(32067),value:ps.ElixirofDraenicWisdom},stats:[le.StatIntellect,le.StatSpirit],level:50},{config:{actionId:x.fromItemId(32068),value:ps.ElixirofIronskin},stats:[le.StatResilience],level:55},{config:{actionId:x.fromItemId(5997),value:ps.ElixirofMinorDefense},stats:[le.StatArmor],level:1},{config:{actionId:x.fromItemId(3826),value:ps.MajorTrollsBloodElixir},stats:[],level:26},{config:{actionId:x.fromItemId(3825),value:ps.ElixirofFortitude},stats:[le.StatHealth],level:25},{config:{actionId:x.fromItemId(3389),value:ps.ElixirofDefense},stats:[le.StatArmor],level:16},{config:{actionId:x.fromItemId(2458),value:ps.ElixirofMinorFortitude},stats:[le.StatHealth],level:2},{config:{actionId:x.fromItemId(3382),value:ps.WeakTrollsBloodElixir},stats:[],level:1},{config:{actionId:x.fromItemId(40078),value:ps.ElixirofMightyFortitude},stats:[le.StatHealth],level:70},{config:{actionId:x.fromItemId(3383),value:ps.ElixirofWisdom},stats:[le.StatIntellect],level:10},{config:{actionId:x.fromItemId(40097),value:ps.ElixirofProtection},stats:[le.StatArmor],level:70},{config:{actionId:x.fromItemId(44328),value:ps.ElixirofMightyDefense},stats:[le.StatDefense],level:70},{config:{actionId:x.fromItemId(3388),value:ps.StrongTrollsBloodElixir},stats:[],level:15},{config:{actionId:x.fromItemId(40109),value:ps.ElixirofMightyMageblood},stats:[le.StatMP5],level:70},{config:{actionId:x.fromItemId(8951),value:ps.ElixirofGreaterDefense},stats:[le.StatArmor],level:29},{config:{actionId:x.fromItemId(13445),value:ps.ElixirofSuperiorDefense},stats:[le.StatArmor],level:43},{config:{actionId:x.fromItemId(20004),value:ps.MightyTrollsBloodElixir},stats:[],level:53},{config:{actionId:x.fromItemId(20007),value:ps.MagebloodElixir},stats:[le.StatMP5],level:40},{config:{actionId:x.fromItemId(22192),value:ps.BloodkelpElixirofDodging},stats:[le.StatDodge],level:0},{config:{actionId:x.fromItemId(22193),value:ps.BloodkelpElixirofResistance},stats:[le.StatFireResistance,le.StatNatureResistance,le.StatFrostResistance,le.StatShadowResistance,le.StatArcaneResistance],level:0},{config:{actionId:x.fromItemId(9179),value:ps.ElixirofGreaterIntellect},stats:[le.StatIntellect],level:37},{config:{actionId:x.fromItemId(22834),value:ps.ElixirofMajorDefense},stats:[le.StatArmor],level:55},{config:{actionId:x.fromItemId(9088),value:ps.GiftofArthas},stats:[le.StatShadowResistance],level:38},{config:{actionId:x.fromItemId(22848),value:ps.ElixirofEmpowerment},stats:[le.StatSpellPenetration],level:60},{config:{actionId:x.fromItemId(32062),value:ps.ElixirofMajorFortitude},stats:[le.StatHealth],level:50},{config:{actionId:x.fromItemId(22840),value:ps.ElixirofMajorMageblood},stats:[le.StatMP5],level:60}],gu=[{config:{actionId:x.fromItemId(13513),value:us.FlaskofChromaticResistance},stats:[le.StatFireResistance,le.StatNatureResistance,le.StatFrostResistance,le.StatShadowResistance,le.StatArcaneResistance],level:50},{config:{actionId:x.fromItemId(46379),value:us.FlaskofStoneblood},stats:[le.StatHealth],level:75},{config:{actionId:x.fromItemId(46378),value:us.FlaskofPureMojo},stats:[le.StatMP5],level:75},{config:{actionId:x.fromItemId(46377),value:us.FlaskofEndlessRage},stats:[le.StatAttackPower,le.StatRangedAttackPower],level:75},{config:{actionId:x.fromItemId(46376),value:us.FlaskoftheFrostWyrm},stats:[le.StatSpellPower],level:75},{config:{actionId:x.fromItemId(13510),value:us.FlaskoftheTitans},stats:[le.StatHealth],level:50},{config:{actionId:x.fromItemId(44939),value:us.LesserFlaskofResistance},stats:[le.StatFireResistance,le.StatNatureResistance,le.StatFrostResistance,le.StatShadowResistance,le.StatArcaneResistance],level:70},{config:{actionId:x.fromItemId(13511),value:us.FlaskofDistilledWisdom},stats:[le.StatIntellect],level:50},{config:{actionId:x.fromItemId(13512),value:us.FlaskofSupremePower},stats:[le.StatSpellPower],level:50},{config:{actionId:x.fromItemId(22851),value:us.FlaskofFortification},stats:[le.StatHealth,le.StatDefense],level:65},{config:{actionId:x.fromItemId(22866),value:us.FlaskofPureDeath},stats:[le.StatSpellPower],level:65},{config:{actionId:x.fromItemId(22861),value:us.FlaskofBlindingLight},stats:[le.StatSpellPower],level:65},{config:{actionId:x.fromItemId(33208),value:us.FlaskofChromaticWonder},stats:[le.StatFireResistance,le.StatNatureResistance,le.StatFrostResistance,le.StatShadowResistance,le.StatArcaneResistance,le.StatStrength,le.StatAgility,le.StatStamina,le.StatIntellect,le.StatSpirit],level:65},{config:{actionId:x.fromItemId(22854),value:us.FlaskofRelentlessAssault},stats:[le.StatAttackPower,le.StatRangedAttackPower],level:65},{config:{actionId:x.fromItemId(22853),value:us.FlaskofMightyRestoration},stats:[le.StatMP5],level:65},{config:{actionId:x.fromItemId(40079),value:us.LesserFlaskofToughness},stats:[le.StatResilience],level:70}],fu=[{config:{actionId:x.fromItemId(724),value:gs.GoretuskLiverPie},stats:[le.StatStamina,le.StatSpirit],level:5},{config:{actionId:x.fromItemId(1082),value:gs.RedridgeGoulash},stats:[le.StatStamina,le.StatSpirit],level:10},{config:{actionId:x.fromItemId(3728),value:gs.TastyLionSteak},stats:[le.StatStamina,le.StatSpirit],level:20},{config:{actionId:x.fromItemId(12215),value:gs.HeavyKodoStew},stats:[le.StatStamina,le.StatSpirit],level:35},{config:{actionId:x.fromItemId(13928),value:gs.GrilledSquid},stats:[le.StatAgility],level:35},{config:{actionId:x.fromItemId(17198),value:gs.EggNog},stats:[le.StatStamina,le.StatSpirit],level:1},{config:{actionId:x.fromItemId(20452),value:gs.SmokedDesertDumplings},stats:[le.StatStrength],level:45},{config:{actionId:x.fromItemId(21023),value:gs.DirgesKickinChimaerokChops},stats:[le.StatStamina],level:55},{config:{actionId:x.fromItemId(24105),value:gs.RoastedMoongrazeTenderloin},stats:[le.StatStamina,le.StatSpirit],level:0},{config:{actionId:x.fromItemId(27651),value:gs.BuzzardBites},stats:[le.StatStamina,le.StatSpirit],level:55},{config:{actionId:x.fromItemId(27655),value:gs.RavagerDog},stats:[le.StatAttackPower,le.StatRangedAttackPower,le.StatSpirit],level:55},{config:{actionId:x.fromItemId(27657),value:gs.BlackenedBasilisk},stats:[le.StatSpellPower,le.StatSpirit],level:55},{config:{actionId:x.fromItemId(27658),value:gs.RoastedClefthoof},stats:[le.StatStrength,le.StatSpirit],level:55},{config:{actionId:x.fromItemId(27659),value:gs.WarpBurger},stats:[le.StatAgility,le.StatSpirit],level:55},{config:{actionId:x.fromItemId(27663),value:gs.BlackenedSporefish},stats:[le.StatStamina,le.StatMP5],level:55},{config:{actionId:x.fromItemId(27667),value:gs.SpicyCrawdad},stats:[le.StatStamina,le.StatSpirit],level:55},{config:{actionId:x.fromItemId(33004),value:gs.ClamletteMagnifique},stats:[le.StatAttackPower,le.StatRangedAttackPower,le.StatSpellPower],level:35},{config:{actionId:x.fromItemId(33024),value:gs.PickledSausage},stats:[le.StatStamina,le.StatSpirit],level:45},{config:{actionId:x.fromItemId(33825),value:gs.SkullfishSoup},stats:[le.StatMeleeCrit,le.StatSpellCrit,le.StatSpirit],level:65},{config:{actionId:x.fromItemId(33867),value:gs.BroiledBloodfin},stats:[le.StatFireResistance,le.StatNatureResistance,le.StatFrostResistance,le.StatShadowResistance,le.StatArcaneResistance],level:55},{config:{actionId:x.fromItemId(33872),value:gs.SpicyHotTalbuk},stats:[le.StatMeleeHit,le.StatSpellHit,le.StatSpirit],level:65},{config:{actionId:x.fromItemId(34754),value:gs.MegaMammothMeal},stats:[le.StatAttackPower,le.StatRangedAttackPower,le.StatStamina],level:70},{config:{actionId:x.fromItemId(34755),value:gs.TenderShoveltuskSteak},stats:[le.StatSpellPower,le.StatStamina],level:70},{config:{actionId:x.fromItemId(34756),value:gs.SpicedWormBurger},stats:[le.StatMeleeCrit,le.StatSpellCrit,le.StatStamina],level:70},{config:{actionId:x.fromItemId(34758),value:gs.MightyRhinoDogs},stats:[le.StatMP5,le.StatStamina],level:70},{config:{actionId:x.fromItemId(34769),value:gs.ImperialMantaSteak},stats:[le.StatMeleeHaste,le.StatSpellHaste,le.StatStamina],level:70},{config:{actionId:x.fromItemId(35563),value:gs.CharredBearKabobs},stats:[le.StatAttackPower,le.StatRangedAttackPower],level:45},{config:{actionId:x.fromItemId(35565),value:gs.JuicyBearBurger},stats:[le.StatSpellPower],level:45},{config:{actionId:x.fromItemId(42994),value:gs.RhinoliciousWormsteak},stats:[le.StatExpertise,le.StatStamina],level:70},{config:{actionId:x.fromItemId(42995),value:gs.HeartyRhino},stats:[le.StatArmorPenetration,le.StatStamina],level:70},{config:{actionId:x.fromItemId(42996),value:gs.SnapperExtreme},stats:[le.StatMeleeHit,le.StatSpellHit,le.StatStamina],level:70},{config:{actionId:x.fromItemId(42998),value:gs.Cuttlesteak},stats:[le.StatSpirit,le.StatStamina],level:70},{config:{actionId:x.fromItemId(42999),value:gs.BlackenedDragonfin},stats:[le.StatAgility,le.StatStamina],level:70},{config:{actionId:x.fromItemId(43e3),value:gs.DragonfinFilet},stats:[le.StatStrength,le.StatStamina],level:70},{config:{actionId:x.fromItemId(43015),value:gs.FishFeast},stats:[le.StatAttackPower,le.StatRangedAttackPower,le.StatStamina,le.StatSpellPower],level:70},{config:{actionId:x.fromItemId(46399),value:gs.ThundersPlunder},stats:[le.StatResilience,le.StatStamina],level:75}];class wu extends m{constructor(e,i,a){super(e,"consumes-picker-root"),t(this,"settingsTab"),t(this,"simUI"),this.settingsTab=i,this.simUI=a,this.buildPotionsPicker(),this.buildElixirsPicker(),this.buildFoodPicker(),this.simUI.player.getClass()!=d.ClassRogue&&this.simUI.player.getClass()!=d.ClassShaman&&this.simUI.player.getClass()!=d.ClassShaman&&this.buildImbuePicker(),this.buildEngPicker(),this.buildPetPicker()}buildPotionsPicker(){const e=document.createElement("fragment");e.innerHTML='\n\t\t\t<div class="consumes-row input-root input-inline">\n\t\t\t\t<label class="form-label">Potions</label>\n\t\t\t\t<div class="consumes-row-inputs">\n\t\t\t\t\t<div class="consumes-prepot"></div>\n          <div class="consumes-potions"></div>\n          <div class="consumes-conjured"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n    ';const t=this.rootElem.appendChild(e.children[0]),i=this.rootElem.querySelector(".consumes-prepot"),a=this.rootElem.querySelector(".consumes-potions"),s=this.rootElem.querySelector(".consumes-conjured");this.buildPickers({changeEmitters:[this.simUI.levelChangeEmitter],containerElem:t,options:[{getConfig:()=>hu(Cp(cu,this.simUI),"Combat Potion"),parentElem:i},{getConfig:()=>mu(Cp(du,this.simUI)),parentElem:a},{getConfig:()=>Ap(Cp(Gp,this.simUI)),parentElem:s}]})}buildElixirsPicker(){const e=document.createElement("fragment");e.innerHTML='\n      <div class="consumes-row input-root input-inline">\n        <label class="form-label">Elixirs</label>\n        <div class="consumes-row-inputs">\n\t\t\t\t\t<div class="consumes-flasks"></div>\n\t\t\t\t\t<span class="elixir-space">or</span>\n\t\t\t\t\t<div class="consumes-battle-elixirs"></div>\n\t\t\t\t\t<div class="consumes-guardian-elixirs"></div>\n\t\t\t\t</div>\n      </div>\n    ';const t=this.rootElem.appendChild(e.children[0]),i=this.rootElem.querySelector(".consumes-flasks"),a=this.rootElem.querySelector(".consumes-battle-elixirs"),s=this.rootElem.querySelector(".consumes-guardian-elixirs");this.buildPickers({changeEmitters:[this.simUI.levelChangeEmitter],containerElem:t,options:[{getConfig:()=>Fp(Cp(gu,this.simUI)),parentElem:i},{getConfig:()=>zp(Cp(pu,this.simUI)),parentElem:a},{getConfig:()=>jp(Cp(uu,this.simUI)),parentElem:s}]})}buildImbuePicker(){const e=document.createElement("fragment");e.innerHTML='\n\t\t  <div class="consumes-row input-root input-inline">\n\t\t\t<label class="form-label">Weapon Imbue</label>\n\t\t\t<div class="consumes-row-inputs">\n\t\t\t  <div class="consumes-weapon-mh"></div>\n\t\t\t  <div class="consumes-weapon-oh"></div>\n\t\t\t</div>\n\t\t  </div>\n    ';const t=this.rootElem.appendChild(e.children[0]),i=this.rootElem.querySelector(".consumes-weapon-mh"),a=this.rootElem.querySelector(".consumes-weapon-oh");this.buildPickers({changeEmitters:[this.simUI.player.gearChangeEmitter,this.simUI.levelChangeEmitter],containerElem:t,options:[{getConfig:()=>Bp(Cp(Hp,this.simUI)),parentElem:i},{getConfig:()=>qp(Cp(Hp,this.simUI)),parentElem:a}]})}buildFoodPicker(){const e=document.createElement("fragment");e.innerHTML='\n      <div class="consumes-row input-root input-inline">\n        <label class="form-label">Food</label>\n        <div class="consumes-row-inputs">\n          <div class="consumes-food"></div>\n        </div>\n      </div>\n    ';const t=this.rootElem.appendChild(e.children[0]),i=this.rootElem.querySelector(".consumes-food");this.buildPickers({changeEmitters:[this.simUI.levelChangeEmitter],containerElem:t,options:[{getConfig:()=>$p(Cp(fu,this.simUI)),parentElem:i}]})}buildEngPicker(){const e=document.createElement("fragment");e.innerHTML='\n      <div class="consumes-row input-root input-inline">\n        <label class="form-label">Engineering</label>\n        <div class="consumes-row-inputs">\n\t\t\t\t\t<div class="consumes-sapper"></div>\n\t\t\t\t\t<div class="consumes-decoy"></div>\n\t\t\t\t\t<div class="consumes-explosives"></div>\n\t\t\t\t</div>\n      </div>\n    ';const t=this.rootElem.appendChild(e.children[0]),i=this.rootElem.querySelector(".consumes-sapper"),a=this.rootElem.querySelector(".consumes-decoy"),s=this.rootElem.querySelector(".consumes-explosives");this.buildPickers({changeEmitters:[this.simUI.player.professionChangeEmitter],containerElem:t,options:[{getConfig:()=>Wp(Cp(Up,this.simUI)),parentElem:i},{getConfig:()=>Vp(Cp(Op,this.simUI)),parentElem:a},{getConfig:()=>Mp(Cp(Dp,this.simUI)),parentElem:s}]})}buildPetPicker(){if(this.simUI.individualConfig.petConsumeInputs?.length){const e=document.createElement("fragment");e.innerHTML='\n        <div class="consumes-row input-root input-inline">\n          <label class="form-label">Pet</label>\n          <div class="consumes-row-inputs">\n\t\t\t\t\t\t<div class="consumes-pet"></div>\n\t\t\t\t\t</div>\n        </div>\n      ',this.rootElem.appendChild(e.children[0]);const t=this.rootElem.querySelector(".consumes-pet");this.simUI.individualConfig.petConsumeInputs.map((e=>Hc(t,this.simUI,e)))}}buildPickers({containerElem:e,changeEmitters:t,options:i}){const a=()=>{const t=i.map((e=>{e.parentElem.innerHTML="";const t=e.getConfig();let i;return i="icon"==t.type?!t.showWhen||t.showWhen(this.simUI.player):(!t.showWhen||t.showWhen(this.simUI.player))&&t.values.filter((e=>!e.showWhen||e.showWhen(this.simUI.player))).length>1,i?Hc(e.parentElem,this.simUI,t):e.parentElem.classList.add("hide"),i||void 0===t.setValue||t.setValue(0,this.simUI.player,0),i})).filter((e=>e)).length>0;t?e.classList.remove("hide"):e.classList.add("hide")};l.onAny(t).on(a),a()}}class Iu extends uc{constructor(e,i){super(e,i,{identifier:"settings-tab",title:"Settings"}),t(this,"simUI"),t(this,"leftPanel"),t(this,"rightPanel"),t(this,"column1",this.buildColumn(1,"settings-left-col")),t(this,"column2",this.buildColumn(2,"settings-left-col")),t(this,"column3",this.buildColumn(3,"settings-left-col")),t(this,"column4"),this.simUI=i,this.leftPanel=document.createElement("div"),this.leftPanel.classList.add("settings-tab-left","tab-panel-left"),this.leftPanel.appendChild(this.column1),this.leftPanel.appendChild(this.column2),this.leftPanel.appendChild(this.column3),this.simUI.isWithinRaidSim&&(this.column4=this.buildColumn(4,"settings-left-col"),this.leftPanel.appendChild(this.column4)),this.rightPanel=document.createElement("div"),this.rightPanel.classList.add("settings-tab-right","tab-panel-right","within-raid-sim-hide"),this.contentContainer.appendChild(this.leftPanel),this.contentContainer.appendChild(this.rightPanel),this.buildTabContent()}buildTabContent(){this.simUI.isWithinRaidSim||this.buildEncounterSettings(),this.buildPlayerSettings(),this.buildCustomSettingsSections(),this.buildConsumesSection(),this.buildOtherSettings(),this.simUI.isWithinRaidSim||(this.buildBuffsSettings(),this.buildDebuffsSettings()),this.simUI.isWithinRaidSim||this.buildSavedDataPickers()}buildEncounterSettings(){const e=new Nd(this.column1,"encounter-settings",{header:{title:"Encounter"}});new Om(e.bodyElement,this.simUI.sim.encounter,this.simUI.individualConfig.encounterPicker,this.simUI)}buildPlayerSettings(){const e=this.column1,t=new Nd(e,"player-settings",{header:{title:"Player"}}),i=u.newGroupContainer();i.classList.add("player-icon-group","icon-group"),t.bodyElement.appendChild(i),this.configureIconSection(i,this.simUI.individualConfig.playerIconInputs.map((e=>Hc(i,this.simUI,e))),!0),new il(t.bodyElement,this.simUI.player,{label:"Level",labelTooltip:"Character level.",changedEvent:e=>e.levelChangeEmitter,getValue:e=>e.getLevel(),setValue:(e,t,i)=>t.setLevel(e,i),float:!1,min:()=>this.simUI.player.getMinLevel(),max:()=>this.simUI.player.getMaxLevel()}),new Dd(t.bodyElement,this.simUI.player,{label:"Expansion",values:[{name:"WOTLK",value:se.ExpansionWotlk},{name:"TBC",value:se.ExpansionTbc},{name:"Vanilla",value:se.ExpansionVanilla}],changedEvent:e=>e.sim.expansionChangeEmitter,getValue:e=>e.getExpansion(),setValue:(e,t,i)=>t.setExpansion(e,i)});const a=Z[this.simUI.player.spec];new Dd(t.bodyElement,this.simUI.player,{label:"Race",values:a.map((e=>({name:Pt.get(e),value:e}))),changedEvent:e=>e.raceChangeEmitter,getValue:e=>e.getRace(),setValue:(e,t,i)=>t.setRace(e,i)}),this.simUI.individualConfig.playerInputs?.inputs.length&&this.configureInputSection(t.bodyElement,this.simUI.individualConfig.playerInputs);const s=u.newGroupContainer();t.bodyElement.appendChild(s);const o=tt(ae);new Dd(s,this.simUI.player,{label:"Profession 1",values:o.map((e=>({name:Ft.get(e),value:e}))),changedEvent:e=>e.professionChangeEmitter,getValue:e=>e.getProfession1(),setValue:(e,t,i)=>t.setProfession1(e,i)}),new Dd(s,this.simUI.player,{label:"Profession 2",values:o.map((e=>({name:Ft.get(e),value:e}))),changedEvent:e=>e.professionChangeEmitter,getValue:e=>e.getProfession2(),setValue:(e,t,i)=>t.setProfession2(e,i)})}buildCustomSettingsSections(){(this.simUI.individualConfig.customSections||[]).forEach((e=>{e(this.column2,this.simUI).rootElem.classList.add("custom-section")}))}buildConsumesSection(){const e=this.simUI.isWithinRaidSim?this.column3:this.column2,t=new Nd(e,"consumes-settings",{header:{title:"Consumables"}});new wu(t.bodyElement,this,this.simUI)}buildOtherSettings(){const e=this.simUI.individualConfig.otherInputs?.inputs.filter((e=>!e.extraCssClasses?.includes("within-raid-sim-hide")||!0)),t=this.simUI.individualConfig.itemSwapSlots||[];if(e.length>0||t.length>0){const i=new Nd(this.column2,"other-settings",{header:{title:"Other"}});e.length>0&&(this.configureInputSection(i.bodyElement,this.simUI.individualConfig.otherInputs),i.bodyElement.querySelectorAll(".input-root").forEach((e=>{e.classList.add("input-inline")}))),t.length>0&&new _p(i.bodyElement,this.simUI,this.simUI.player,{itemSlots:t})}}buildBuffsSettings(){const e=new Nd(this.column3,"buffs-settings",{header:{title:"Raid Buffs",tooltip:"Buffs provided by other party/raid members."}}),t=Cp(Sp,this.simUI);this.configureIconSection(e.bodyElement,t.map((t=>t.picker&&new t.picker(e.bodyElement,this.simUI.player,t.config,this.simUI))));const i=Cp(Ep,this.simUI);i.length>0&&new yh(e.bodyElement,this.simUI.player,{inputs:i.map((e=>e.config)),label:"Misc"},this.simUI)}buildDebuffsSettings(){const e=new Nd(this.column3,"debuffs-settings",{header:{title:"Debuffs",tooltip:"Debuffs applied by other raid members."}}),t=Cp(Pp,this.simUI);this.configureIconSection(e.bodyElement,t.map((t=>t.picker&&new t.picker(e.bodyElement,this.simUI.player,t.config,this.simUI))));const i=Cp(kp,this.simUI);i.length&&new yh(e.bodyElement,this.simUI.player,{inputs:i.map((e=>e.config)),label:"Misc"},this.simUI)}buildSavedDataPickers(){const e=new yc(this.rightPanel,this.simUI.sim.encounter,{label:"Encounter",header:{title:"Saved Encounters"},storageKey:this.simUI.getSavedEncounterStorageKey(),getData:e=>fs.create({encounter:e.toProto()}),setData:(e,t,i)=>t.fromProto(e,i.encounter),changeEmitters:[this.simUI.sim.encounter.changeEmitter],equals:(e,t)=>fs.equals(e,t),toJson:e=>fs.toJson(e),fromJson:e=>fs.fromJson(e)}),t=new yc(this.rightPanel,this.simUI,{label:"Settings",header:{title:"Saved Settings"},storageKey:this.simUI.getSavedSettingsStorageKey(),getData:e=>{const t=e.player;return ws.create({raidBuffs:e.sim.raid.getBuffs(),partyBuffs:t.getParty()?.getBuffs()||o.create(),playerBuffs:t.getBuffs(),debuffs:e.sim.raid.getDebuffs(),consumes:t.getConsumes(),race:t.getRace(),professions:t.getProfessions(),enableItemSwap:t.getEnableItemSwap(),itemSwap:t.getItemSwapGear().toProto(),reactionTimeMs:t.getReactionTime(),channelClipDelayMs:t.getChannelClipDelay(),inFrontOfTarget:t.getInFrontOfTarget(),distanceFromTarget:t.getDistanceFromTarget(),healingModel:t.getHealingModel(),nibelungAverageCasts:t.getNibelungAverageCasts()})},setData:(e,t,i)=>{l.freezeAllAndDo((()=>{t.sim.raid.setBuffs(e,i.raidBuffs||Ue.create()),t.sim.raid.setDebuffs(e,i.debuffs||Oe.create());const a=t.player.getParty();a&&a.setBuffs(e,i.partyBuffs||o.create()),t.player.setBuffs(e,i.playerBuffs||z.create()),t.player.setConsumes(e,i.consumes||j.create()),t.player.setRace(e,i.race),t.player.setProfessions(e,i.professions),t.player.setEnableItemSwap(e,i.enableItemSwap),t.player.setItemSwapGear(e,t.sim.db.lookupItemSwap(i.itemSwap||Is.create())),t.player.setReactionTime(e,i.reactionTimeMs),t.player.setChannelClipDelay(e,i.channelClipDelayMs),t.player.setInFrontOfTarget(e,i.inFrontOfTarget),t.player.setDistanceFromTarget(e,i.distanceFromTarget),t.player.setHealingModel(e,i.healingModel||Y.create()),t.player.setNibelungAverageCasts(e,i.nibelungAverageCasts)}))},changeEmitters:[this.simUI.sim.raid.buffsChangeEmitter,this.simUI.sim.raid.debuffsChangeEmitter,this.simUI.player.getParty().buffsChangeEmitter,this.simUI.player.buffsChangeEmitter,this.simUI.player.consumesChangeEmitter,this.simUI.player.raceChangeEmitter,this.simUI.player.professionChangeEmitter,this.simUI.player.itemSwapChangeEmitter,this.simUI.player.miscOptionsChangeEmitter,this.simUI.player.inFrontOfTargetChangeEmitter,this.simUI.player.distanceFromTargetChangeEmitter,this.simUI.player.healingModelChangeEmitter],equals:(e,t)=>ws.equals(e,t),toJson:e=>ws.toJson(e),fromJson:e=>ws.fromJson(e)});this.simUI.sim.waitForInit().then((()=>{e.loadUserData(),t.loadUserData()}))}configureInputSection(e,t){t.inputs.forEach((t=>{"number"==t.type?new il(e,this.simUI.player,t):"boolean"==t.type?new xt(e,this.simUI.player,{...t,reverse:!0}):"enum"==t.type&&new Dd(e,this.simUI.player,t)}))}configureIconSection(e,t,i){0==t.length?e.classList.add("hide"):i&&(t.length<=4?e.style.gridTemplateColumns=`repeat(${t.length}, 1fr)`:t.length>4&&t.length<8&&(e.style.gridTemplateColumns=`repeat(${Math.ceil(t.length/2)}, 1fr)`))}}const xu={id:0,name:"Empty",description:"",iconUrl:"https://wow.zamimg.com/images/wow/icons/medium/inventoryslot_empty.jpg",quality:null};class yu extends m{constructor(e,i,a){super(e,"glyphs-picker-root"),t(this,"glyphsConfig"),t(this,"majorGlyphPickers",[]),t(this,"minorGlyphPickers",[]),this.glyphsConfig=a,this.rootElem.appendChild(h("h6",{className:"mt-2 fw-bold d-xl-block d-none"},"Glyphs"));const s=Object.keys(a.majorGlyphs).map((e=>Number(e))),o=Object.keys(a.minorGlyphs).map((e=>Number(e))),l=s.map((e=>this.getGlyphData(e))),n=o.map((e=>this.getGlyphData(e)));l.sort(((e,t)=>Ne(e.name,t.name))),n.sort(((e,t)=>Ne(e.name,t.name)));const r=new Nd(this.rootElem,"major-glyphs",{header:{title:"Major",extraCssClasses:["border-0","mb-1"]}}),d=new Nd(this.rootElem,"minor-glyphs",{header:{title:"Minor",extraCssClasses:["border-0","mb-1"]}});this.majorGlyphPickers=["major1","major2","major3"].map((e=>new bu(r.bodyElement,i,l,e,!0))),this.minorGlyphPickers=["minor1","minor2","minor3"].map((e=>new bu(d.bodyElement,i,n,e,!1)))}getGlyphData(e){const t=this.glyphsConfig.majorGlyphs[e]||this.glyphsConfig.minorGlyphs[e];return{id:e,name:t.name,description:t.description,iconUrl:t.iconUrl,quality:lt.ItemQualityCommon}}}class bu extends u{constructor(e,i,a,s,o){super(e,"glyph-picker-root",i,{changedEvent:e=>l.onAny([e.glyphsChangeEmitter,e.levelChangeEmitter]),getValue:e=>e.getGlyphs()[s],setValue:(e,t,i)=>{const a=t.getGlyphs();a[s]=i,t.setGlyphs(e,a)},enableWhen:e=>{let t;switch(s){case"major1":case"minor1":t=15;break;case"major2":t=30;break;case"minor2":t=50;break;case"minor3":t=70;break;case"major3":t=80}return e.getLevel()>=t}}),t(this,"player"),t(this,"iconElem"),t(this,"glyphOptions"),t(this,"selectedGlyph"),o||this.rootElem.classList.add("minor"),this.player=i,this.glyphOptions=a,this.selectedGlyph=xu,this.rootElem.innerHTML="<a class=\"glyph-picker-icon\" data-whtticon='false'></a>",this.iconElem=this.rootElem.getElementsByClassName("glyph-picker-icon")[0],this.iconElem.addEventListener("click",(e=>{e.preventDefault(),new vu(this.rootElem.closest(".individual-sim-ui"),this,this.glyphOptions)})),this.init()}getInputElem(){return this.iconElem}getInputValue(){return this.selectedGlyph.id}setInputValue(e){this.selectedGlyph=this.glyphOptions.find((t=>t.id==e))||xu,this.iconElem.style.backgroundImage=`url('${this.selectedGlyph.iconUrl}')`,this.iconElem.href=0==this.selectedGlyph.id?"":x.makeItemUrl(this.selectedGlyph.id)}}class vu extends dd{constructor(e,t,i){super(e,"glyph-modal",{title:"Glyphs"}),this.body.innerHTML='\n\t\t\t<div class="input-root">\n\t\t\t\t<input class="selector-modal-search form-control" type="text" placeholder="Search...">\n\t\t\t</div>\n\t\t\t<ul class="selector-modal-list"></ul>\n\t\t';const a=this.rootElem.getElementsByClassName("selector-modal-list")[0],s=(i=[xu].concat(i)).map(((e,i)=>{const s=document.createElement("li");s.classList.add("selector-modal-list-item"),a.appendChild(s),s.dataset.idx=String(i),s.innerHTML=`\n\t\t\t\t<a class="selector-modal-list-item-link">\n\t\t\t\t\t<img class="selector-modal-list-item-icon" />\n\t\t\t\t\t<label class="selector-modal-list-item-name">${e.name}</label>\n\t\t\t\t\t<span class="selector-modal-list-item-description">${e.description}</span>\n\t\t\t\t</a>\n      `;const o=s.children[0],n=s.querySelector(".selector-modal-list-item-icon"),r=s.querySelector(".selector-modal-list-item-name");return o.href=0==e.id?"":x.makeItemUrl(e.id),o.addEventListener("click",(i=>{i.preventDefault(),t.setValue(l.nextEventID(),e.id)})),n.src=e.iconUrl,Rd(r,e.quality),s})),o=()=>{const e=t.selectedGlyph.id;s.forEach((t=>{const a=parseInt(t.dataset.idx),s=i[a];t.classList.remove("active"),s.id==e&&t.classList.add("active")}))};o();const n=()=>{let e=s;e=e.filter((e=>{const t=parseInt(e.dataset.idx),a=i[t];if(r.value.length>0){const e=r.value.toLowerCase().split(" "),t=a.name.toLowerCase();let i=!0;if(e.forEach((e=>{t.includes(e)||(i=!1)})),!i)return!1}return!0})),a.innerHTML="",a.append(...e)},r=this.rootElem.getElementsByClassName("selector-modal-search")[0];r.addEventListener("input",n),r.addEventListener("keyup",(e=>{"Enter"==e.key&&s.find((e=>{if(e.classList.contains("hidden"))return!1;return e.getElementsByClassName("selector-modal-list-item-name")[0].click(),!0}))})),t.player.glyphsChangeEmitter.on((()=>{n(),o()}))}}function Su(){return jc({fieldName:"petType",numColumns:5,values:[{value:xs.PetNone,tooltip:"No Pet"},{actionId:x.fromPetName("Bat"),tooltip:"Bat",value:xs.Bat},{actionId:x.fromPetName("Bear"),tooltip:"Bear",value:xs.Bear},{actionId:x.fromPetName("Bird of Prey"),tooltip:"Bird of Prey",value:xs.BirdOfPrey},{actionId:x.fromPetName("Boar"),tooltip:"Boar",value:xs.Boar},{actionId:x.fromPetName("Carrion Bird"),tooltip:"Carrion Bird",value:xs.CarrionBird},{actionId:x.fromPetName("Cat"),tooltip:"Cat",value:xs.Cat},{actionId:x.fromPetName("Chimaera"),tooltip:"Chimaera (Exotic)",value:xs.Chimaera},{actionId:x.fromPetName("Core Hound"),tooltip:"Core Hound (Exotic)",value:xs.CoreHound},{actionId:x.fromPetName("Crab"),tooltip:"Crab",value:xs.Crab},{actionId:x.fromPetName("Crocolisk"),tooltip:"Crocolisk",value:xs.Crocolisk},{actionId:x.fromPetName("Devilsaur"),tooltip:"Devilsaur (Exotic)",value:xs.Devilsaur},{actionId:x.fromPetName("Dragonhawk"),tooltip:"Dragonhawk",value:xs.Dragonhawk},{actionId:x.fromPetName("Gorilla"),tooltip:"Gorilla",value:xs.Gorilla},{actionId:x.fromPetName("Hyena"),tooltip:"Hyena",value:xs.Hyena},{actionId:x.fromPetName("Moth"),tooltip:"Moth",value:xs.Moth},{actionId:x.fromPetName("Nether Ray"),tooltip:"Nether Ray",value:xs.NetherRay},{actionId:x.fromPetName("Raptor"),tooltip:"Raptor",value:xs.Raptor},{actionId:x.fromPetName("Ravager"),tooltip:"Ravager",value:xs.Ravager},{actionId:x.fromPetName("Rhino"),tooltip:"Rhino",value:xs.Rhino},{actionId:x.fromPetName("Scorpid"),tooltip:"Scorpid",value:xs.Scorpid},{actionId:x.fromPetName("Serpent"),tooltip:"Serpent",value:xs.Serpent},{actionId:x.fromPetName("Silithid"),tooltip:"Silithid (Exotic)",value:xs.Silithid},{actionId:x.fromPetName("Spider"),tooltip:"Spider",value:xs.Spider},{actionId:x.fromPetName("Spirit Beast"),tooltip:"Spirit Beast (Exotic)",value:xs.SpiritBeast},{actionId:x.fromPetName("Spore Bat"),tooltip:"Spore Bat",value:xs.SporeBat},{actionId:x.fromPetName("Tallstrider"),tooltip:"Tallstrider",value:xs.Tallstrider},{actionId:x.fromPetName("Turtle"),tooltip:"Turtle",value:xs.Turtle},{actionId:x.fromPetName("Warp Stalker"),tooltip:"Warp Stalker",value:xs.WarpStalker},{actionId:x.fromPetName("Wasp"),tooltip:"Wasp",value:xs.Wasp},{actionId:x.fromPetName("Wind Serpent"),tooltip:"Wind Serpent",value:xs.WindSerpent},{actionId:x.fromPetName("Wolf"),tooltip:"Wolf",value:xs.Wolf},{actionId:x.fromPetName("Worm"),tooltip:"Worm (Exotic)",value:xs.Worm}]})}const Eu={[xs.PetNone]:1,[xs.Bat]:0,[xs.Bear]:2,[xs.BirdOfPrey]:0,[xs.Boar]:2,[xs.CarrionBird]:1,[xs.Cat]:1,[xs.Chimaera]:0,[xs.CoreHound]:1,[xs.Crab]:2,[xs.Crocolisk]:2,[xs.Devilsaur]:1,[xs.Dragonhawk]:0,[xs.Gorilla]:2,[xs.Hyena]:1,[xs.Moth]:1,[xs.NetherRay]:0,[xs.Raptor]:1,[xs.Ravager]:0,[xs.Rhino]:2,[xs.Scorpid]:2,[xs.Serpent]:0,[xs.Silithid]:0,[xs.Spider]:0,[xs.SpiritBeast]:1,[xs.SporeBat]:0,[xs.Tallstrider]:1,[xs.Turtle]:2,[xs.WarpStalker]:2,[xs.Wasp]:1,[xs.WindSerpent]:0,[xs.Wolf]:1,[xs.Worm]:2},Pu=[0,1,2],ku=["cunning","ferocity","tenacity"];class Cu extends m{constructor(e,i,a){super(e,"hunter-pet-talents-picker"),t(this,"simUI"),t(this,"player"),t(this,"curCategory"),t(this,"curTalents"),t(this,"savedSets"),this.simUI=i,this.player=a,this.rootElem.innerHTML='\n\t\t\t<div class="pet-talents-container"></div>\n\t\t',this.curCategory=this.getCategoryFromPlayer(),this.curTalents=this.getPetTalentsFromPlayer(),this.savedSets=Ru.slice(),this.savedSets[this.curCategory]=this.curTalents,this.rootElem.classList.add(ku[this.curCategory]);const s=this.rootElem.getElementsByClassName("pet-talents-container")[0],o=Pu.map(((e,t)=>{const i=Du[t],o=document.createElement("div");o.classList.add("hunter-pet-talents-"+ku[t]),s.appendChild(o);const n=new mo(o,a,{klass:a.getClass(),trees:i,changedEvent:e=>l.onAny([e.specOptionsChangeEmitter,e.levelChangeEmitter]),getValue:e=>Wo(this.getPetTalentsFromPlayer(),i),setValue:(e,a,s)=>{const o=a.getSpecOptions();o.petTalents=Mo(ys.create(),s,i),a.setSpecOptions(e,o),this.savedSets[t]=o.petTalents,this.curTalents=o.petTalents},pointsPerRow:3,maxPoints:a.getMaxPetTalentPoints()}),r=new yc(o,this.player,{presetsOnly:!0,label:"Pet Talents",storageKey:"__NEVER_USED__",getData:e=>Wo(this.getPetTalentsFromPlayer(),i),setData:(e,a,s)=>{const o=a.getSpecOptions();o.petTalents=Mo(ys.create(),s,i),a.setSpecOptions(e,o),this.savedSets[t]=o.petTalents,this.curTalents=o.petTalents},changeEmitters:[this.player.specOptionsChangeEmitter],equals:(e,t)=>e==t,toJson:e=>e,fromJson:e=>""});return r.addSavedData({name:"Default",isPreset:!0,data:Wo(Ru[t],i)}),r.addSavedData({name:"Beast Mastery",isPreset:!0,data:Wo(Au[t],i)}),n}));a.specOptionsChangeEmitter.on((()=>{const e=this.getCategoryFromPlayer(),t=Pu.indexOf(e);if(e!=this.curCategory){this.curCategory=e,this.rootElem.classList.remove(...ku),this.rootElem.classList.add(ku[t]);const i=this.getPetTalentsFromPlayer();if(ys.equals(i,this.curTalents)){const e=this.player.getSpecOptions();e.petTalents=this.savedSets[this.curCategory],this.player.setSpecOptions(l.nextEventID(),e),this.curTalents=e.petTalents}else this.curTalents=i,this.savedSets[this.curCategory]=this.curTalents}}));const n=()=>{o.forEach((e=>e.setMaxPoints(a.getMaxPetTalentPoints())))};l.onAny([a.talentsChangeEmitter,a.levelChangeEmitter]).on(n),n()}getPetTalentsFromPlayer(){return this.player.getSpecOptions().petTalents||ys.create()}getCategoryFromPlayer(){const e=this.player.getSpecOptions().petType;return Eu[e]}}function _u(e){const t=Eu[e],i=Pu.indexOf(t);return Du[i]}const Nu=ys.create({cobraReflexes:2,dive:!0,boarsSpeed:!0,mobility:2,spikedCollar:3,cornered:2,feedingFrenzy:2,wolverineBite:!0,bullheaded:!0,wildHunt:1}),Tu=ys.create({cobraReflexes:2,dive:!0,spikedCollar:3,boarsSpeed:!0,cullingTheHerd:3,spidersBite:3,rabid:!0,callOfTheWild:!0,wildHunt:1}),Ru=[Nu,Tu,ys.create({cobraReflexes:2,charge:!0,greatStamina:3,bloodOfTheRhino:2,guardDog:2,thunderstomp:!0,graceOfTheMantis:2,taunt:!0,roarOfSacrifice:!0,wildHunt:1})],Lu=ys.create({cobraReflexes:2,dive:!0,boarsSpeed:!0,mobility:2,spikedCollar:3,cornered:2,feedingFrenzy:2,wolverineBite:!0,bullheaded:!0,graceOfTheMantis:2,wildHunt:2,roarOfSacrifice:!0}),Gu=ys.create({cobraReflexes:2,dive:!0,bloodthirsty:1,spikedCollar:3,boarsSpeed:!0,cullingTheHerd:3,spidersBite:3,rabid:!0,callOfTheWild:!0,sharkAttack:2,wildHunt:2}),Au=[Lu,Gu,ys.create({cobraReflexes:2,charge:!0,greatStamina:3,spikedCollar:3,bloodOfTheRhino:2,guardDog:2,thunderstomp:!0,graceOfTheMantis:2,taunt:!0,roarOfSacrifice:!0,wildHunt:2})],Du=[go([{name:"Cunning",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/411.jpg",talents:[{fieldName:"cobraReflexes",location:{rowIdx:0,colIdx:0},spellIds:[61682],maxPoints:2},{fieldName:"dive",location:{rowIdx:0,colIdx:1},spellIds:[23145],maxPoints:1},{fieldName:"greatStamina",location:{rowIdx:0,colIdx:2},spellIds:[61686],maxPoints:3},{fieldName:"naturalArmor",location:{rowIdx:0,colIdx:3},spellIds:[61689],maxPoints:2},{fieldName:"boarsSpeed",location:{rowIdx:1,colIdx:0},spellIds:[19596],maxPoints:1},{fieldName:"mobility",location:{rowIdx:1,colIdx:1},prereqLocation:{rowIdx:0,colIdx:1},spellIds:[53554],maxPoints:2},{fieldName:"owlsFocus",location:{rowIdx:1,colIdx:2},spellIds:[53514,53516],maxPoints:2},{fieldName:"spikedCollar",location:{rowIdx:1,colIdx:3},spellIds:[53182],maxPoints:3},{fieldName:"cullingTheHerd",location:{rowIdx:2,colIdx:0},spellIds:[61680,61681,52858],maxPoints:3},{fieldName:"lionhearted",location:{rowIdx:2,colIdx:1},spellIds:[53409,53411],maxPoints:2},{fieldName:"carrionFeeder",location:{rowIdx:2,colIdx:2},spellIds:[54044],maxPoints:1},{fieldName:"greatResistance",location:{rowIdx:3,colIdx:1},spellIds:[53427,53429],maxPoints:3},{fieldName:"cornered",location:{rowIdx:3,colIdx:2},spellIds:[52234,53497],maxPoints:2},{fieldName:"feedingFrenzy",location:{rowIdx:3,colIdx:3},prereqLocation:{rowIdx:1,colIdx:3},spellIds:[53511],maxPoints:2},{fieldName:"wolverineBite",location:{rowIdx:4,colIdx:0},spellIds:[53508],maxPoints:1},{fieldName:"roarOfRecovery",location:{rowIdx:4,colIdx:1},spellIds:[53517],maxPoints:1},{fieldName:"bullheaded",location:{rowIdx:4,colIdx:2},prereqLocation:{rowIdx:3,colIdx:2},spellIds:[53490],maxPoints:1},{fieldName:"graceOfTheMantis",location:{rowIdx:4,colIdx:3},spellIds:[53450],maxPoints:2},{fieldName:"wildHunt",location:{rowIdx:5,colIdx:0},prereqLocation:{rowIdx:4,colIdx:0},spellIds:[62758,62762],maxPoints:2},{fieldName:"roarOfSacrifice",location:{rowIdx:5,colIdx:3},prereqLocation:{rowIdx:4,colIdx:3},spellIds:[53480],maxPoints:1}]}]),go([{name:"Ferocity",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/410.jpg",talents:[{fieldName:"cobraReflexes",location:{rowIdx:0,colIdx:0},spellIds:[61682],maxPoints:2},{fieldName:"dive",location:{rowIdx:0,colIdx:1},spellIds:[23145],maxPoints:1},{fieldName:"greatStamina",location:{rowIdx:0,colIdx:2},spellIds:[61686],maxPoints:3},{fieldName:"naturalArmor",location:{rowIdx:0,colIdx:3},spellIds:[61689],maxPoints:2},{fieldName:"improvedCower",location:{rowIdx:1,colIdx:0},spellIds:[53180],maxPoints:2},{fieldName:"bloodthirsty",location:{rowIdx:1,colIdx:1},spellIds:[53186],maxPoints:2},{fieldName:"spikedCollar",location:{rowIdx:1,colIdx:2},spellIds:[53182],maxPoints:3},{fieldName:"boarsSpeed",location:{rowIdx:1,colIdx:3},spellIds:[19596],maxPoints:1},{fieldName:"cullingTheHerd",location:{rowIdx:2,colIdx:0},spellIds:[61680,61681,52858],maxPoints:3},{fieldName:"lionhearted",location:{rowIdx:2,colIdx:2},spellIds:[53409,53411],maxPoints:2},{fieldName:"charge",location:{rowIdx:2,colIdx:3},spellIds:[61685],maxPoints:1},{fieldName:"heartOfThePheonix",location:{rowIdx:3,colIdx:1},prereqLocation:{rowIdx:1,colIdx:1},spellIds:[55709],maxPoints:1},{fieldName:"spidersBite",location:{rowIdx:3,colIdx:2},spellIds:[53203],maxPoints:3},{fieldName:"greatResistance",location:{rowIdx:3,colIdx:3},spellIds:[53427,53429],maxPoints:3},{fieldName:"rabid",location:{rowIdx:4,colIdx:0},spellIds:[53401],maxPoints:1},{fieldName:"lickYourWounds",location:{rowIdx:4,colIdx:1},prereqLocation:{rowIdx:3,colIdx:1},spellIds:[53426],maxPoints:1},{fieldName:"callOfTheWild",location:{rowIdx:4,colIdx:2},prereqLocation:{rowIdx:3,colIdx:2},spellIds:[53434],maxPoints:1},{fieldName:"sharkAttack",location:{rowIdx:5,colIdx:0},spellIds:[62759],maxPoints:2},{fieldName:"wildHunt",location:{rowIdx:5,colIdx:2},prereqLocation:{rowIdx:4,colIdx:2},spellIds:[62758,62762],maxPoints:2}]}]),go([{name:"Tenacity",backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/wrath/409.jpg",talents:[{fieldName:"cobraReflexes",location:{rowIdx:0,colIdx:0},spellIds:[61682],maxPoints:2},{fieldName:"charge",location:{rowIdx:0,colIdx:1},spellIds:[61685],maxPoints:1},{fieldName:"greatStamina",location:{rowIdx:0,colIdx:2},spellIds:[61686],maxPoints:3},{fieldName:"naturalArmor",location:{rowIdx:0,colIdx:3},spellIds:[61689],maxPoints:2},{fieldName:"spikedCollar",location:{rowIdx:1,colIdx:0},spellIds:[53182],maxPoints:3},{fieldName:"boarsSpeed",location:{rowIdx:1,colIdx:1},spellIds:[19596],maxPoints:1},{fieldName:"bloodOfTheRhino",location:{rowIdx:1,colIdx:2},prereqLocation:{rowIdx:0,colIdx:2},spellIds:[53481],maxPoints:2},{fieldName:"petBarding",location:{rowIdx:1,colIdx:3},prereqLocation:{rowIdx:0,colIdx:3},spellIds:[53175],maxPoints:2},{fieldName:"cullingTheHerd",location:{rowIdx:2,colIdx:0},spellIds:[61680,61681,52858],maxPoints:3},{fieldName:"guardDog",location:{rowIdx:2,colIdx:1},spellIds:[53178],maxPoints:2},{fieldName:"lionhearted",location:{rowIdx:2,colIdx:2},spellIds:[53409,53411],maxPoints:2},{fieldName:"thunderstomp",location:{rowIdx:2,colIdx:3},spellIds:[63900],maxPoints:1},{fieldName:"graceOfTheMantis",location:{rowIdx:3,colIdx:2},spellIds:[53450],maxPoints:2},{fieldName:"greatResistance",location:{rowIdx:3,colIdx:3},spellIds:[53427,53429],maxPoints:3},{fieldName:"lastStand",location:{rowIdx:4,colIdx:0},spellIds:[53478],maxPoints:1},{fieldName:"taunt",location:{rowIdx:4,colIdx:1},prereqLocation:{rowIdx:2,colIdx:1},spellIds:[53477],maxPoints:1},{fieldName:"roarOfSacrifice",location:{rowIdx:4,colIdx:2},prereqLocation:{rowIdx:3,colIdx:2},spellIds:[53480],maxPoints:1},{fieldName:"intervene",location:{rowIdx:4,colIdx:3},spellIds:[53476],maxPoints:1},{fieldName:"silverback",location:{rowIdx:5,colIdx:1},spellIds:[62764],maxPoints:2},{fieldName:"wildHunt",location:{rowIdx:5,colIdx:2},prereqLocation:{rowIdx:4,colIdx:2},spellIds:[62758,62762],maxPoints:2}]}])];class Uu extends uc{constructor(e,i){super(e,i,{identifier:"talents-tab",title:"Talents"}),t(this,"simUI"),t(this,"leftPanel"),t(this,"rightPanel"),this.simUI=i,this.leftPanel=document.createElement("div"),this.leftPanel.classList.add("talents-tab-left","tab-panel-left"),this.rightPanel=document.createElement("div"),this.rightPanel.classList.add("talents-tab-right","tab-panel-right","within-raid-sim-hide"),this.contentContainer.appendChild(this.leftPanel),this.contentContainer.appendChild(this.rightPanel),this.buildTabContent()}buildTabContent(){this.simUI.player.getClass()==d.ClassHunter?this.buildHunterPickers():(this.buildTalentsPicker(this.leftPanel),this.buildGlyphsPicker(this.leftPanel)),this.buildSavedTalentsPicker()}buildTalentsPicker(e){new mo(e,this.simUI.player,{klass:this.simUI.player.getClass(),trees:Uo[this.simUI.player.getClass()],changedEvent:e=>l.onAny([e.talentsChangeEmitter,e.levelChangeEmitter]),getValue:e=>e.getTalentsString(),setValue:(e,t,i)=>{t.setTalentsString(e,i)},pointsPerRow:5,maxPoints:this.simUI.player.getMaxTalentPoints()})}buildGlyphsPicker(e){new yu(e,this.simUI.player,Oo[this.simUI.player.getClass()])}buildHunterPickers(){this.leftPanel.innerHTML='\n      <div class="hunter-talents-pickers-container tab-content">\n        <ul class="nav nav-tabs" role="tablist">\n          <li class="nav-item" role="presentation">\n            <a\n              class="nav-link active"\n              type="button"\n              role="tab"\n              data-bs-toggle="tab"\n              data-bs-target="#player-talents-tab"\n              aria-controls="#player-talents-tab"\n              aria-selected="true"\n            >\n              Player\n            </a>\n          </li>\n          <li class="nav-item" role="presentation">\n            <a\n              class="nav-link"\n              type="button"\n              role="tab"\n              data-bs-toggle="tab"\n              data-bs-target="#pet-talents-tab"\n              aria-controls="#pet-talents-tab"\n              aria-selected="false"\n            >\n              Pet</a\n            >\n          </li>\n        </ul>\n        <div id="player-talents-tab" class="tab-pane fade active show" role="tabpanel">\n        </div>\n        <div id="pet-talents-tab" class="tab-pane fade" role="tabpanel">\n        </div>\n      </div>\n    ';const e=this.leftPanel.querySelector("#player-talents-tab"),t=this.leftPanel.querySelector("#pet-talents-tab");this.buildTalentsPicker(e),this.buildGlyphsPicker(e),this.buildHunterPetPicker(t)}buildHunterPetPicker(e){new Cu(e,this.simUI,this.simUI.player),new Pc(e,this.simUI.player,Su(),this.simUI)}buildSavedTalentsPicker(){const e=new yc(this.rightPanel,this.simUI.player,{label:"Talents",header:{title:"Saved Talents"},storageKey:this.simUI.getSavedTalentsStorageKey(),getData:e=>ei.create({talentsString:e.getTalentsString(),glyphs:e.getGlyphs()}),setData:(e,t,i)=>{l.freezeAllAndDo((()=>{t.setTalentsString(e,i.talentsString),t.setGlyphs(e,i.glyphs||K.create())}))},changeEmitters:[this.simUI.player.talentsChangeEmitter,this.simUI.player.glyphsChangeEmitter],equals:(e,t)=>ei.equals(e,t),toJson:e=>ei.toJson(e),fromJson:e=>ei.fromJson(e)});this.simUI.sim.waitForInit().then((()=>{e.loadUserData(),this.simUI.individualConfig.presets.talents.forEach((t=>{t.isPreset=!0,e.addSavedData({name:t.name,isPreset:!0,data:t.data})}))}))}}const Ou=class extends dd{constructor(e,a,s,o){super(e.rootElem,"ep-weights-menu",function(e){const t={footer:!0,scrollContents:!0};return e.sim.getShowThreatMetrics()&&e.sim.getShowExperimental()?{size:"xl",...t}:t}(e)),t(this,"simUI"),t(this,"container"),t(this,"table"),t(this,"tableBody"),t(this,"resultsViewer"),t(this,"statsType"),t(this,"epStats"),t(this,"epPseudoStats"),t(this,"epReferenceStat"),t(this,"showAllStats",!1),this.simUI=e,this.statsType="ep",this.epStats=a,this.epPseudoStats=s,this.epReferenceStat=o,this.header?.insertAdjacentHTML("afterbegin",'<h5 class="modal-title">Calculate Stat Weights</h5>'),this.body.innerHTML='\n\t\t\t<div class="ep-weights-options row">\n\t\t\t\t<div class="col col-sm-3">\n\t\t\t\t\t<select class="ep-type-select form-select">\n\t\t\t\t\t\t<option value="ep">EP</option>\n\t\t\t\t\t\t<option value="weight">Weights</option>\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t<div class="show-all-stats-container col col-sm-3"></div>\n\t\t\t</div>\n\t\t\t<div class="ep-reference-options row experimental">\n\t\t\t\t<div class="col col-sm-4 damage-metrics">\n\t\t\t\t\t<span>DPS/TPS reference:</span>\n\t\t\t\t\t<select class="ref-stat-select form-select damage-metrics">\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t<div class="col col-sm-4 healing-metrics">\n\t\t\t\t\t<span>Healing reference:</span>\n\t\t\t\t\t<select class="ref-stat-select form-select healing-metrics">\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t<div class="col col-sm-4 threat-metrics">\n\t\t\t\t\t<span>Mitigation reference:</span>\n\t\t\t\t\t<select class="ref-stat-select form-select threat-metrics">\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t<p>The above stat selectors control which reference stat is used for EP normalisation for the different EP columns.</p>\n\t\t\t</div>\n\t\t\t<p>The \'Current EP\' column displays the values currently used by the item pickers to sort items.</br>\n\t\t\tUse the <a href=\'javascript:void(0)\' class="fa fa-copy"></a> icon above the EPs to use newly calculated EPs.</p>\n\t\t\t<div class="results-ep-table-container modal-scroll-table">\n\t\t\t\t<div class="results-pending-overlay"></div>\n\t\t\t\t<table class="results-ep-table">\n\t\t\t\t\t<thead>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th>Stat</th>\n\t\t\t\t\t\t\t<th class="damage-metrics type-weight">\n\t\t\t\t\t\t\t\t<span>DPS Weight</span>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" role="button" class="col-action">\n\t\t\t\t\t\t\t\t\t<i class="fa fa-copy"></i>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t<th class="damage-metrics type-ep">\n\t\t\t\t\t\t\t\t<span>DPS EP</span>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" role="button" class="col-action">\n\t\t\t\t\t\t\t\t\t<i class="fa fa-copy"></i>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t<th class="healing-metrics type-weight">\n\t\t\t\t\t\t\t\t<span>HPS Weight</span>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" role="button" class="col-action">\n\t\t\t\t\t\t\t\t\t<i class="fa fa-copy"></i>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t<th class="healing-metrics type-ep">\n\t\t\t\t\t\t\t\t<span>HPS EP</span>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" role="button" class="col-action">\n\t\t\t\t\t\t\t\t\t<i class="fa fa-copy"></i>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t<th class="threat-metrics type-weight">\n\t\t\t\t\t\t\t\t<span>TPS Weight</span>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" role="button" class="col-action">\n\t\t\t\t\t\t\t\t\t<i class="fa fa-copy"></i>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t<th class="threat-metrics type-ep">\n\t\t\t\t\t\t\t\t<span>TPS EP</span>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" role="button" class="col-action">\n\t\t\t\t\t\t\t\t\t<i class="fa fa-copy"></i>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t<th class="threat-metrics type-weight">\n\t\t\t\t\t\t\t\t<span>DTPS Weight</span>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" role="button" class="col-action">\n\t\t\t\t\t\t\t\t\t<i class="fa fa-copy"></i>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t<th class="threat-metrics type-ep">\n\t\t\t\t\t\t\t\t<span>DTPS EP</span>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" role="button" class="col-action">\n\t\t\t\t\t\t\t\t\t<i class="fa fa-copy"></i>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t<th class="threat-metrics type-weight experimental">\n\t\t\t\t\t\t\t\t<span>TMI Weight</span>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" role="button" class="col-action">\n\t\t\t\t\t\t\t\t\t<i class="fa fa-copy"></i>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t<th class="threat-metrics type-ep experimental">\n\t\t\t\t\t\t\t\t<span>TMI EP</span>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" role="button" class="col-action">\n\t\t\t\t\t\t\t\t\t<i class="fa fa-copy"></i>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t<th class="threat-metrics type-weight experimental">\n\t\t\t\t\t\t\t\t<span>Death Weight</span>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" role="button" class="col-action">\n\t\t\t\t\t\t\t\t\t<i class="fa fa-copy"></i>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t<th class="threat-metrics type-ep experimental">\n\t\t\t\t\t\t\t\t<span>Death EP</span>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" role="button" class="col-action">\n\t\t\t\t\t\t\t\t\t<i class="fa fa-copy"></i>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t<th style="text-align: center">\n\t\t\t\t\t\t\t\t<span>Current EP</span>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" role="button" class="col-action">\n\t\t\t\t\t\t\t\t\t<i class="fas fa-arrows-rotate"></i>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr class="ep-ratios">\n\t\t\t\t\t\t\t<td>EP Ratio</td>\n\t\t\t\t\t\t\t<td class="damage-metrics type-ratio type-weight">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class="damage-metrics type-ratio type-ep">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class="healing-metrics type-ratio type-weight">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class="healing-metrics type-ratio type-ep">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class="threat-metrics type-ratio type-weight">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class="threat-metrics type-ratio type-ep">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class="threat-metrics type-ratio type-weight">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class="threat-metrics type-ratio type-ep">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class="threat-metrics type-ratio type-weight experimental">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class="threat-metrics type-ratio type-ep experimental">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class="threat-metrics type-ratio type-weight experimental">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class="threat-metrics type-ratio type-ep experimental">\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td style="text-align: center; vertical-align: middle;">\n\t\t\t\t\t\t\t\t<button class="btn btn-primary compute-ep">\n\t\t\t\t\t\t\t\t\t<i class="fas fa-calculator"></i>\n\t\t\t\t\t\t\t\t\t<span class="not-tiny">Update </span>EP\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody></tbody>\n\t\t\t\t</table>\n\t\t\t</div>\n\t\t',this.footer.innerHTML='\n\t\t\t<button class="btn btn-primary optimize-gems experimental me-2">\n\t\t\t\tOptimize Gems\n\t\t\t</button>\n\t\t\t<button class="btn btn-primary calc-weights">\n\t\t\t\t<i class="fas fa-calculator"></i>\n\t\t\t\tCalculate\n\t\t\t</button>\n\t\t',this.container=this.rootElem.querySelector(".results-ep-table-container"),this.table=this.rootElem.querySelector(".results-ep-table"),this.tableBody=this.rootElem.querySelector(".results-ep-table tbody");const n=this.rootElem.querySelector(".results-pending-overlay");this.resultsViewer=new pc(n);const r=()=>{"ep"==this.statsType?(this.table.classList.remove("stats-type-weight"),this.table.classList.add("stats-type-ep")):(this.table.classList.add("stats-type-weight"),this.table.classList.remove("stats-type-ep"))},d=this.rootElem.getElementsByClassName("ep-type-select")[0];d.addEventListener("input",(e=>{this.statsType=d.value,r()})),d.value=this.statsType,r();const c=e=>void 0!==e?rt(e,this.simUI.player.getClass()):"??",m=e=>{for(const t of this.epStats)if(c(t)==e)return t},h=()=>{this.simUI.player.epRefStatChangeEmitter.emit(l.nextEventID()),this.simUI.prevEpSimResult=this.calculateEp(this.getPrevSimResult()),this.updateTable()};this.rootElem.querySelectorAll(".ref-stat-select").forEach(((e,t)=>{this.epStats.forEach((t=>{e.options[e.options.length]=new Option(c(t))})),e.classList.contains("damage-metrics")?(e.addEventListener("input",(t=>{this.simUI.dpsRefStat=m(e.value),h()})),e.value=c(this.getDpsEpRefStat())):e.classList.contains("healing-metrics")?(e.addEventListener("input",(t=>{this.simUI.healRefStat=m(e.value),h()})),e.value=c(this.getHealEpRefStat())):e.classList.contains("threat-metrics")&&(e.addEventListener("input",(t=>{this.simUI.tankRefStat=m(e.value),h()})),e.value=c(this.getTankEpRefStat()))}));const p=this.rootElem.getElementsByClassName("optimize-gems")[0];i.getOrCreateInstance(p,{html:!0,title:"<p><span class='warning link-warning'><i class='fa fa-exclamation-triangle'></i> WARNING</span> This feature is experimental, and will not always produce the most optimal gems especially when interacting with soft/hard stat caps.</p>\n\t\t\t<p>Optimizes equipped gems to maximize EP, based on the values in <b>Current EP</b>.</p>\n\t\t\t<p class='mb-0'>Does not change the meta gem, but ensures that its condition is met. Uses JC gems if Jewelcrafting is a selected profession.</p>"}),p.addEventListener("click",(async e=>{const t=p.innerHTML;p.classList.add("disabled"),p.style.width=`${p.getBoundingClientRect().width.toFixed(3)}px`,p.innerHTML='<i class="fa fa-spinner fa-spin"></i>&nbsp;Running',await this.optimizeGems(l.nextEventID()),p.innerHTML=t,p.classList.remove("disabled")}));const u=this.rootElem.getElementsByClassName("calc-weights")[0];u.addEventListener("click",(async e=>{const t=u.innerHTML;u.classList.add("disabled"),u.style.width=`${u.getBoundingClientRect().width.toFixed(3)}px`,u.innerHTML='<i class="fa fa-spinner fa-spin"></i>&nbsp;Running',this.container.scrollTo({top:0}),this.container.classList.add("pending"),this.resultsViewer.setPending();const i=this.simUI.sim.getIterations(),a=await this.simUI.player.computeStatWeights(l.nextEventID(),this.epStats,this.epPseudoStats,this.epReferenceStat,(e=>{this.setSimProgress(e)}));this.container.classList.remove("pending"),this.resultsViewer.hideAll(),u.innerHTML=t,u.classList.remove("disabled"),this.simUI.prevEpIterations=i,this.simUI.prevEpSimResult=this.calculateEp(a),this.updateTable()}));const g=Array.from(this.rootElem.getElementsByClassName("col-action")),f=(e,t,a,s,o)=>{const n=e.previousElementSibling;new i(n,{toggle:"tooltip",html:!0,title:()=>{if(!o)return t;const e=c(o());return t+` Normalized by ${e}.`}}),i.getOrCreateInstance(e,{title:a,html:!0}),e.addEventListener("click",(e=>{this.simUI.player.setEpWeights(l.nextEventID(),H.fromProto(s())),this.updateTable()}))};f(g[0],"Per-point increase in DPS (Damage Per Second) for each stat.","Copy to Current EP",(()=>this.getPrevSimResult().dps.weights)),f(g[1],"EP (Equivalency Points) for DPS (Damage Per Second) for each stat.","Copy to Current EP",(()=>this.getPrevSimResult().dps.epValues),(()=>this.getDpsEpRefStat())),f(g[2],"Per-point increase in HPS (Healing Per Second) for each stat.","Copy to Current EP",(()=>this.getPrevSimResult().hps.weights)),f(g[3],"EP (Equivalency Points) for HPS (Healing Per Second) for each stat.","Copy to Current EP",(()=>this.getPrevSimResult().hps.epValues),(()=>this.getHealEpRefStat())),f(g[4],"Per-point increase in TPS (Threat Per Second) for each stat.","Copy to Current EP",(()=>this.getPrevSimResult().tps.weights)),f(g[5],"EP (Equivalency Points) for TPS (Threat Per Second) for each stat.","Copy to Current EP",(()=>this.getPrevSimResult().tps.epValues),(()=>this.getDpsEpRefStat())),f(g[6],"Per-point increase in DTPS (Damage Taken Per Second) for each stat.","Copy to Current EP",(()=>this.getPrevSimResult().dtps.weights)),f(g[7],"EP (Equivalency Points) for DTPS (Damage Taken Per Second) for each stat.","Copy to Current EP",(()=>this.getPrevSimResult().dtps.epValues),(()=>this.getTankEpRefStat())),f(g[8],"Per-point decrease in TMI (Theck-Meloree Index) for each stat.","Copy to Current EP",(()=>this.getPrevSimResult().tmi.weights)),f(g[9],"EP (Equivalency Points) for TMI (Theck-Meloree Index) for each stat.","Copy to Current EP",(()=>this.getPrevSimResult().tmi.epValues),(()=>this.getTankEpRefStat())),f(g[10],"Per-point decrease in p(death) for each stat.","Copy to Current EP",(()=>this.getPrevSimResult().pDeath.weights)),f(g[11],"EP (Equivalency Points) for p(death) for each stat.","Copy to Current EP",(()=>this.getPrevSimResult().pDeath.epValues),(()=>this.getTankEpRefStat())),f(g[12],"Current EP Weights. Used to sort the gear selector menus.","Restore Default EP",(()=>this.simUI.individualConfig.defaults.epWeights.toProto()));const w=this.rootElem.getElementsByClassName("show-all-stats-container")[0];new xt(w,this,{label:"Show All Stats",inline:!0,changedEvent:()=>new l,getValue:()=>this.showAllStats,setValue:(e,t,i)=>{this.showAllStats=i,this.updateTable()}}),this.updateTable();const I=(e,t)=>{new il(e,this.simUI.player,{float:!0,changedEvent:e=>e.epRatiosChangeEmitter,getValue:e=>this.simUI.player.getEpRatios()[t],setValue:(e,i,a)=>{const s=i.getEpRatios();s[t]=a,i.setEpRatios(e,s)}})};this.body.querySelectorAll(".type-ratio.type-ep").forEach(I),this.simUI.player.epRatiosChangeEmitter.on((e=>this.updateTable()));this.body.querySelectorAll(".type-ratio.type-weight").forEach(I);const x=this.rootElem.getElementsByClassName("compute-ep")[0];i.getOrCreateInstance(x,{title:"Compute Weighted EP"}),x.addEventListener("click",(e=>{const t=this.getPrevSimResult(),i=this.simUI.player.getEpRatios();if("ep"==this.statsType){const e=H.fromProto(t.dps.epValues).scale(i[0]),a=H.fromProto(t.hps.epValues).scale(i[1]),s=H.fromProto(t.tps.epValues).scale(i[2]),o=H.fromProto(t.dtps.epValues).scale(i[3]),n=H.fromProto(t.tmi.epValues).scale(i[4]),r=H.fromProto(t.pDeath.epValues).scale(i[5]),d=e.add(a).add(s).add(o).add(n).add(r);this.simUI.player.setEpWeights(l.nextEventID(),d)}else{const e=H.fromProto(t.dps.weights).scale(i[0]),a=H.fromProto(t.hps.weights).scale(i[1]),s=H.fromProto(t.tps.weights).scale(i[2]),o=H.fromProto(t.dtps.weights).scale(i[3]),n=H.fromProto(t.tmi.weights).scale(i[4]),r=H.fromProto(t.pDeath.weights).scale(i[5]),d=e.add(a).add(s).add(o).add(n).add(r);this.simUI.player.setEpWeights(l.nextEventID(),d)}this.updateTable()}))}setSimProgress(e){this.resultsViewer.setContent(`\n\t\t\t<div class="results-sim">\n\t\t\t\t<div class=""> ${e.completedSims} / ${e.totalSims}<br>simulations complete</div>\n\t\t\t\t<div class="">\n\t\t\t\t\t${e.completedIterations} / ${e.totalIterations}<br>iterations complete\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`)}updateTable(){this.tableBody.innerHTML="",Ou.epUnitStats.forEach((e=>{if(!this.showAllStats&&e.isStat()&&!this.epStats.includes(e.getStat())||e.isPseudoStat()&&!this.epPseudoStats.includes(e.getPseudoStat()))return;const t=this.makeTableRow(e);this.tableBody.appendChild(t)}))}makeTableRow(e){const t=document.createElement("tr"),i=this.simUI.prevEpSimResult,a=this.simUI.player.getEpRatios(),s=function(e,t,i){return i?t[0]*e.getProtoValue(i.dps?.epValues)+t[1]*e.getProtoValue(i.hps?.epValues)+t[2]*e.getProtoValue(i.tps?.epValues)+t[3]*e.getProtoValue(i.dtps?.epValues)+t[4]*e.getProtoValue(i.tmi?.epValues)+t[5]*e.getProtoValue(i.pDeath?.epValues):0}(e,a,i);t.innerHTML=`\n\t\t\t<td>${e.getName(this.simUI.player.getClass())}</td>\n\t\t\t${this.makeTableRowCells(e,i?.dps,"damage-metrics",s,a[0])}\n\t\t\t${this.makeTableRowCells(e,i?.hps,"healing-metrics",s,a[1])}\n\t\t\t${this.makeTableRowCells(e,i?.tps,"threat-metrics",s,a[2])}\n\t\t\t${this.makeTableRowCells(e,i?.dtps,"threat-metrics",s,a[3])}\n\t\t\t${this.makeTableRowCells(e,i?.tmi,"threat-metrics experimental",s,a[4])}\n\t\t\t${this.makeTableRowCells(e,i?.pDeath,"threat-metrics experimental",s,a[5])}\n\t\t\t<td class="current-ep"></td>\n\t\t`;const o=t.querySelector(".current-ep");return new il(o,this.simUI.player,{float:!0,changedEvent:e=>e.epWeightsChangeEmitter,getValue:t=>this.simUI.player.getEpWeights().getUnitStat(e),setValue:(t,i,a)=>{const s=i.getEpWeights().withUnitStat(e,a);i.setEpWeights(t,s)}}),t}makeTableRowCells(e,t,i,a,s){let o,l;if(t){const i=e.getProtoValue(t.weights),a=e.getProtoValue(t.weightsStdev);o=this.makeTableCellContents(i,a);const s=e.getProtoValue(t.epValues),n=e.getProtoValue(t.epValuesStdev);l=this.makeTableCellContents(s,n)}else o='<span class="results-avg notapplicable">N/A</span>',l=o;const n=document.createElement("template");if(n.innerHTML=`\n\t\t\t<td class="stdev-cell ${i} type-weight">\n\t\t\t\t${o}\n\t\t\t</td>\n\t\t\t<td class="stdev-cell ${i} type-ep">\n\t\t\t\t${l}\n\t\t\t</td>\n\t\t`,!t)return n.innerHTML;if(0==s){return n.content.querySelectorAll(".stdev-cell").forEach((e=>e.classList.add("unused-ep"))),n.innerHTML}const r=a-this.simUI.player.getEpWeights().getUnitStat(e),d=n.content.querySelector(".type-ep .results-avg");return"0.00"==r.toFixed(2)||(r>0?d.classList.add("positive"):r<0&&d.classList.add("negative")),n.innerHTML}makeTableCellContents(e,t){const i=this.simUI.prevEpIterations||1;return`\n\t\t\t<span class="results-avg">${e.toFixed(2)}</span>\n\t\t\t<span class="results-stdev">\n\t\t\t\t(<i class="fas fa-plus-minus fa-xs"></i>${bs(t,i).toFixed(2)})\n\t\t\t</span>\n\t\t`}calculateEp(e){const t=Be.clone(e),i=(e,t)=>{const i=bt.fromStat(e),a=i.getProtoValue(t.weights),s=i.getProtoValue(t.weightsStdev);Ou.epUnitStats.forEach((e=>{const i=e.getProtoValue(t.weights);e.setProtoValue(t.epValues,0==a?0:i/a);const o=e.getProtoValue(t.weightsStdev);e.setProtoValue(t.epValuesStdev,0==s?0:o/s)}))};return void 0!==this.simUI.dpsRefStat&&(i(this.simUI.dpsRefStat,t.dps),i(this.simUI.dpsRefStat,t.tps)),void 0!==this.simUI.healRefStat&&i(this.simUI.healRefStat,t.hps),void 0!==this.simUI.tankRefStat&&(i(this.simUI.tankRefStat,t.dtps),i(this.simUI.tankRefStat,t.tmi),i(this.simUI.tankRefStat,t.pDeath)),t}getDpsEpRefStat(){return void 0!==this.simUI.dpsRefStat?this.simUI.dpsRefStat:this.epReferenceStat}getHealEpRefStat(){return void 0!==this.simUI.healRefStat?this.simUI.healRefStat:this.epReferenceStat}getTankEpRefStat(){return void 0!==this.simUI.tankRefStat?this.simUI.tankRefStat:le.StatArmor}getPrevSimResult(){return this.simUI.prevEpSimResult||Be.create({dps:{weights:(new H).toProto(),weightsStdev:(new H).toProto(),epValues:(new H).toProto(),epValuesStdev:(new H).toProto()},hps:{weights:(new H).toProto(),weightsStdev:(new H).toProto(),epValues:(new H).toProto(),epValuesStdev:(new H).toProto()},tps:{weights:(new H).toProto(),weightsStdev:(new H).toProto(),epValues:(new H).toProto(),epValuesStdev:(new H).toProto()},dtps:{weights:(new H).toProto(),weightsStdev:(new H).toProto(),epValues:(new H).toProto(),epValuesStdev:(new H).toProto()},tmi:{weights:(new H).toProto(),weightsStdev:(new H).toProto(),epValues:(new H).toProto(),epValuesStdev:(new H).toProto()},pDeath:{weights:(new H).toProto(),weightsStdev:(new H).toProto(),epValues:(new H).toProto(),epValuesStdev:(new H).toProto()}})}async optimizeGems(e){let t=this.simUI.player.getEpWeights();t=new H(t.asArray().map((e=>0==e?1e-8:e)));const i=this.simUI.player.getGear(),a=this.simUI.sim.db.getGems(),s=this.simUI.sim.getExpansion(),o=this.simUI.player.isBlacksmithing(),l=this.simUI.player.hasProfession(ae.Jewelcrafting),n=this.simUI.player.canUseExtraSockets(),r=Ou.optimizeGemsForWeights(t,i,a,s,o,l,n);this.simUI.player.setGear(e,r)}static optimizeGemsForWeights(e,t,i,a,s,o,l){const n=i.filter((e=>fe(e,a))),{bestGemForColor:r,bestGemForColorEP:d,bestGemForSocket:c,bestGemForSocketEP:m,bestGem:h,bestGemEP:p}=Ou.findBestGems(n,e),u=t.asMap(),f=Object.values(u).map((t=>null!=t?new H(t.item.socketBonus).computeEP(e):0));Object.entries(u).forEach((([e,t],i)=>{if(null==t)return;const a=t.curSocketColors(s,l);g(a.map((e=>e==Ot.GemColorMeta?0:p)))>f[i]+g(a.map((e=>e==Ot.GemColorMeta?0:m[e])))?a.forEach(((e,i)=>{e!=Ot.GemColorMeta&&(t=t.withGem(h,i))})):a.forEach(((e,i)=>{e!=Ot.GemColorMeta&&(t=t.withGem(c[e],i))})),u[Number(e)]=t})),t=new B(u);const w=Object.keys(u).map((e=>{const t=parseInt(e),i=u[t];if(!i)return[];const a=i.numSockets(s,l);return[...Array(a).keys()].filter((e=>i.item.gemSockets[e]!=Ot.GemColorMeta)).map((e=>({itemSlot:t,socketIdx:e})))})).flat(),I=vs(w,3),x=t=>t.statsFromGems(s,l).computeEP(e);return t=(t=>{if(!o)return t;const a=i.filter((e=>e.requiredProfession==ae.Jewelcrafting)),{bestGemForColor:n,bestGemForColorEP:r,bestGemForSocket:d,bestGemForSocketEP:c,bestGem:m,bestGemEP:h}=Ou.findBestGems(a,e);let p=t,u=x(t);return I.forEach((e=>{const i=t.asMap();for(let t=0;t<e.length;t++){const{itemSlot:a,socketIdx:s}=e[t],o=i[a],l=o.gems[s].color;i[a]=o.withGem(n[l],s)}const a=new B(i);if(a.hasActiveMetaGem(s,l)){const e=x(a);e>u&&(p=a,u=e)}})),p})(t=(e=>{const t=e.getMetaGem();if(!t)return e;const i=Ss(t.id);if(!i||i.isCompareColorCondition())return e;if(e.getAllGems(s,l).length-1<3)return e;const a=Ou.getColorCombosToSatisfyCondition(i);let o=e,n=x(e);return a.forEach((t=>{I.forEach((i=>{const a=e.asMap();for(let e=0;e<t.length;e++){const s=t[e],{itemSlot:o,socketIdx:l}=i[e];a[o]=a[o].withGem(r[s],l)}const d=new B(a);if(d.hasActiveMetaGem(s,l)){const e=x(d);e>n&&(o=d,n=e)}}))})),o})(t))}static getColorCombosToSatisfyCondition(e){if(e.isOneOfEach())return[Es,[Ot.GemColorPrismatic]].concat(Ps.map(((e,t)=>{const i=Es[t];return ks.get(i).map((t=>[t,e]))})).flat());if(e.isTwoAndOne()){const t=Es[[e.minRed,e.minYellow,e.minBlue].indexOf(1)],i=Es[[e.minRed,e.minYellow,e.minBlue].indexOf(2)],a=Ps.find((e=>Cs(e,t)&&Cs(e,i)));return[[Ot.GemColorPrismatic],[a],[t,i]].map((e=>ks.get(i).map((t=>e.concat([t]))))).flat()}if(e.isThreeOfAColor()){const t=Es[[e.minRed,e.minYellow,e.minBlue].indexOf(3)],i=ks.get(t);return _s(i,3)}return[]}static findBestGems(e,t){const i=Ns.map((e=>null)),a=Ns.map((e=>0)),s=i.slice(),o=a.slice();let l=e[0],n=0;return e.forEach((e=>{const r=new H(e.stats).computeEP(t);r>a[e.color]&&(a[e.color]=r,i[e.color]=e,e.color!=Ot.GemColorMeta&&r>n&&(n=r,l=e)),Ns.forEach((t=>{we(e,t)&&r>o[t]&&(o[t]=r,s[t]=e)}))})),{bestGemForColor:i,bestGemForColorEP:a,bestGemForSocket:s,bestGemForSocketEP:o,bestGem:l,bestGemEP:n}}};let Mu=Ou;t(Mu,"epUnitStats",bt.getAll().filter((e=>!!e.isStat()||[ge.PseudoStatMainHandDps,ge.PseudoStatOffHandDps,ge.PseudoStatRangedDps].includes(e.getPseudoStat()))));var Wu=(e=>(e[e.Unlaunched=0]="Unlaunched",e[e.Alpha=1]="Alpha",e[e.Beta=2]="Beta",e[e.Launched=3]="Launched",e))(Wu||{});const Vu=3,Fu={[ne.SpecBalanceDruid]:3,[ne.SpecFeralDruid]:3,[ne.SpecFeralTankDruid]:3,[ne.SpecRestorationDruid]:0,[ne.SpecElementalShaman]:3,[ne.SpecEnhancementShaman]:3,[ne.SpecRestorationShaman]:0,[ne.SpecHunter]:3,[ne.SpecMage]:3,[ne.SpecRogue]:3,[ne.SpecHolyPaladin]:0,[ne.SpecProtectionPaladin]:3,[ne.SpecRetributionPaladin]:3,[ne.SpecHealingPriest]:1,[ne.SpecShadowPriest]:3,[ne.SpecSmitePriest]:3,[ne.SpecWarlock]:3,[ne.SpecWarrior]:3,[ne.SpecProtectionWarrior]:3,[ne.SpecDeathknight]:3,[ne.SpecTankDeathknight]:3},zu=[ne.SpecSmitePriest];function ju(e){return Object.keys(F).map((e=>parseInt(e))).filter((t=>F[t]==e&&Fu[t]>0))}class Hu extends dd{constructor(e,a){super(e,"settings-menu",{title:"Options",footer:!0}),t(this,"simUI"),this.simUI=a,this.body.innerHTML='\n\t\t\t<div class="picker-group">\n\t\t\t\t<div class="fixed-rng-seed-container">\n\t\t\t\t\t<div class="fixed-rng-seed"></div>\n\t\t\t\t\t<div class="form-text">\n\t\t\t\t\t\t<span>Last used RNG seed:</span>&nbsp;<span class="last-used-rng-seed">0</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="language-picker within-raid-sim-hide"></div>\n\t\t\t</div>\n\t\t\t<div class="show-threat-metrics-picker w-50 pe-2"></div>\n\t\t\t<div class="show-experimental-picker w-50 pe-2"></div>\n\t\t',this.footer.innerHTML='\n\t\t\t<button\n\t\t\t\tclass="restore-defaults-button btn btn-primary"\n\t\t\t>Restore Defaults</button>\n\t\t';const s=this.rootElem.getElementsByClassName("restore-defaults-button")[0];i.getOrCreateInstance(s,{title:"Restores all default settings (gear, consumes, buffs, talents, EP weights, etc). Saved settings are preserved."}),s.addEventListener("click",(e=>{this.simUI.applyDefaults(l.nextEventID())}));const o=this.rootElem.getElementsByClassName("fixed-rng-seed")[0];new il(o,this.simUI.sim,{label:"Fixed RNG Seed",labelTooltip:"Seed value for the random number generator used during sims, or 0 to use different randomness each run. Use this to share exact sim results or for debugging.",extraCssClasses:["mb-0"],changedEvent:e=>e.fixedRngSeedChangeEmitter,getValue:e=>e.getFixedRngSeed(),setValue:(e,t,i)=>{t.setFixedRngSeed(e,i)}});const n=this.rootElem.getElementsByClassName("last-used-rng-seed")[0];n.textContent=String(this.simUI.sim.getLastUsedRngSeed()),this.simUI.sim.lastUsedRngSeedChangeEmitter.on((()=>n.textContent=String(this.simUI.sim.getLastUsedRngSeed())));const r=this.rootElem.getElementsByClassName("language-picker")[0],d=Object.keys(Hs),c=d.indexOf("en");new Dd(r,this.simUI.sim,{label:"Language",labelTooltip:"Controls the language for Wowhead tooltips.",values:d.map(((e,t)=>({name:Hs[e],value:t}))),changedEvent:e=>e.languageChangeEmitter,getValue:e=>{const t=d.indexOf(e.getLanguage());return-1==t?c:t},setValue:(e,t,i)=>{t.setLanguage(e,d[i]||"en")}}).changeEmitter.on((()=>setTimeout((()=>location.reload()),100)));const m=this.rootElem.getElementsByClassName("show-threat-metrics-picker")[0];new xt(m,this.simUI.sim,{label:"Show Threat/Tank Options",labelTooltip:"Shows all options and metrics relevant to tanks, like TPS/DTPS.",inline:!0,changedEvent:e=>e.showThreatMetricsChangeEmitter,getValue:e=>e.getShowThreatMetrics(),setValue:(e,t,i)=>{t.setShowThreatMetrics(e,i)}});const h=this.rootElem.getElementsByClassName("show-experimental-picker")[0];new xt(h,this.simUI.sim,{label:"Show Experimental",labelTooltip:"Shows experimental options, if there are any active experiments.",inline:!0,changedEvent:e=>e.showExperimentalChangeEmitter,getValue:e=>e.getShowExperimental(),setValue:(e,t,i)=>{t.setShowExperimental(e,i)}})}}class Bu extends m{static buildGitHubLink(){const e=h("a",{href:"https://github.com/WoWLegacySims/wotlk",target:"_blank",className:"github-link link-alt",dataset:{bsToggle:"tooltip",bsTitle:"Contribute on GitHub"}},h("i",{className:"fab fa-github fa-lg"}));return i.getOrCreateInstance(e),e}}class qu extends m{constructor(e,i){super(e,"sim-header"),t(this,"simUI"),t(this,"simTabsContainer"),t(this,"simToolbar"),t(this,"knownIssuesLink"),t(this,"knownIssuesContent"),this.simUI=i,this.simTabsContainer=this.rootElem.querySelector(".sim-tabs"),this.simToolbar=this.rootElem.querySelector(".sim-toolbar"),this.knownIssuesContent=h("ul",{className:"text-start ps-3 mb-0"}),this.knownIssuesLink=this.addKnownIssuesLink(),this.addBugReportLink(),this.addDownloadBinaryLink(),this.addSimOptionsLink(),this.addSocialLinks(),new IntersectionObserver((([e])=>e.target.classList.toggle("stuck",e.intersectionRatio<1)),{threshold:[1]}).observe(this.rootElem)}activateTab(e){this.simTabsContainer.getElementsByClassName(e)[0].click()}addTab(e,t){const i=0==this.simTabsContainer.children.length,a=h("li",{className:`${t} nav-item`,attributes:{role:"presentation"}},h("a",{className:`nav-link ${i&&"active"}`,dataset:{bsToggle:"tab",bsTarget:`#${t}`},attributes:{role:"tab","aria-selected":i},type:"button"},e));a.setAttribute("aria-controls",t),this.simTabsContainer.appendChild(a)}addSimTabLink(e){const t=0==this.simTabsContainer.children.length;e.navLink.setAttribute("aria-selected",t.toString()),t&&e.navLink.classList.add("active","show"),this.simTabsContainer.appendChild(e.navItem)}addImportLink(e,t,i){this.addImportExportLink("import-dropdown",e,t,i)}addExportLink(e,t,i){this.addImportExportLink("export-dropdown",e,t,i)}addImportExportLink(e,t,i,a){const s=this.rootElem.getElementsByClassName(e)[0].getElementsByClassName("dropdown-menu")[0],o=h("li",null,h("a",{href:"javascript:void(0)",className:"dropdown-item",attributes:{role:"button"}},t));o.children[0].addEventListener("click",(()=>i(s))),s.appendChild(o)}addToolbarLink(e){const t=h("div",{className:"sim-toolbar-item"},h("a",{href:e.href?e.href:"javascript:void(0)",className:e.classes,target:e.href?"_blank":"_self"},e.icon&&h("i",{className:e.icon}),e.text?` ${e.text} `:"")),a=t.children[0];return e.onclick&&a.addEventListener("click",(()=>{e.onclick&&e.onclick()})),e.tooltip&&new i(a,{placement:"bottom",title:e.tooltip,html:!0}),e.parent.appendChild(t)}addKnownIssuesLink(){return this.addToolbarLink({parent:this.simToolbar,text:"Known Issues",tooltip:this.knownIssuesContent,classes:"known-issues link-danger hide"}).children[0]}addKnownIssue(e){this.knownIssuesContent.appendChild(h("li",null,e)),this.knownIssuesLink.classList.remove("hide"),i.getInstance(this.knownIssuesLink)?.setContent({".tooltip-inner":this.knownIssuesContent})}addBugReportLink(){this.addToolbarLink({href:"https://github.com/WoWLegacySims/wotlk/issues/new/choose",parent:this.simToolbar,icon:"fas fa-bug fa-lg",tooltip:"Report a bug or<br>Request a feature"})}addDownloadBinaryLink(){const e="https://github.com/WoWLegacySims/wotlk/releases",t="fas fa-gauge-high fa-lg",i=this.simToolbar;document.location.href.includes("localhost")?fetch("/version").then((a=>{a.json().then((a=>{2==a.outdated&&this.addToolbarLink({href:e,parent:i,icon:t,tooltip:"Newer version of simulator available for download",classes:"downbin link-danger"})})).catch((e=>{console.warn("No version info found!")}))})):this.addToolbarLink({href:e,parent:i,icon:t,tooltip:"Download simulator for faster simulating",classes:"downbin"})}addSimOptionsLink(){this.addToolbarLink({parent:this.simToolbar,icon:"fas fa-cog fa-lg",tooltip:"Show Sim Options",classes:"sim-options",onclick:()=>new Hu(this.simUI.rootElem,this.simUI)})}addSocialLinks(){const e=document.createElement("div");e.classList.add("sim-toolbar-socials"),this.simToolbar.appendChild(e),this.addGitHubLink(e)}addGitHubLink(e){e.appendChild(h("div",{className:"sim-toolbar-item"},Bu.buildGitHubLink()))}customRootElement(){return h("header",{className:"sim-header"},h("div",{className:"sim-header-container"},h("ul",{className:"sim-tabs nav nav-tabs",attributes:{role:"tablist"}}),h("div",{className:"import-export within-raid-sim-hide"},h("div",{className:"dropdown sim-dropdown-menu import-dropdown"},h("a",{href:"javascript:void(0)",className:"import-link",attributes:{role:"button","aria-expanded":"false"},dataset:{bsToggle:"dropdown",bsDisplay:"dynamic"}},h("i",{className:"fa fa-download"})," Import "),h("ul",{className:"dropdown-menu"})),h("div",{className:"dropdown sim-dropdown-menu export-dropdown"},h("a",{href:"javascript:void(0)",className:"export-link",attributes:{role:"button","aria-expanded":"false"},dataset:{bsToggle:"dropdown",bsDisplay:"dynamic"}},h("i",{className:"fa fa-right-from-bracket"})," Export "),h("ul",{className:"dropdown-menu"}))),h("div",{className:"sim-toolbar"})))}}class $u extends m{constructor(e,i,a={}){super(e,"sim-title-dropdown-root"),t(this,"dropdownMenu"),t(this,"specLabels",{[ne.SpecBalanceDruid]:"Balance",[ne.SpecFeralDruid]:"Feral DPS",[ne.SpecFeralTankDruid]:"Feral Tank",[ne.SpecRestorationDruid]:"Restoration",[ne.SpecElementalShaman]:"Elemental",[ne.SpecEnhancementShaman]:"Enhancement",[ne.SpecRestorationShaman]:"Restoration",[ne.SpecHunter]:"Hunter",[ne.SpecMage]:"Mage",[ne.SpecRogue]:"Rogue",[ne.SpecHolyPaladin]:"Holy",[ne.SpecProtectionPaladin]:"Protection",[ne.SpecRetributionPaladin]:"Retribution",[ne.SpecHealingPriest]:"Healing",[ne.SpecShadowPriest]:"Shadow",[ne.SpecSmitePriest]:"Smite",[ne.SpecWarlock]:"Warlock",[ne.SpecWarrior]:"DPS",[ne.SpecProtectionWarrior]:"Protection",[ne.SpecDeathknight]:"DPS",[ne.SpecTankDeathknight]:"Tank"});const s=null===i?{type:"Raid"}:{type:"Spec",index:i},o=this.buildRootSimLink(s);a.noDropdown?this.rootElem.innerHTML=o.outerHTML:(this.rootElem.innerHTML=`\n\t\t\t<div class="dropdown sim-link-dropdown">\n\t\t\t\t${o.outerHTML}\n\t\t\t\t<ul class="dropdown-menu"></ul>\n\t\t\t</div>\n\t\t`,this.dropdownMenu=this.rootElem.getElementsByClassName("dropdown-menu")[0],this.buildDropdown(),this.dropdownMenu.addEventListener("click",(e=>{e.target.closest('a:not([href="javascript:void(0)"]')||(e.stopPropagation(),e.preventDefault())})))}buildDropdown(){if(3>=Wu.Alpha){const e=document.createElement("li");e.appendChild(this.buildRaidLink()),this.dropdownMenu?.appendChild(e)}Ts.forEach((e=>{const t=document.createElement("li"),i=ju(e);1==i.length?(t.appendChild(this.buildClassLink(e)),this.dropdownMenu?.appendChild(t)):i.length>1&&(t.appendChild(this.buildClassDropdown(e)),this.dropdownMenu?.appendChild(t))}))}buildClassDropdown(e){const t=ju(e),i=document.createElement("fragment"),a=document.createElement("ul");a.classList.add("dropdown-menu");const s=this.buildClassLink(e);return t.forEach((e=>{const t=document.createElement("li"),i=this.buildSpecLink(e);t.appendChild(i),a.appendChild(t)})),i.innerHTML=`\n\t\t\t<div class="dropend sim-link-dropdown">\n\t\t\t\t${s.outerHTML}\n\t\t\t\t${a.outerHTML}\n\t\t\t</div>\n    \t`,i.children[0]}buildRootSimLink(e){const t=this.getSimIconPath(e),i=this.getContextualKlass(e);let a;if("Raid"==e.type)a=Os;else{const t=F[e.index];a=ju(t).length>1?vt[e.index]:Gs[t]}const s=document.createElement("fragment");return s.innerHTML=`\n\t\t\t<a href="javascript:void(0)" class="sim-link ${i}" role="button" data-bs-toggle="dropdown" data-bs-trigger="click" aria-expanded="false">\n\t\t\t\t<div class="sim-link-content">\n\t\t\t\t\t<img src="${t}" class="sim-link-icon">\n\t\t\t\t\t<div class="d-flex flex-column">\n\t\t\t\t\t\t<span class="sim-link-label text-white">WoWLegacySims - WOTLK</span>\n\t\t\t\t\t\t<span class="sim-link-title">${a}</span>\n\t\t\t\t\t\t${this.launchStatusLabel(e)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</a>\n\t\t`,s.children[0]}buildRaidLink(){const e=this.getContextualKlass({type:"Raid"}),t=this.getSimIconPath({type:"Raid"}),i=Os,a=document.createElement("fragment");return a.innerHTML=`\n\t\t\t<a href="${Rs}" class="sim-link ${e}">\n\t\t\t\t<div class="sim-link-content">\n\t\t\t\t\t<img src="${t}" class="sim-link-icon">\n\t\t\t\t\t<div class="d-flex flex-column">\n\t\t\t\t\t\t<span class="sim-link-title">${i}</span>\n\t\t\t\t\t\t${this.launchStatusLabel({type:"Raid"})}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</a>\n    \t`,a.children[0]}buildClassLink(e){const t=ju(e),i=t.length>1?"javascript:void(0)":Ls(t[0]),a=this.getContextualKlass({type:"Class",index:e}),s=this.getSimIconPath({type:"Class",index:e}),o=Gs[e],l=document.createElement("fragment");return l.innerHTML=`\n\t\t\t<a href="${i}" class="sim-link ${a}" ${t.length>1?'role="button" data-bs-toggle="dropdown" aria-expanded="false"':""}>\n\t\t\t\t<div class="sim-link-content">\n\t\t\t\t\t<img src="${s}" class="sim-link-icon">\n\t\t\t\t\t<div class="d-flex flex-column">\n\t\t\t\t\t\t<span class="sim-link-title">${o}</span>\n\t\t\t\t\t\t${1==t.length?this.launchStatusLabel({type:"Spec",index:t[0]}):""}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</a>\n    \t`,l.children[0]}buildSpecLink(e){const t=Ls(e),i=this.getContextualKlass({type:"Spec",index:e}),a=this.getSimIconPath({type:"Spec",index:e}),s=Gs[F[e]],o=this.specLabels[e],l=document.createElement("fragment");return l.innerHTML=`\n\t\t\t<a href="${t}" class="sim-link ${i}" role="button">\n\t\t\t\t<div class="sim-link-content">\n\t\t\t\t\t<img src="${a}" class="sim-link-icon">\n\t\t\t\t\t<div class="d-flex flex-column">\n\t\t\t\t\t\t<span class="sim-link-label">${s}</span>\n\t\t\t\t\t\t<span class="sim-link-title">${o}</span>\n\t\t\t\t\t\t${this.launchStatusLabel({type:"Spec",index:e})}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</a>\n    \t`,l.children[0]}launchStatusLabel(e){if("Raid"==e.type&&3==Wu.Launched||"Spec"==e.type&&Fu[e.index]==Wu.Launched)return"";const t="Raid"==e.type?Wu[3]:Wu[Fu[e.index]],i=document.createElement("span");return i.classList.add("launch-status-label","text-brand"),i.textContent=t,i.outerHTML}getSimIconPath(e){let t;if("Raid"==e.type)t=Ms;else if("Class"==e.type){t=`/sims/wotlk/all/assets/img/${Gs[e.index].toLowerCase().replace(/\s/g,"_")}_icon.png`}else t=As[e.index];return t}getContextualKlass(e){return"Raid"==e.type?"text-white":"Class"==e.type?Ds(e.index):Us(e.index)}}const Ku=[];class Yu extends m{constructor(e,i,a){super(e,"sim-ui"),t(this,"sim"),t(this,"cssClass"),t(this,"cssScheme"),t(this,"isWithinRaidSim"),t(this,"changeEmitter"),t(this,"levelChangeEmitter",new l),t(this,"resultsViewer"),t(this,"simHeader"),t(this,"simContentContainer"),t(this,"simMain"),t(this,"simActionsContainer"),t(this,"iterationsPicker"),t(this,"simTabContentsContainer"),this.sim=i,this.cssClass=a.cssClass,this.cssScheme=a.cssScheme,this.isWithinRaidSim=null!=this.rootElem.closest(".within-raid-sim"),a.noticeText="",this.rootElem.innerHTML=`\n\t\t\t<div class="sim-root">\n\t\t\t\t<div class="sim-bg"></div>\n\t\t\t\t${a.noticeText?`<div class="notices-banner alert border-bottom mb-0 text-center">${a.noticeText}</div>`:""}\n\t\t\t\t<div class="sim-container">\n\t\t\t\t\t<aside class="sim-sidebar">\n\t\t\t\t\t\t<div class="sim-title"></div>\n\t\t\t\t\t\t<div class="sim-sidebar-content ${a.noticeText?"smaller":""}">\n\t\t\t\t\t\t\t<div class="sim-sidebar-actions within-raid-sim-hide"></div>\n\t\t\t\t\t\t\t<div class="sim-sidebar-results within-raid-sim-hide"></div>\n\t\t\t\t\t\t\t<div class="sim-sidebar-stats"></div>\n\t\t\t\t\t\t\t<div class="sim-sidebar-socials"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</aside>\n\t\t\t\t\t<div class="sim-content container-fluid"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`,this.simContentContainer=this.rootElem.querySelector(".sim-content"),this.simHeader=new qu(this.simContentContainer,this),this.simMain=document.createElement("main"),this.simMain.classList.add("sim-main","tab-content"),this.simContentContainer.appendChild(this.simMain),this.rootElem.classList.add(this.cssClass),this.isWithinRaidSim||this.rootElem.classList.add("not-within-raid-sim"),this.changeEmitter=l.onAny([this.sim.changeEmitter,this.levelChangeEmitter],"SimUIChange"),this.sim.crashEmitter.on(((e,t)=>this.handleCrash(t)));const s=()=>{this.sim.getShowDamageMetrics()?this.rootElem.classList.remove("hide-damage-metrics"):this.rootElem.classList.add("hide-damage-metrics")};s(),this.sim.showDamageMetricsChangeEmitter.on(s);const o=()=>{this.sim.getShowThreatMetrics()?this.rootElem.classList.remove("hide-threat-metrics"):this.rootElem.classList.add("hide-threat-metrics")};o(),this.sim.showThreatMetricsChangeEmitter.on(o);const n=()=>{this.sim.getShowHealingMetrics()?this.rootElem.classList.remove("hide-healing-metrics"):this.rootElem.classList.add("hide-healing-metrics")};n(),this.sim.showHealingMetricsChangeEmitter.on(n);const r=()=>{this.sim.getShowThreatMetrics()||this.sim.getShowDamageMetrics()&&this.sim.getShowHealingMetrics()?this.rootElem.classList.remove("hide-ep-ratios"):this.rootElem.classList.add("hide-ep-ratios")};r(),this.sim.showDamageMetricsChangeEmitter.on(r),this.sim.showHealingMetricsChangeEmitter.on(r),this.sim.showThreatMetricsChangeEmitter.on(r);const d=()=>{this.sim.getShowExperimental()?this.rootElem.classList.remove("hide-experimental"):this.rootElem.classList.add("hide-experimental")};d(),this.sim.showExperimentalChangeEmitter.on(d),this.addKnownIssues(a);const c=this.rootElem.querySelector(".sim-title");new $u(c,a.spec,{noDropdown:this.isWithinRaidSim}),this.simActionsContainer=this.rootElem.querySelector(".sim-sidebar-actions"),this.iterationsPicker=new il(this.simActionsContainer,this.sim,{label:"Iterations",extraCssClasses:["iterations-picker","within-raid-sim-hide"],changedEvent:e=>e.iterationsChangeEmitter,getValue:e=>e.getIterations(),setValue:(e,t,i)=>{t.setIterations(e,i)}}).rootElem;const m=this.rootElem.querySelector(".sim-sidebar-results");this.resultsViewer=new pc(m);this.rootElem.querySelector(".sim-sidebar-socials").appendChild(Bu.buildGitHubLink()),this.simTabContentsContainer=this.rootElem.querySelector(".sim-main.tab-content"),this.isWithinRaidSim||window.addEventListener("message",(async e=>{"runOnce"==e.data&&this.runSimOnce()}))}addAction(e,t,i){const a=document.createElement("button");a.classList.add("btn","btn-primary","w-100",t),a.textContent=e,a.addEventListener("click",i),this.simActionsContainer.appendChild(a)}addTab(e,t,i){const a=t.replace(/\s+/g,"-")+"-tab",s=0==this.simTabContentsContainer.children.length;this.simHeader.addTab(e,a);const o=document.createElement("fragment");o.innerHTML=`\n\t\t\t<div\n\t\t\t\tid="${a}"\n\t\t\t\tclass="tab-pane fade ${s?"active show":""}"\n\t\t\t>${i}</div>\n\t\t`,this.simTabContentsContainer.appendChild(o.children[0])}addSimTab(e){this.simHeader.addSimTabLink(e)}addWarning(e){this.resultsViewer.addWarning(e)}addKnownIssues(e){let t="";e.launchStatus==Wu.Unlaunched?t="This sim is a WORK IN PROGRESS. It is not fully developed and should not be used for general purposes.":e.launchStatus==Wu.Alpha?t="This sim is in ALPHA. Bugs are expected; please let us know if you find one!":e.launchStatus==Wu.Beta&&(t="This sim is in BETA. There may still be a few bugs; please let us know if you find one!"),t&&(e.knownIssues=[t].concat(e.knownIssues||[])),e.knownIssues&&e.knownIssues.length&&e.knownIssues.forEach((e=>this.simHeader.addKnownIssue(e))),Ku.forEach((e=>this.simHeader.addKnownIssue(e)))}getSettingsStorageKey(){return this.getStorageKey("__currentSettings__")}getSavedEncounterStorageKey(){return"sharedData__savedEncounter__"}isIndividualSim(){return this.rootElem.classList.contains("individual-sim-ui")}async runSim(e){this.resultsViewer.setPending();try{await this.sim.runRaidSim(l.nextEventID(),e)}catch(t){this.resultsViewer.hideAll(),this.handleCrash(t)}}async runSimOnce(){this.resultsViewer.setPending();try{await this.sim.runRaidSimWithLogs(l.nextEventID())}catch(e){this.resultsViewer.hideAll(),this.handleCrash(e)}}async handleCrash(e){if(!(e instanceof tl))return void alert(e);const t=e.errorStr;if(t.startsWith("[USER_ERROR] ")){let e=t.substring(13);return e=await x.replaceAllInString(e),void alert(e)}if(window.confirm("Simulation Failure:\n"+t+"\nPress Ok to file crash report")){const e=this.hashCode(t),i=this.toLink(),a=this.sim.getLastUsedRngSeed();fetch("https://api.github.com/search/issues?q=is:issue+is:open+repo:WoWLegacySims/wotlk+"+e).then((s=>{s.json().then((s=>{if(s.total_count>0)window.open(s.items[0].html_url,"_blank");else{const s=`${"https://github.com/WoWLegacySims/wotlk/issues/new?assignees=&labels=&title=Crash%20Report%20"}${e}&body=`,o=2048-s.length;let l=encodeURIComponent(`Link:\n${i}\n\nRNG Seed: ${a}\n\n${t}`);i.includes("/raid/")&&(l=encodeURIComponent(`${t}\nRNG Seed: ${a}\nLink:\n${i}`));let n=!1;for(;l.length>o-(n?3:0);)l=l.slice(0,l.lastIndexOf("%")),n=!0;n&&(l+="...",new Ju(this.rootElem,i)),window.open(s+l,"_blank")}}))})).catch((e=>{alert("Failed to file report... try again another time:"+e)}))}}hashCode(e){let t=0;for(let i=0,a=e.length;i<a;i++){t=(t<<5)-t+e.charCodeAt(i),t|=0}return t}}class Ju extends dd{constructor(e,t){super(e,"crash",{title:"Extra Crash Information"}),this.body.innerHTML='\n\t\t\t<div class="sim-crash-report">\n\t\t\t\t<h3 class="sim-crash-report-header">Please append the following complete link to the issue you just created. This will simplify debugging the issue.</h3>\n\t\t\t\t<textarea class="sim-crash-report-text form-control"></textarea>\n\t\t\t</div>\n\t\t';const i=document.createTextNode(t);this.body.querySelector("textarea")?.appendChild(i)}}function Zu(e,t){return function(e,t){zo[e]=t}(e,t),t}const Qu=[];class Xu extends Yu{constructor(e,i,a){super(e,i.sim,{cssClass:a.cssClass,cssScheme:a.cssScheme,spec:i.spec,knownIssues:a.knownIssues,launchStatus:Fu[i.spec]}),t(this,"player"),t(this,"individualConfig"),t(this,"raidSimResultsManager"),t(this,"prevEpIterations"),t(this,"prevEpSimResult"),t(this,"dpsRefStat"),t(this,"healRefStat"),t(this,"tankRefStat"),t(this,"bt"),this.rootElem.classList.add("individual-sim-ui"),this.player=i,this.individualConfig=a,this.raidSimResultsManager=null,this.prevEpIterations=0,this.prevEpSimResult=null,this.levelChangeEmitter=this.player.levelChangeEmitter,(a.itemSwapSlots||[]).length>0&&!Qu.includes(i.spec)&&Qu.push(i.spec),this.addWarning({updateOn:this.player.gearChangeEmitter,getContent:()=>{if(!this.player.getGear().hasInactiveMetaGem(this.player.isBlacksmithing(),this.player.canUseExtraSockets()))return"";const e=this.player.getGear().getMetaGem();return`Meta gem disabled (${e.name}): ${Ws(e)}`}}),this.addWarning({updateOn:l.onAny([this.player.gearChangeEmitter,this.player.professionChangeEmitter]),getContent:()=>{const e=this.player.getGear().getFailedProfessionRequirements(this.player.getProfessions());return 0==e.length?"":e.map((e=>`${e.name} requires ${Ft.get(e.requiredProfession)}, but it is not selected.`))}}),this.addWarning({updateOn:this.player.gearChangeEmitter,getContent:()=>{const e=this.player.getGear().getJCGems(this.player.isBlacksmithing(),this.player.canUseExtraSockets());return e.length<=3?"":`Only 3 Jewelcrafting Gems are allowed, but ${e.length} are equipped.`}}),this.addWarning({updateOn:l.onAny([this.levelChangeEmitter,this.player.talentsChangeEmitter]),getContent:()=>{const e=Vs(this.player.getTalentsString());return 0==e?"":e<i.getMaxTalentPoints()?"Unspent talent points.":e>i.getMaxTalentPoints()?"More than maximum talent points spent.":""}}),this.addWarning({updateOn:l.onAny([this.player.gearChangeEmitter,this.player.talentsChangeEmitter]),getContent:()=>this.player.canDualWield2H()||(this.player.getEquippedItem(Q.ItemSlotMainHand)?.item.handType!=Re.HandTypeTwoHand||null==this.player.getEquippedItem(Q.ItemSlotOffHand))&&this.player.getEquippedItem(Q.ItemSlotOffHand)?.item.handType!=Re.HandTypeTwoHand?"":"Dual wielding two-handed weapon(s) without Titan's Grip spec."}),(a.warnings||[]).forEach((e=>this.addWarning(e(this)))),this.isWithinRaidSim||this.sim.waitForInit().then((()=>{this.loadSettings(),Ga(this.player.spec)&&alert("*** WARNING - USE AT YOUR OWN RISK ***\n\nThe entire concept of a healing sim is EXPERIMENTAL. All results should be taken with an EXTREMELY large grain of salt.\n\nThis tool is currently more similar to a spreadsheet than a true sim. Options for specifying incoming damage profiles in order to have proper reactive rotations have not yet been added.")})),this.addSidebarComponents(),this.addGearTab(),this.bt=this.addBulkTab(),this.addSettingsTab(),this.addTalentsTab(),this.addRotationTab(),this.isWithinRaidSim||this.addDetailedResultsTab(),this.addTopbarComponents()}loadSettings(){const e=l.nextEventID();l.freezeAllAndDo((()=>{this.applyDefaults(e);const t=window.localStorage.getItem(this.getSettingsStorageKey());if(null!=t)try{const i=ct.fromJsonString(t);this.fromProto(e,i)}catch(i){console.warn("Failed to parse saved settings: "+i)}try{const t=hd.tryParseUrlLocation(window.location);t&&this.fromProto(e,t.settings,t.categories)}catch(i){console.warn("Failed to parse link settings: "+i)}window.location.hash="",this.player.setName(e,"Player"),this.changeEmitter.on((e=>{const t=ct.toJsonString(this.toProto());window.localStorage.setItem(this.getSettingsStorageKey(),t)}))}))}addSidebarComponents(){var e,t,i,a;this.raidSimResultsManager=Fs(this),e=this,t=this.individualConfig.epStats,i=this.individualConfig.epPseudoStats,a=this.individualConfig.epReferenceStat,e.addAction("Stat Weights","ep-weights-action",(()=>{new Mu(e,t,i||[],a)})),new al(this.rootElem.querySelector(".sim-sidebar-stats"),this.player,this.individualConfig.displayStats,this.individualConfig.modifyDisplayStats)}addGearTab(){new vc(this.simTabContentsContainer,this).rootElem.classList.add("active","show")}addBulkTab(){const e=new Ic(this.simTabContentsContainer,this);return e.navLink.hidden=!this.sim.getShowExperimental(),this.sim.showExperimentalChangeEmitter.on((()=>{e.navLink.hidden=!this.sim.getShowExperimental()})),e}addSettingsTab(){new Iu(this.simTabContentsContainer,this)}addTalentsTab(){new Uu(this.simTabContentsContainer,this)}addRotationTab(){new Um(this.simTabContentsContainer,this)}addDetailedResultsTab(){this.addTab("Results","detailed-results-tab",'\n\t\t\t<div class="detailed-results">\n\t\t\t</div>\n\t\t'),new zs(this.rootElem.getElementsByClassName("detailed-results")[0],this,this.raidSimResultsManager)}addTopbarComponents(){this.simHeader.addImportLink("JSON",(e=>new pd(this.rootElem,this)),!0),this.simHeader.addImportLink("80U",(e=>new ud(this.rootElem,this)),!0),this.simHeader.addImportLink("WoWHead",(e=>new fd(this.rootElem,this)),!1),this.simHeader.addImportLink("Addon",(e=>new wd(this.rootElem,this)),!0),this.simHeader.addExportLink("Link",(e=>new bd(this.rootElem,this)),!1),this.simHeader.addExportLink("JSON",(e=>new vd(this.rootElem,this)),!0),this.simHeader.addExportLink("WoWHead",(e=>new Sd(this.rootElem,this)),!1),this.simHeader.addExportLink("80U EP",(e=>new Pd(this.rootElem,this)),!1),this.simHeader.addExportLink("Pawn EP",(e=>new Cd(this.rootElem,this)),!1),this.simHeader.addExportLink("CLI",(e=>new _d(this.rootElem,this)),!0)}applyDefaults(e){l.freezeAllAndDo((()=>{const t=_e(this.player.spec),i=Ga(this.player.spec),a=this.individualConfig.defaults.raidBuffs.totemOfWrath||this.individualConfig.defaults.debuffs.totemOfWrath;this.individualConfig.defaults.raidBuffs.totemOfWrath=a,this.individualConfig.defaults.debuffs.totemOfWrath=a,this.player.applySharedDefaults(e),this.player.setRace(e,Z[this.player.spec][0]),this.player.setGear(e,this.sim.db.lookupEquipmentSpec(this.individualConfig.defaults.gear)),this.player.setConsumes(e,this.individualConfig.defaults.consumes),this.player.setTalentsString(e,this.individualConfig.defaults.talents.talentsString),this.player.setGlyphs(e,this.individualConfig.defaults.talents.glyphs||K.create()),this.player.setSpecOptions(e,this.individualConfig.defaults.specOptions),this.player.setBuffs(e,this.individualConfig.defaults.individualBuffs),this.player.getParty().setBuffs(e,this.individualConfig.defaults.partyBuffs),this.player.getRaid().setBuffs(e,this.individualConfig.defaults.raidBuffs),this.player.setEpWeights(e,this.individualConfig.defaults.epWeights);const s=this.player.getDefaultEpRatios(t,i);this.player.setEpRatios(e,s),this.player.setProfession1(e,this.individualConfig.defaults.other?.profession1||ae.Engineering),this.player.setProfession2(e,this.individualConfig.defaults.other?.profession2||ae.Jewelcrafting),this.player.setExpansion(e,this.individualConfig.defaults.other?.expansion||se.ExpansionWotlk),this.player.setLevel(e,this.individualConfig.defaults.other?.level||this.player.getMaxLevel()),this.player.setDistanceFromTarget(e,this.individualConfig.defaults.other?.distanceFromTarget||0),this.player.setChannelClipDelay(e,this.individualConfig.defaults.other?.channelClipDelay||0),this.player.setNibelungAverageCasts(e,this.individualConfig.defaults.other?.nibelungAverageCasts||11),this.isWithinRaidSim?this.sim.raid.setTargetDummies(e,0):(this.sim.raid.setTargetDummies(e,i?9:0),this.sim.encounter.applyDefaults(e),this.sim.raid.setDebuffs(e,this.individualConfig.defaults.debuffs),this.sim.applyDefaults(e,t,i),t?this.sim.raid.setTanks(e,[this.player.makeUnitReference()]):this.sim.raid.setTanks(e,[]))}))}getSavedGearStorageKey(){return this.getStorageKey("__savedGear__")}getSavedRotationStorageKey(){return this.getStorageKey("__savedRotation__")}getSavedSettingsStorageKey(){return this.getStorageKey("__savedSettings__")}getSavedTalentsStorageKey(){return this.getStorageKey("__savedTalents__")}getStorageKey(e){return js[this.player.spec]+e}toProto(e){const t=t=>!e||0==e.length||e.includes(t),i=ct.create({player:this.player.toProto(!0,!1,e)});return t(Qo.Miscellaneous)&&ct.mergePartial(i,{tanks:this.sim.raid.getTanks()}),t(Qo.Encounter)&&ct.mergePartial(i,{encounter:this.sim.encounter.toProto()}),t(Qo.External)&&ct.mergePartial(i,{partyBuffs:this.player.getParty()?.getBuffs()||o.create(),raidBuffs:this.sim.raid.getBuffs(),debuffs:this.sim.raid.getDebuffs(),targetDummies:this.sim.raid.getTargetDummies()}),t(Qo.UISettings)&&ct.mergePartial(i,{settings:this.sim.toProto(),epWeightsStats:this.player.getEpWeights().toProto(),epRatios:this.player.getEpRatios(),dpsRefStat:this.dpsRefStat,healRefStat:this.healRefStat,tankRefStat:this.tankRefStat}),i}toLink(){return bd.createLink(this)}getLevel(){return this.player.getLevel()}fromProto(e,t,i){const a=e=>!i||0==i.length||i.includes(e),s=_e(this.player.spec),n=Ga(this.player.spec);l.freezeAllAndDo((()=>{if(t.player){if(this.player.fromProto(e,t.player,i),a(Qo.Miscellaneous)&&this.sim.raid.setTanks(e,t.tanks||[]),a(Qo.External)){this.sim.raid.setBuffs(e,t.raidBuffs||Ue.create()),this.sim.raid.setDebuffs(e,t.debuffs||Oe.create());const i=this.player.getParty();i&&i.setBuffs(e,t.partyBuffs||o.create()),this.sim.raid.setTargetDummies(e,t.targetDummies)}if(a(Qo.Encounter)&&this.sim.encounter.fromProto(e,t.encounter||Ge.create()),a(Qo.UISettings)){t.epWeightsStats?this.player.setEpWeights(e,H.fromProto(t.epWeightsStats)):this.player.setEpWeights(e,this.individualConfig.defaults.epWeights);const i=this.player.getDefaultEpRatios(s,n);if(t.epRatios){const a=new Array(i.length-t.epRatios.length).fill(0);this.player.setEpRatios(e,t.epRatios.concat(a))}else this.player.setEpRatios(e,i);t.dpsRefStat&&(this.dpsRefStat=t.dpsRefStat),t.healRefStat&&(this.healRefStat=t.healRefStat),t.tankRefStat&&(this.tankRefStat=t.tankRefStat),t.settings?this.sim.fromProto(e,t.settings):this.sim.applyDefaults(e,s,n)}}}))}}function eg(e,t,i){return function(e,t,i){let a=[];null!=i.talentTree&&a.push((e=>e.getTalentTree()==i.talentTree));null!=i.talentTrees&&a.push((e=>(i.talentTrees||[]).includes(e.getTalentTree())));null!=i.faction&&a.push((e=>e.getFaction()==i.faction));null!=i.customCondition&&a.push(i.customCondition);return{name:e,tooltip:i.tooltip||Ec,gear:t,enableWhen:a.length>0?e=>a.every((t=>t(e))):void 0}}(e,gt.fromJson(t),i||{})}function tg(e,t,i){return ag(e,ts.create({rotation:$.fromJson(t)}),i)}function ig(e,t,i,a){return ag(e,ts.create({rotation:{type:ce.TypeSimple,simple:{specRotationJson:JSON.stringify(V[t].rotationToJson(i))}}}),a)}function ag(e,t,i){let a=[];return null!=i?.talentTree&&a.push((e=>e.getTalentTree()==i.talentTree)),{name:e,rotation:t,enableWhen:a.length>0?e=>a.every((t=>t(e))):void 0}}export{Vh as $,Ph as A,oh as B,Nd as C,Hd as D,rh as E,Zm as F,to as G,eh as H,Xu as I,Mc as J,kc as K,th as L,Ah as M,ch as N,Qm as O,Bo as P,Ih as Q,Fd as R,el as S,qd as T,Xm as U,sh as V,dh as W,Dc as X,il as Y,Uh as Z,Dh as _,Lc as a,jh as a0,dp as a1,Uc as a2,Tc as a3,Gc as a4,ig as a5,Lh as a6,Ip as a7,Rh as a8,Wh as a9,uc as aA,yc as aB,zu as aC,Om as aD,Sc as aE,Yu as aF,Vu as aG,Km as aH,Ym as aI,Jm as aJ,zd as aK,hh as aL,xh as aM,ph as aN,uh as aO,Bh as aP,up as aa,gp as ab,$d as ac,Kd as ad,Yd as ae,Jd as af,Qd as ag,Zd as ah,$m as ai,Su as aj,qm as ak,Tu as al,Gu as am,Wo as an,_u as ao,$s as ap,fh as aq,wh as ar,jo as as,cd as at,xd as au,qo as av,$o as aw,Dd as ax,no as ay,dd as az,eg as b,tg as c,Gh as d,Eh as e,lp as f,np as g,pp as h,Nc as i,Kp as j,fp as k,Hh as l,Wc as m,Bd as n,rp as o,_h as p,mp as q,Zu as r,jd as s,jc as t,Zs as u,Pc as v,nh as w,lh as x,ah as y,ih as z};
//# sourceMappingURL=preset_utils-df16cf84.chunk.js.map
